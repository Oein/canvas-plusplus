var Nl=Object.defineProperty;var Ml=(e,t,r)=>t in e?Nl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var qt=(e,t,r)=>Ml(e,typeof t!="symbol"?t+"":t,r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const h of o)if(h.type==="childList")for(const f of h.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&n(f)}).observe(document,{childList:!0,subtree:!0});function r(o){const h={};return o.integrity&&(h.integrity=o.integrity),o.referrerPolicy&&(h.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?h.credentials="include":o.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function n(o){if(o.ep)return;o.ep=!0;const h=r(o);fetch(o.href,h)}})();var Cr=Object.defineProperty,Rl=(e,t,r)=>t in e?Cr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Tr=(e,t)=>{for(var r in t)Cr(e,r,{get:t[r],enumerable:!0})},g=(e,t,r)=>(Rl(e,typeof t!="symbol"?t+"":t,r),r),q={move:"M",line:"L",curve:"C",arc:"A",close:"Z"},Er={};Tr(Er,{HALF_PI:()=>Nt,NumArray:()=>de,TWO_PI:()=>Yt,decomposeMatrix:()=>Ye,getComputedMatrix:()=>Lr,getPoT:()=>Or,lerp:()=>Gt,mod:()=>$t,setMatrix:()=>Ar,toFixed:()=>Tt});var Ct;typeof window<"u"?Ct=window:typeof global<"u"?Ct=global:typeof self<"u"&&(Ct=self);var Sr,Yt=Math.PI*2,Nt=Math.PI*.5;function Ye(e,t,r,n,o,h){let f;return arguments.length<=1?(f=e.a,t=e.b,r=e.c,n=e.d,o=e.e,h=e.f):f=e,{translateX:o,translateY:h,scaleX:Math.sqrt(f*f+t*t),scaleY:Math.sqrt(r*r+n*n),rotation:180*Math.atan2(t,f)/Math.PI}}function Ar(e){Sr=e}function Lr(e,t){t=t&&t.identity()||new Sr;let r=e;const n=[];for(;r&&r._matrix;)n.push(r._matrix),r=r.parent;n.reverse();for(let o=0;o<n.length;o++){const f=n[o].elements;t.multiply(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8],f[9])}return t}function Gt(e,t,r){return r*(t-e)+e}var Xi=[2,4,8,16,32,64,128,256,512,1024,2048,4096];function Or(e){let t=0;for(;Xi[t]&&Xi[t]<e;)t++;return Xi[t]}function $t(e,t){for(;e<0;)e+=t;return e%t}var de=Ct.Float32Array||Array,Bl=Math.floor;function Tt(e){return Bl(e*1e6)/1e6}var kr={};Tr(kr,{Curve:()=>Ue,getAnchorsFromArcData:()=>Xl,getComponentOnCubicBezier:()=>Je,getControlPoints:()=>Fr,getCurveBoundingBox:()=>Mr,getCurveFromPoints:()=>Br,getCurveLength:()=>Nr,getReflection:()=>$i,integrate:()=>Rr,subdivide:()=>cs});var D=class{constructor(){g(this,"_events",{}),g(this,"_bound",!1)}addEventListener(e,t){return(this._events[e]||(this._events[e]=[])).push(t),this._bound=!0,this}on(){return this.addEventListener.apply(this,arguments)}bind(){return this.addEventListener.apply(this,arguments)}removeEventListener(e,t){if(!this._events)return this;if(!e&&!t)return this._events={},this._bound=!1,this;const r=e?[e]:Object.keys(this._events);for(let n=0,o=r.length;n<o;n++){e=r[n];let h=this._events[e];if(h){let f=[];if(t)for(let u=0,d=h.length;u<d;u++){let _=h[u];_=_.handler?_.handler:_,t!==_&&f.push(_)}this._events[e]=f}}return this}off(){return this.removeEventListener.apply(this,arguments)}unbind(){return this.removeEventListener.apply(this,arguments)}dispatchEvent(e){if(!this._events)return this;const t=Array.prototype.slice.call(arguments,1),r=this._events[e];if(r)for(let n=0;n<r.length;n++)r[n].call(this,...t);return this}trigger(){return this.dispatchEvent.apply(this,arguments)}listen(e,t,r){const n=this;e&&(o.obj=e,o.name=t,o.handler=r,e.on(t,o));function o(){r.apply(n,arguments)}return n}ignore(e,t,r){return e.off(t,r),this}};g(D,"Types",{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change",remove:"remove",insert:"insert",order:"order",load:"load"});g(D,"Methods",["addEventListener","on","removeEventListener","off","unbind","dispatchEvent","trigger","listen","ignore"]);var Ts={x:{enumerable:!0,get:function(){return this._x},set:function(e){this._x!==e&&(this._x=e,this._bound&&this.dispatchEvent(D.Types.change))}},y:{enumerable:!0,get:function(){return this._y},set:function(e){this._y!==e&&(this._y=e,this._bound&&this.dispatchEvent(D.Types.change))}}},le=class extends D{constructor(e=0,t=0){super(),g(this,"_x",0),g(this,"_y",0);for(let r in Ts)Object.defineProperty(this,r,Ts[r]);this.x=e,this.y=t}static add(e,t){return new le(e.x+t.x,e.y+t.y)}static sub(e,t){return new le(e.x-t.x,e.y-t.y)}static subtract(e,t){return le.sub(e,t)}static ratioBetween(e,t){return(e.x*t.x+e.y*t.y)/(e.length()*t.length())}static angleBetween(e,t){if(arguments.length>=4){const o=arguments[0]-arguments[2],h=arguments[1]-arguments[3];return Math.atan2(h,o)}const r=e.x-t.x,n=e.y-t.y;return Math.atan2(n,r)}static distanceBetween(e,t){return Math.sqrt(le.distanceBetweenSquared(e,t))}static distanceBetweenSquared(e,t){const r=e.x-t.x,n=e.y-t.y;return r*r+n*n}set(e,t){return this.x=e,this.y=t,this}copy(e){return this.x=e.x,this.y=e.y,this}clear(){return this.x=0,this.y=0,this}clone(){return new le(this.x,this.y)}add(e,t){return arguments.length<=0?this:(arguments.length<=1?typeof e=="number"?(this.x+=e,this.y+=e):e&&typeof e.x=="number"&&typeof e.y=="number"&&(this.x+=e.x,this.y+=e.y):(this.x+=e,this.y+=t),this)}addSelf(e){return this.add.apply(this,arguments)}sub(e,t){return arguments.length<=0?this:(arguments.length<=1?typeof e=="number"?(this.x-=e,this.y-=e):e&&typeof e.x=="number"&&typeof e.y=="number"&&(this.x-=e.x,this.y-=e.y):(this.x-=e,this.y-=t),this)}subtract(){return this.sub.apply(this,arguments)}subSelf(e){return this.sub.apply(this,arguments)}subtractSelf(e){return this.sub.apply(this,arguments)}multiply(e,t){return arguments.length<=0?this:(arguments.length<=1?typeof e=="number"?(this.x*=e,this.y*=e):e&&typeof e.x=="number"&&typeof e.y=="number"&&(this.x*=e.x,this.y*=e.y):(this.x*=e,this.y*=t),this)}multiplySelf(e){return this.multiply.apply(this,arguments)}multiplyScalar(e){return this.multiply(e)}divide(e,t){return arguments.length<=0?this:(arguments.length<=1?typeof e=="number"?(this.x/=e,this.y/=e):e&&typeof e.x=="number"&&typeof e.y=="number"&&(this.x/=e.x,this.y/=e.y):(this.x/=e,this.y/=t),isNaN(this.x)&&(this.x=0),isNaN(this.y)&&(this.y=0),this)}divideSelf(e){return this.divide.apply(this,arguments)}divideScalar(e){return this.divide(e)}negate(){return this.multiply(-1)}dot(e){return this.x*e.x+this.y*e.y}length(){return Math.sqrt(this.lengthSquared())}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return this.divideScalar(this.length())}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}setLength(e){return this.normalize().multiplyScalar(e)}equals(e,t){return t=typeof t>"u"?1e-4:t,this.distanceTo(e)<t}lerp(e,t){const r=(e.x-this.x)*t+this.x,n=(e.y-this.y)*t+this.y;return this.set(r,n)}isZero(e){return e=typeof e>"u"?1e-4:e,this.length()<e}toString(){return this.x+", "+this.y}toObject(){return{x:this.x,y:this.y}}rotate(e){const t=this.x,r=this.y,n=Math.cos(e),o=Math.sin(e);return this.x=t*n-r*o,this.y=t*o+r*n,this}},z=le;g(z,"zero",new le);g(z,"left",new le(-1,0));g(z,"right",new le(1,0));g(z,"up",new le(0,-1));g(z,"down",new le(0,1));var ct=class extends z{constructor(e=0,t=0,r=0,n=0,o=0,h=0,f=q.move){super(e,t),g(this,"controls",{left:new z,right:new z}),g(this,"_command",q.move),g(this,"_relative",!0),g(this,"_rx",0),g(this,"_ry",0),g(this,"_xAxisRotation",0),g(this,"_largeArcFlag",0),g(this,"_sweepFlag",1);for(let d in Es)Object.defineProperty(this,d,Es[d]);this.command=f,this.relative=!0;const u=ct.makeBroadcast(this);this.controls.left.set(r,n).addEventListener(D.Types.change,u),this.controls.right.set(o,h).addEventListener(D.Types.change,u)}static makeBroadcast(e){return t;function t(){e._bound&&e.dispatchEvent(D.Types.change)}}copy(e){return this.x=e.x,this.y=e.y,typeof e.command=="string"&&(this.command=e.command),e.controls&&(e.controls.left&&this.controls.left.copy(e.controls.left),e.controls.right&&this.controls.right.copy(e.controls.right)),typeof e.relative=="boolean"&&(this.relative=e.relative),typeof e.rx=="number"&&(this.rx=e.rx),typeof e.ry=="number"&&(this.ry=e.ry),typeof e.xAxisRotation=="number"&&(this.xAxisRotation=e.xAxisRotation),typeof e.largeArcFlag=="number"&&(this.largeArcFlag=e.largeArcFlag),typeof e.sweepFlag=="number"&&(this.sweepFlag=e.sweepFlag),this}clone(){return new ct().copy(this)}toObject(){return{x:this.x,y:this.y,command:this.command,relative:this.relative,controls:{left:this.controls.left.toObject(),right:this.controls.right.toObject()},rx:this.rx,ry:this.ry,xAxisRotation:this.xAxisRotation,largeArcFlag:this.largeArcFlag,sweepFlag:this.sweepFlag}}toString(){return JSON.stringify(this.toObject())}},Es={command:{enumerable:!0,get:function(){return this._command},set:function(e){this._command!==e&&(this._command=e,this._bound&&this.dispatchEvent(D.Types.change))}},relative:{enumerable:!0,get:function(){return this._relative},set:function(e){this._relative!==!!e&&(this._relative=!!e,this._bound&&this.dispatchEvent(D.Types.change))}},rx:{enumerable:!0,get:function(){return this._rx},set:function(e){this._rx!==e&&(this._rx=e,this._bound&&this.dispatchEvent(D.Types.change))}},ry:{enumerable:!0,get:function(){return this._ry},set:function(e){this._ry!==e&&(this._ry=e,this._bound&&this.dispatchEvent(D.Types.change))}},xAxisRotation:{enumerable:!0,get:function(){return this._xAxisRotation},set:function(e){this._xAxisRotation!==e&&(this._xAxisRotation=e,this._bound&&this.dispatchEvent(D.Types.change))}},largeArcFlag:{enumerable:!0,get:function(){return this._largeArcFlag},set:function(e){this._largeArcFlag!==e&&(this._largeArcFlag=e,this._bound&&this.dispatchEvent(D.Types.change))}},sweepFlag:{get:function(){return this._sweepFlag},set:function(e){this._sweepFlag!==e&&(this._sweepFlag=e,this._bound&&this.dispatchEvent(D.Types.change))}}},Fl=0,Rt={nextFrameID:null,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Version:"v0.8.14",PublishDate:"2024-06-11T02:06:29.216Z",Identifier:"two-",Resolution:12,AutoCalculateImportedMatrices:!0,Instances:[],uniqueId:function(){return Fl++}},Ue={CollinearityEpsilon:Math.pow(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:.25,angle:0,epsilon:Number.EPSILON},abscissas:[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],weights:[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]]};function Je(e,t,r,n,o){const h=1-e;return h*h*h*t+3*h*h*e*r+3*h*e*e*n+e*e*e*o}function cs(e,t,r,n,o,h,f,u,d){d=d||Ue.RecursionLimit;const _=d+1;if(Math.abs(e-f)<.001&&Math.abs(t-u)<.001)return[new ct(f,u)];const y=[];for(let P=0;P<_;P++){const w=P/_,v=Je(w,e,r,o,f),C=Je(w,t,n,h,u);y.push(new ct(v,C))}return y}function Nr(e,t,r,n,o,h,f,u,d){if(e===r&&t===n&&o===f&&h===u){const L=f-e,O=u-t;return Math.sqrt(L*L+O*O)}const _=9*(r-o)+3*(f-e),y=6*(e+o)-12*r,P=3*(r-e),w=9*(n-h)+3*(u-t),v=6*(t+h)-12*n,C=3*(n-t);function k(L){const O=(_*L+y)*L+P,E=(w*L+v)*L+C;return Math.sqrt(O*O+E*E)}return Rr(k,0,1,d||Ue.RecursionLimit)}function Mr(e,t,r,n,o,h,f,u){const d=[],_=[[],[]];let y,P,w,v,C,k,L,O;for(let F=0;F<2;++F){if(F==0?(P=6*e-12*r+6*o,y=-3*e+9*r-9*o+3*f,w=3*r-3*e):(P=6*t-12*n+6*h,y=-3*t+9*n-9*h+3*u,w=3*n-3*t),Math.abs(y)<1e-12){if(Math.abs(P)<1e-12)continue;v=-w/P,0<v&&v<1&&d.push(v);continue}L=P*P-4*w*y,O=Math.sqrt(L),!(L<0)&&(C=(-P+O)/(2*y),0<C&&C<1&&d.push(C),k=(-P-O)/(2*y),0<k&&k<1&&d.push(k))}let E=d.length,N=E,W;for(;E--;)v=d[E],W=1-v,_[0][E]=W*W*W*e+3*W*W*v*r+3*W*v*v*o+v*v*v*f,_[1][E]=W*W*W*t+3*W*W*v*n+3*W*v*v*h+v*v*v*u;return _[0][N]=e,_[1][N]=t,_[0][N+1]=f,_[1][N+1]=u,_[0].length=_[1].length=N+2,{min:{x:Math.min.apply(0,_[0]),y:Math.min.apply(0,_[1])},max:{x:Math.max.apply(0,_[0]),y:Math.max.apply(0,_[1])}}}function Rr(e,t,r,n){let o=Ue.abscissas[n-2],h=Ue.weights[n-2],f=.5*(r-t),u=f+t,d=0,_=n+1>>1,y=n&1?h[d++]*e(u):0;for(;d<_;){const P=f*o[d];y+=h[d++]*(e(u+P)+e(u-P))}return f*y}function Br(e,t){const r=e.length,n=r-1;for(let o=0;o<r;o++){const h=e[o],f=t?$t(o-1,r):Math.max(o-1,0),u=t?$t(o+1,r):Math.min(o+1,n),d=e[f],_=h,y=e[u];Fr(d,_,y),_.command=o===0?q.move:q.curve}}function Fr(e,t,r){const n=z.angleBetween(e,t),o=z.angleBetween(r,t);let h=z.distanceBetween(e,t),f=z.distanceBetween(r,t),u=(n+o)/2;return h<1e-4||f<1e-4?(typeof t.relative=="boolean"&&!t.relative&&(t.controls.left.copy(t),t.controls.right.copy(t)),t):(h*=.33,f*=.33,o<n?u+=Nt:u-=Nt,t.controls.left.x=Math.cos(u)*h,t.controls.left.y=Math.sin(u)*h,u-=Math.PI,t.controls.right.x=Math.cos(u)*f,t.controls.right.y=Math.sin(u)*f,typeof t.relative=="boolean"&&!t.relative&&(t.controls.left.x+=t.x,t.controls.left.y+=t.y,t.controls.right.x+=t.x,t.controls.right.y+=t.y),t)}function $i(e,t,r){return new z(2*e.x-(t.x+e.x)-(r?e.x:0),2*e.y-(t.y+e.y)-(r?e.y:0))}function Xl(e,t,r,n,o,h,f){const u=Rt.Resolution;for(let d=0;d<u;d++){let _=(d+1)/u;f&&(_=1-_);const y=_*h+o,P=r*Math.cos(y),w=n*Math.sin(y),v=new ct(P,w);v.command=q.line}}var Dl=Ct.devicePixelRatio||1;function Yl(e){return e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1}function us(e){return Dl/Yl(e)}var Ss=Array.prototype.slice;function Ul(e){if(e==null)return!1;const t=e.length;return typeof t=="number"&&t>=0&&t<4294967296}var $={isNaN:function(e){return typeof e=="number"&&e!==+e},isElement:function(e){return!!(e&&e.nodeType===1)},isObject:function(e){const t=typeof e;return t==="function"||t==="object"&&!!e},extend:function(e){const t=Ss.call(arguments,1);for(let r=0;r<t.length;r++){const n=t[r];for(let o in n)e[o]=n[o]}return e},defaults:function(e){const t=Ss.call(arguments,1);for(let r=0;r<t.length;r++){const n=t[r];for(let o in n)e[o]===void 0&&(e[o]=n[o])}return e},each:function(e,t,r){const n=r||this,o=!Ul(e)&&Object.keys(e),h=(o||e).length;for(let f=0;f<h;f++){const u=o?o[f]:f;t.call(n,e[u],u,e)}return e},performance:Ct.performance&&Ct.performance.now?Ct.performance:Date},Si=class extends D{constructor(){super(),g(this,"_flagId",!1),g(this,"_flagClassName",!1),g(this,"_renderer",{}),g(this,"_id",""),g(this,"_className",""),g(this,"classList",[]);for(let e in As)Object.defineProperty(this,e,As[e])}flagReset(){this._flagId=this._flagClassName=!1}},As={renderer:{enumerable:!1,get:function(){return this._renderer}},id:{enumerable:!0,get:function(){return this._id},set:function(e){const t=this._id;e!==this._id&&(this._id=e,this._flagId=!0,this.parent&&(delete this.parent.children.ids[t],this.parent.children.ids[this._id]=this))}},className:{enumerable:!0,get:function(){return this._className},set:function(e){this._className!==e&&(this._flagClassName=!0,this.classList=e.split(/\s+?/),this._className=e)}}},Wl=Math.cos,Vl=Math.sin,Ls=Math.tan,Di=[],ee=class extends D{constructor(e,t,r,n,o,h){super(),g(this,"elements",new de(9)),g(this,"manual",!1);let f=e;Array.isArray(f)||(f=Array.prototype.slice.call(arguments)),this.identity(),f.length>0&&this.set(f)}static Multiply(e,t,r){if(t.length<=3){const F=e;let Z,G,st;const et=t[0]||0,Q=t[1]||0,ht=t[2]||0;return Z=F[0]*et+F[1]*Q+F[2]*ht,G=F[3]*et+F[4]*Q+F[5]*ht,st=F[6]*et+F[7]*Q+F[8]*ht,[Z,G,st]}const n=e[0],o=e[1],h=e[2],f=e[3],u=e[4],d=e[5],_=e[6],y=e[7],P=e[8],w=t[0],v=t[1],C=t[2],k=t[3],L=t[4],O=t[5],E=t[6],N=t[7],W=t[8];return r=r||new de(9),r[0]=n*w+o*k+h*E,r[1]=n*v+o*L+h*N,r[2]=n*C+o*O+h*W,r[3]=f*w+u*k+d*E,r[4]=f*v+u*L+d*N,r[5]=f*C+u*O+d*W,r[6]=_*w+y*k+P*E,r[7]=_*v+y*L+P*N,r[8]=_*C+y*O+P*W,r}set(e,t,r,n,o,h,f,u,d){if(typeof t>"u"){const _=e;e=_[0],t=_[1],r=_[2],n=_[3],o=_[4],h=_[5],f=_[6],u=_[7],d=_[8]}return this.elements[0]=e,this.elements[1]=t,this.elements[2]=r,this.elements[3]=n,this.elements[4]=o,this.elements[5]=h,this.elements[6]=f,this.elements[7]=u,this.elements[8]=d,this.trigger(D.Types.change)}copy(e){return this.elements[0]=e.elements[0],this.elements[1]=e.elements[1],this.elements[2]=e.elements[2],this.elements[3]=e.elements[3],this.elements[4]=e.elements[4],this.elements[5]=e.elements[5],this.elements[6]=e.elements[6],this.elements[7]=e.elements[7],this.elements[8]=e.elements[8],this.manual=e.manual,this.trigger(D.Types.change)}identity(){return this.elements[0]=ee.Identity[0],this.elements[1]=ee.Identity[1],this.elements[2]=ee.Identity[2],this.elements[3]=ee.Identity[3],this.elements[4]=ee.Identity[4],this.elements[5]=ee.Identity[5],this.elements[6]=ee.Identity[6],this.elements[7]=ee.Identity[7],this.elements[8]=ee.Identity[8],this.trigger(D.Types.change)}multiply(e,t,r,n,o,h,f,u,d){if(typeof t>"u")return this.elements[0]*=e,this.elements[1]*=e,this.elements[2]*=e,this.elements[3]*=e,this.elements[4]*=e,this.elements[5]*=e,this.elements[6]*=e,this.elements[7]*=e,this.elements[8]*=e,this.trigger(D.Types.change);if(typeof r>"u"&&(r=1),typeof n>"u"){e=e||0,t=t||0,r=r||0,o=this.elements;const T=o[0]*e+o[1]*t+o[2]*r,V=o[3]*e+o[4]*t+o[5]*r,R=o[6]*e+o[7]*t+o[8]*r;return[T,V,R]}const _=this.elements,y=[e,t,r,n,o,h,f,u,d],P=_[0],w=_[1],v=_[2],C=_[3],k=_[4],L=_[5],O=_[6],E=_[7],N=_[8],W=y[0],F=y[1],Z=y[2],G=y[3],st=y[4],et=y[5],Q=y[6],ht=y[7],at=y[8];return this.elements[0]=P*W+w*G+v*Q,this.elements[1]=P*F+w*st+v*ht,this.elements[2]=P*Z+w*et+v*at,this.elements[3]=C*W+k*G+L*Q,this.elements[4]=C*F+k*st+L*ht,this.elements[5]=C*Z+k*et+L*at,this.elements[6]=O*W+E*G+N*Q,this.elements[7]=O*F+E*st+N*ht,this.elements[8]=O*Z+E*et+N*at,this.trigger(D.Types.change)}inverse(e){const t=this.elements;e=e||new ee;const r=t[0],n=t[1],o=t[2],h=t[3],f=t[4],u=t[5],d=t[6],_=t[7],y=t[8],P=y*f-u*_,w=-y*h+u*d,v=_*h-f*d;let C=r*P+n*w+o*v;return C?(C=1/C,e.elements[0]=P*C,e.elements[1]=(-y*n+o*_)*C,e.elements[2]=(u*n-o*f)*C,e.elements[3]=w*C,e.elements[4]=(y*r-o*d)*C,e.elements[5]=(-u*r+o*h)*C,e.elements[6]=v*C,e.elements[7]=(-_*r+n*d)*C,e.elements[8]=(f*r-n*h)*C,e):null}scale(e,t){return arguments.length<=1&&(t=e),this.multiply(e,0,0,0,t,0,0,0,1)}rotate(e){const t=Wl(e),r=Vl(e);return this.multiply(t,-r,0,r,t,0,0,0,1)}translate(e,t){return this.multiply(1,0,e,0,1,t,0,0,1)}skewX(e){const t=Ls(e);return this.multiply(1,t,0,0,1,0,0,0,1)}skewY(e){const t=Ls(e);return this.multiply(1,0,0,t,1,0,0,0,1)}toString(e){return Di.length=0,this.toTransformArray(e,Di),Di.map(Tt).join(" ")}toTransformArray(e,t){const r=this.elements,n=!!t,o=r[0],h=r[1],f=r[2],u=r[3],d=r[4],_=r[5];if(e){const y=r[6],P=r[7],w=r[8];if(n){t[0]=o,t[1]=u,t[2]=y,t[3]=h,t[4]=d,t[5]=P,t[6]=f,t[7]=_,t[8]=w;return}return[o,u,y,h,d,P,f,_,w]}if(n){t[0]=o,t[1]=u,t[2]=h,t[3]=d,t[4]=f,t[5]=_;return}return[o,u,h,d,f,_]}toArray(e,t){const r=this.elements,n=!!t,o=r[0],h=r[1],f=r[2],u=r[3],d=r[4],_=r[5];if(e){const y=r[6],P=r[7],w=r[8];if(n){t[0]=o,t[1]=h,t[2]=f,t[3]=u,t[4]=d,t[5]=_,t[6]=y,t[7]=P,t[8]=w;return}return[o,h,f,u,d,_,y,P,w]}if(n){t[0]=o,t[1]=h,t[2]=f,t[3]=u,t[4]=d,t[5]=_;return}return[o,h,f,u,d,_]}toObject(){return{elements:this.toArray(!0),manual:!!this.manual}}clone(){return new ee().copy(this)}},Ee=ee;g(Ee,"Identity",[1,0,0,0,1,0,0,0,1]);Ar(Ee);var ye=class extends Si{constructor(){super(),g(this,"_flagMatrix",!0),g(this,"_flagScale",!1),g(this,"_matrix",null),g(this,"_worldMatrix",null),g(this,"_position",null),g(this,"_rotation",0),g(this,"_scale",1),g(this,"_skewX",0),g(this,"_skewY",0);for(let e in si)Object.defineProperty(this,e,si[e]);this._renderer.flagMatrix=Xr.bind(this),this.isShape=!0,this.id=Rt.Identifier+Rt.uniqueId(),this.matrix=new Ee,this.worldMatrix=new Ee,this.position=new z,this.rotation=0,this.scale=1,this.skewX=0,this.skewY=0}get renderer(){return this._renderer}set renderer(e){this._renderer=e}get translation(){return si.position.get.apply(this,arguments)}set translation(e){si.position.set.apply(this,arguments)}addTo(e){return e.add(this),this}remove(){return this.parent?(this.parent.remove(this),this):this}clone(e){const t=new ye;return t.position.copy(this.position),t.rotation=this.rotation,t.scale=this.scale,t.skewX=this.skewX,t.skewY=this.skewY,this.matrix.manual&&t.matrix.copy(this.matrix),e&&e.add(t),t._update()}_update(e){return!this._matrix.manual&&this._flagMatrix&&(this._matrix.identity().translate(this.position.x,this.position.y),this._scale instanceof z?this._matrix.scale(this._scale.x,this._scale.y):this._matrix.scale(this._scale),this._matrix.rotate(this.rotation),this._matrix.skewX(this.skewX),this._matrix.skewY(this.skewY)),e&&this.parent&&this.parent._update&&this.parent._update(),this}flagReset(){return this._flagMatrix=this._flagScale=!1,super.flagReset.call(this),this}},si={position:{enumerable:!0,get:function(){return this._position},set:function(e){this._position&&this._position.unbind(D.Types.change,this._renderer.flagMatrix),this._position=e,this._position.bind(D.Types.change,this._renderer.flagMatrix),Xr.call(this)}},rotation:{enumerable:!0,get:function(){return this._rotation},set:function(e){this._rotation=e,this._flagMatrix=!0}},scale:{enumerable:!0,get:function(){return this._scale},set:function(e){this._scale instanceof z&&this._scale.unbind(D.Types.change,this._renderer.flagMatrix),this._scale=e,this._scale instanceof z&&this._scale.bind(D.Types.change,this._renderer.flagMatrix),this._flagMatrix=!0,this._flagScale=!0}},skewX:{enumerable:!0,get:function(){return this._skewX},set:function(e){this._skewX=e,this._flagMatrix=!0}},skewY:{enumerable:!0,get:function(){return this._skewY},set:function(e){this._skewY=e,this._flagMatrix=!0}},matrix:{enumerable:!0,get:function(){return this._matrix},set:function(e){this._matrix=e,this._flagMatrix=!0}},worldMatrix:{enumerable:!0,get:function(){return Lr(this,this._worldMatrix),this._worldMatrix},set:function(e){this._worldMatrix=e}}};function Xr(){this._flagMatrix=!0}var xe=class extends Array{constructor(){super(),g(this,"_events",new D),arguments[0]&&Array.isArray(arguments[0])?arguments[0].length>0&&this.push.apply(this,arguments[0]):arguments.length>0&&this.push.apply(this,arguments)}get _bound(){return this._events._bound}set _bound(e){this._events._bound=e}addEventListener(){return this._events.addEventListener.apply(this,arguments)}on(){return this._events.on.apply(this,arguments)}bind(){return this._events.bind.apply(this,arguments)}removeEventListener(){return this._events.removeEventListener.apply(this,arguments)}off(){return this._events.off.apply(this,arguments)}unbind(){return this._events.unbind.apply(this,arguments)}dispatchEvent(){return this._events.dispatchEvent.apply(this,arguments)}trigger(){return this._events.trigger.apply(this,arguments)}listen(){return this._events.listen.apply(this,arguments)}ignore(){return this._events.ignore.apply(this,arguments)}pop(){const e=super.pop.apply(this,arguments);return this.trigger(D.Types.remove,[e]),e}shift(){const e=super.shift.apply(this,arguments);return this.trigger(D.Types.remove,[e]),e}push(){const e=super.push.apply(this,arguments);return this.trigger(D.Types.insert,arguments),e}unshift(){const e=super.unshift.apply(this,arguments);return this.trigger(D.Types.insert,arguments),e}splice(){const e=super.splice.apply(this,arguments);if(this.trigger(D.Types.remove,e),arguments.length>2){const t=this.slice(arguments[0],arguments[0]+arguments.length-2);this.trigger(D.Types.insert,t),this.trigger(D.Types.order)}return e}sort(){return super.sort.apply(this,arguments),this.trigger(D.Types.order),this}reverse(){return super.reverse.apply(this,arguments),this.trigger(D.Types.order),this}indexOf(){return super.indexOf.apply(this,arguments)}map(e,t){const r=[];for(let n=0;n<this.length;n++){const o=this[n];let h;t?h=e.call(t,o,n):h=e(o,n),r.push(h)}return r}},Dr=class extends xe{constructor(e){e=Array.isArray(e)?e:Array.prototype.slice.call(arguments),super(e),g(this,"ids",{}),this.attach(e),this.on(D.Types.insert,this.attach),this.on(D.Types.remove,this.detach)}attach(e){for(let t=0;t<e.length;t++){const r=e[t];r&&r.id&&(this.ids[r.id]=r)}return this}detach(e){for(let t=0;t<e.length;t++)delete this.ids[e[t].id];return this}},ri=Math.min,ni=Math.max,Yr=class extends ye{constructor(e){super(),g(this,"_flagAdditions",!1),g(this,"_flagSubtractions",!1),g(this,"_flagOrder",!1),g(this,"_flagOpacity",!0),g(this,"_flagBeginning",!1),g(this,"_flagEnding",!1),g(this,"_flagLength",!1),g(this,"_flagMask",!1),g(this,"_fill","#fff"),g(this,"_stroke","#000"),g(this,"_linewidth",1),g(this,"_opacity",1),g(this,"_visible",!0),g(this,"_cap","round"),g(this,"_join","round"),g(this,"_miter",4),g(this,"_closed",!0),g(this,"_curved",!1),g(this,"_automatic",!0),g(this,"_beginning",0),g(this,"_ending",1),g(this,"_length",0),g(this,"_mask",null);for(let t in Os)Object.defineProperty(this,t,Os[t]);this._renderer.type="group",this.additions=[],this.subtractions=[],this.children=Array.isArray(e)?e:Array.prototype.slice.call(arguments)}static InsertChildren(e){for(let t=0;t<e.length;t++)ks.call(this,e[t],this)}static RemoveChildren(e){for(let t=0;t<e.length;t++)ks.call(this,e[t])}static OrderChildren(e){this._flagOrder=!0}clone(e){const t=new Yr,r=this.children.map(function(n){return n.clone()});return t.add(r),t.opacity=this.opacity,this.mask&&(t.mask=this.mask),t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale,t.className=this.className,this.matrix.manual&&t.matrix.copy(this.matrix),e&&e.add(t),t._update()}toObject(){const e={children:[],translation:this.translation.toObject(),rotation:this.rotation,scale:this.scale instanceof z?this.scale.toObject():this.scale,opacity:this.opacity,className:this.className,mask:this.mask?this.mask.toObject():null};return this.matrix.manual&&(e.matrix=this.matrix.toObject()),$.each(this.children,function(t,r){e.children[r]=t.toObject()},this),e}corner(){const e=this.getBoundingClientRect(!0);for(let t=0;t<this.children.length;t++){const r=this.children[t];r.translation.x-=e.left,r.translation.y-=e.top}return this.mask&&(this.mask.translation.x-=e.left,this.mask.translation.y-=e.top),this}center(){const e=this.getBoundingClientRect(!0),t=e.left+e.width/2-this.translation.x,r=e.top+e.height/2-this.translation.y;for(let n=0;n<this.children.length;n++){const o=this.children[n];o.isShape&&(o.translation.x-=t,o.translation.y-=r)}return this.mask&&(this.mask.translation.x-=t,this.mask.translation.y-=r),this}getById(e){let t=null;function r(n){if(n.id===e)return n;if(n.children){for(let o=0;o<n.children.length;o++)if(t=r(n.children[o]),t)return t}return null}return r(this)}getByClassName(e){const t=[];function r(n){if(Array.prototype.indexOf.call(n.classList,e)>=0&&t.push(n),n.children)for(let o=0;o<n.children.length;o++){const h=n.children[o];r(h)}return t}return r(this)}getByType(e){const t=[];function r(n){if(n instanceof e&&t.push(n),n.children)for(let o=0;o<n.children.length;o++){const h=n.children[o];r(h)}return t}return r(this)}add(e){e instanceof Array?e=e.slice():e=Array.prototype.slice.call(arguments);for(let t=0;t<e.length;t++){const r=e[t];if(!(r&&r.id))continue;const n=Array.prototype.indexOf.call(this.children,r);n>=0&&this.children.splice(n,1),this.children.push(r)}return this}remove(e){const t=arguments.length,r=this.parent;if(t<=0&&r)return r.remove(this),this;e instanceof Array?e=e.slice():e=Array.prototype.slice.call(arguments);for(let n=0;n<e.length;n++){const o=e[n];if(!o||!this.children.ids[o.id])continue;const h=this.children.indexOf(o);h>=0&&this.children.splice(h,1)}return this}getBoundingClientRect(e){let t,r,n,o,h,f;this._update(!0);let u=1/0,d=-1/0,_=1/0,y=-1/0;const P=/texture|gradient/i;r=e?this.matrix:this.worldMatrix;for(let w=0;w<this.children.length;w++){const v=this.children[w];if(!(!v.visible||P.test(v._renderer.type))&&(t=v.getBoundingClientRect(e),n=typeof t.top!="number"||$.isNaN(t.top)||!isFinite(t.top),o=typeof t.left!="number"||$.isNaN(t.left)||!isFinite(t.left),h=typeof t.right!="number"||$.isNaN(t.right)||!isFinite(t.right),f=typeof t.bottom!="number"||$.isNaN(t.bottom)||!isFinite(t.bottom),!(n||o||h||f)))if(e){const[C,k]=r.multiply(t.left,t.top),[L,O]=r.multiply(t.right,t.top),[E,N]=r.multiply(t.left,t.bottom),[W,F]=r.multiply(t.right,t.bottom);_=ri(k,O,N,F),u=ri(C,L,E,W),d=ni(C,L,E,W),y=ni(k,O,N,F)}else _=ri(t.top,_),u=ri(t.left,u),d=ni(t.right,d),y=ni(t.bottom,y)}return{top:_,left:u,right:d,bottom:y,width:d-u,height:y-_}}noFill(){return this.children.forEach(function(e){e.noFill()}),this}noStroke(){return this.children.forEach(function(e){e.noStroke()}),this}subdivide(){const e=arguments;return this.children.forEach(function(t){t.subdivide.apply(t,e)}),this}_update(){let e,t,r;if(this._flagBeginning||this._flagEnding){const n=Math.min(this._beginning,this._ending),o=Math.max(this._beginning,this._ending),h=this.length;let f=0;const u=n*h,d=o*h;for(e=0;e<this.children.length;e++)r=this.children[e],t=r.length,u>f+t?(r.beginning=1,r.ending=1):d<f?(r.beginning=0,r.ending=0):u>f&&u<f+t?(r.beginning=(u-f)/t,r.ending=1):d>f&&d<f+t?(r.beginning=0,r.ending=(d-f)/t):(r.beginning=0,r.ending=1),f+=t}return super._update.apply(this,arguments)}flagReset(){return this._flagAdditions&&(this.additions.length=0,this._flagAdditions=!1),this._flagSubtractions&&(this.subtractions.length=0,this._flagSubtractions=!1),this._flagOrder=this._flagMask=this._flagOpacity=this._flagBeginning=this._flagEnding=!1,super.flagReset.call(this),this}},At=Yr;g(At,"Children",Dr);g(At,"Properties",["fill","stroke","linewidth","cap","join","miter","closed","curved","automatic"]);var Os={visible:{enumerable:!0,get:function(){return this._visible},set:function(e){this._flagVisible=this._visible!==e||this._flagVisible,this._visible=e}},opacity:{enumerable:!0,get:function(){return this._opacity},set:function(e){this._flagOpacity=this._opacity!==e||this._flagOpacity,this._opacity=e}},beginning:{enumerable:!0,get:function(){return this._beginning},set:function(e){this._flagBeginning=this._beginning!==e||this._flagBeginning,this._beginning=e}},ending:{enumerable:!0,get:function(){return this._ending},set:function(e){this._flagEnding=this._ending!==e||this._flagEnding,this._ending=e}},length:{enumerable:!0,get:function(){if(this._flagLength||this._length<=0){if(this._length=0,!this.children)return this._length;for(let e=0;e<this.children.length;e++){const t=this.children[e];this._length+=t.length}}return this._length}},fill:{enumerable:!0,get:function(){return this._fill},set:function(e){this._fill=e;for(let t=0;t<this.children.length;t++){const r=this.children[t];r.fill=e}}},stroke:{enumerable:!0,get:function(){return this._stroke},set:function(e){this._stroke=e;for(let t=0;t<this.children.length;t++){const r=this.children[t];r.stroke=e}}},linewidth:{enumerable:!0,get:function(){return this._linewidth},set:function(e){this._linewidth=e;for(let t=0;t<this.children.length;t++){const r=this.children[t];r.linewidth=e}}},join:{enumerable:!0,get:function(){return this._join},set:function(e){this._join=e;for(let t=0;t<this.children.length;t++){const r=this.children[t];r.join=e}}},miter:{enumerable:!0,get:function(){return this._miter},set:function(e){this._miter=e;for(let t=0;t<this.children.length;t++){const r=this.children[t];r.miter=e}}},cap:{enumerable:!0,get:function(){return this._cap},set:function(e){this._cap=e;for(let t=0;t<this.children.length;t++){const r=this.children[t];r.cap=e}}},closed:{enumerable:!0,get:function(){return this._closed},set:function(e){this._closed=e;for(let t=0;t<this.children.length;t++){const r=this.children[t];r.closed=e}}},curved:{enumerable:!0,get:function(){return this._curved},set:function(e){this._curved=e;for(let t=0;t<this.children.length;t++){const r=this.children[t];r.curved=e}}},automatic:{enumerable:!0,get:function(){return this._automatic},set:function(e){this._automatic=e;for(let t=0;t<this.children.length;t++){const r=this.children[t];r.automatic=e}}},children:{enumerable:!0,get:function(){return this._children},set:function(e){const t=At.InsertChildren.bind(this),r=At.RemoveChildren.bind(this),n=At.OrderChildren.bind(this);this._children&&(this._children.unbind(),this._children.length>0&&r(this._children)),this._children=new Dr(e),this._children.bind(D.Types.insert,t),this._children.bind(D.Types.remove,r),this._children.bind(D.Types.order,n),e.length>0&&t(e)}},mask:{enumerable:!0,get:function(){return this._mask},set:function(e){this._mask=e,this._flagMask=!0,$.isObject(e)&&!e.clip&&(e.clip=!0)}}};function ks(e,t){const r=e.parent;let n;if(r===t){o();return}if(r&&r.children.ids[e.id]&&(n=Array.prototype.indexOf.call(r.children,e),r.children.splice(n,1),h()),t){o();return}h(),r._flagAdditions&&r.additions.length===0&&(r._flagAdditions=!1),r._flagSubtractions&&r.subtractions.length===0&&(r._flagSubtractions=!1),delete e.parent;function o(){t.subtractions.length>0&&(n=Array.prototype.indexOf.call(t.subtractions,e),n>=0&&t.subtractions.splice(n,1)),t.additions.length>0&&(n=Array.prototype.indexOf.call(t.additions,e),n>=0&&t.additions.splice(n,1)),e.parent=t,t.additions.push(e),t._flagAdditions=!0}function h(){n=Array.prototype.indexOf.call(r.additions,e),n>=0&&r.additions.splice(n,1),n=Array.prototype.indexOf.call(r.subtractions,e),n<0&&(r.subtractions.push(e),r._flagSubtractions=!0)}}var Yi=[],Qi=Math.max,ql=Math.min,Ns=Math.abs,li=Math.sin,oi=Math.cos,jl=Math.acos,Ii=Math.sqrt,Et={isHidden:/(undefined|none|transparent)/i,alignments:{left:"start",middle:"center",right:"end"},baselines:{top:"top",middle:"middle",bottom:"bottom",baseline:"alphabetic"},shim:function(e,t){return e.tagName=e.nodeName=t||"canvas",e.nodeType=1,e.getAttribute=function(r){return this[r]},e.setAttribute=function(r,n){return this[r]=n,this},e},group:{renderChild:function(e){Et[e._renderer.type].render.call(e,this.ctx,!0,this.clip)},render:function(e){if(!this._visible)return this;this._update();const t=this._matrix.elements,r=this.parent;this._renderer.opacity=this._opacity*(r&&r._renderer?r._renderer.opacity:1);const n=this._mask,o=ai(t),h=!o||!!n;if(this._renderer.context||(this._renderer.context={}),this._renderer.context.ctx=e,h&&(e.save(),o||e.transform(t[0],t[3],t[1],t[4],t[2],t[5])),n&&Et[n._renderer.type].render.call(n,e,!0),this._opacity>0&&this._scale!==0)for(let f=0;f<this.children.length;f++){const u=this.children[f];Et[u._renderer.type].render.call(u,e)}return h&&e.restore(),this.flagReset()}},path:{render:function(e,t,r){let n,o,h,f,u,d,_,y,P,w,v,C,k,L,O,E,N,W,F,Z,G,st,et,Q,ht,at,T,V,R,X,Y,K,tt,it;if(it=this.parent&&this.parent._renderer?this.parent._renderer.opacity:1,R=this._mask,X=this._clip,u=this._opacity*(it||1),d=this._visible,!t&&(!d||X||u===0))return this;this._update(),n=this._matrix.elements,o=this._stroke,h=this._linewidth,f=this._fill,_=this._cap,y=this._join,P=this._miter,w=this._closed,v=this._renderer.vertices,C=v.length,k=C-1,Y=ai(n),tt=this.dashes,Y||(e.save(),e.transform(n[0],n[3],n[1],n[4],n[2],n[5])),R&&Et[R._renderer.type].render.call(R,e,!0),f&&(typeof f=="string"?e.fillStyle=f:(Et[f._renderer.type].render.call(f,e,this),e.fillStyle=f._renderer.effect)),o&&(typeof o=="string"?e.strokeStyle=o:(Et[o._renderer.type].render.call(o,e,this),e.strokeStyle=o._renderer.effect),h&&(e.lineWidth=h),P&&(e.miterLimit=P),y&&(e.lineJoin=y),!w&&_&&(e.lineCap=_)),typeof u=="number"&&(e.globalAlpha=u),tt&&tt.length>0&&(e.lineDashOffset=tt.offset||0,e.setLineDash(tt)),e.beginPath();let lt,ft,Xt,Pe,be,we,zt;for(let xt=0;xt<C;xt++)switch(E=v[xt],T=E.x,V=E.y,E.command){case q.close:e.closePath();break;case q.arc:lt=E.rx,ft=E.ry,Xt=E.xAxisRotation,Pe=E.largeArcFlag,be=E.sweepFlag,L=w?$t(xt-1,C):Qi(xt-1,0),O=v[L],we=O.x,zt=O.y,Et.renderSvgArcCommand(e,we,zt,lt,ft,Pe,be,Xt,T,V);break;case q.curve:L=w?$t(xt-1,C):Math.max(xt-1,0),O=v[L],et=O.controls&&O.controls.right||z.zero,Q=E.controls&&E.controls.left||z.zero,O._relative?(G=et.x+O.x,st=et.y+O.y):(G=et.x,st=et.y),E._relative?(F=Q.x+E.x,Z=Q.y+E.y):(F=Q.x,Z=Q.y),e.bezierCurveTo(G,st,F,Z,T,V),xt>=k&&w&&(N=W,ht=E.controls&&E.controls.right||z.zero,at=N.controls&&N.controls.left||z.zero,E._relative?(G=ht.x+E.x,st=ht.y+E.y):(G=ht.x,st=ht.y),N._relative?(F=at.x+N.x,Z=at.y+N.y):(F=at.x,Z=at.y),T=N.x,V=N.y,e.bezierCurveTo(G,st,F,Z,T,V));break;case q.line:e.lineTo(T,V);break;case q.move:W=E,e.moveTo(T,V);break}return w&&e.closePath(),!X&&!r&&(Et.isHidden.test(f)||(K=f._renderer&&f._renderer.offset,K&&(e.save(),e.translate(-f._renderer.offset.x,-f._renderer.offset.y),e.scale(f._renderer.scale.x,f._renderer.scale.y)),e.fill(),K&&e.restore()),Et.isHidden.test(o)||(K=o._renderer&&o._renderer.offset,K&&(e.save(),e.translate(-o._renderer.offset.x,-o._renderer.offset.y),e.scale(o._renderer.scale.x,o._renderer.scale.y),e.lineWidth=h/o._renderer.scale.x),e.stroke(),K&&e.restore())),Y||e.restore(),X&&!r&&e.clip(),tt&&tt.length>0&&e.setLineDash(Yi),this.flagReset()}},points:{render:function(e,t,r){let n,o,h,f,u,d,_,y,P,w,v,C,k,L,O,E;if(E=this.parent&&this.parent._renderer?this.parent._renderer.opacity:1,u=this._opacity*(E||1),d=this._visible,!t&&(!d||u===0))return this;this._update(),n=this._matrix.elements,o=this._stroke,h=this._linewidth,f=this._fill,y=this._renderer.collection,P=y.length,k=ai(n),O=this.dashes,_=this._size,k||(e.save(),e.transform(n[0],n[3],n[1],n[4],n[2],n[5])),f&&(typeof f=="string"?e.fillStyle=f:(Et[f._renderer.type].render.call(f,e,this),e.fillStyle=f._renderer.effect)),o&&(typeof o=="string"?e.strokeStyle=o:(Et[o._renderer.type].render.call(o,e,this),e.strokeStyle=o._renderer.effect),h&&(e.lineWidth=h)),typeof u=="number"&&(e.globalAlpha=u),O&&O.length>0&&(e.lineDashOffset=O.offset||0,e.setLineDash(O)),e.beginPath();let N=_*.5,W;this._sizeAttenuation||(W=this.worldMatrix.elements,W=Ye(W[0],W[3],W[1],W[4],W[2],W[5]),N/=Math.max(W.scaleX,W.scaleY));for(let F=0;F<P;F++)w=y[F],v=w.x,C=w.y,e.moveTo(v+N,C),e.arc(v,C,N,0,Yt);return r||(Et.isHidden.test(f)||(L=f._renderer&&f._renderer.offset,L&&(e.save(),e.translate(-f._renderer.offset.x,-f._renderer.offset.y),e.scale(f._renderer.scale.x,f._renderer.scale.y)),e.fill(),L&&e.restore()),Et.isHidden.test(o)||(L=o._renderer&&o._renderer.offset,L&&(e.save(),e.translate(-o._renderer.offset.x,-o._renderer.offset.y),e.scale(o._renderer.scale.x,o._renderer.scale.y),e.lineWidth=h/o._renderer.scale.x),e.stroke(),L&&e.restore())),k||e.restore(),O&&O.length>0&&e.setLineDash(Yi),this.flagReset()}},text:{render:function(e,t,r){const n=this.parent&&this.parent._renderer?this.parent._renderer.opacity:1,o=this._opacity*n,h=this._visible,f=this._mask,u=this._clip;if(!t&&(!h||u||o===0))return this;this._update();const d=this._matrix.elements,_=this._stroke,y=this._linewidth,P=this._fill,w=this._decoration,v=this._direction,C=ai(d),k=P._renderer&&P._renderer.offset&&_._renderer&&_._renderer.offset,L=this.dashes,O=Et.alignments[this._alignment]||this._alignment,E=Et.baselines[this._baseline]||this._baseline;let N,W,F,Z,G,st,et,Q,ht,at,T;if(C||(e.save(),e.transform(d[0],d[3],d[1],d[4],d[2],d[5])),f&&Et[f._renderer.type].render.call(f,e,!0),k||(e.font=[this._style,this._weight,this._size+"px/"+this._leading+"px",this._family].join(" ")),e.textAlign=O,e.textBaseline=E,e.direction=v,P&&(typeof P=="string"?e.fillStyle=P:(Et[P._renderer.type].render.call(P,e,this),e.fillStyle=P._renderer.effect)),_&&(typeof _=="string"?e.strokeStyle=_:(Et[_._renderer.type].render.call(_,e,this),e.strokeStyle=_._renderer.effect),y&&(e.lineWidth=y)),typeof o=="number"&&(e.globalAlpha=o),L&&L.length>0&&(e.lineDashOffset=L.offset||0,e.setLineDash(L)),!u&&!r&&(Et.isHidden.test(P)||(P._renderer&&P._renderer.offset?(st=P._renderer.scale.x,et=P._renderer.scale.y,e.save(),e.translate(-P._renderer.offset.x,-P._renderer.offset.y),e.scale(st,et),N=this._size/P._renderer.scale.y,W=this._leading/P._renderer.scale.y,e.font=[this._style,this._weight,N+"px/",W+"px",this._family].join(" "),F=P._renderer.offset.x/P._renderer.scale.x,Z=P._renderer.offset.y/P._renderer.scale.y,e.fillText(this.value,F,Z),e.restore()):e.fillText(this.value,0,0)),Et.isHidden.test(_)||(_._renderer&&_._renderer.offset?(st=_._renderer.scale.x,et=_._renderer.scale.y,e.save(),e.translate(-_._renderer.offset.x,-_._renderer.offset.y),e.scale(st,et),N=this._size/_._renderer.scale.y,W=this._leading/_._renderer.scale.y,e.font=[this._style,this._weight,N+"px/",W+"px",this._family].join(" "),F=_._renderer.offset.x/_._renderer.scale.x,Z=_._renderer.offset.y/_._renderer.scale.y,G=y/_._renderer.scale.x,e.lineWidth=G,e.strokeText(this.value,F,Z),e.restore()):e.strokeText(this.value,0,0))),/(underline|strikethrough)/i.test(w)){const V=e.measureText(this.value);let R=1;switch(w){case"underline":ht=V.actualBoundingBoxDescent,T=V.actualBoundingBoxDescent;break;case"strikethrough":ht=0,T=0,R=.5;break}switch(E){case"top":ht+=this._size*R,T+=this._size*R;break;case"baseline":case"bottom":ht-=this._size*R,T-=this._size*R;break}switch(O){case"left":case"start":Q=0,at=V.width;break;case"right":case"end":Q=-V.width,at=0;break;default:Q=-V.width/2,at=V.width/2}e.lineWidth=Math.max(Math.floor(this._size/15),1),e.strokeStyle=e.fillStyle,e.beginPath(),e.moveTo(Q,ht),e.lineTo(at,T),e.stroke()}return C||e.restore(),u&&!r&&e.clip(),L&&L.length>0&&e.setLineDash(Yi),this.flagReset()}},"linear-gradient":{render:function(e,t){if(t){if(this._update(),!this._renderer.effect||this._flagEndPoints||this._flagStops||this._flagUnits){let r,n=this.left._x,o=this.left._y,h=this.right._x,f=this.right._y;/objectBoundingBox/i.test(this._units)&&(r=t.getBoundingClientRect(!0),n=(n-.5)*r.width,o=(o-.5)*r.height,h=(h-.5)*r.width,f=(f-.5)*r.height),this._renderer.effect=e.createLinearGradient(n,o,h,f);for(let u=0;u<this.stops.length;u++){const d=this.stops[u];this._renderer.effect.addColorStop(d._offset,d._color)}}return this.flagReset()}}},"radial-gradient":{render:function(e,t){if(t){if(this._update(),!this._renderer.effect||this._flagCenter||this._flagFocal||this._flagRadius||this._flagStops||this._flagUnits){let r,n=this.center._x,o=this.center._y,h=this.focal._x,f=this.focal._y,u=this._radius;/objectBoundingBox/i.test(this._units)&&(r=t.getBoundingClientRect(!0),n=(n-.5)*r.width*.5,o=(o-.5)*r.height*.5,h=(h-.5)*r.width*.5,f=(f-.5)*r.height*.5,u*=Math.min(r.width,r.height)),this._renderer.effect=e.createRadialGradient(n,o,0,h,f,u);for(let d=0;d<this.stops.length;d++){const _=this.stops[d];this._renderer.effect.addColorStop(_._offset,_._color)}}return this.flagReset()}}},texture:{render:function(e){this._update();const t=this.image;return(!this._renderer.effect||(this._flagLoaded||this._flagImage||this._flagVideo||this._flagRepeat)&&this.loaded)&&(this._renderer.effect=e.createPattern(this.image,this._repeat)),(this._flagOffset||this._flagLoaded||this._flagScale)&&(this._renderer.offset instanceof z||(this._renderer.offset=new z),this._renderer.offset.x=-this._offset.x,this._renderer.offset.y=-this._offset.y,t&&(this._renderer.offset.x+=t.width/2,this._renderer.offset.y+=t.height/2,this._scale instanceof z?(this._renderer.offset.x*=this._scale.x,this._renderer.offset.y*=this._scale.y):(this._renderer.offset.x*=this._scale,this._renderer.offset.y*=this._scale))),(this._flagScale||this._flagLoaded)&&(this._renderer.scale instanceof z||(this._renderer.scale=new z),this._scale instanceof z?this._renderer.scale.copy(this._scale):this._renderer.scale.set(this._scale,this._scale)),this.flagReset()}},renderSvgArcCommand:function(e,t,r,n,o,h,f,u,d,_){u=u*Math.PI/180,n=Ns(n),o=Ns(o);const y=(t-d)/2,P=(r-_)/2,w=oi(u)*y+li(u)*P,v=-li(u)*y+oi(u)*P,C=w*w,k=v*v;let L=n*n,O=o*o;const E=C/L+k/O;if(E>1){const V=Ii(E);n=V*n,o=V*o,L=n*n,O=o*o}const N=L*k+O*C,W=(L*O-N)/N;let F=Ii(Qi(0,W));h===f&&(F=-F);const Z=F*n*v/o,G=-F*o*w/n,st=oi(u)*Z-li(u)*G+(t+d)/2,et=li(u)*Z+oi(u)*G+(r+_)/2,Q=Ms(1,0,(w-Z)/n,(v-G)/o),ht=Ms((w-Z)/n,(v-G)/o,(-w-Z)/n,(-v-G)/o)%Yt,at=Q+ht;zl(e,st,et,n,o,Q,at,f===0,u)}},We=class extends D{constructor(e){super();const t=e.smoothing!==!1;this.domElement=e.domElement||document.createElement("canvas"),this.ctx=this.domElement.getContext("2d"),this.overdraw=e.overdraw||!1,typeof this.ctx.imageSmoothingEnabled<"u"&&(this.ctx.imageSmoothingEnabled=t),this.scene=new At,this.scene.parent=this}setSize(e,t,r){return this.width=e,this.height=t,this.ratio=typeof r>"u"?us(this.ctx):r,this.domElement.width=e*this.ratio,this.domElement.height=t*this.ratio,this.domElement.style&&$.extend(this.domElement.style,{width:e+"px",height:t+"px"}),this.trigger(D.Types.resize,e,t,r)}render(){const e=this.ratio===1;return e||(this.ctx.save(),this.ctx.scale(this.ratio,this.ratio)),this.overdraw||this.ctx.clearRect(0,0,this.width,this.height),Et.group.render.call(this.scene,this.ctx),e||this.ctx.restore(),this}};g(We,"Utils",Et);function zl(e,t,r,n,o,h,f,u,d){const _=f-h,y=Ue.Tolerance.epsilon,P=Math.abs(_)<y;let w=$t(_,Yt);w<y&&(P?w=0:w=Yt),u===!0&&!P&&(w===Yt?w=-Yt:w=w-Yt);for(let v=0;v<Rt.Resolution;v++){const C=v/(Rt.Resolution-1),k=h+C*w;let L=t+n*Math.cos(k),O=r+o*Math.sin(k);if(d!==0){const E=Math.cos(d),N=Math.sin(d),W=L-t,F=O-r;L=W*E-F*N+t,O=W*N+F*E+r}e.lineTo(L,O)}}function Ms(e,t,r,n){const o=e*r+t*n,h=Ii(e*e+t*t)*Ii(r*r+n*n);let f=jl(Qi(-1,ql(1,o/h)));return e*n-t*r<0&&(f=-f),f}function ai(e){return e[0]==1&&e[3]==0&&e[1]==0&&e[4]==1&&e[2]==0&&e[5]==0}var Jt={Image:null,isHeadless:!1,shim:function(e,t){return We.Utils.shim(e),typeof t<"u"&&(Jt.Image=t),Jt.isHeadless=!0,e}},Zt={hasEventListeners:typeof Ct.addEventListener=="function",bind:function(e,t,r,n){return this.hasEventListeners?e.addEventListener(t,r,!!n):e.attachEvent("on"+t,r),Zt},unbind:function(e,t,r,n){return Zt.hasEventListeners?e.removeEventListeners(t,r,!!n):e.detachEvent("on"+t,r),Zt},getRequestAnimationFrame:function(){const e=["ms","moz","webkit","o"];let t=0,r=Ct.requestAnimationFrame;if(!r){for(let o=0;o<e.length;o++)r=Ct[e[o]+"RequestAnimationFrame"]||r;r=r||n}function n(o,h){const f=new Date().getTime(),u=Math.max(0,16-(f-t)),d=Ct.setTimeout(_,u);t=f+u;function _(){o(f+u)}return d}return r}},Xe=Ct.document?Ct.document.createElement("div"):{};Xe.id="help-two-load";Object.defineProperty(Zt,"temp",{enumerable:!0,get:function(){return $.isElement(Xe)&&!Ct.document.head.contains(Xe)&&(Xe.style.display="none",Ct.document.head.appendChild(Xe)),Xe}});var Kt=class extends Error{constructor(e){super(),g(this,"name","Two.js"),g(this,"message"),this.message=e}},Ai=class{constructor(){g(this,"map",{})}add(e,t){return this.map[e]=t,this}remove(e){return delete this.map[e],this}get(e){return this.map[e]}contains(e){return e in this.map}};function Rs(e,t){if(t===0||t===1)return!0;const n=e._length*t;let o=0;for(let h=0;h<e._lengths.length;h++){const f=e._lengths[h];if(o>=n)return n-o>=0;o+=f}return!1}function Ci(e,t){const r=e._length;if(t<=0)return 0;if(t>=r)return e._lengths.length-1;for(let n=0,o=0;n<e._lengths.length;n++){if(o+e._lengths[n]>=t)return t-=o,Math.max(n-1,0)+t/e._lengths[n];o+=e._lengths[n]}return-1}function Ur(e,t,r){let n,o,h,f,u,d,_,y;const P=t.controls&&t.controls.right,w=e.controls&&e.controls.left;return n=t.x,u=t.y,o=(P||t).x,d=(P||t).y,h=(w||e).x,_=(w||e).y,f=e.x,y=e.y,P&&t._relative&&(o+=t.x,d+=t.y),w&&e._relative&&(h+=e.x,_+=e.y),Nr(n,u,o,d,h,_,f,y,r)}function Bs(e,t,r){let n,o,h,f,u,d,_,y;const P=t.controls&&t.controls.right,w=e.controls&&e.controls.left;return n=t.x,u=t.y,o=(P||t).x,d=(P||t).y,h=(w||e).x,_=(w||e).y,f=e.x,y=e.y,P&&t._relative&&(o+=t.x,d+=t.y),w&&e._relative&&(h+=e.x,_+=e.y),cs(n,u,o,d,h,_,f,y,r)}var ge=class extends Si{constructor(e,t,r){super(),g(this,"_flagOffset",!0),g(this,"_flagOpacity",!0),g(this,"_flagColor",!0),g(this,"_offset",0),g(this,"_opacity",1),g(this,"_color","#fff");for(let n in Fs)Object.defineProperty(this,n,Fs[n]);this._renderer.type="stop",this.offset=typeof e=="number"?e:ge.Index<=0?0:1,this.opacity=typeof r=="number"?r:1,this.color=typeof t=="string"?t:ge.Index<=0?"#fff":"#000",ge.Index=(ge.Index+1)%2}clone(e){const t=new ge;return $.each(ge.Properties,function(r){t[r]=this[r]},this),e&&e.stops&&e.stops.push(t),t}toObject(){const e={};return $.each(ge.Properties,function(t){e[t]=this[t]},this),e}flagReset(){return this._flagOffset=this._flagColor=this._flagOpacity=!1,super.flagReset.call(this),this}},ve=ge;g(ve,"Index",0);g(ve,"Properties",["offset","opacity","color"]);var Fs={offset:{enumerable:!0,get:function(){return this._offset},set:function(e){this._offset=e,this._flagOffset=!0,this.parent&&(this.parent._flagStops=!0)}},opacity:{enumerable:!0,get:function(){return this._opacity},set:function(e){this._opacity=e,this._flagOpacity=!0,this.parent&&(this.parent._flagStops=!0)}},color:{enumerable:!0,get:function(){return this._color},set:function(e){this._color=e,this._flagColor=!0,this.parent&&(this.parent._flagStops=!0)}}},di=class extends Si{constructor(e){super(),g(this,"_flagStops",!1),g(this,"_flagSpread",!1),g(this,"_flagUnits",!1),g(this,"_spread",""),g(this,"_units","");for(let t in Xs)Object.defineProperty(this,t,Xs[t]);this._renderer.type="gradient",this.id=Rt.Identifier+Rt.uniqueId(),this.classList=[],this._renderer.flagStops=Hl.bind(this),this._renderer.bindStops=Gl.bind(this),this._renderer.unbindStops=Zl.bind(this),this.spread="pad",this.units="objectBoundingBox",e&&(this.stops=e)}clone(e){const t=this.stops.map(function(n){return n.clone()}),r=new di(t);return $.each(di.Properties,function(n){r[n]=this[n]},this),e&&e.add(r),r}toObject(){const e={stops:this.stops.map(function(t){return t.toObject()})};return $.each(di.Properties,function(t){e[t]=this[t]},this),e}_update(){return(this._flagSpread||this._flagStops)&&this.trigger(D.Types.change),this}flagReset(){return this._flagSpread=this._flagUnits=this._flagStops=!1,super.flagReset.call(this),this}},Lt=di;g(Lt,"Stop",ve);g(Lt,"Properties",["spread","stops","renderer","units"]);var Xs={spread:{enumerable:!0,get:function(){return this._spread},set:function(e){this._spread=e,this._flagSpread=!0}},units:{enumerable:!0,get:function(){return this._units},set:function(e){this._units=e,this._flagUnits=!0}},stops:{enumerable:!0,get:function(){return this._stops},set:function(e){const t=this._renderer.bindStops,r=this._renderer.unbindStops;this._stops&&this._stops.unbind(D.Types.insert,t).unbind(D.Types.remove,r),this._stops=new xe((e||[]).slice(0)),this._stops.bind(D.Types.insert,t).bind(D.Types.remove,r),t(this._stops)}}};function Hl(){this._flagStops=!0}function Gl(e){let t=e.length;for(;t--;)e[t].bind(D.Types.change,this._renderer.flagStops),e[t].parent=this;this._renderer.flagStops()}function Zl(e){let t=e.length;for(;t--;)e[t].unbind(D.Types.change,this._renderer.flagStops),delete e[t].parent;this._renderer.flagStops()}var Wr=class extends Lt{constructor(e,t,r,n,o){super(o),g(this,"_flagEndPoints",!1),g(this,"_left",null),g(this,"_right",null);for(let h in Ds)Object.defineProperty(this,h,Ds[h]);this._renderer.type="linear-gradient",this._renderer.flagEndPoints=Jl.bind(this),this.left=new z,this.right=new z,typeof e=="number"&&(this.left.x=e),typeof t=="number"&&(this.left.y=t),typeof r=="number"&&(this.right.x=r),typeof n=="number"&&(this.right.y=n)}clone(e){const t=this.stops.map(function(n){return n.clone()}),r=new Wr(this.left._x,this.left._y,this.right._x,this.right._y,t);return $.each(Lt.Properties,function(n){r[n]=this[n]},this),e&&e.add(r),r}toObject(){const e=super.toObject.call(this);return e.left=this.left.toObject(),e.right=this.right.toObject(),e}_update(){return(this._flagEndPoints||this._flagSpread||this._flagStops)&&this.trigger(D.Types.change),this}flagReset(){return this._flagEndPoints=!1,super.flagReset.call(this),this}},wt=Wr;g(wt,"Properties",["left","right"]);g(wt,"Stop",ve);var Ds={left:{enumerable:!0,get:function(){return this._left},set:function(e){this._left instanceof z&&this._left.unbind(D.Types.change,this._renderer.flagEndPoints),this._left=e,this._left.bind(D.Types.change,this._renderer.flagEndPoints),this._flagEndPoints=!0}},right:{enumerable:!0,get:function(){return this._right},set:function(e){this._right instanceof z&&this._right.unbind(D.Types.change,this._renderer.flagEndPoints),this._right=e,this._right.bind(D.Types.change,this._renderer.flagEndPoints),this._flagEndPoints=!0}}};function Jl(){this._flagEndPoints=!0}var pi=class extends Lt{constructor(e,t,r,n,o,h){super(n),g(this,"_flagRadius",!1),g(this,"_flagCenter",!1),g(this,"_flagFocal",!1),g(this,"_radius",0),g(this,"_center",null),g(this,"_focal",null);for(let f in Ys)Object.defineProperty(this,f,Ys[f]);this._renderer.type="radial-gradient",this._renderer.flagCenter=Kl.bind(this),this._renderer.flagFocal=$l.bind(this),this.center=new z,this.radius=typeof r=="number"?r:1,this.focal=new z,typeof e=="number"&&(this.center.x=e),typeof t=="number"&&(this.center.y=t),this.focal.copy(this.center),typeof o=="number"&&(this.focal.x=o),typeof h=="number"&&(this.focal.y=h)}clone(e){const t=this.stops.map(function(n){return n.clone()}),r=new pi(this.center._x,this.center._y,this._radius,t,this.focal._x,this.focal._y);return $.each(Lt.Properties.concat(pi.Properties),function(n){r[n]=this[n]},this),e&&e.add(r),r}toObject(){const e=super.toObject.call(this);return $.each(pi.Properties,function(t){e[t]=this[t]},this),e.center=this.center.toObject(),e.focal=this.focal.toObject(),e}_update(){return(this._flagRadius||this._flatCenter||this._flagFocal||this._flagSpread||this._flagStops)&&this.trigger(D.Types.change),this}flagReset(){return this._flagRadius=this._flagCenter=this._flagFocal=!1,super.flagReset.call(this),this}},It=pi;g(It,"Stop",ve);g(It,"Properties",["center","radius","focal"]);var Ys={radius:{enumerable:!0,get:function(){return this._radius},set:function(e){this._radius=e,this._flagRadius=!0}},center:{enumerable:!0,get:function(){return this._center},set:function(e){this._center&&this._center.unbind(D.Types.change,this._renderer.flagCenter),this._center=e,this._center.bind(D.Types.change,this._renderer.flagCenter),this._flagCenter=!0}},focal:{enumerable:!0,get:function(){return this._focal},set:function(e){this._focal&&this._focal.unbind(D.Types.change,this._renderer.flagFocal),this._focal=e,this._focal.bind(D.Types.change,this._renderer.flagFocal),this._flagFocal=!0}}};function Kl(){this._flagCenter=!0}function $l(){this._flagFocal=!0}var _i,Vr={video:/\.(mp4|webm|ogg)$/i,image:/\.(jpe?g|png|gif|tiff|webp)$/i,effect:/texture|gradient/i};Ct.document&&(_i=document.createElement("a"));var Ft=class extends Si{constructor(e,t){super(),g(this,"_flagSrc",!1),g(this,"_flagImage",!1),g(this,"_flagVideo",!1),g(this,"_flagLoaded",!1),g(this,"_flagRepeat",!1),g(this,"_flagOffset",!1),g(this,"_flagScale",!1),g(this,"_src",""),g(this,"_image",null),g(this,"_loaded",!1),g(this,"_repeat","no-repeat"),g(this,"_scale",1),g(this,"_offset",null),this._renderer={};for(let r in Us)Object.defineProperty(this,r,Us[r]);if(this._renderer.type="texture",this._renderer.flagOffset=Ql.bind(this),this._renderer.flagScale=to.bind(this),this.id=Rt.Identifier+Rt.uniqueId(),this.classList=[],this.loaded=!1,this.repeat="no-repeat",this.offset=new z,typeof t=="function"){const r=(function(){this.unbind(D.Types.load,r),typeof t=="function"&&t()}).bind(this);this.bind(D.Types.load,r)}if(typeof e=="string")this.src=e;else if(typeof e=="object"){const r=Object.prototype.toString.call(e);(r==="[object HTMLImageElement]"||r==="[object HTMLCanvasElement]"||r==="[object HTMLVideoElement]"||r==="[object Image]")&&(this.image=e)}this._update()}static getAbsoluteURL(e){return _i?(_i.href=e,_i.href):e}static loadHeadlessBuffer(e,t){e.image.onload=t,e.image.src=e.src}static getTag(e){return e&&e.nodeName&&e.nodeName.toLowerCase()||"img"}static getImage(e){const t=Ft.getAbsoluteURL(e);if(Ft.ImageRegistry.contains(t))return Ft.ImageRegistry.get(t);let r;return Jt.Image?(r=new Jt.Image,We.Utils.shim(r,"img")):Ct.document?Vr.video.test(t)?r=document.createElement("video"):r=document.createElement("img"):console.warn("Two.js: no prototypical image defined for Two.Texture"),r.crossOrigin="anonymous",r.referrerPolicy="no-referrer",r}static load(e,t){let r=e.image,n=Ft.getTag(r);e._flagImage&&(/canvas/i.test(n)?Ft.Register.canvas(e,t):(e._src=!Jt.isHeadless&&r.getAttribute("two-src")||r.src,Ft.Register[n](e,t))),e._flagSrc&&(r||(r=Ft.getImage(e.src),e.image=r),n=Ft.getTag(r),Ft.Register[n](e,t))}clone(){const e=new Ft(this.src);return e.repeat=this.repeat,e.offset.copy(this.origin),e.scale=this.scale,e}toObject(){return{src:this.src,repeat:this.repeat,origin:this.origin.toObject(),scale:typeof this.scale=="number"?this.scale:this.scale.toObject()}}_update(){return(this._flagSrc||this._flagImage)&&(this.trigger(D.Types.change),(this._flagSrc||this._flagImage)&&(this.loaded=!1,Ft.load(this,(function(){this.loaded=!0,this.trigger(D.Types.change).trigger(D.Types.load)}).bind(this)))),this._image&&this._image.readyState>=4&&(this._flagVideo=!0),this}flagReset(){return this._flagSrc=this._flagImage=this._flagLoaded=this._flagRepeat=this._flagVideo=this._flagScale=this._flagOffset=!1,super.flagReset.call(this),this}},yt=Ft;g(yt,"Properties",["src","loaded","repeat","scale","offset","image"]);g(yt,"RegularExpressions",Vr);g(yt,"ImageRegistry",new Ai);g(yt,"Register",{canvas:function(e,t){e._src="#"+e.id,Ft.ImageRegistry.add(e.src,e.image),typeof t=="function"&&t()},img:function(e,t){const r=e.image,n=function(h){!Jt.isHeadless&&r.removeEventListener&&typeof r.removeEventListener=="function"&&(r.removeEventListener("load",n,!1),r.removeEventListener("error",o,!1)),typeof t=="function"&&t()},o=function(h){throw!Jt.isHeadless&&typeof r.removeEventListener=="function"&&(r.removeEventListener("load",n,!1),r.removeEventListener("error",o,!1)),new Kt("unable to load "+e.src)};typeof r.width=="number"&&r.width>0&&typeof r.height=="number"&&r.height>0?n():!Jt.isHeadless&&typeof r.addEventListener=="function"&&(r.addEventListener("load",n,!1),r.addEventListener("error",o,!1)),e._src=Ft.getAbsoluteURL(e._src),!(!Jt.isHeadless&&r&&r.getAttribute("two-src"))&&(Jt.isHeadless||r.setAttribute("two-src",e.src),Ft.ImageRegistry.add(e.src,r),Jt.isHeadless?Ft.loadHeadlessBuffer(e,n):e.image.src=e.src)},video:function(e,t){if(Jt.isHeadless)throw new Kt("video textures are not implemented in headless environments.");const r=function(o){e.image.removeEventListener("canplaythrough",r,!1),e.image.removeEventListener("error",n,!1),e.image.width=e.image.videoWidth,e.image.height=e.image.videoHeight,typeof t=="function"&&t()},n=function(o){throw e.image.removeEventListener("canplaythrough",r,!1),e.image.removeEventListener("error",n,!1),new Kt("unable to load "+e.src)};e._src=Ft.getAbsoluteURL(e._src),e.image.getAttribute("two-src")||(e.image.setAttribute("two-src",e.src),Ft.ImageRegistry.add(e.src,e.image)),e.image.readyState>=4?r():(e.image.addEventListener("canplaythrough",r,!1),e.image.addEventListener("error",n,!1),e.image.src=e.src,e.image.load())}});var Us={src:{enumerable:!0,get:function(){return this._src},set:function(e){this._src=e,this._flagSrc=!0}},loaded:{enumerable:!0,get:function(){return this._loaded},set:function(e){this._loaded=e,this._flagLoaded=!0}},repeat:{enumerable:!0,get:function(){return this._repeat},set:function(e){this._repeat=e,this._flagRepeat=!0}},image:{enumerable:!0,get:function(){return this._image},set:function(e){const t=yt.getTag(e);let r;switch(t){case"canvas":r="#"+e.id;break;default:r=e.src}yt.ImageRegistry.contains(r)?this._image=yt.ImageRegistry.get(e.src):this._image=e,this._flagImage=!0}},offset:{enumerable:!0,get:function(){return this._offset},set:function(e){this._offset&&this._offset.unbind(D.Types.change,this._renderer.flagOffset),this._offset=e,this._offset.bind(D.Types.change,this._renderer.flagOffset),this._flagOffset=!0}},scale:{enumerable:!0,get:function(){return this._scale},set:function(e){this._scale instanceof z&&this._scale.unbind(D.Types.change,this._renderer.flagScale),this._scale=e,this._scale instanceof z&&this._scale.bind(D.Types.change,this._renderer.flagScale),this._flagScale=!0}}};function Ql(){this._flagOffset=!0}function to(){this._flagScale=!0}var Ne=Math.min,Me=Math.max,eo=Math.ceil,io=Math.floor,so=new z,ze=class extends ye{constructor(e,t,r,n){super(),g(this,"_flagVertices",!0),g(this,"_flagLength",!0),g(this,"_flagFill",!0),g(this,"_flagStroke",!0),g(this,"_flagLinewidth",!0),g(this,"_flagOpacity",!0),g(this,"_flagVisible",!0),g(this,"_flagCap",!0),g(this,"_flagJoin",!0),g(this,"_flagMiter",!0),g(this,"_flagMask",!1),g(this,"_flagClip",!1),g(this,"_length",0),g(this,"_fill","#fff"),g(this,"_stroke","#000"),g(this,"_linewidth",1),g(this,"_opacity",1),g(this,"_visible",!0),g(this,"_cap","round"),g(this,"_join","round"),g(this,"_miter",4),g(this,"_closed",!0),g(this,"_curved",!1),g(this,"_automatic",!0),g(this,"_beginning",0),g(this,"_ending",1),g(this,"_mask",null),g(this,"_clip",!1),g(this,"_dashes",null);for(let o in Ws)Object.defineProperty(this,o,Ws[o]);this._renderer.type="path",this._renderer.flagVertices=qr.bind(this),this._renderer.bindVertices=jr.bind(this),this._renderer.unbindVertices=zr.bind(this),this._renderer.flagFill=Hr.bind(this),this._renderer.flagStroke=Gr.bind(this),this._renderer.vertices=[],this._renderer.collection=[],this.closed=!!t,this.curved=!!r,this.beginning=0,this.ending=1,this.fill="#fff",this.stroke="#000",this.linewidth=1,this.opacity=1,this.className="",this.visible=!0,this.cap="butt",this.join="miter",this.miter=4,this.vertices=e,this.automatic=!n,this.dashes=[],this.dashes.offset=0}clone(e){const t=new ze;for(let r=0;r<this.vertices.length;r++)t.vertices.push(this.vertices[r].clone());for(let r=0;r<ze.Properties.length;r++){const n=ze.Properties[r];t[n]=this[n]}return t.className=this.className,t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale,t.skewX=this.skewX,t.skewY=this.skewY,this.matrix.manual&&t.matrix.copy(this.matrix),e&&e.add(t),t._update()}toObject(){const e={vertices:this.vertices.map(function(t){return t.toObject()})};return $.each(ze.Properties,function(t){typeof this[t]<"u"&&(this[t].toObject?e[t]=this[t].toObject():e[t]=this[t])},this),e.className=this.className,e.translation=this.translation.toObject(),e.rotation=this.rotation,e.scale=this.scale instanceof z?this.scale.toObject():this.scale,e.skewX=this.skewX,e.skewY=this.skewY,this.matrix.manual&&(e.matrix=this.matrix.toObject()),e}noFill(){return this.fill="none",this}noStroke(){return this.stroke="none",this}corner(){const e=this.getBoundingClientRect(!0),t=e.width/2,r=e.height/2,n=e.left+e.width/2,o=e.top+e.height/2;for(let h=0;h<this.vertices.length;h++){const f=this.vertices[h];f.x-=n,f.y-=o,f.x+=t,f.y+=r}return this.mask&&(this.mask.translation.x-=n,this.mask.translation.x+=t,this.mask.translation.y-=o,this.mask.translation.y+=r),this}center(){const e=this.getBoundingClientRect(!0),t=e.left+e.width/2-this.translation.x,r=e.top+e.height/2-this.translation.y;for(let n=0;n<this.vertices.length;n++){const o=this.vertices[n];o.x-=t,o.y-=r}return this.mask&&(this.mask.translation.x-=t,this.mask.translation.y-=r),this}getBoundingClientRect(e){let t,r,n,o,h,f,u=1/0,d=-1/0,_=1/0,y=-1/0;if(this._update(!0),t=e?this.matrix:this.worldMatrix,r=(this.linewidth||0)/2,n=this._renderer.vertices.length,this.linewidth>0||this.stroke&&!/(transparent|none)/i.test(this.stroke))if(this.matrix.manual){const{scaleX:P,scaleY:w}=Ye(t.elements[0],t.elements[3],t.elements[1],t.elements[4],t.elements[2],t.elements[5]);typeof P=="number"&&typeof w=="number"&&(r=Math.max(P,w)*(this.linewidth||0)/2)}else r*=typeof this.scale=="number"?this.scale:Math.max(this.scale.x,this.scale.y);if(n<=0)return{width:0,height:0};for(o=0;o<n;o++){f=this._renderer.vertices[o],h=this._renderer.vertices[(o+n-1)%n];const[P,w]=t.multiply(h.x,h.y),[v,C]=t.multiply(f.x,f.y);if(h.controls&&f.controls){let k=h.controls.right.x,L=h.controls.right.y;h.relative&&(k+=h.x,L+=h.y);let[O,E]=t.multiply(k,L),N=f.controls.left.x,W=f.controls.left.y;f.relative&&(N+=f.x,W+=f.y);let[F,Z]=t.multiply(N,W);const G=Mr(P,w,O,E,F,Z,v,C);_=Ne(G.min.y-r,_),u=Ne(G.min.x-r,u),d=Me(G.max.x+r,d),y=Me(G.max.y+r,y)}else o<=1&&(_=Ne(w-r,_),u=Ne(P-r,u),d=Me(P+r,d),y=Me(w+r,y)),_=Ne(C-r,_),u=Ne(v-r,u),d=Me(v+r,d),y=Me(C+r,y)}return{top:_,left:u,right:d,bottom:y,width:d-u,height:y-_}}getPointAt(e,t){let r,n,o,h,f,u,d,_,y,P,w,v,C,k,L,O=this.length*Math.min(Math.max(e,0),1);const E=this.vertices.length,N=E-1;let W=null,F=null;for(let X=0,Y=this._lengths.length,K=0;X<Y;X++){if(K+this._lengths[X]>=O){this._closed?(r=$t(X,E),n=$t(X-1,E),X===0&&(r=n,n=X)):(r=X,n=Math.min(Math.max(X-1,0),N)),W=this.vertices[r],F=this.vertices[n],O-=K,this._lengths[X]!==0?e=O/this._lengths[X]:e=0;break}K+=this._lengths[X]}if(W===null||F===null)return null;if(W){if(!F)return W}else return F;L=F.controls&&F.controls.right,k=W.controls&&W.controls.left,f=F.x,P=F.y,u=(L||F).x,w=(L||F).y,d=(k||W).x,v=(k||W).y,_=W.x,C=W.y,L&&F.relative&&(u+=F.x,w+=F.y),k&&W.relative&&(d+=W.x,v+=W.y),h=Je(e,f,u,d,_),y=Je(e,P,w,v,C);const Z=Gt(f,u,e),G=Gt(P,w,e),st=Gt(u,d,e),et=Gt(w,v,e),Q=Gt(d,_,e),ht=Gt(v,C,e),at=Gt(Z,st,e),T=Gt(G,et,e),V=Gt(st,Q,e),R=Gt(et,ht,e);return $.isObject(t)?(t.x=h,t.y=y,t instanceof ct&&(t.controls.left.x=at,t.controls.left.y=T,t.controls.right.x=V,t.controls.right.y=R,(typeof t.relative!="boolean"||t.relative)&&(t.controls.left.x-=h,t.controls.left.y-=y,t.controls.right.x-=h,t.controls.right.y-=y)),t.t=e,t):(o=new ct(h,y,at-h,T-y,V-h,R-y,this._curved?q.curve:q.line),o.t=e,o)}plot(){if(this.curved)return Br(this._collection,this.closed),this;for(let e=0;e<this._collection.length;e++)this._collection[e].command=e===0?q.move:q.line;return this}subdivide(e){this._update();const t=this.vertices.length-1,r=this._closed||this.vertices[t]._command===q.close;let n=this.vertices[t],o=[],h;return $.each(this.vertices,function(f,u){if(u<=0&&!r){n=f;return}if(f.command===q.move){o.push(new ct(n.x,n.y)),u>0&&(o[o.length-1].command=q.line),n=f;return}h=Bs(f,n,e),o=o.concat(h),$.each(h,function(d,_){_<=0&&n.command===q.move?d.command=q.move:d.command=q.line}),u>=t&&(this._closed&&this._automatic?(n=f,h=Bs(f,n,e),o=o.concat(h),$.each(h,function(d,_){_<=0&&n.command===q.move?d.command=q.move:d.command=q.line})):r&&o.push(new ct(f.x,f.y)),o[o.length-1].command=r?q.close:q.line),n=f},this),this._automatic=!1,this._curved=!1,this.vertices=o,this}_updateLength(e,t){t||this._update();const n=this.vertices.length-1,o=!1;let h=this.vertices[n],f=0;return typeof this._lengths>"u"&&(this._lengths=[]),$.each(this.vertices,function(u,d){if(d<=0&&!o||u.command===q.move){h=u,this._lengths[d]=0;return}this._lengths[d]=Ur(u,h,e),f+=this._lengths[d],h=u},this),this._length=f,this._flagLength=!1,this}_update(){if(this._flagVertices){this._automatic&&this.plot(),this._flagLength&&this._updateLength(void 0,!0);const e=this._collection.length,t=this._closed,r=Math.min(this._beginning,this._ending),n=Math.max(this._beginning,this._ending),o=Ci(this,r*this._length),h=Ci(this,n*this._length),f=eo(o),u=io(h);let d,_,y,P,w,v;for(this._renderer.vertices.length=0,v=0;v<e;v++)this._renderer.collection.length<=v&&this._renderer.collection.push(new ct),v>u&&!_?(w=this._renderer.collection[v].copy(this._collection[v]),this.getPointAt(n,w),w.command=this._renderer.collection[v].command,this._renderer.vertices.push(w),_=w,y=this._collection[v-1],y&&y.controls&&(w.relative?w.controls.right.clear():w.controls.right.copy(w),y.relative?this._renderer.collection[v-1].controls.right.copy(y.controls.right).lerp(z.zero,1-w.t):this._renderer.collection[v-1].controls.right.copy(y.controls.right).lerp(y,1-w.t))):v>=f&&v<=u&&(w=this._renderer.collection[v].copy(this._collection[v]),this._renderer.vertices.push(w),v===u&&Rs(this,n)?(_=w,!t&&_.controls&&(_.relative?_.controls.right.clear():_.controls.right.copy(_))):v===f&&Rs(this,r)&&(d=w,d.command=q.move,!t&&d.controls&&(d.relative?d.controls.left.clear():d.controls.left.copy(d))));f>0&&!d&&(v=f-1,w=this._renderer.collection[v].copy(this._collection[v]),this.getPointAt(r,w),w.command=q.move,this._renderer.vertices.unshift(w),P=this._collection[v+1],P&&P.controls&&(w.controls.left.clear(),P.relative?this._renderer.collection[v+1].controls.left.copy(P.controls.left).lerp(z.zero,w.t):(so.copy(P),this._renderer.collection[v+1].controls.left.copy(P.controls.left).lerp(P,w.t))))}return ye.prototype._update.apply(this,arguments),this}flagReset(){return this._flagVertices=this._flagLength=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagCap=this._flagJoin=this._flagMiter=this._flagClip=!1,ye.prototype.flagReset.call(this),this}},mt=ze;g(mt,"Properties",["fill","stroke","linewidth","opacity","visible","cap","join","miter","closed","curved","automatic","beginning","ending"]);g(mt,"Utils",{getCurveLength:Ur});var Ws={linewidth:{enumerable:!0,get:function(){return this._linewidth},set:function(e){this._linewidth=e,this._flagLinewidth=!0}},opacity:{enumerable:!0,get:function(){return this._opacity},set:function(e){this._opacity=e,this._flagOpacity=!0}},visible:{enumerable:!0,get:function(){return this._visible},set:function(e){this._visible=e,this._flagVisible=!0}},cap:{enumerable:!0,get:function(){return this._cap},set:function(e){this._cap=e,this._flagCap=!0}},join:{enumerable:!0,get:function(){return this._join},set:function(e){this._join=e,this._flagJoin=!0}},miter:{enumerable:!0,get:function(){return this._miter},set:function(e){this._miter=e,this._flagMiter=!0}},fill:{enumerable:!0,get:function(){return this._fill},set:function(e){(this._fill instanceof Lt||this._fill instanceof wt||this._fill instanceof It||this._fill instanceof yt)&&this._fill.unbind(D.Types.change,this._renderer.flagFill),this._fill=e,this._flagFill=!0,(this._fill instanceof Lt||this._fill instanceof wt||this._fill instanceof It||this._fill instanceof yt)&&this._fill.bind(D.Types.change,this._renderer.flagFill)}},stroke:{enumerable:!0,get:function(){return this._stroke},set:function(e){(this._stroke instanceof Lt||this._stroke instanceof wt||this._stroke instanceof It||this._stroke instanceof yt)&&this._stroke.unbind(D.Types.change,this._renderer.flagStroke),this._stroke=e,this._flagStroke=!0,(this._stroke instanceof Lt||this._stroke instanceof wt||this._stroke instanceof It||this._stroke instanceof yt)&&this._stroke.bind(D.Types.change,this._renderer.flagStroke)}},length:{get:function(){return this._flagLength&&this._updateLength(),this._length}},closed:{enumerable:!0,get:function(){return this._closed},set:function(e){this._closed=!!e,this._flagVertices=!0}},curved:{enumerable:!0,get:function(){return this._curved},set:function(e){this._curved=!!e,this._flagVertices=!0}},automatic:{enumerable:!0,get:function(){return this._automatic},set:function(e){if(e===this._automatic)return;this._automatic=!!e;const t=this._automatic?"ignore":"listen";$.each(this.vertices,function(r){r[t]()})}},beginning:{enumerable:!0,get:function(){return this._beginning},set:function(e){this._beginning=e,this._flagVertices=!0}},ending:{enumerable:!0,get:function(){return this._ending},set:function(e){this._ending=e,this._flagVertices=!0}},vertices:{enumerable:!0,get:function(){return this._collection},set:function(e){const t=this._renderer.bindVertices,r=this._renderer.unbindVertices;this._collection&&this._collection.unbind(D.Types.insert,t).unbind(D.Types.remove,r),e instanceof xe?this._collection=e:this._collection=new xe(e||[]),this._collection.bind(D.Types.insert,t).bind(D.Types.remove,r),t(this._collection)}},mask:{enumerable:!0,get:function(){return this._mask},set:function(e){this._mask=e,this._flagMask=!0,$.isObject(e)&&!e.clip&&(e.clip=!0)}},clip:{enumerable:!0,get:function(){return this._clip},set:function(e){this._clip=e,this._flagClip=!0}},dashes:{enumerable:!0,get:function(){return this._dashes},set:function(e){typeof e.offset!="number"&&(e.offset=this.dashes&&this._dashes.offset||0),this._dashes=e}}};function qr(){this._flagVertices=!0,this._flagLength=!0,this.parent&&(this.parent._flagLength=!0)}function jr(e){let t=e.length;for(;t--;)e[t].bind(D.Types.change,this._renderer.flagVertices);this._renderer.flagVertices()}function zr(e){let t=e.length;for(;t--;)e[t].unbind(D.Types.change,this._renderer.flagVertices);this._renderer.flagVertices()}function Hr(){this._flagFill=!0}function Gr(){this._flagStroke=!0}var Zr=class extends mt{constructor(e,t,r,n){const o=[new ct,new ct,new ct,new ct];super(o,!0,!1,!0),g(this,"_flagWidth",0),g(this,"_flagHeight",0),g(this,"_width",0),g(this,"_height",0),g(this,"_origin",null);for(let h in Vs)Object.defineProperty(this,h,Vs[h]);this.width=typeof r=="number"?r:1,this.height=typeof n=="number"?n:1,this.origin=new z,typeof e=="number"&&(this.translation.x=e),typeof t=="number"&&(this.translation.y=t),this._update()}_update(){if(this._flagVertices||this._flagWidth||this._flagHeight){const e=this._width/2,t=this._height/2;!this._closed&&this.vertices.length===4&&this.vertices.push(new ct),this.vertices[0].set(-e,-t).sub(this._origin).command=q.move,this.vertices[1].set(e,-t).sub(this._origin).command=q.line,this.vertices[2].set(e,t).sub(this._origin).command=q.line,this.vertices[3].set(-e,t).sub(this._origin).command=q.line,this.vertices[4]&&(this.vertices[4].set(-e,-t).sub(this._origin).command=q.line)}return super._update.call(this),this}flagReset(){return this._flagWidth=this._flagHeight=!1,super.flagReset.call(this),this}clone(e){const t=new Zr(0,0,this.width,this.height);t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale,t.skewX=this.skewX,t.skewY=this.skewY,this.matrix.manual&&t.matrix.copy(this.matrix);for(let r=0;r<mt.Properties.length;r++){const n=mt.Properties[r];t[n]=this[n]}return e&&e.add(t),t}toObject(){const e=super.toObject.call(this);return e.width=this.width,e.height=this.height,e.origin=this.origin.toObject(),e}},Ae=Zr;g(Ae,"Properties",["width","height"]);var Vs={width:{enumerable:!0,get:function(){return this._width},set:function(e){this._width=e,this._flagWidth=!0}},height:{enumerable:!0,get:function(){return this._height},set:function(e){this._height=e,this._flagHeight=!0}},origin:{enumerable:!0,get:function(){return this._origin},set:function(e){this._origin&&this._origin.unbind(D.Types.change,this._renderer.flagVertices),this._origin=e,this._origin.bind(D.Types.change,this._renderer.flagVertices),this._renderer.flagVertices()}}},Jr=class extends Ae{constructor(e,t,r,n,o,h){super(t,r,0,0),g(this,"_flagTexture",!1),g(this,"_flagColumns",!1),g(this,"_flagRows",!1),g(this,"_flagFrameRate",!1),g(this,"_flagIndex",!1),g(this,"_amount",1),g(this,"_duration",0),g(this,"_startTime",0),g(this,"_playing",!1),g(this,"_firstFrame",0),g(this,"_lastFrame",0),g(this,"_loop",!0),g(this,"_texture",null),g(this,"_columns",1),g(this,"_rows",1),g(this,"_frameRate",0),g(this,"_index",0),g(this,"_origin",null);for(let f in qs)Object.defineProperty(this,f,qs[f]);this.noStroke(),this.noFill(),e instanceof yt?this.texture=e:typeof e=="string"&&(this.texture=new yt(e)),this.origin=new z,this._update(),typeof n=="number"&&(this.columns=n),typeof o=="number"&&(this.rows=o),typeof h=="number"&&(this.frameRate=h),this.index=0}play(e,t,r){return this._playing=!0,this._firstFrame=0,this._lastFrame=this.amount-1,this._startTime=$.performance.now(),typeof e=="number"&&(this._firstFrame=e),typeof t=="number"&&(this._lastFrame=t),typeof r=="function"?this._onLastFrame=r:delete this._onLastFrame,this._index!==this._firstFrame&&(this._startTime-=1e3*Math.abs(this._index-this._firstFrame)/this._frameRate),this}pause(){return this._playing=!1,this}stop(){return this._playing=!1,this._index=0,this}clone(e){const t=new Jr(this.texture,this.translation.x,this.translation.y,this.columns,this.rows,this.frameRate);return this.playing&&(t.play(this._firstFrame,this._lastFrame),t._loop=this._loop),e&&e.add(t),t}toObject(){const e=super.toObject.call(this);return e.texture=this.texture.toObject(),e.columns=this.columns,e.rows=this.rows,e.frameRate=this.frameRate,e.index=this.index,e._firstFrame=this._firstFrame,e._lastFrame=this._lastFrame,e._loop=this._loop,e}_update(){const e=this._texture,t=this._columns,r=this._rows;let n,o,h,f,u,d,_,y,P;if(e&&((this._flagColumns||this._flagRows)&&(this._amount=this._columns*this._rows),this._flagFrameRate&&(this._duration=1e3*this._amount/this._frameRate),this._flagTexture&&(this.fill=e),e.loaded)){_=e.image.width,y=e.image.height,n=_/t,o=y/r,f=this._amount,this.width!==n&&(this.width=n),this.height!==o&&(this.height=o),this._playing&&this._frameRate>0&&($.isNaN(this._lastFrame)&&(this._lastFrame=f-1),h=$.performance.now()-this._startTime,P=this._lastFrame+1,u=1e3*(P-this._firstFrame)/this._frameRate,this._loop?h=h%u:h=Math.min(h,u),d=Gt(this._firstFrame,P,h/u),d=Math.floor(d),d!==this._index&&(this._index=d,d>=this._lastFrame-1&&this._onLastFrame&&this._onLastFrame()));const w=this._index%t,v=Math.floor(this._index/t),C=-n*w+(_-n)/2,k=-o*v+(y-o)/2;C!==e.offset.x&&(e.offset.x=C),k!==e.offset.y&&(e.offset.y=k)}return super._update.call(this),this}flagReset(){return this._flagTexture=this._flagColumns=this._flagRows=this._flagFrameRate=!1,super.flagReset.call(this),this}},Li=Jr;g(Li,"Properties",["texture","columns","rows","frameRate","index"]);var qs={texture:{enumerable:!0,get:function(){return this._texture},set:function(e){this._texture=e,this._flagTexture=!0}},columns:{enumerable:!0,get:function(){return this._columns},set:function(e){this._columns=e,this._flagColumns=!0}},rows:{enumerable:!0,get:function(){return this._rows},set:function(e){this._rows=e,this._flagRows=!0}},frameRate:{enumerable:!0,get:function(){return this._frameRate},set:function(e){this._frameRate=e,this._flagFrameRate=!0}},index:{enumerable:!0,get:function(){return this._index},set:function(e){this._index=e,this._flagIndex=!0}}},Ui=Math.cos,Wi=Math.sin,mi=class extends mt{constructor(e,t,r,n){const o=n?Math.max(n,2):4,h=[];for(let f=0;f<o;f++)h.push(new ct(0,0,0,0,0,0));super(h,!0,!0,!0),g(this,"_flagRadius",!1),g(this,"_radius",0);for(let f in js)Object.defineProperty(this,f,js[f]);typeof r=="number"&&(this.radius=r),this._update(),typeof e=="number"&&(this.translation.x=e),typeof t=="number"&&(this.translation.y=t)}_update(){if(this._flagVertices||this._flagRadius){let e=this.vertices.length;!this._closed&&e>2&&(e-=1);const t=4/3*Math.tan(Math.PI/(e*2)),r=this._radius,n=r*t;for(let o=0;o<this.vertices.length;o++){const f=o/e*Yt,u=r*Ui(f),d=r*Wi(f),_=n*Ui(f-Nt),y=n*Wi(f-Nt),P=n*Ui(f+Nt),w=n*Wi(f+Nt),v=this.vertices[o];v.command=o===0?q.move:q.curve,v.set(u,d),v.controls.left.set(_,y),v.controls.right.set(P,w)}}return super._update.call(this),this}flagReset(){return this._flagRadius=!1,super.flagReset.call(this),this}clone(e){const t=new mi(0,0,this.radius,this.vertices.length);t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale,t.skewX=this.skewX,t.skewY=this.skewY,this.matrix.manual&&t.matrix.copy(this.matrix);for(let r=0;r<mt.Properties.length;r++){const n=mt.Properties[r];t[n]=this[n]}return e&&e.add(t),t}toObject(){const e=super.toObject.call(this);for(let t=0;t<mi.Properties.length;t++){const r=mi.Properties[t];e[r]=this[r]}return e}},Oi=mi;g(Oi,"Properties",["radius"]);var js={radius:{enumerable:!0,get:function(){return this._radius},set:function(e){this._radius=e,this._flagRadius=!0}}},Vi=Math.cos,qi=Math.sin,gi=class extends mt{constructor(e,t,r,n,o){typeof n!="number"&&typeof r=="number"&&(n=r);const h=o?Math.max(o,2):4,f=[];for(let u=0;u<h;u++)f.push(new ct);super(f,!0,!0,!0),g(this,"_flagWidth",!1),g(this,"_flagHeight",!1),g(this,"_width",0),g(this,"_height",0);for(let u in zs)Object.defineProperty(this,u,zs[u]);typeof r=="number"&&(this.width=r*2),typeof n=="number"&&(this.height=n*2),this._update(),typeof e=="number"&&(this.translation.x=e),typeof t=="number"&&(this.translation.y=t)}_update(){if(this._flagVertices||this._flagWidth||this._flagHeight){let e=this.vertices.length;!this._closed&&e>2&&(e-=1);const t=4/3*Math.tan(Math.PI/(this.vertices.length*2)),r=this._width/2,n=this._height/2;for(let o=0;o<this.vertices.length;o++){const f=o/e*Yt,u=r*Vi(f),d=n*qi(f),_=r*t*Vi(f-Nt),y=n*t*qi(f-Nt),P=r*t*Vi(f+Nt),w=n*t*qi(f+Nt),v=this.vertices[o];v.command=o===0?q.move:q.curve,v.set(u,d),v.controls.left.set(_,y),v.controls.right.set(P,w)}}return super._update.call(this),this}flagReset(){return this._flagWidth=this._flagHeight=!1,super.flagReset.call(this),this}clone(e){const t=this.width/2,r=this.height/2,n=this.vertices.length,o=new gi(0,0,t,r,n);o.translation.copy(this.translation),o.rotation=this.rotation,o.scale=this.scale,o.skewX=this.skewX,o.skewY=this.skewY,this.matrix.manual&&o.matrix.copy(this.matrix);for(let h=0;h<mt.Properties.length;h++){const f=mt.Properties[h];o[f]=this[f]}return e&&e.add(o),o}toObject(){const e=super.toObject.call(this);for(let t=0;t<gi.Properties.length;t++){const r=gi.Properties[t];e[r]=this[r]}return e}},ki=gi;g(ki,"Properties",["width","height"]);var zs={width:{enumerable:!0,get:function(){return this._width},set:function(e){this._width=e,this._flagWidth=!0}},height:{enumerable:!0,get:function(){return this._height},set:function(e){this._height=e,this._flagHeight=!0}}},ds=class extends mt{constructor(e,t,r,n){const o=[new ct(e,t),new ct(r,n)];super(o);for(let h in Hs)Object.defineProperty(this,h,Hs[h]);this.vertices[0].command=q.move,this.vertices[1].command=q.line,this.automatic=!1}},Hs={left:{enumerable:!0,get:function(){return this.vertices[0]},set:function(e){if($.isObject(e))this.vertices.splice(0,1,e);else{const t=new Kt("Two.Line.x argument is not an object.");console.warn(t.name,t.message)}}},right:{enumerable:!0,get:function(){return this.vertices[1]},set:function(e){if($.isObject(e))this.vertices.splice(1,1,e);else{const t=new Kt("Two.Line.y argument is not an object.");console.warn(t.name,t.message)}}}},yi=class extends mt{constructor(e,t,r,n,o){typeof o>"u"&&typeof r=="number"&&typeof n=="number"&&(o=Math.floor(Math.min(r,n)/12));const h=[];for(let f=0;f<10;f++)h.push(new ct(0,0,0,0,0,0,f===0?q.move:q.curve));super(h),g(this,"_flagWidth",!1),g(this,"_flagHeight",!1),g(this,"_flagRadius",!1),g(this,"_width",0),g(this,"_height",0),g(this,"_radius",12);for(let f in Gs)Object.defineProperty(this,f,Gs[f]);this.closed=!0,this.automatic=!1,this._renderer.flagRadius=ro.bind(this),typeof r=="number"&&(this.width=r),typeof n=="number"&&(this.height=n),typeof o=="number"&&(this.radius=o),this._update(),typeof e=="number"&&(this.translation.x=e),typeof t=="number"&&(this.translation.y=t)}_update(){if(this._flagVertices||this._flagWidth||this._flagHeight||this._flagRadius){const e=this._width,t=this._height;let r,n;this._radius instanceof z?(r=this._radius.x,n=this._radius.y):(r=this._radius,n=this._radius);let o,h=e/2,f=t/2;o=this.vertices[0],o.x=-(h-r),o.y=-f,o=this.vertices[1],o.x=h-r,o.y=-f,o.controls.left.clear(),o.controls.right.x=r,o.controls.right.y=0,o=this.vertices[2],o.x=h,o.y=-(f-n),o.controls.right.clear(),o.controls.left.clear(),o=this.vertices[3],o.x=h,o.y=f-n,o.controls.left.clear(),o.controls.right.x=0,o.controls.right.y=n,o=this.vertices[4],o.x=h-r,o.y=f,o.controls.right.clear(),o.controls.left.clear(),o=this.vertices[5],o.x=-(h-r),o.y=f,o.controls.left.clear(),o.controls.right.x=-r,o.controls.right.y=0,o=this.vertices[6],o.x=-h,o.y=f-n,o.controls.left.clear(),o.controls.right.clear(),o=this.vertices[7],o.x=-h,o.y=-(f-n),o.controls.left.clear(),o.controls.right.x=0,o.controls.right.y=-n,o=this.vertices[8],o.x=-(h-r),o.y=-f,o.controls.left.clear(),o.controls.right.clear(),o=this.vertices[9],o.copy(this.vertices[8])}return super._update.call(this),this}flagReset(){return this._flagWidth=this._flagHeight=this._flagRadius=!1,super.flagReset.call(this),this}clone(e){const t=this.width,r=this.height,n=this.radius,o=new yi(0,0,t,r,n);o.translation.copy(this.translation),o.rotation=this.rotation,o.scale=this.scale,o.skewX=this.skewX,o.skewY=this.skewY,this.matrix.manual&&o.matrix.copy(this.matrix);for(let h=0;h<mt.Properties.length;h++){const f=mt.Properties[h];o[f]=this[f]}return e&&e.add(o),o}toObject(){const e=super.toObject.call(this);for(let t=0;t<yi.Properties.length;t++){const r=yi.Properties[t];e[r]=this[r]}return e.radius=typeof this.radius=="number"?this.radius:this.radius.toObject(),e}},Ni=yi;g(Ni,"Properties",["width","height","radius"]);var Gs={width:{enumerable:!0,get:function(){return this._width},set:function(e){this._width=e,this._flagWidth=!0}},height:{enumerable:!0,get:function(){return this._height},set:function(e){this._height=e,this._flagHeight=!0}},radius:{enumerable:!0,get:function(){return this._radius},set:function(e){this._radius instanceof z&&this._radius.unbind(D.Types.change,this._renderer.flagRadius),this._radius=e,this._radius instanceof z&&this._radius.bind(D.Types.change,this._renderer.flagRadius),this._flagRadius=!0}}};function ro(){this._flagRadius=!0}var ts,Zs=Math.min,Js=Math.max;Ct.document&&(ts=document.createElement("canvas"));var he=class extends ye{constructor(e,t,r,n){super(),g(this,"_flagValue",!0),g(this,"_flagFamily",!0),g(this,"_flagSize",!0),g(this,"_flagLeading",!0),g(this,"_flagAlignment",!0),g(this,"_flagBaseline",!0),g(this,"_flagStyle",!0),g(this,"_flagWeight",!0),g(this,"_flagDecoration",!0),g(this,"_flagFill",!0),g(this,"_flagStroke",!0),g(this,"_flagLinewidth",!0),g(this,"_flagOpacity",!0),g(this,"_flagVisible",!0),g(this,"_flagMask",!1),g(this,"_flagClip",!1),g(this,"_flagDirection",!0),g(this,"_value",""),g(this,"_family","sans-serif"),g(this,"_size",13),g(this,"_leading",17),g(this,"_alignment","center"),g(this,"_baseline","middle"),g(this,"_style","normal"),g(this,"_weight",500),g(this,"_decoration","none"),g(this,"_direction","ltr"),g(this,"_fill","#000"),g(this,"_stroke","none"),g(this,"_linewidth",1),g(this,"_opacity",1),g(this,"_visible",!0),g(this,"_mask",null),g(this,"_clip",!1),g(this,"_dashes",null);for(let o in Ks)Object.defineProperty(this,o,Ks[o]);if(this._renderer.type="text",this._renderer.flagFill=no.bind(this),this._renderer.flagStroke=lo.bind(this),this.value=e,typeof t=="number"&&(this.translation.x=t),typeof r=="number"&&(this.translation.y=r),this.dashes=[],this.dashes.offset=0,!$.isObject(n))return this;for(let o=0;o<he.Properties.length;o++){const h=he.Properties[o];h in n&&(this[h]=n[h])}}static Measure(e){if(ts){const t=ts.getContext("2d");t.font=[e._style,e._weight,`${e._size}px/${e._leading}px`,e._family].join(" ");const r=t.measureText(e.value,0,0),n=r.actualBoundingBoxDescent+r.actualBoundingBoxAscent;return{width:r.width,height:n}}else{const t=this.value.length*this.size*he.Ratio,r=this.leading;return console.warn("Two.Text: unable to accurately measure text, so using an approximation."),{width:t,height:r}}}clone(e){const t=new he(this.value);t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale;for(let r=0;r<he.Properties.length;r++){const n=he.Properties[r];t[n]=this[n]}return this.matrix.manual&&t.matrix.copy(this.matrix),e&&e.add(t),t._update()}toObject(){const e={translation:this.translation.toObject(),rotation:this.rotation,scale:this.scale};this.matrix.manual&&(e.matrix=this.matrix.toObject());for(let t=0;t<he.Properties.length;t++){const r=he.Properties[t];e[r]=this[r]}return e}noFill(){return this.fill="none",this}noStroke(){return this.stroke="none",this.linewidth=0,this}getBoundingClientRect(e){let t,r,n,o,h;this._update(!0),t=e?this.matrix:this.worldMatrix;const{width:f,height:u}=he.Measure(this),d=(this._linewidth||0)/2;switch(this.alignment){case"left":r=-d,n=f+d;break;case"right":r=-(f+d),n=d;break;default:r=-(f/2+d),n=f/2+d}switch(this.baseline){case"middle":o=-(u/2+d),h=u/2+d;break;default:o=-(u+d),h=d}const[_,y]=t.multiply(r,o),[P,w]=t.multiply(r,h),[v,C]=t.multiply(n,o),[k,L]=t.multiply(n,h);return o=Zs(y,w,C,L),r=Zs(_,P,v,k),n=Js(_,P,v,k),h=Js(y,w,C,L),{top:o,left:r,right:n,bottom:h,width:n-r,height:h-o}}flagReset(){return super.flagReset.call(this),this._flagValue=this._flagFamily=this._flagSize=this._flagLeading=this._flagAlignment=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagClip=this._flagDecoration=this._flagClassName=this._flagBaseline=this._flagWeight=this._flagStyle=this._flagDirection=!1,this}},ne=he;g(ne,"Ratio",.6);g(ne,"Properties",["value","family","size","leading","alignment","linewidth","style","weight","decoration","direction","baseline","opacity","visible","fill","stroke"]);var Ks={value:{enumerable:!0,get:function(){return this._value},set:function(e){this._value=e,this._flagValue=!0}},family:{enumerable:!0,get:function(){return this._family},set:function(e){this._family=e,this._flagFamily=!0}},size:{enumerable:!0,get:function(){return this._size},set:function(e){this._size=e,this._flagSize=!0}},leading:{enumerable:!0,get:function(){return this._leading},set:function(e){this._leading=e,this._flagLeading=!0}},alignment:{enumerable:!0,get:function(){return this._alignment},set:function(e){this._alignment=e,this._flagAlignment=!0}},linewidth:{enumerable:!0,get:function(){return this._linewidth},set:function(e){this._linewidth=e,this._flagLinewidth=!0}},style:{enumerable:!0,get:function(){return this._style},set:function(e){this._style=e,this._flagStyle=!0}},weight:{enumerable:!0,get:function(){return this._weight},set:function(e){this._weight=e,this._flagWeight=!0}},decoration:{enumerable:!0,get:function(){return this._decoration},set:function(e){this._decoration=e,this._flagDecoration=!0}},direction:{enumerable:!0,get:function(){return this._direction},set:function(e){this._direction=e,this._flagDirection=!0}},baseline:{enumerable:!0,get:function(){return this._baseline},set:function(e){this._baseline=e,this._flagBaseline=!0}},opacity:{enumerable:!0,get:function(){return this._opacity},set:function(e){this._opacity=e,this._flagOpacity=!0}},visible:{enumerable:!0,get:function(){return this._visible},set:function(e){this._visible=e,this._flagVisible=!0}},fill:{enumerable:!0,get:function(){return this._fill},set:function(e){(this._fill instanceof Lt||this._fill instanceof wt||this._fill instanceof It||this._fill instanceof yt)&&this._fill.unbind(D.Types.change,this._renderer.flagFill),this._fill=e,this._flagFill=!0,(this._fill instanceof Lt||this._fill instanceof wt||this._fill instanceof It||this._fill instanceof yt)&&this._fill.bind(D.Types.change,this._renderer.flagFill)}},stroke:{enumerable:!0,get:function(){return this._stroke},set:function(e){(this._stroke instanceof Lt||this._stroke instanceof wt||this._stroke instanceof It||this._stroke instanceof yt)&&this._stroke.unbind(D.Types.change,this._renderer.flagStroke),this._stroke=e,this._flagStroke=!0,(this._stroke instanceof Lt||this._stroke instanceof wt||this._stroke instanceof It||this._stroke instanceof yt)&&this._stroke.bind(D.Types.change,this._renderer.flagStroke)}},mask:{enumerable:!0,get:function(){return this._mask},set:function(e){this._mask=e,this._flagMask=!0,$.isObject(e)&&!e.clip&&(e.clip=!0)}},clip:{enumerable:!0,get:function(){return this._clip},set:function(e){this._clip=e,this._flagClip=!0}},dashes:{enumerable:!0,get:function(){return this._dashes},set:function(e){typeof e.offset!="number"&&(e.offset=this.dashes&&this._dashes.offset||0),this._dashes=e}}};function no(){this._flagFill=!0}function lo(){this._flagStroke=!0}var ce={path:/[+-]?(?:\d*\.\d+|\d+)(?:[eE][+-]\d+)?/g,cssBackgroundImage:/url\(['"]?#([\w\d-_]*)['"]?\)/i,unitSuffix:/[a-zA-Z%]*/i},oo={start:"left",middle:"center",end:"right"},$s=["id","class","transform","xmlns","viewBox"],ao=["x","y","width","height","href","xlink:href"];function ho(e){return oo[e]}function fo(e){const t=e.getAttribute("dominant-baseline"),r=e.getAttribute("alignment-baseline");return t||r}function Ke(e){return e.replace(/svg:/ig,"").toLowerCase()}function Qs(e,t){if(t.x+=e.translateX,t.y+=e.translateY,t.x*=e.scaleX,t.y*=e.scaleY,e.rotation!==0){const r=t.length();t.x=r*Math.cos(e.rotation),t.y=r*Math.sin(e.rotation)}}function co(e,t){t||(t={});const r=e.split(";");for(let n=0;n<r.length;n++){const o=r[n].split(":"),h=o[0],f=o[1];typeof h>"u"||typeof f>"u"||(t[h]=f.replace(/\s/,""))}return t}function uo(e){const t={},r=po(e),n=Math.max(r.length,e.style.length);for(let o=0;o<n;o++){const h=e.style[o],f=r[o];h&&(t[h]=e.style[h]),f&&(t[f]=e.getAttribute(f))}return t}function po(e){const t=e.getAttributeNames();for(let r=0;r<$s.length;r++){const n=$s[r],o=Array.prototype.indexOf.call(t,n);o>=0&&t.splice(o,1)}return t}function _o(e,t){const r=t.split(/[\s,]/),n=-parseFloat(r[0]),o=-parseFloat(r[1]),h=parseFloat(r[2]),f=parseFloat(r[3]);if(n&&o)for(let P=0;P<e.children.length;P++){const w=e.children[P];"translation"in w?w.translation.add(n,o):"x"in w?w.x=n:"y"in w&&(w.y=o)}const u=typeof e.x=="number",d=typeof e.y=="number",_=typeof e.width=="number",y=typeof e.height=="number";return u&&(e.translation.x+=e.x),d&&(e.translation.y+=e.y),(_||y)&&(e.scale=new z(1,1)),_&&(e.scale.x=e.width/h),y&&(e.scale.y=e.height/f),e.mask=new Ae(0,0,h,f),e.mask.origin.set(-h/2,-f/2),e}function Qt(e,t,r){const n={},o={},h={};let f,u,d,_,y,P,w,v,C,k,L,O,E,N,W,F,Z;if(e===null)return n;if(Ct.getComputedStyle){const G=Ct.getComputedStyle(e);for(f=G.length;f--;)d=G[f],_=G[d],typeof _<"u"&&(n[d]=_)}for(f=0;f<e.attributes.length;f++)P=e.attributes[f],/style/i.test(P.nodeName)?co(P.value,h):o[P.nodeName]=P.value;typeof n.opacity<"u"&&(n["stroke-opacity"]=n.opacity,n["fill-opacity"]=n.opacity,delete n.opacity),r&&$.defaults(n,r),$.extend(n,h,o),n.visible=!(typeof n.display>"u"&&/none/i.test(n.display))||typeof n.visibility>"u"&&/hidden/i.test(n.visibility);for(d in n)switch(_=n[d],d){case"gradientTransform":if(/none/i.test(_)||(u=e.gradientTransform&&e.gradientTransform.baseVal&&e.gradientTransform.baseVal.length>0?e.gradientTransform.baseVal[0].matrix:e.getCTM?e.getCTM():null,u===null))break;switch(w=Ye(u),t._renderer.type){case"linear-gradient":Qs(w,t.left),Qs(w,t.right);break;case"radial-gradient":t.center.x+=w.translateX,t.center.y+=w.translateY,t.focal.x+=w.translateX,t.focal.y+=w.translateY,t.radius*=Math.max(w.scaleX,w.scaleY);break}break;case"transform":if(/none/i.test(_)||(u=e.transform&&e.transform.baseVal&&e.transform.baseVal.length>0?e.transform.baseVal[0].matrix:e.getCTM?e.getCTM():null,u===null))break;w=Ye(u),t.translation.set(w.translateX,w.translateY),t.rotation=Math.PI*(w.rotation/180),t.scale=new z(w.scaleX,w.scaleY),v=parseFloat((n.x+"").replace("px")),C=parseFloat((n.y+"").replace("px")),v&&(t.translation.x=v),C&&(t.translation.y=C);break;case"visible":if(t instanceof At){t._visible=_;break}t.visible=_;break;case"stroke-linecap":if(t instanceof At){t._cap=_;break}t.cap=_;break;case"stroke-linejoin":if(t instanceof At){t._join=_;break}t.join=_;break;case"stroke-miterlimit":if(t instanceof At){t._miter=_;break}t.miter=_;break;case"stroke-width":if(t instanceof At){t._linewidth=parseFloat(_);break}t.linewidth=parseFloat(_);break;case"opacity":case"stroke-opacity":case"fill-opacity":if(t instanceof At){t._opacity=parseFloat(_);break}t.opacity=parseFloat(_);break;case"clip-path":if(ce.cssBackgroundImage.test(_)&&(k=_.replace(ce.cssBackgroundImage,"$1"),bt.defs.current&&bt.defs.current.contains(k)&&(O=bt.defs.current.get(k),O&&O.childNodes.length>0)))switch(O=O.childNodes[0],E=Ke(O.nodeName),t.mask=bt[E].call(this,O,{}),t._renderer.type){case"text":case"path":t.position.add(t.mask.position),t.mask.position.clear();break}break;case"fill":case"stroke":y=(t instanceof At?"_":"")+d,ce.cssBackgroundImage.test(_)?(k=_.replace(ce.cssBackgroundImage,"$1"),bt.defs.current&&bt.defs.current.contains(k)?(O=bt.defs.current.get(k),O.object||(E=Ke(O.nodeName),O.object=bt[E].call(this,O,{})),O=O.object):(L=go(this),O=L.getById(k)),t[y]=O):t[y]=_;break;case"id":t.id=_;break;case"class":case"className":t.classList=_.split(" "),t._flagClassName=!0;break;case"x":case"y":if(N=t instanceof Lt,W=t instanceof wt,F=t instanceof It,N||W||F)break;_.match("[a-z%]$")&&!_.endsWith("px")&&(Z=new Kt("only pixel values are supported with the "+d+" attribute."),console.warn(Z.name,Z.message)),t.translation[d]=parseFloat(_);break;case"font-family":t instanceof ne&&(t.family=_);break;case"font-size":t instanceof ne&&(t.size=_);break;case"font-weight":t instanceof ne&&(t.weight=_);break;case"font-style":t instanceof ne&&(t.style=_);break;case"text-decoration":t instanceof ne&&(t.decoration=_);break;case"line-height":t instanceof ne&&(t.leading=_);break}return Object.keys(e.dataset).length&&(t.dataset=e.dataset),n}function mo(e,t){for(let r=0,n=e.childNodes.length;r<n;r++){const o=e.childNodes[r];!o.id||Ke(e.nodeName)==="#text"||t.add(o.id,o)}}function go(e){for(;e.parent;)e=e.parent;return e.scene}var bt={svg:function(e){const t=bt.defs.current=new Ai,r=e.getElementsByTagName("defs");for(let C=0;C<r.length;C++)mo(r[C],t);const n=bt.g.call(this,e),o=e.getAttribute("viewBox"),h=e.getAttribute("x"),f=e.getAttribute("y"),u=e.getAttribute("width"),d=e.getAttribute("height");n.defs=t;const _=o!==null,y=h!==null,P=f!==null,w=u!==null,v=d!==null;return y&&(n.x=parseFloat(h.replace(ce.unitSuffix,""))),P&&(n.y=parseFloat(f.replace(ce.unitSuffix,""))),w&&(n.width=parseFloat(u.replace(ce.unitSuffix,""))),v&&(n.height=parseFloat(d.replace(ce.unitSuffix,""))),_&&_o(n,o),delete bt.defs.current,n},defs:function(e){return null},use:function(e,t){let r;const n=e.getAttribute("href")||e.getAttribute("xlink:href");if(!n)return r=new Kt("encountered <use /> with no href."),console.warn(r.name,r.message),null;const o=n.slice(1);if(!bt.defs.current.contains(o))return r=new Kt("unable to find element for reference "+n+"."),console.warn(r.name,r.message),null;const f=bt.defs.current.get(o).cloneNode(!0);for(let d=0;d<e.attributes.length;d++){const _=e.attributes[d],y=ao.includes(_.nodeName),P=!f.hasAttribute(_.nodeName);(y||P)&&f.setAttribute(_.nodeName,_.value)}const u=Ke(f.nodeName);return bt[u].call(this,f,t)},g:function(e,t){const r=new At;Qt.call(this,e,r,t),this.add(r);const n=uo.call(this,e);for(let o=0,h=e.childNodes.length;o<h;o++){const f=e.childNodes[o],u=f.nodeName;if(!u)return;const d=Ke(u);if(d in bt){const _=bt[d].call(r,f,n);_&&!_.parent&&r.add(_)}}return r},polygon:function(e,t){let r;typeof e=="string"?r=e:r=e.getAttribute("points");const n=[];r.replace(/(-?[\d.eE-]+)[,|\s](-?[\d.eE-]+)/g,function(h,f,u){n.push(new ct(parseFloat(f),parseFloat(u)))});const o=new mt(n,!0).noStroke();return o.fill="black",Qt.call(this,e,o,t),o},polyline:function(e,t){const r=bt.polygon.call(this,e,t);return r.closed=!1,r},path:function(e,t){let r;typeof e=="string"?(r=e,e=null):r=e.getAttribute("d");let n=[],o=!1,h=!1;if(r){let u=new ct,d,_,y=r.match(/[a-df-z][^a-df-z]*/ig);const P=y.length-1;$.each(y.slice(0),function(w,v){const C=w.slice(1).trim().match(ce.path),k=w[0],L=k.toLowerCase();let O,E,N,W,F;const Z=[];switch(v===0&&(y=[]),L){case"h":case"v":C.length>1&&(O=1);break;case"m":case"l":case"t":C.length>2&&(O=2);break;case"s":case"q":C.length>4&&(O=4);break;case"c":C.length>6&&(O=6);break;case"a":C.length>7&&(O=7);break}if(O){for(E=0,N=C.length,F=0;E<N;E+=O){if(W=k,F>0)switch(k){case"m":W="l";break;case"M":W="L";break}Z.push(W+C.slice(E,E+O).join(" ")),F++}y=Array.prototype.concat.apply(y,Z)}else y.push(w)}),$.each(y,function(w,v){let C,k,L;const O=w[0],E=O.toLowerCase();_=w.slice(1).trim().match(ce.path),h=O===E;let N,W,F,Z,G,st,et,Q,ht,at,T,V,R,X,Y,K,tt;switch(E){case"z":if(v>=P)o=!0;else{k=u.x,L=u.y,C=new ct(k,L,void 0,void 0,void 0,void 0,q.close);for(let it=n.length-1;it>=0;it--){const lt=n[it];if(/m/i.test(lt.command)){u=lt;break}}}break;case"m":case"l":d=void 0,k=parseFloat(_[0]),L=parseFloat(_[1]),C=new ct(k,L,void 0,void 0,void 0,void 0,/m/i.test(E)?q.move:q.line),h&&C.addSelf(u),u=C;break;case"h":case"v":at=/h/i.test(E)?"x":"y",T=/x/i.test(at)?"y":"x",C=new ct(void 0,void 0,void 0,void 0,void 0,void 0,q.line),C[at]=parseFloat(_[0]),C[T]=u[T],h&&(C[at]+=u[at]),u=C;break;case"c":case"s":N=u.x,W=u.y,d||(d=new z),/c/i.test(E)?(F=parseFloat(_[0]),Z=parseFloat(_[1]),G=parseFloat(_[2]),st=parseFloat(_[3]),et=parseFloat(_[4]),Q=parseFloat(_[5])):(ht=$i(u,d,h),F=ht.x,Z=ht.y,G=parseFloat(_[0]),st=parseFloat(_[1]),et=parseFloat(_[2]),Q=parseFloat(_[3])),h&&(F+=N,Z+=W,G+=N,st+=W,et+=N,Q+=W),u.controls.right.set(F-u.x,Z-u.y),C=new ct(et,Q,G-et,st-Q,void 0,void 0,q.curve),u=C,d=C.controls.left;break;case"t":case"q":N=u.x,W=u.y,d||(d=new z),/q/i.test(E)?(F=parseFloat(_[0]),Z=parseFloat(_[1]),G=parseFloat(_[0]),st=parseFloat(_[1]),et=parseFloat(_[2]),Q=parseFloat(_[3])):(ht=$i(u,d,h),F=ht.x,Z=ht.y,G=ht.x,st=ht.y,et=parseFloat(_[0]),Q=parseFloat(_[1])),h&&(F+=N,Z+=W,G+=N,st+=W,et+=N,Q+=W),u.controls.right.set((F-u.x)*.33,(Z-u.y)*.33),C=new ct(et,Q,G-et,st-Q,void 0,void 0,q.curve),u=C,d=C.controls.left;break;case"a":N=u.x,W=u.y,R=parseFloat(_[0]),X=parseFloat(_[1]),Y=parseFloat(_[2]),K=parseFloat(_[3]),tt=parseFloat(_[4]),et=parseFloat(_[5]),Q=parseFloat(_[6]),h&&(et+=N,Q+=W),V=new ct(et,Q),V.command=q.arc,V.rx=R,V.ry=X,V.xAxisRotation=Y,V.largeArcFlag=K,V.sweepFlag=tt,C=V,u=V,d=void 0;break}C&&(Array.isArray(C)?n=n.concat(C):n.push(C))})}r=new mt(n,o,void 0,!0).noStroke(),r.fill="black";const f=r.getBoundingClientRect(!0);return f.centroid={x:f.left+f.width/2,y:f.top+f.height/2},$.each(r.vertices,function(u){u.subSelf(f.centroid)}),Qt.call(this,e,r,t),r.translation.addSelf(f.centroid),r},circle:function(e,t){const r=parseFloat(e.getAttribute("cx")),n=parseFloat(e.getAttribute("cy")),o=parseFloat(e.getAttribute("r")),h=new Oi(0,0,o).noStroke();return h.fill="black",Qt.call(this,e,h,t),h.translation.x=r,h.translation.y=n,h},ellipse:function(e,t){const r=parseFloat(e.getAttribute("cx")),n=parseFloat(e.getAttribute("cy")),o=parseFloat(e.getAttribute("rx")),h=parseFloat(e.getAttribute("ry")),f=new ki(0,0,o,h).noStroke();return f.fill="black",Qt.call(this,e,f,t),f.translation.x=r,f.translation.y=n,f},rect:function(e,t){const r=parseFloat(e.getAttribute("rx")),n=parseFloat(e.getAttribute("ry"));if(!$.isNaN(r)||!$.isNaN(n))return bt["rounded-rect"](e);const o=parseFloat(e.getAttribute("width")),h=parseFloat(e.getAttribute("height")),f=o/2,u=h/2,d=new Ae(0,0,o,h).noStroke();return d.fill="black",Qt.call(this,e,d,t),d.translation.x+=f,d.translation.y+=u,d},"rounded-rect":function(e,t){const r=parseFloat(e.getAttribute("rx"))||0,n=parseFloat(e.getAttribute("ry"))||0,o=parseFloat(e.getAttribute("width")),h=parseFloat(e.getAttribute("height")),f=o/2,u=h/2,d=new z(r,n),_=new Ni(0,0,o,h,d).noStroke();return _.fill="black",Qt.call(this,e,_,t),_.translation.x+=f,_.translation.y+=u,_},line:function(e,t){const r=parseFloat(e.getAttribute("x1")),n=parseFloat(e.getAttribute("y1")),o=parseFloat(e.getAttribute("x2")),h=parseFloat(e.getAttribute("y2")),f=new ds(r,n,o,h).noFill();return Qt.call(this,e,f,t),f},lineargradient:function(e,t){let r=e.getAttribute("gradientUnits"),n=e.getAttribute("spreadMethod");r||(r="objectBoundingBox"),n||(n="pad");let o=parseFloat(e.getAttribute("x1")||0),h=parseFloat(e.getAttribute("y1")||0),f=parseFloat(e.getAttribute("x2")||0),u=parseFloat(e.getAttribute("y2")||0);const d=(f+o)/2,_=(u+h)/2;/userSpaceOnUse/i.test(r)&&(o-=d,h-=_,f-=d,u-=_);const y=[];for(let w=0;w<e.children.length;w++){const v=e.children[w];let C=v.getAttribute("offset");/%/ig.test(C)&&(C=parseFloat(C.replace(/%/ig,""))/100),C=parseFloat(C);let k=v.getAttribute("stop-color"),L=v.getAttribute("stop-opacity"),O=v.getAttribute("style"),E;k===null&&(E=O?O.match(/stop-color:\s?([#a-fA-F0-9]*)/):!1,k=E&&E.length>1?E[1]:void 0),L===null?(E=O?O.match(/stop-opacity:\s?([0-9.-]*)/):!1,L=E&&E.length>1?parseFloat(E[1]):1):L=parseFloat(L),y.push(new ve(C,k,L))}const P=new wt(o,h,f,u,y);return P.spread=n,P.units=r,Qt.call(this,e,P,t),P},radialgradient:function(e,t){let r=e.getAttribute("gradientUnits"),n=e.getAttribute("spreadMethod");r||(r="objectBoundingBox"),n||(n="pad");let o=parseFloat(e.getAttribute("cx"))||0,h=parseFloat(e.getAttribute("cy"))||0,f=parseFloat(e.getAttribute("r")),u=parseFloat(e.getAttribute("fx")),d=parseFloat(e.getAttribute("fy"));$.isNaN(u)&&(u=o),$.isNaN(d)&&(d=h);const _=Math.abs(o+u)/2,y=Math.abs(h+d)/2;/userSpaceOnUse/i.test(r)&&(o-=_,h-=y,u-=_,d-=y);const P=[];for(let v=0;v<e.children.length;v++){const C=e.children[v];let k=C.getAttribute("offset");/%/ig.test(k)&&(k=parseFloat(k.replace(/%/ig,""))/100),k=parseFloat(k);let L=C.getAttribute("stop-color"),O=C.getAttribute("stop-opacity"),E=C.getAttribute("style"),N;L===null&&(N=E?E.match(/stop-color:\s?([#a-fA-F0-9]*)/):!1,L=N&&N.length>1?N[1]:void 0),O===null?(N=E?E.match(/stop-opacity:\s?([0-9.-]*)/):!1,O=N&&N.length>1?parseFloat(N[1]):1):O=parseFloat(O),P.push(new ve(k,L,O))}const w=new It(o,h,f,P,u,d);return w.spread=n,w.units=r,Qt.call(this,e,w,t),w},text:function(e,t){const r=ho(e.getAttribute("text-anchor"))||"left",n=fo(e)||"baseline",o=e.textContent,h=new ne(o);return Qt.call(this,e,h,t),h.alignment=r,h.baseline=n,h},clippath:function(e,t){return bt.defs.current&&!bt.defs.current.contains(e.id)&&bt.defs.current.add(e.id,e),null},image:function(e,t){let r;const n=e.getAttribute("href")||e.getAttribute("xlink:href");if(!n)return r=new Kt("encountered <image /> with no href."),console.warn(r.name,r.message),null;const o=parseFloat(e.getAttribute("x"))||0,h=parseFloat(e.getAttribute("y"))||0,f=parseFloat(e.getAttribute("width")),u=parseFloat(e.getAttribute("height")),d=new Li(n,o,h);return $.isNaN(f)||(d.width=f),$.isNaN(u)||(d.height=u),Qt.call(this,e,d,t),d}};function Kr(e,t){const r=new XMLHttpRequest;return r.open("GET",e),r.onreadystatechange=function(){r.readyState===4&&r.status===200&&t(r.responseText)},r.send(),r}var es=class extends Ae{constructor(e,t,r,n){super(t,r,0,0),g(this,"_flagTextures",!1),g(this,"_flagFrameRate",!1),g(this,"_flagIndex",!1),g(this,"_amount",1),g(this,"_duration",0),g(this,"_index",0),g(this,"_startTime",0),g(this,"_playing",!1),g(this,"_firstFrame",0),g(this,"_lastFrame",0),g(this,"_loop",!0),g(this,"_textures",null),g(this,"_frameRate",0),g(this,"_origin",null);for(let o in tr)Object.defineProperty(this,o,tr[o]);this._renderer.flagTextures=yo.bind(this),this._renderer.bindTextures=xo.bind(this),this._renderer.unbindTextures=vo.bind(this),this.noStroke(),this.noFill(),Array.isArray(e)?this.textures=e.map(er.bind(this)):this.textures=[er(e)],this.origin=new z,this._update(),typeof n=="number"?this.frameRate=n:this.frameRate=es.DefaultFrameRate,this.index=0}play(e,t,r){return this._playing=!0,this._firstFrame=0,this._lastFrame=this.amount-1,this._startTime=$.performance.now(),typeof e=="number"&&(this._firstFrame=e),typeof t=="number"&&(this._lastFrame=t),typeof r=="function"?this._onLastFrame=r:delete this._onLastFrame,this._index!==this._firstFrame&&(this._startTime-=1e3*Math.abs(this._index-this._firstFrame)/this._frameRate),this}pause(){return this._playing=!1,this}stop(){return this._playing=!1,this._index=this._firstFrame,this}clone(e){const t=new es(this.textures,this.translation.x,this.translation.y,this.frameRate);return t._loop=this._loop,this._playing&&t.play(),e&&e.add(t),t}toObject(){const e=super.toObject.call(this);return e.textures=this.textures.map(function(t){return t.toObject()}),e.frameRate=this.frameRate,e.index=this.index,e._firstFrame=this._firstFrame,e._lastFrame=this._lastFrame,e._loop=this._loop,e}_update(){const e=this._textures;let t,r,n,o,h,f,u,d;return e&&(this._flagTextures&&(this._amount=e.length),this._flagFrameRate&&(this._duration=1e3*this._amount/this._frameRate),this._playing&&this._frameRate>0?(o=this._amount,$.isNaN(this._lastFrame)&&(this._lastFrame=o-1),n=$.performance.now()-this._startTime,d=this._lastFrame+1,h=1e3*(d-this._firstFrame)/this._frameRate,this._loop?n=n%h:n=Math.min(n,h),u=Gt(this._firstFrame,d,n/h),u=Math.floor(u),u!==this._index&&(this._index=u,f=e[this._index],f.loaded&&(t=f.image.width,r=f.image.height,this.width!==t&&(this.width=t),this.height!==r&&(this.height=r),this.fill=f,u>=this._lastFrame-1&&this._onLastFrame&&this._onLastFrame()))):(this._flagIndex||!(this.fill instanceof yt))&&(f=e[this._index],f.loaded&&(t=f.image.width,r=f.image.height,this.width!==t&&(this.width=t),this.height!==r&&(this.height=r)),this.fill=f)),super._update.call(this),this}flagReset(){return this._flagTextures=this._flagFrameRate=!1,super.flagReset.call(this),this}},Mi=es;g(Mi,"Properties",["textures","frameRate","index"]);g(Mi,"DefaultFrameRate",30);var tr={frameRate:{enumerable:!0,get:function(){return this._frameRate},set:function(e){this._frameRate=e,this._flagFrameRate=!0}},index:{enumerable:!0,get:function(){return this._index},set:function(e){this._index=e,this._flagIndex=!0}},textures:{enumerable:!0,get:function(){return this._textures},set:function(e){const t=this._renderer.bindTextures,r=this._renderer.unbindTextures;this._textures&&this._textures.unbind(D.Types.insert,t).unbind(D.Types.remove,r),this._textures=new xe((e||[]).slice(0)),this._textures.bind(D.Types.insert,t).bind(D.Types.remove,r),t(this._textures)}}};function yo(){this._flagTextures=!0}function xo(e){let t=e.length;for(;t--;)e[t].bind(D.Types.change,this._renderer.flagTextures);this._renderer.flagTextures()}function vo(e){let t=e.length;for(;t--;)e[t].unbind(D.Types.change,this._renderer.flagTextures);this._renderer.flagTextures()}function er(e){if(e instanceof yt)return e;if(typeof e=="string")return new yt(e)}var xi=class extends mt{constructor(e,t,r,n,o,h,f){const u=f||Rt.Resolution*3,d=[];for(let _=0;_<u;_++)d.push(new ct);super(d,!0,!1,!0),g(this,"_flagStartAngle",!1),g(this,"_flagEndAngle",!1),g(this,"_flagInnerRadius",!1),g(this,"_flagOuterRadius",!1),g(this,"_startAngle",0),g(this,"_endAngle",Yt),g(this,"_innerRadius",0),g(this,"_outerRadius",0);for(let _ in ir)Object.defineProperty(this,_,ir[_]);typeof r=="number"&&(this.innerRadius=r),typeof n=="number"&&(this.outerRadius=n),typeof o=="number"&&(this.startAngle=o),typeof h=="number"&&(this.endAngle=h),this._update(),typeof e=="number"&&(this.translation.x=e),typeof t=="number"&&(this.translation.y=t)}_update(){if(this._flagVertices||this._flagStartAngle||this._flagEndAngle||this._flagInnerRadius||this._flagOuterRadius){const e=this._startAngle,t=this._endAngle,r=this._innerRadius,n=this._outerRadius,o=$t(e,Yt)===$t(t,Yt),h=r>0,f=this.vertices;let u=h?f.length/2:f.length,d,_=0,y,P,w,v,C,k,L,O,E;for(o?u--:h||(u-=2),y=0,P=u-1;y<u;y++){switch(w=y/P,v=f[_],C=w*(t-e)+e,k=(t-e)/u,L=n*Math.cos(C),O=n*Math.sin(C),y){case 0:d=q.move;break;default:d=q.curve}v.command=d,v.x=L,v.y=O,v.controls.left.clear(),v.controls.right.clear(),v.command===q.curve&&(E=n*k/Math.PI,v.controls.left.x=E*Math.cos(C-Nt),v.controls.left.y=E*Math.sin(C-Nt),v.controls.right.x=E*Math.cos(C+Nt),v.controls.right.y=E*Math.sin(C+Nt),y===1&&v.controls.left.multiplyScalar(2),y===P&&v.controls.right.multiplyScalar(2)),_++}if(h){for(o?(f[_].command=q.close,_++):(u--,P=u-1),y=0;y<u;y++)w=y/P,v=f[_],C=(1-w)*(t-e)+e,k=(t-e)/u,L=r*Math.cos(C),O=r*Math.sin(C),d=q.curve,y<=0&&(d=o?q.move:q.line),v.command=d,v.x=L,v.y=O,v.controls.left.clear(),v.controls.right.clear(),v.command===q.curve&&(E=r*k/Math.PI,v.controls.left.x=E*Math.cos(C+Nt),v.controls.left.y=E*Math.sin(C+Nt),v.controls.right.x=E*Math.cos(C-Nt),v.controls.right.y=E*Math.sin(C-Nt),y===1&&v.controls.left.multiplyScalar(2),y===P&&v.controls.right.multiplyScalar(2)),_++;f[_].copy(f[0]),f[_].command=q.line}else o||(f[_].command=q.line,f[_].x=0,f[_].y=0,_++,f[_].copy(f[0]),f[_].command=q.line)}return super._update.call(this),this}flagReset(){return super.flagReset.call(this),this._flagStartAngle=this._flagEndAngle=this._flagInnerRadius=this._flagOuterRadius=!1,this}clone(e){const t=this.innerRadius,r=this.outerRadius,n=this.startAngle,o=this.endAngle,h=this.vertices.length,f=new xi(0,0,t,r,n,o,h);f.translation.copy(this.translation),f.rotation=this.rotation,f.scale=this.scale,f.skewX=this.skewX,f.skewY=this.skewY,this.matrix.manual&&f.matrix.copy(this.matrix);for(let u=0;u<mt.Properties.length;u++){const d=mt.Properties[u];f[d]=this[d]}return e&&e.add(f),f}toObject(){const e=super.toObject.call(this);for(let t=0;t<xi.Properties.length;t++){const r=xi.Properties[t];e[r]=this[r]}return e}},ps=xi;g(ps,"Properties",["startAngle","endAngle","innerRadius","outerRadius"]);var ir={startAngle:{enumerable:!0,get:function(){return this._startAngle},set:function(e){this._startAngle=e,this._flagStartAngle=!0}},endAngle:{enumerable:!0,get:function(){return this._endAngle},set:function(e){this._endAngle=e,this._flagEndAngle=!0}},innerRadius:{enumerable:!0,get:function(){return this._innerRadius},set:function(e){this._innerRadius=e,this._flagInnerRadius=!0}},outerRadius:{enumerable:!0,get:function(){return this._outerRadius},set:function(e){this._outerRadius=e,this._flagOuterRadius=!0}}},Po=Math.ceil,bo=Math.floor,He=class extends ye{constructor(e){super(),g(this,"_flagVertices",!0),g(this,"_flagLength",!0),g(this,"_flagFill",!0),g(this,"_flagStroke",!0),g(this,"_flagLinewidth",!0),g(this,"_flagOpacity",!0),g(this,"_flagVisible",!0),g(this,"_flagSize",!0),g(this,"_flagSizeAttenuation",!0),g(this,"_length",0),g(this,"_fill","#fff"),g(this,"_stroke","#000"),g(this,"_linewidth",1),g(this,"_opacity",1),g(this,"_visible",!0),g(this,"_size",1),g(this,"_sizeAttenuation",!1),g(this,"_beginning",0),g(this,"_ending",1),g(this,"_dashes",null),g(this,"noFill",mt.prototype.noFill),g(this,"noStroke",mt.prototype.noStroke),g(this,"corner",mt.prototype.corner),g(this,"center",mt.prototype.center),g(this,"getBoundingClientRect",mt.prototype.getBoundingClientRect),g(this,"_updateLength",mt.prototype._updateLength);for(let t in sr)Object.defineProperty(this,t,sr[t]);this._renderer.type="points",this._renderer.flagVertices=qr.bind(this),this._renderer.bindVertices=jr.bind(this),this._renderer.unbindVertices=zr.bind(this),this._renderer.flagFill=Hr.bind(this),this._renderer.flagStroke=Gr.bind(this),this._renderer.vertices=null,this._renderer.collection=null,this.sizeAttenuation=!1,this.beginning=0,this.ending=1,this.fill="#fff",this.stroke="#000",this.className="",this.visible=!0,this.vertices=e,this.dashes=[],this.dashes.offset=0}clone(e){const t=new He;for(let r=0;r<this.vertices.length;r++)t.vertices.push(this.vertices[r].clone());for(let r=0;r<He.Properties.length;r++){const n=He.Properties[r];t[n]=this[n]}return t.className=this.className,t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale,t.skewX=this.skewX,t.skewY=this.skewY,this.matrix.manual&&t.matrix.copy(this.matrix),e&&e.add(t),t._update()}toObject(){const e={vertices:this.vertices.map(function(t){return t.toObject()})};return $.each(He.Properties,function(t){e[t]=this[t]},this),e.className=this.className,e.translation=this.translation.toObject(),e.rotation=this.rotation,e.scale=this.scale instanceof z?this.scale.toObject():this.scale,e.skewX=this.skewX,e.skewY=this.skewY,this.matrix.manual&&(e.matrix=this.matrix.toObject()),e}subdivide(e){this._update();let t=[];for(let r=0;r<this.vertices.length;r++){const n=this.vertices[r],o=this.vertices[r-1];if(!o)continue;const h=n.x,f=n.y,u=o.x,d=o.y,_=cs(h,f,h,f,u,d,u,d,e);t=t.concat(_)}return this.vertices=t,this}_update(){if(this._flagVertices){this._flagLength&&this._updateLength(void 0,!0);const e=Math.min(this._beginning,this._ending),t=Math.max(this._beginning,this._ending),r=Ci(this,e*this._length),n=Ci(this,t*this._length),o=Po(r),h=bo(n);let f=0,u;this._renderer.vertices=[],this._renderer.collection=[];for(let d=0;d<this._collection.length;d++)d>=o&&d<=h&&(u=this._collection[d],this._renderer.collection.push(u),this._renderer.vertices[f*2+0]=u.x,this._renderer.vertices[f*2+1]=u.y,f++)}return super._update.apply(this,arguments),this}flagReset(){return this._flagVertices=this._flagLength=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagSize=this._flagSizeAttenuation=!1,super.flagReset.call(this),this}},_s=He;g(_s,"Properties",["fill","stroke","linewidth","opacity","visible","size","sizeAttenuation","beginning","ending"]);var sr={linewidth:{enumerable:!0,get:function(){return this._linewidth},set:function(e){this._linewidth=e,this._flagLinewidth=!0}},opacity:{enumerable:!0,get:function(){return this._opacity},set:function(e){this._opacity=e,this._flagOpacity=!0}},visible:{enumerable:!0,get:function(){return this._visible},set:function(e){this._visible=e,this._flagVisible=!0}},size:{enumerable:!0,get:function(){return this._size},set:function(e){this._size=e,this._flagSize=!0}},sizeAttenuation:{enumerable:!0,get:function(){return this._sizeAttenuation},set:function(e){this._sizeAttenuation=e,this._flagSizeAttenuation=!0}},fill:{enumerable:!0,get:function(){return this._fill},set:function(e){(this._fill instanceof Lt||this._fill instanceof wt||this._fill instanceof It||this._fill instanceof yt)&&this._fill.unbind(D.Types.change,this._renderer.flagFill),this._fill=e,this._flagFill=!0,(this._fill instanceof Lt||this._fill instanceof wt||this._fill instanceof It||this._fill instanceof yt)&&this._fill.bind(D.Types.change,this._renderer.flagFill)}},stroke:{enumerable:!0,get:function(){return this._stroke},set:function(e){(this._stroke instanceof Lt||this._stroke instanceof wt||this._stroke instanceof It||this._stroke instanceof yt)&&this._stroke.unbind(D.Types.change,this._renderer.flagStroke),this._stroke=e,this._flagStroke=!0,(this._stroke instanceof Lt||this._stroke instanceof wt||this._stroke instanceof It||this._stroke instanceof yt)&&this._stroke.bind(D.Types.change,this._renderer.flagStroke)}},length:{get:function(){return this._flagLength&&this._updateLength(),this._length}},beginning:{enumerable:!0,get:function(){return this._beginning},set:function(e){this._beginning=e,this._flagVertices=!0}},ending:{enumerable:!0,get:function(){return this._ending},set:function(e){this._ending=e,this._flagVertices=!0}},vertices:{enumerable:!0,get:function(){return this._collection},set:function(e){const t=this._renderer.bindVertices,r=this._renderer.unbindVertices;this._collection&&this._collection.unbind(D.Types.insert,t).unbind(D.Types.remove,r),e instanceof xe?this._collection=e:this._collection=new xe(e||[]),this._collection.bind(D.Types.insert,t).bind(D.Types.remove,r),t(this._collection)}},dashes:{enumerable:!0,get:function(){return this._dashes},set:function(e){typeof e.offset!="number"&&(e.offset=this.dashes&&this._dashes.offset||0),this._dashes=e}}},wo=Math.cos,Io=Math.sin,vi=class extends mt{constructor(e,t,r,n){n=Math.max(n||0,3),super(),g(this,"_flagWidth",!1),g(this,"_flagHeight",!1),g(this,"_flagSides",!1),g(this,"_radius",0),g(this,"_width",0),g(this,"_height",0),g(this,"_sides",0);for(let o in rr)Object.defineProperty(this,o,rr[o]);this.closed=!0,this.automatic=!1,typeof r=="number"&&(this.radius=r),typeof n=="number"&&(this.sides=n),this._update(),typeof e=="number"&&(this.translation.x=e),typeof t=="number"&&(this.translation.y=t)}_update(){if(this._flagVertices||this._flagWidth||this._flagHeight||this._flagSides){const e=this._sides,t=e+1;let r=this.vertices.length;r>e&&(this.vertices.splice(e-1,r-e),r=e);for(let n=0;n<t;n++){const o=(n+.5)/e,h=Yt*o+Math.PI/2,f=this._width*wo(h)/2,u=this._height*Io(h)/2;n>=r?this.vertices.push(new ct(f,u)):this.vertices[n].set(f,u),this.vertices[n].command=n===0?q.move:q.line}}return super._update.call(this),this}flagReset(){return this._flagWidth=this._flagHeight=this._flagSides=!1,super.flagReset.call(this),this}clone(e){const t=new vi(0,0,0,this.sides);t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale,t.skewX=this.skewX,t.skewY=this.skewY,t.width=this.width,t.height=this.height,this.matrix.manual&&t.matrix.copy(this.matrix);for(let r=0;r<mt.Properties.length;r++){const n=mt.Properties[r];t[n]=this[n]}return e&&e.add(t),t}toObject(){const e=super.toObject.call(this);for(let t=0;t<vi.Properties.length;t++){const r=vi.Properties[t];e[r]=this[r]}return e}},ms=vi;g(ms,"Properties",["width","height","sides"]);var rr={radius:{enumerable:!0,get:function(){return this._radius},set:function(e){this._radius=e,this.width=e*2,this.height=e*2}},width:{enumerable:!0,get:function(){return this._width},set:function(e){this._width=e,this._flagWidth=!0,this._radius=Math.max(this.width,this.height)/2}},height:{enumerable:!0,get:function(){return this._height},set:function(e){this._height=e,this._flagHeight=!0,this._radius=Math.max(this.width,this.height)/2}},sides:{enumerable:!0,get:function(){return this._sides},set:function(e){this._sides=e,this._flagSides=!0}}},Co=Math.cos,To=Math.sin,Pi=class extends mt{constructor(e,t,r,n,o){arguments.length<=3&&(n=r,r=n/2),(typeof o!="number"||o<=0)&&(o=5),super(),g(this,"_flagInnerRadius",!1),g(this,"_flagOuterRadius",!1),g(this,"_flagSides",!1),g(this,"_innerRadius",0),g(this,"_outerRadius",0),g(this,"_sides",0);for(let h in nr)Object.defineProperty(this,h,nr[h]);this.closed=!0,this.automatic=!1,typeof r=="number"&&(this.innerRadius=r),typeof n=="number"&&(this.outerRadius=n),typeof o=="number"&&(this.sides=o),this._update(),typeof e=="number"&&(this.translation.x=e),typeof t=="number"&&(this.translation.y=t)}_update(){if(this._flagVertices||this._flagInnerRadius||this._flagOuterRadius||this._flagSides){const e=this._sides*2,t=e+1;let r=this.vertices.length;r>e&&(this.vertices.splice(e-1,r-e),r=e);for(let n=0;n<t;n++){const o=(n+.5)/e,h=Yt*o,f=(n%2?this._outerRadius:this._innerRadius)/2,u=f*Co(h),d=f*To(h);n>=r?this.vertices.push(new ct(u,d)):this.vertices[n].set(u,d),this.vertices[n].command=n===0?q.move:q.line}}return super._update.call(this),this}flagReset(){return this._flagInnerRadius=this._flagOuterRadius=this._flagSides=!1,super.flagReset.call(this),this}clone(e){const t=this.innerRadius,r=this.outerRadius,n=this.sides,o=new Pi(0,0,t,r,n);o.translation.copy(this.translation),o.rotation=this.rotation,o.scale=this.scale,o.skewX=this.skewX,o.skewY=this.skewY,this.matrix.manual&&o.matrix.copy(this.matrix);for(let h=0;h<mt.Properties.length;h++){const f=mt.Properties[h];o[f]=this[f]}return e&&e.add(o),o}toObject(){const e=super.toObject.call(this);for(let t=0;t<Pi.Properties.length;t++){const r=Pi.Properties[t];e[r]=this[r]}return e}},gs=Pi;g(gs,"Properties",["innerRadius","outerRadius","sides"]);var nr={innerRadius:{enumerable:!0,get:function(){return this._innerRadius},set:function(e){this._innerRadius=e,this._flagInnerRadius=!0}},outerRadius:{enumerable:!0,get:function(){return this._outerRadius},set:function(e){this._outerRadius=e,this._flagOuterRadius=!0}},sides:{enumerable:!0,get:function(){return this._sides},set:function(e){this._sides=e,this._flagSides=!0}}},nt={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",alignments:{left:"start",center:"middle",right:"end"},baselines:{top:"hanging",middle:"middle",bottom:"ideographic",baseline:"alphabetic"},createElement:function(e,t){const r=e,n=document.createElementNS(nt.ns,r);return r==="svg"&&(t=$.defaults(t||{},{version:nt.version})),t&&Object.keys(t).length>0&&nt.setAttributes(n,t),n},setAttributes:function(e,t){const r=Object.keys(t);for(let n=0;n<r.length;n++)/href/.test(r[n])?e.setAttributeNS(nt.xlink,r[n],t[r[n]]):e.setAttribute(r[n],t[r[n]]);return this},removeAttributes:function(e,t){for(let r in t)e.removeAttribute(r);return this},toString:function(e,t){let r=e.length,n=r-1,o,h="";for(let f=0;f<r;f++){const u=e[f],d=t?$t(f-1,r):Math.max(f-1,0),_=e[d];let y,P,w,v,C,k,L,O,E,N,W,F,Z,G,st,et=Tt(u.x),Q=Tt(u.y);switch(u.command){case q.close:y=q.close;break;case q.arc:W=u.rx,F=u.ry,Z=u.xAxisRotation,G=u.largeArcFlag,st=u.sweepFlag,y=q.arc+" "+W+" "+F+" "+Z+" "+G+" "+st+" "+et+" "+Q;break;case q.curve:L=_.controls&&_.controls.right||z.zero,O=u.controls&&u.controls.left||z.zero,_.relative?(w=Tt(L.x+_.x),v=Tt(L.y+_.y)):(w=Tt(L.x),v=Tt(L.y)),u.relative?(C=Tt(O.x+u.x),k=Tt(O.y+u.y)):(C=Tt(O.x),k=Tt(O.y)),y=(f===0?q.move:q.curve)+" "+w+" "+v+" "+C+" "+k+" "+et+" "+Q;break;case q.move:o=u,y=q.move+" "+et+" "+Q;break;default:y=u.command+" "+et+" "+Q}f>=n&&t&&(u.command===q.curve&&(P=o,E=u.controls&&u.controls.right||u,N=P.controls&&P.controls.left||P,u.relative?(w=Tt(E.x+u.x),v=Tt(E.y+u.y)):(w=Tt(E.x),v=Tt(E.y)),P.relative?(C=Tt(N.x+P.x),k=Tt(N.y+P.y)):(C=Tt(N.x),k=Tt(N.y)),et=Tt(P.x),Q=Tt(P.y),y+=" C "+w+" "+v+" "+C+" "+k+" "+et+" "+Q),u.command!==q.close&&(y+=" Z")),h+=y+" "}return h},pointsToString:function(e,t){let r="";const n=t*.5;for(let o=0;o<e.length;o++){const h=e[o].x,f=e[o].y-n;r+=q.move+" "+h+" "+f+" ",r+="a "+n+" "+n+" 0 1 0 0.001 0 Z"}return r},getClip:function(e,t){let r=e._renderer.clip;return r||(r=e._renderer.clip=nt.createElement("clipPath",{"clip-rule":"nonzero"})),r.parentNode===null&&t.defs.appendChild(r),r},defs:{update:function(e){const{defs:t}=e;if(t._flagUpdate){const r=Array.prototype.slice.call(t.children,0);for(let n=0;n<r.length;n++){const o=r[n],h=o.id,f=`[fill="url(#${h})"],[stroke="url(#${h})"],[clip-path="url(#${h})"]`;e.querySelector(f)||t.removeChild(o)}t._flagUpdate=!1}}},group:{appendChild:function(e){const t=e._renderer.elem;if(!t)return;const r=t.nodeName;!r||/(radial|linear)gradient/i.test(r)||e._clip||this.elem.appendChild(t)},removeChild:function(e){const t=e._renderer.elem;!t||t.parentNode!=this.elem||!t.nodeName||e._clip||this.elem.removeChild(t)},orderChild:function(e){this.elem.appendChild(e._renderer.elem)},renderChild:function(e){nt[e._renderer.type].render.call(e,this)},render:function(e){if(!this._visible&&!this._flagVisible||this._opacity===0&&!this._flagOpacity)return this;this._update(),this._renderer.elem||(this._renderer.elem=nt.createElement("g",{id:this.id}),e.appendChild(this._renderer.elem));const t=this._matrix.manual||this._flagMatrix,r={domElement:e,elem:this._renderer.elem};t&&this._renderer.elem.setAttribute("transform","matrix("+this._matrix.toString()+")");for(let n=0;n<this.children.length;n++){const o=this.children[n];nt[o._renderer.type].render.call(o,e)}return this._flagId&&this._renderer.elem.setAttribute("id",this._id),this._flagOpacity&&this._renderer.elem.setAttribute("opacity",this._opacity),this._flagVisible&&this._renderer.elem.setAttribute("display",this._visible?"inline":"none"),this._flagClassName&&this._renderer.elem.setAttribute("class",this.classList.join(" ")),this._flagAdditions&&this.additions.forEach(nt.group.appendChild,r),this._flagSubtractions&&this.subtractions.forEach(nt.group.removeChild,r),this._flagOrder&&this.children.forEach(nt.group.orderChild,r),this._flagMask&&(this._mask?(nt[this._mask._renderer.type].render.call(this._mask,e),this._renderer.elem.setAttribute("clip-path","url(#"+this._mask.id+")")):this._renderer.elem.removeAttribute("clip-path")),this.dataset&&Object.assign(this._renderer.elem.dataset,this.dataset),this.flagReset()}},path:{render:function(e){if(this._opacity===0&&!this._flagOpacity)return this;this._update();const t={};if((this._matrix.manual||this._flagMatrix)&&(t.transform="matrix("+this._matrix.toString()+")"),this._flagId&&(t.id=this._id),this._flagVertices){const n=nt.toString(this._renderer.vertices,this._closed);t.d=n}if(this._fill&&this._fill._renderer&&(this._renderer.hasFillEffect=!0,this._fill._update(),nt[this._fill._renderer.type].render.call(this._fill,e,!0)),this._flagFill&&(t.fill=this._fill&&this._fill.id?"url(#"+this._fill.id+")":this._fill,this._renderer.hasFillEffect&&typeof this._fill.id>"u"&&(e.defs._flagUpdate=!0,delete this._renderer.hasFillEffect)),this._stroke&&this._stroke._renderer&&(this._renderer.hasStrokeEffect=!0,this._stroke._update(),nt[this._stroke._renderer.type].render.call(this._stroke,e,!0)),this._flagStroke&&(t.stroke=this._stroke&&this._stroke.id?"url(#"+this._stroke.id+")":this._stroke,this._renderer.hasStrokeEffect&&typeof this._stroke.id>"u"&&(e.defs._flagUpdate=!0,delete this._renderer.hasStrokeEffect)),this._flagLinewidth&&(t["stroke-width"]=this._linewidth),this._flagOpacity&&(t["stroke-opacity"]=this._opacity,t["fill-opacity"]=this._opacity),this._flagClassName&&(t.class=this.classList.join(" ")),this._flagVisible&&(t.visibility=this._visible?"visible":"hidden"),this._flagCap&&(t["stroke-linecap"]=this._cap),this._flagJoin&&(t["stroke-linejoin"]=this._join),this._flagMiter&&(t["stroke-miterlimit"]=this._miter),this.dashes&&this.dashes.length>0&&(t["stroke-dasharray"]=this.dashes.join(" "),t["stroke-dashoffset"]=this.dashes.offset||0),this._renderer.elem?nt.setAttributes(this._renderer.elem,t):(t.id=this._id,this._renderer.elem=nt.createElement("path",t),e.appendChild(this._renderer.elem)),this._flagClip){const n=nt.getClip(this,e),o=this._renderer.elem;this._clip?(o.removeAttribute("id"),n.setAttribute("id",this.id),n.appendChild(o)):(n.removeAttribute("id"),o.setAttribute("id",this.id),this.parent._renderer.elem.appendChild(o))}return this._flagMask&&(this._mask?(nt[this._mask._renderer.type].render.call(this._mask,e),this._renderer.elem.setAttribute("clip-path","url(#"+this._mask.id+")")):this._renderer.elem.removeAttribute("clip-path")),this.flagReset()}},points:{render:function(e){if(this._opacity===0&&!this._flagOpacity)return this;this._update();const t={};if((this._matrix.manual||this._flagMatrix)&&(t.transform="matrix("+this._matrix.toString()+")"),this._flagId&&(t.id=this._id),this._flagVertices||this._flagSize||this._flagSizeAttenuation){let n=this._size;if(!this._sizeAttenuation){const h=this.worldMatrix.elements,f=Ye(h[0],h[3],h[1],h[4],h[2],h[5]);n/=Math.max(f.scaleX,f.scaleY)}const o=nt.pointsToString(this._renderer.collection,n);t.d=o}return this._fill&&this._fill._renderer&&(this._renderer.hasFillEffect=!0,this._fill._update(),nt[this._fill._renderer.type].render.call(this._fill,e,!0)),this._flagFill&&(t.fill=this._fill&&this._fill.id?"url(#"+this._fill.id+")":this._fill,this._renderer.hasFillEffect&&typeof this._fill.id>"u"&&(e.defs._flagUpdate=!0,delete this._renderer.hasFillEffect)),this._stroke&&this._stroke._renderer&&(this._renderer.hasStrokeEffect=!0,this._stroke._update(),nt[this._stroke._renderer.type].render.call(this._stroke,e,!0)),this._flagStroke&&(t.stroke=this._stroke&&this._stroke.id?"url(#"+this._stroke.id+")":this._stroke,this._renderer.hasStrokeEffect&&typeof this._stroke.id>"u"&&(e.defs._flagUpdate=!0,delete this._renderer.hasStrokeEffect)),this._flagLinewidth&&(t["stroke-width"]=this._linewidth),this._flagOpacity&&(t["stroke-opacity"]=this._opacity,t["fill-opacity"]=this._opacity),this._flagClassName&&(t.class=this.classList.join(" ")),this._flagVisible&&(t.visibility=this._visible?"visible":"hidden"),this.dashes&&this.dashes.length>0&&(t["stroke-dasharray"]=this.dashes.join(" "),t["stroke-dashoffset"]=this.dashes.offset||0),this._renderer.elem?nt.setAttributes(this._renderer.elem,t):(t.id=this._id,this._renderer.elem=nt.createElement("path",t),e.appendChild(this._renderer.elem)),this.flagReset()}},text:{render:function(e){this._update();const t={};if((this._matrix.manual||this._flagMatrix)&&(t.transform="matrix("+this._matrix.toString()+")"),this._flagId&&(t.id=this._id),this._flagFamily&&(t["font-family"]=this._family),this._flagSize&&(t["font-size"]=this._size),this._flagLeading&&(t["line-height"]=this._leading),this._flagAlignment&&(t["text-anchor"]=nt.alignments[this._alignment]||this._alignment),this._flagBaseline&&(t["dominant-baseline"]=nt.baselines[this._baseline]||this._baseline),this._flagStyle&&(t["font-style"]=this._style),this._flagWeight&&(t["font-weight"]=this._weight),this._flagDecoration&&(t["text-decoration"]=this._decoration),this._flagDirection&&(t.direction=this._direction),this._fill&&this._fill._renderer&&(this._renderer.hasFillEffect=!0,this._fill._update(),nt[this._fill._renderer.type].render.call(this._fill,e,!0)),this._flagFill&&(t.fill=this._fill&&this._fill.id?"url(#"+this._fill.id+")":this._fill,this._renderer.hasFillEffect&&typeof this._fill.id>"u"&&(e.defs._flagUpdate=!0,delete this._renderer.hasFillEffect)),this._stroke&&this._stroke._renderer&&(this._renderer.hasStrokeEffect=!0,this._stroke._update(),nt[this._stroke._renderer.type].render.call(this._stroke,e,!0)),this._flagStroke&&(t.stroke=this._stroke&&this._stroke.id?"url(#"+this._stroke.id+")":this._stroke,this._renderer.hasStrokeEffect&&typeof this._stroke.id>"u"&&(e.defs._flagUpdate=!0,delete this._renderer.hasStrokeEffect)),this._flagLinewidth&&(t["stroke-width"]=this._linewidth),this._flagOpacity&&(t.opacity=this._opacity),this._flagClassName&&(t.class=this.classList.join(" ")),this._flagVisible&&(t.visibility=this._visible?"visible":"hidden"),this.dashes&&this.dashes.length>0&&(t["stroke-dasharray"]=this.dashes.join(" "),t["stroke-dashoffset"]=this.dashes.offset||0),this._renderer.elem?nt.setAttributes(this._renderer.elem,t):(t.id=this._id,this._renderer.elem=nt.createElement("text",t),e.appendChild(this._renderer.elem)),this._flagClip){const n=nt.getClip(this,e),o=this._renderer.elem;this._clip?(o.removeAttribute("id"),n.setAttribute("id",this.id),n.appendChild(o)):(n.removeAttribute("id"),o.setAttribute("id",this.id),this.parent._renderer.elem.appendChild(o))}return this._flagMask&&(this._mask?(nt[this._mask._renderer.type].render.call(this._mask,e),this._renderer.elem.setAttribute("clip-path","url(#"+this._mask.id+")")):this._renderer.elem.removeAttribute("clip-path")),this._flagValue&&(this._renderer.elem.textContent=this._value),this.flagReset()}},"linear-gradient":{render:function(e,t){t||this._update();const r={};if(this._flagId&&(r.id=this._id),this._flagEndPoints&&(r.x1=this.left._x,r.y1=this.left._y,r.x2=this.right._x,r.y2=this.right._y),this._flagSpread&&(r.spreadMethod=this._spread),this._flagUnits&&(r.gradientUnits=this._units),this._renderer.elem?nt.setAttributes(this._renderer.elem,r):(r.id=this._id,this._renderer.elem=nt.createElement("linearGradient",r)),this._renderer.elem.parentNode===null&&e.defs.appendChild(this._renderer.elem),this._flagStops){const n=this._renderer.elem.childNodes.length!==this.stops.length;if(n)for(;this._renderer.elem.lastChild;)this._renderer.elem.removeChild(this._renderer.elem.lastChild);for(let o=0;o<this.stops.length;o++){const h=this.stops[o],f={};h._flagOffset&&(f.offset=100*h._offset+"%"),h._flagColor&&(f["stop-color"]=h._color),h._flagOpacity&&(f["stop-opacity"]=h._opacity),h._renderer.elem?nt.setAttributes(h._renderer.elem,f):h._renderer.elem=nt.createElement("stop",f),n&&this._renderer.elem.appendChild(h._renderer.elem),h.flagReset()}}return this.flagReset()}},"radial-gradient":{render:function(e,t){t||this._update();const r={};if(this._flagId&&(r.id=this._id),this._flagCenter&&(r.cx=this.center._x,r.cy=this.center._y),this._flagFocal&&(r.fx=this.focal._x,r.fy=this.focal._y),this._flagRadius&&(r.r=this._radius),this._flagSpread&&(r.spreadMethod=this._spread),this._flagUnits&&(r.gradientUnits=this._units),this._renderer.elem?nt.setAttributes(this._renderer.elem,r):(r.id=this._id,this._renderer.elem=nt.createElement("radialGradient",r)),this._renderer.elem.parentNode===null&&e.defs.appendChild(this._renderer.elem),this._flagStops){const n=this._renderer.elem.childNodes.length!==this.stops.length;if(n)for(;this._renderer.elem.lastChild;)this._renderer.elem.removeChild(this._renderer.elem.lastChild);for(let o=0;o<this.stops.length;o++){const h=this.stops[o],f={};h._flagOffset&&(f.offset=100*h._offset+"%"),h._flagColor&&(f["stop-color"]=h._color),h._flagOpacity&&(f["stop-opacity"]=h._opacity),h._renderer.elem?nt.setAttributes(h._renderer.elem,f):h._renderer.elem=nt.createElement("stop",f),n&&this._renderer.elem.appendChild(h._renderer.elem),h.flagReset()}}return this.flagReset()}},texture:{render:function(e,t){t||this._update();const r={},n={x:0,y:0},o=this.image;if(this._flagId&&(r.id=this._id),this._flagLoaded&&this.loaded)switch(o.nodeName.toLowerCase()){case"canvas":n.href=n["xlink:href"]=o.toDataURL("image/png");break;case"img":case"image":n.href=n["xlink:href"]=this.src;break}if((this._flagOffset||this._flagLoaded||this._flagScale)&&(r.x=this._offset.x,r.y=this._offset.y,o&&(r.x-=o.width/2,r.y-=o.height/2,this._scale instanceof z?(r.x*=this._scale.x,r.y*=this._scale.y):(r.x*=this._scale,r.y*=this._scale)),r.x>0&&(r.x*=-1),r.y>0&&(r.y*=-1)),(this._flagScale||this._flagLoaded||this._flagRepeat)&&(r.width=0,r.height=0,o)){switch(r.width=o.width,r.height=o.height,this._repeat){case"no-repeat":r.width+=1,r.height+=1;break}this._scale instanceof z?(r.width*=this._scale.x,r.height*=this._scale.y):(r.width*=this._scale,r.height*=this._scale),n.width=r.width,n.height=r.height}return(this._flagScale||this._flagLoaded)&&(this._renderer.image?nt.setAttributes(this._renderer.image,n):this._renderer.image=nt.createElement("image",n)),this._renderer.elem?Object.keys(r).length!==0&&nt.setAttributes(this._renderer.elem,r):(r.id=this._id,r.patternUnits="userSpaceOnUse",this._renderer.elem=nt.createElement("pattern",r)),this._renderer.elem.parentNode===null&&e.defs.appendChild(this._renderer.elem),this._renderer.elem&&this._renderer.image&&!this._renderer.appended&&(this._renderer.elem.appendChild(this._renderer.image),this._renderer.appended=!0),this.flagReset()}}},$r=class extends D{constructor(e){super(),this.domElement=e.domElement||nt.createElement("svg"),this.scene=new At,this.scene.parent=this,this.defs=nt.createElement("defs"),this.defs._flagUpdate=!1,this.domElement.appendChild(this.defs),this.domElement.defs=this.defs,this.domElement.style.overflow="hidden"}setSize(e,t){return this.width=e,this.height=t,nt.setAttributes(this.domElement,{width:e,height:t}),this.trigger(D.Types.resize,e,t)}render(){return nt.group.render.call(this.scene,this.domElement),nt.defs.update(this.domElement),this}};g($r,"Utils",nt);var te={create:function(e,t,r){const n=e.createShader(e[r]);if(e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS)){const h=e.getShaderInfoLog(n);throw e.deleteShader(n),new Kt("unable to compile shader "+n+": "+h)}return n},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},path:{vertex:`
      precision mediump float;
      attribute vec2 a_position;

      uniform mat3 u_matrix;
      uniform vec2 u_resolution;
      uniform vec4 u_rect;

      varying vec2 v_textureCoords;

      void main() {
        vec2 rectCoords = (a_position * (u_rect.zw - u_rect.xy)) + u_rect.xy;
        vec2 projected = (u_matrix * vec3(rectCoords, 1.0)).xy;
        vec2 normal = projected / u_resolution;
        vec2 clipspace = (normal * 2.0) - 1.0;

        gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);
        v_textureCoords = a_position;
      }
    `,fragment:`
      precision mediump float;

      uniform sampler2D u_image;
      varying vec2 v_textureCoords;

      void main() {
        vec4 texel = texture2D(u_image, v_textureCoords);
        if (texel.a == 0.0) {
          discard;
        }
        gl_FragColor = texel;
      }
    `},points:{vertex:`
      precision mediump float;
      attribute vec2 a_position;

      uniform float u_size;
      uniform mat3 u_matrix;
      uniform vec2 u_resolution;

      varying vec2 v_textureCoords;

      void main() {
        vec2 projected = (u_matrix * vec3(a_position, 1.0)).xy;
        vec2 normal = projected / u_resolution;
        vec2 clipspace = (normal * 2.0) - 1.0;

        gl_PointSize = u_size;
        gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);
        v_textureCoords = a_position;
      }
    `,fragment:`
      precision mediump float;

      uniform sampler2D u_image;

      void main() {
        vec4 texel = texture2D(u_image, gl_PointCoord);
        if (texel.a == 0.0) {
          discard;
        }
        gl_FragColor = texel;
      }
    `}},hi=Ee.Multiply,Eo=[1,0,0,0,1,0,0,0,1],_e=new de(9),So=We.Utils,lr=new z,is=new de([0,0,1,0,0,1,0,1,1,0,1,1]),ot={precision:.9,isHidden:/(undefined|none|transparent)/i,canvas:Ct.document?Ct.document.createElement("canvas"):{getContext:function(){}},alignments:{left:"start",middle:"center",right:"end"},matrix:new Ee,group:{removeChild:function(e,t){if(e.children)for(let r=0;r<e.children.length;r++)ot.group.removeChild(e.children[r],t);e._renderer.texture&&(t.deleteTexture(e._renderer.texture),delete e._renderer.texture),e._renderer.positionBuffer&&(t.deleteBuffer(e._renderer.positionBuffer),delete e._renderer.positionBuffer)},render:function(e,t){if(!this._visible)return;this._update();const r=this.parent,n=r._matrix&&r._matrix.manual||r._flagMatrix,o=this._matrix.manual||this._flagMatrix;(n||o)&&(this._renderer.matrix||(this._renderer.matrix=new de(9)),this._matrix.toTransformArray(!0,_e),hi(_e,r._renderer.matrix,this._renderer.matrix),this._renderer.scale instanceof z||(this._renderer.scale=new z),this._scale instanceof z?(this._renderer.scale.x=this._scale.x,this._renderer.scale.y=this._scale.y):(this._renderer.scale.x=this._scale,this._renderer.scale.y=this._scale),/renderer/i.test(r._renderer.type)||(this._renderer.scale.x*=r._renderer.scale.x,this._renderer.scale.y*=r._renderer.scale.y),n&&(this._flagMatrix=!0)),this._mask&&(e.clear(e.STENCIL_BUFFER_BIT),e.enable(e.STENCIL_TEST),e.stencilFunc(e.ALWAYS,1,0),e.stencilOp(e.KEEP,e.KEEP,e.REPLACE),e.colorMask(!1,!1,!1,!1),ot[this._mask._renderer.type].render.call(this._mask,e,t,this),e.stencilFunc(e.EQUAL,1,255),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.colorMask(!0,!0,!0,!0)),this._flagOpacity=r._flagOpacity||this._flagOpacity,this._renderer.opacity=this._opacity*(r&&r._renderer?r._renderer.opacity:1);let h;if(this._flagSubtractions)for(h=0;h<this.subtractions.length;h++)ot.group.removeChild(this.subtractions[h],e);for(h=0;h<this.children.length;h++){const f=this.children[h];ot[f._renderer.type].render.call(f,e,t)}return this._mask&&e.disable(e.STENCIL_TEST),this.flagReset()}},path:{updateCanvas:function(e,t){let r,n,o,h,f,u,d,_,y,P,w,v,C,k;const L=t._renderer.vertices,O=this.canvas,E=this.ctx,N=e.renderer.ratio,W=lr.copy(t._renderer.scale).multiply(N),F=t._stroke,Z=t._linewidth,G=t._fill,st=t._renderer.opacity||t._opacity,et=t._cap,Q=t._join,ht=t._miter,at=t._closed,T=t.dashes,V=L.length,R=V-1;O.width=Math.max(Math.ceil(t._renderer.rect.width*W.x),1),O.height=Math.max(Math.ceil(t._renderer.rect.height*W.y),1);const X=t._renderer.rect.centroid,Y=X.x,K=X.y;E.clearRect(0,0,O.width,O.height),G&&(typeof G=="string"?E.fillStyle=G:(ot[G._renderer.type].render.call(G,E,t),E.fillStyle=G._renderer.effect)),F&&(typeof F=="string"?E.strokeStyle=F:(ot[F._renderer.type].render.call(F,E,t),E.strokeStyle=F._renderer.effect),Z&&(E.lineWidth=Z),ht&&(E.miterLimit=ht),Q&&(E.lineJoin=Q),!at&&et&&(E.lineCap=et)),typeof st=="number"&&(E.globalAlpha=st),T&&T.length>0&&(E.lineDashOffset=T.offset||0,E.setLineDash(T));let tt,it,lt,ft,Xt,Pe,be,we;E.save(),E.scale(W.x,W.y),E.translate(Y,K),E.beginPath();for(let zt=0;zt<L.length;zt++){const xt=L[zt];switch(v=xt.x,C=xt.y,xt.command){case q.close:E.closePath();break;case q.arc:it=xt.rx,lt=xt.ry,ft=xt.xAxisRotation,Xt=xt.largeArcFlag,Pe=xt.sweepFlag,r=at?$t(zt-1,V):Math.max(zt-1,0),n=L[r],be=n.x,we=n.y,So.renderSvgArcCommand(E,be,we,it,lt,Xt,Pe,ft,v,C);break;case q.curve:r=at?$t(zt-1,V):Math.max(zt-1,0),n=L[r],_=n.controls&&n.controls.right||z.zero,y=xt.controls&&xt.controls.left||z.zero,n._relative?(u=_.x+n.x,d=_.y+n.y):(u=_.x,d=_.y),xt._relative?(h=y.x+xt.x,f=y.y+xt.y):(h=y.x,f=y.y),E.bezierCurveTo(u,d,h,f,v,C),zt>=R&&at&&(o=tt,P=xt.controls&&xt.controls.right||z.zero,w=o.controls&&o.controls.left||z.zero,xt._relative?(u=P.x+xt.x,d=P.y+xt.y):(u=P.x,d=P.y),o._relative?(h=w.x+o.x,f=w.y+o.y):(h=w.x,f=w.y),v=o.x,C=o.y,E.bezierCurveTo(u,d,h,f,v,C));break;case q.line:E.lineTo(v,C);break;case q.move:tt=xt,E.moveTo(v,C);break}}at&&E.closePath(),ot.isHidden.test(G)||(k=G._renderer&&G._renderer.offset,k&&(E.save(),E.translate(-G._renderer.offset.x,-G._renderer.offset.y),E.scale(G._renderer.scale.x,G._renderer.scale.y)),E.fill(),k&&E.restore()),ot.isHidden.test(F)||(k=F._renderer&&F._renderer.offset,k&&(E.save(),E.translate(-F._renderer.offset.x,-F._renderer.offset.y),E.scale(F._renderer.scale.x,F._renderer.scale.y),E.lineWidth=Z/F._renderer.scale.x),E.stroke(),k&&E.restore()),E.restore()},getBoundingClientRect:function(e,t,r){let n=1/0,o=-1/0,h=1/0,f=-1/0,u,d;e.forEach(function(_){const y=_.x,P=_.y,w=_.controls;let v,C,k,L,O,E;h=Math.min(P,h),n=Math.min(y,n),o=Math.max(y,o),f=Math.max(P,f),_.controls&&(O=w.left,E=w.right,!(!O||!E)&&(v=_._relative?O.x+y:O.x,C=_._relative?O.y+P:O.y,k=_._relative?E.x+y:E.x,L=_._relative?E.y+P:E.y,!(!v||!C||!k||!L)&&(h=Math.min(C,L,h),n=Math.min(v,k,n),o=Math.max(v,k,o),f=Math.max(C,L,f))))}),typeof t=="number"&&(h-=t,n-=t,o+=t,f+=t),u=o-n,d=f-h,r.top=h,r.left=n,r.right=o,r.bottom=f,r.width=u,r.height=d,r.centroid||(r.centroid={}),r.centroid.x=-n,r.centroid.y=-h},render:function(e,t,r){if(!this._visible||!this._opacity)return this;this._update();const n=r||this.parent,o=t[this._renderer.type],h=n._matrix.manual||n._flagMatrix,f=this._matrix.manual||this._flagMatrix,u=this._renderer.parent!==n,d=this._flagVertices||this._flagFill||this._fill instanceof wt&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagEndPoints)||this._fill instanceof It&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagRadius||this._fill._flagCenter||this._fill._flagFocal)||this._fill instanceof yt&&(this._fill._flagLoaded&&this._fill.loaded||this._fill._flagImage||this._fill._flagVideo||this._fill._flagRepeat||this._fill._flagOffset||this._fill._flagScale)||this._stroke instanceof wt&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagEndPoints)||this._stroke instanceof It&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagRadius||this._stroke._flagCenter||this._stroke._flagFocal)||this._stroke instanceof yt&&(this._stroke._flagLoaded&&this._stroke.loaded||this._stroke._flagImage||this._stroke._flagVideo||this._stroke._flagRepeat||this._stroke._flagOffset||this._fill._flagScale)||this._flagStroke||this._flagLinewidth||this._flagOpacity||n._flagOpacity||this._flagVisible||this._flagCap||this._flagJoin||this._flagMiter||this._flagScale||this.dashes&&this.dashes.length>0||!this._renderer.texture;if((h||f||u)&&(this._renderer.matrix||(this._renderer.matrix=new de(9)),this._matrix.toTransformArray(!0,_e),hi(_e,n._renderer.matrix,this._renderer.matrix),this._renderer.scale instanceof z||(this._renderer.scale=new z),this._scale instanceof z?(this._renderer.scale.x=this._scale.x*n._renderer.scale.x,this._renderer.scale.y=this._scale.y*n._renderer.scale.y):(this._renderer.scale.x=this._scale*n._renderer.scale.x,this._renderer.scale.y=this._scale*n._renderer.scale.y),u&&(this._renderer.parent=n)),this._mask&&(e.clear(e.STENCIL_BUFFER_BIT),e.enable(e.STENCIL_TEST),e.stencilFunc(e.ALWAYS,1,0),e.stencilOp(e.KEEP,e.KEEP,e.REPLACE),e.colorMask(!1,!1,!1,!1),ot[this._mask._renderer.type].render.call(this._mask,e,t,this),e.stencilFunc(e.EQUAL,1,255),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.colorMask(!0,!0,!0,!0)),d?(this._renderer.rect||(this._renderer.rect={}),this._renderer.opacity=this._opacity*n._renderer.opacity,ot.path.getBoundingClientRect(this._renderer.vertices,this._linewidth,this._renderer.rect),ot.updateTexture.call(ot,e,this)):(this._fill&&this._fill._update&&this._fill._update(),this._stroke&&this._stroke._update&&this._stroke._update()),this._clip&&!r||!this._renderer.texture)return this;t.current!==o&&(e.useProgram(o),e.bindBuffer(e.ARRAY_BUFFER,t.buffers.position),e.vertexAttribPointer(o.position,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(o.position),e.bufferData(e.ARRAY_BUFFER,is,e.STATIC_DRAW),t.resolution.flagged||e.uniform2f(e.getUniformLocation(o,"u_resolution"),t.resolution.width,t.resolution.height),t.current=o),t.resolution.flagged&&e.uniform2f(e.getUniformLocation(o,"u_resolution"),t.resolution.width,t.resolution.height),e.bindTexture(e.TEXTURE_2D,this._renderer.texture);const _=this._renderer.rect;return e.uniformMatrix3fv(o.matrix,!1,this._renderer.matrix),e.uniform4f(o.rect,_.left,_.top,_.right,_.bottom),e.drawArrays(e.TRIANGLES,0,6),this._mask&&e.disable(e.STENCIL_TEST),this.flagReset()}},points:{updateCanvas:function(e,t){let r;const n=this.canvas,o=this.ctx,h=e.renderer.ratio,f=t._stroke,u=t._linewidth,d=t._fill,_=t._renderer.opacity||t._opacity,y=t.dashes,P=t._size*h;let w=P;ot.isHidden.test(f)||(w+=u),n.width=Or(w),n.height=n.width;const v=w/n.width,C=n.width/2,k=n.height/2;o.clearRect(0,0,n.width,n.height),d&&(typeof d=="string"?o.fillStyle=d:(ot[d._renderer.type].render.call(d,o,t),o.fillStyle=d._renderer.effect)),f&&(typeof f=="string"?o.strokeStyle=f:(ot[f._renderer.type].render.call(f,o,t),o.strokeStyle=f._renderer.effect),u&&(o.lineWidth=u/v)),typeof _=="number"&&(o.globalAlpha=_),y&&y.length>0&&(o.lineDashOffset=y.offset||0,o.setLineDash(y)),o.save(),o.translate(C,k),o.scale(ot.precision,ot.precision),o.beginPath(),o.arc(0,0,P/v*.5,0,Yt),o.restore(),closed&&o.closePath(),ot.isHidden.test(d)||(r=d._renderer&&d._renderer.offset,r&&(o.save(),o.translate(-d._renderer.offset.x,-d._renderer.offset.y),o.scale(d._renderer.scale.x,d._renderer.scale.y)),o.fill(),r&&o.restore()),ot.isHidden.test(f)||(r=f._renderer&&f._renderer.offset,r&&(o.save(),o.translate(-f._renderer.offset.x,-f._renderer.offset.y),o.scale(f._renderer.scale.x,f._renderer.scale.y),o.lineWidth=u/f._renderer.scale.x),o.stroke(),r&&o.restore())},render:function(e,t,r){if(!this._visible||!this._opacity)return this;this._update();let n=this._size;const o=r||this.parent,h=t[this._renderer.type],f=this._sizeAttenuation,u=this._stroke,d=this._linewidth,_=o._matrix.manual||o._flagMatrix,y=this._matrix.manual||this._flagMatrix,P=this._renderer.parent!==o,w=this._renderer.vertices,v=this._renderer.collection.length,C=this._flagVertices,k=this._flagFill||this._fill instanceof wt&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagEndPoints)||this._fill instanceof It&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagRadius||this._fill._flagCenter||this._fill._flagFocal)||this._fill instanceof yt&&(this._fill._flagLoaded&&this._fill.loaded||this._fill._flagImage||this._fill._flagVideo||this._fill._flagRepeat||this._fill._flagOffset||this._fill._flagScale)||this._stroke instanceof wt&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagEndPoints)||this._stroke instanceof It&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagRadius||this._stroke._flagCenter||this._stroke._flagFocal)||this._stroke instanceof yt&&(this._stroke._flagLoaded&&this._stroke.loaded||this._stroke._flagImage||this._stroke._flagVideo||this._stroke._flagRepeat||this._stroke._flagOffset||this._fill._flagScale)||this._flagStroke||this._flagLinewidth||this._flagOpacity||o._flagOpacity||this._flagVisible||this._flagScale||this.dashes&&this.dashes.length>0||!this._renderer.texture;if((_||y||P)&&(this._renderer.matrix||(this._renderer.matrix=new de(9)),this._matrix.toTransformArray(!0,_e),hi(_e,o._renderer.matrix,this._renderer.matrix),this._renderer.scale instanceof z||(this._renderer.scale=new z),this._scale instanceof z?(this._renderer.scale.x=this._scale.x*o._renderer.scale.x,this._renderer.scale.y=this._scale.y*o._renderer.scale.y):(this._renderer.scale.x=this._scale*o._renderer.scale.x,this._renderer.scale.y=this._scale*o._renderer.scale.y),P&&(this._renderer.parent=o)),C){const L=this._renderer.positionBuffer;L&&e.deleteBuffer(L),this._renderer.positionBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this._renderer.positionBuffer),e.vertexAttribPointer(h.position,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(h.position),e.bufferData(e.ARRAY_BUFFER,w,e.STATIC_DRAW)}return k?(this._renderer.opacity=this._opacity*o._renderer.opacity,ot.updateTexture.call(ot,e,this)):(this._fill&&this._fill._update&&this._fill._update(),this._stroke&&this._stroke._update&&this._stroke._update()),this._clip&&!r||!this._renderer.texture?this:(ot.isHidden.test(u)||(n+=d),n/=ot.precision,f&&(n*=Math.max(this._renderer.scale.x,this._renderer.scale.y)),t.current!==h&&(e.useProgram(h),t.resolution.flagged||e.uniform2f(e.getUniformLocation(h,"u_resolution"),t.resolution.width,t.resolution.height),t.current=h),t.resolution.flagged&&e.uniform2f(e.getUniformLocation(h,"u_resolution"),t.resolution.width,t.resolution.height),e.bindTexture(e.TEXTURE_2D,this._renderer.texture),e.uniformMatrix3fv(h.matrix,!1,this._renderer.matrix),e.uniform1f(h.size,n*t.resolution.ratio),e.drawArrays(e.POINTS,0,v),this.flagReset())}},text:{updateCanvas:function(e,t){const r=this.canvas,n=this.ctx,o=e.renderer.ratio,h=lr.copy(t._renderer.scale).multiply(o),f=t._stroke,u=t._linewidth,d=t._fill,_=t._renderer.opacity||t._opacity,y=t.dashes,P=t._decoration,w=t._direction;r.width=Math.max(Math.ceil(t._renderer.rect.width*h.x),1),r.height=Math.max(Math.ceil(t._renderer.rect.height*h.y),1);const v=t._renderer.rect.centroid,C=v.x,k=v.y;let L,O,E,N,W,F,Z,G,st,et,Q;const ht=d._renderer&&d._renderer.offset&&f._renderer&&f._renderer.offset;if(n.clearRect(0,0,r.width,r.height),ht||(n.font=[t._style,t._weight,t._size+"px/"+t._leading+"px",t._family].join(" ")),n.textAlign="center",n.textBaseline="middle",n.textDirection=w,d&&(typeof d=="string"?n.fillStyle=d:(ot[d._renderer.type].render.call(d,n,t),n.fillStyle=d._renderer.effect)),f&&(typeof f=="string"?n.strokeStyle=f:(ot[f._renderer.type].render.call(f,n,t),n.strokeStyle=f._renderer.effect),u&&(n.lineWidth=u)),typeof _=="number"&&(n.globalAlpha=_),y&&y.length>0&&(n.lineDashOffset=y.offset||0,n.setLineDash(y)),n.save(),n.scale(h.x,h.y),n.translate(C,k),ot.isHidden.test(d)||(d._renderer&&d._renderer.offset?(F=d._renderer.scale.x,Z=d._renderer.scale.y,n.save(),n.translate(-d._renderer.offset.x,-d._renderer.offset.y),n.scale(F,Z),L=t._size/d._renderer.scale.y,O=t._leading/d._renderer.scale.y,n.font=[t._style,t._weight,L+"px/",O+"px",t._family].join(" "),E=d._renderer.offset.x/d._renderer.scale.x,N=d._renderer.offset.y/d._renderer.scale.y,n.fillText(t.value,E,N),n.restore()):n.fillText(t.value,0,0)),ot.isHidden.test(f)||(f._renderer&&f._renderer.offset?(F=f._renderer.scale.x,Z=f._renderer.scale.y,n.save(),n.translate(-f._renderer.offset.x,-f._renderer.offset.y),n.scale(F,Z),L=t._size/f._renderer.scale.y,O=t._leading/f._renderer.scale.y,n.font=[t._style,t._weight,L+"px/",O+"px",t._family].join(" "),E=f._renderer.offset.x/f._renderer.scale.x,N=f._renderer.offset.y/f._renderer.scale.y,W=u/f._renderer.scale.x,n.lineWidth=W,n.strokeText(t.value,E,N),n.restore()):n.strokeText(t.value,0,0)),/(underline|strikethrough)/i.test(P)){const at=n.measureText(t.value);switch(P){case"underline":st=at.actualBoundingBoxDescent,Q=at.actualBoundingBoxDescent;break;case"strikethrough":st=0,Q=0;break}G=-at.width/2,et=at.width/2,n.lineWidth=Math.max(Math.floor(t._size/15),1),n.strokeStyle=n.fillStyle,n.beginPath(),n.moveTo(G,st),n.lineTo(et,Q),n.stroke()}n.restore()},getBoundingClientRect:function(e,t){const r=ot.ctx;r.font=[e._style,e._weight,e._size+"px/"+e._leading+"px",e._family].join(" "),r.textAlign="center",r.textBaseline=We.Utils.baselines[e._baseline]||e._baseline;const n=r.measureText(e._value);let o=n.width,h=1.15*(n.actualBoundingBoxAscent+n.actualBoundingBoxDescent);this._linewidth&&!ot.isHidden.test(this._stroke)&&(o+=this._linewidth*2,h+=this._linewidth*2);const f=o/2,u=h/2;switch(ot.alignments[e._alignment]||e._alignment){case ot.alignments.left:e.direction==="ltr"?(t.left=0,t.right=o):(t.left=-o,t.right=0);break;case ot.alignments.right:e.direction==="ltr"?(t.left=-o,t.right=0):(t.left=0,t.right=o);break;default:t.left=-f,t.right=f}switch(e._baseline){case"bottom":t.top=-h,t.bottom=0;break;case"top":t.top=0,t.bottom=h;break;case"baseline":t.top=-u*1.5,t.bottom=u*.5;break;default:t.top=-u,t.bottom=u}t.width=o,t.height=h,t.centroid||(t.centroid={}),t.centroid.x=f,t.centroid.y=u},render:function(e,t,r){if(!this._visible||!this._opacity)return this;this._update();const n=r||this.parent,o=t[this._renderer.type],h=n._matrix.manual||n._flagMatrix,f=this._matrix.manual||this._flagMatrix,u=this._renderer.parent!==n,d=this._flagVertices||this._flagFill||this._fill instanceof wt&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagEndPoints)||this._fill instanceof It&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagRadius||this._fill._flagCenter||this._fill._flagFocal)||this._fill instanceof yt&&(this._fill._flagLoaded&&this._fill.loaded||this._fill._flagImage||this._fill._flagVideo||this._fill._flagRepeat||this._fill._flagOffset||this._fill._flagScale)||this._stroke instanceof wt&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagEndPoints)||this._stroke instanceof It&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagRadius||this._stroke._flagCenter||this._stroke._flagFocal)||this._stroke instanceof yt&&(this._stroke._flagLoaded&&this._stroke.loaded||this._stroke._flagImage||this._stroke._flagVideo||this._stroke._flagRepeat||this._stroke._flagOffset||this._fill._flagScale)||this._flagStroke||this._flagLinewidth||this._flagOpacity||n._flagOpacity||this._flagVisible||this._flagScale||this._flagValue||this._flagFamily||this._flagSize||this._flagLeading||this._flagAlignment||this._flagBaseline||this._flagStyle||this._flagWeight||this._flagDecoration||this.dashes&&this.dashes.length>0||!this._renderer.texture;if((h||f||u)&&(this._renderer.matrix||(this._renderer.matrix=new de(9)),this._matrix.toTransformArray(!0,_e),hi(_e,n._renderer.matrix,this._renderer.matrix),this._renderer.scale instanceof z||(this._renderer.scale=new z),this._scale instanceof z?(this._renderer.scale.x=this._scale.x*n._renderer.scale.x,this._renderer.scale.y=this._scale.y*n._renderer.scale.y):(this._renderer.scale.x=this._scale*n._renderer.scale.x,this._renderer.scale.y=this._scale*n._renderer.scale.y),u&&(this._renderer.parent=n)),this._mask&&(e.clear(e.STENCIL_BUFFER_BIT),e.enable(e.STENCIL_TEST),e.stencilFunc(e.ALWAYS,1,0),e.stencilOp(e.KEEP,e.KEEP,e.REPLACE),e.colorMask(!1,!1,!1,!1),ot[this._mask._renderer.type].render.call(this._mask,e,t,this),e.stencilFunc(e.EQUAL,1,255),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.colorMask(!0,!0,!0,!0)),d?(this._renderer.rect||(this._renderer.rect={}),this._renderer.opacity=this._opacity*n._renderer.opacity,ot.text.getBoundingClientRect(this,this._renderer.rect),ot.updateTexture.call(ot,e,this)):(this._fill&&this._fill._update&&this._fill._update(),this._stroke&&this._stroke._update&&this._stroke._update()),this._clip&&!r||!this._renderer.texture)return this;t.current!==o&&(e.useProgram(o),e.bindBuffer(e.ARRAY_BUFFER,t.buffers.position),e.vertexAttribPointer(o.position,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(o.position),e.bufferData(e.ARRAY_BUFFER,is,e.STATIC_DRAW),t.resolution.flagged||e.uniform2f(e.getUniformLocation(o,"u_resolution"),t.resolution.width,t.resolution.height),t.current=o),t.resolution.flagged&&e.uniform2f(e.getUniformLocation(o,"u_resolution"),t.resolution.width,t.resolution.height),e.bindTexture(e.TEXTURE_2D,this._renderer.texture);const _=this._renderer.rect;return e.uniformMatrix3fv(o.matrix,!1,this._renderer.matrix),e.uniform4f(o.rect,_.left,_.top,_.right,_.bottom),e.drawArrays(e.TRIANGLES,0,6),this._mask&&e.disable(e.STENCIL_TEST),this.flagReset()}},"linear-gradient":{render:function(e,t){if(!(!e.canvas.getContext("2d")||!t)){if(this._update(),!this._renderer.effect||this._flagEndPoints||this._flagStops||this._flagUnits){let r,n=this.left._x,o=this.left._y,h=this.right._x,f=this.right._y;/objectBoundingBox/i.test(this._units)&&(r=t.getBoundingClientRect(!0),n=(n-.5)*r.width,o=(o-.5)*r.height,h=(h-.5)*r.width,f=(f-.5)*r.height),this._renderer.effect=e.createLinearGradient(n,o,h,f);for(let u=0;u<this.stops.length;u++){const d=this.stops[u];this._renderer.effect.addColorStop(d._offset,d._color)}}return this.flagReset()}}},"radial-gradient":{render:function(e,t){if(!(!e.canvas.getContext("2d")||!t)){if(this._update(),!this._renderer.effect||this._flagCenter||this._flagFocal||this._flagRadius||this._flagStops||this._flagUnits){let r,n=this.center._x,o=this.center._y,h=this.focal._x,f=this.focal._y,u=this._radius;/objectBoundingBox/i.test(this._units)&&(r=t.getBoundingClientRect(!0),n=(n-.5)*r.width*.5,o=(o-.5)*r.height*.5,h=(h-.5)*r.width*.5,f=(f-.5)*r.height*.5,u*=Math.min(r.width,r.height)),this._renderer.effect=e.createRadialGradient(n,o,0,h,f,u);for(let d=0;d<this.stops.length;d++){const _=this.stops[d];this._renderer.effect.addColorStop(_._offset,_._color)}}return this.flagReset()}}},texture:{render:function(e,t){if(!e.canvas.getContext("2d"))return;this._update();const r=this.image;if((this._flagLoaded||this._flagImage||this._flagVideo||this._flagRepeat)&&this.loaded)this._renderer.effect=e.createPattern(r,this._repeat);else if(!this._renderer.effect)return this.flagReset();return(this._flagOffset||this._flagLoaded||this._flagScale)&&(this._renderer.offset instanceof z||(this._renderer.offset=new z),this._renderer.offset.x=-this._offset.x,this._renderer.offset.y=-this._offset.y,r&&(this._renderer.offset.x+=r.width/2,this._renderer.offset.y+=r.height/2,this._scale instanceof z?(this._renderer.offset.x*=this._scale.x,this._renderer.offset.y*=this._scale.y):(this._renderer.offset.x*=this._scale,this._renderer.offset.y*=this._scale))),(this._flagScale||this._flagLoaded)&&(this._renderer.scale instanceof z||(this._renderer.scale=new z),this._scale instanceof z?this._renderer.scale.copy(this._scale):this._renderer.scale.set(this._scale,this._scale)),this.flagReset()}},updateTexture:function(e,t){if(this[t._renderer.type].updateCanvas.call(ot,e,t),this.canvas.width<=0||this.canvas.height<=0){t._renderer.texture&&e.deleteTexture(t._renderer.texture),delete t._renderer.texture;return}t._renderer.texture||(t._renderer.texture=e.createTexture()),e.bindTexture(e.TEXTURE_2D,t._renderer.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this.canvas),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR)},program:{create:function(e,t){let r,n,o;if(r=e.createProgram(),$.each(t,function(h){e.attachShader(r,h)}),e.linkProgram(r),n=e.getProgramParameter(r,e.LINK_STATUS),!n)throw o=e.getProgramInfoLog(r),e.deleteProgram(r),new Kt("unable to link program: "+o);return r}},extensions:{init:function(e){const t={},r=["EXT_texture_filter_anisotropic","WEBGL_compressed_texture_s3tc","OES_texture_float_linear","WEBGL_multisampled_render_to_texture"];for(let n=0;n<r.length;n++){const o=r[n];t[o]=ot.extensions.get(e,o)}return t},get:function(e,t){return e.getExtension(t)||e.getExtension(`MOZ_${t}`)||e.getExtension(`WEBKIT_${t}`)}},TextureRegistry:new Ai};ot.ctx=ot.canvas.getContext("2d");var Qr=class extends D{constructor(e){super();let t,r,n,o;if(this.domElement=e.domElement||document.createElement("canvas"),typeof e.offscreenElement<"u"&&(ot.canvas=e.offscreenElement,ot.ctx=ot.canvas.getContext("2d")),this.scene=new At,this.scene.parent=this,this._renderer={type:"renderer",matrix:new de(Eo),scale:1,opacity:1},this._flagMatrix=!0,e=$.defaults(e||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,preserveDrawingBuffer:!0,overdraw:!1}),this.overdraw=e.overdraw,t=this.ctx=this.domElement.getContext("webgl",e)||this.domElement.getContext("experimental-webgl",e),!this.ctx)throw new Kt("unable to create a webgl context. Try using another renderer.");n=te.create(t,te.path.vertex,te.types.vertex),o=te.create(t,te.path.fragment,te.types.fragment),this.programs={current:null,buffers:{position:t.createBuffer()},resolution:{width:0,height:0,ratio:1,flagged:!1}},r=this.programs.path=ot.program.create(t,[n,o]),this.programs.text=this.programs.path,t.extensions=ot.extensions.init(t),t.renderer=this,r.position=t.getAttribLocation(r,"a_position"),r.matrix=t.getUniformLocation(r,"u_matrix"),r.rect=t.getUniformLocation(r,"u_rect");const h=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,h),t.vertexAttribPointer(r.position,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(r.position),t.bufferData(t.ARRAY_BUFFER,is,t.STATIC_DRAW),n=te.create(t,te.points.vertex,te.types.vertex),o=te.create(t,te.points.fragment,te.types.fragment),r=this.programs.points=ot.program.create(t,[n,o]),r.position=t.getAttribLocation(r,"a_position"),r.matrix=t.getUniformLocation(r,"u_matrix"),r.size=t.getUniformLocation(r,"u_size"),t.enable(t.BLEND),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA)}setSize(e,t,r){let n,o;const h=this.ctx;return this.width=e,this.height=t,this.ratio=typeof r>"u"?us(h):r,this.domElement.width=e*this.ratio,this.domElement.height=t*this.ratio,$.isObject(this.domElement.style)&&$.extend(this.domElement.style,{width:e+"px",height:t+"px"}),this._renderer.matrix[0]=this._renderer.matrix[4]=this._renderer.scale=this.ratio,this._flagMatrix=!0,n=e*this.ratio,o=t*this.ratio,h.viewport(0,0,n,o),this.programs.resolution.width=n,this.programs.resolution.height=o,this.programs.resolution.ratio=this.ratio,this.programs.resolution.flagged=!0,this.trigger(D.Types.resize,e,t,r)}render(){const e=this.ctx;return this.overdraw||e.clear(e.COLOR_BUFFER_BIT),ot.group.render.call(this.scene,e,this.programs),this._flagMatrix=!1,this.programs.resolution.flagged=!0,this}};g(Qr,"Utils",ot);var Ao=$.extend({Error:Kt,getRatio:us,read:bt,xhr:Kr},$,Jt,kr,Er),Ge=class{constructor(e){g(this,"_events",new D),g(this,"type",""),g(this,"renderer",null),g(this,"scene",null),g(this,"width",0),g(this,"height",0),g(this,"frameCount",0),g(this,"timeDelta",0),g(this,"playing",!1);const t=$.defaults(e||{},{fullscreen:!1,fitted:!1,width:640,height:480,type:Ge.Types.svg,autostart:!1});if($.each(t,function(r,n){/fullscreen/i.test(n)||/autostart/i.test(n)||(this[n]=r)},this),$.isElement(t.domElement)){const r=t.domElement.tagName.toLowerCase();/^(CanvasRenderer-canvas|WebGLRenderer-canvas|SVGRenderer-svg)$/.test(this.type+"-"+r)||(this.type=Ge.Types[r])}this.renderer=new Ge[this.type](this),this.setPlaying(t.autostart),this.frameCount=0,t.fullscreen?(this.fit=Lo.bind(this),this.fit.domElement=window,this.fit.attached=!0,$.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),$.extend(this.renderer.domElement.style,{display:"block",top:0,left:0,right:0,bottom:0,position:"fixed"}),Zt.bind(this.fit.domElement,"resize",this.fit),this.fit()):t.fitted?(this.fit=Oo.bind(this),$.extend(this.renderer.domElement.style,{display:"block"})):$.isElement(t.domElement)||(this.renderer.setSize(t.width,t.height,this.ratio),this.width=t.width,this.height=t.height),this.renderer.bind(D.Types.resize,ko.bind(this)),this.scene=this.renderer.scene,Ge.Instances.push(this),t.autostart&&$e.init()}get _bound(){return this._events._bound}set _bound(e){this._events._bound=e}addEventListener(){return this._events.addEventListener.apply(this,arguments)}on(){return this._events.addEventListener.apply(this,arguments)}bind(){return this._events.addEventListener.apply(this,arguments)}removeEventListener(){return this._events.removeEventListener.apply(this,arguments)}off(){return this._events.removeEventListener.apply(this,arguments)}unbind(){return this._events.removeEventListener.apply(this,arguments)}dispatchEvent(){return this._events.dispatchEvent.apply(this,arguments)}trigger(){return this._events.dispatchEvent.apply(this,arguments)}listen(){return this._events.listen.apply(this,arguments)}ignore(){return this._events.ignore.apply(this,arguments)}appendTo(e){return e.appendChild(this.renderer.domElement),this.fit&&(this.fit.domElement!==window&&(this.fit.domElement=e,this.fit.attached=!1),this.update()),this}play(){return this.playing=!0,$e.init(),this.trigger(D.Types.play)}pause(){return this.playing=!1,this.trigger(D.Types.pause)}setPlaying(e){this.playing=e}release(e){let t,r,n;if(!$.isObject(e))return this.release(this.scene);if(typeof e.unbind=="function"&&e.unbind(),e.vertices)for(typeof e.vertices.unbind=="function"&&e.vertices.unbind(),t=0;t<e.vertices.length;t++)r=e.vertices[t],typeof r.unbind=="function"&&r.unbind(),r.controls&&(r.controls.left&&typeof r.controls.left.unbind=="function"&&r.controls.left.unbind(),r.controls.right&&typeof r.controls.right.unbind=="function"&&r.controls.right.unbind());if(e.children){for(t=0;t<e.children.length;t++)n=e.children[t],this.release(n);typeof e.children.unbind=="function"&&e.children.unbind()}return e}update(){const e=!!this._lastFrame,t=$.performance.now();e&&(this.timeDelta=parseFloat((t-this._lastFrame).toFixed(3))),this._lastFrame=t,this.fit&&this.fit.domElement&&!this.fit.attached&&(Zt.bind(this.fit.domElement,"resize",this.fit),this.fit.attached=!0,this.fit());const r=this.width,n=this.height,o=this.renderer;return(r!==o.width||n!==o.height)&&o.setSize(r,n,this.ratio),this.trigger(D.Types.update,this.frameCount,this.timeDelta),this.render()}render(){return this.renderer.render(),this.trigger(D.Types.render,this.frameCount++)}add(e){return e instanceof Array||(e=Array.prototype.slice.call(arguments)),this.scene.add(e),this}remove(e){return e instanceof Array||(e=Array.prototype.slice.call(arguments)),this.scene.remove(e),this}clear(){return this.scene.remove(this.scene.children),this}makeLine(e,t,r,n){const o=new ds(e,t,r,n);return this.scene.add(o),o}makeArrow(e,t,r,n,o){const h=typeof o=="number"?o:10,f=Math.atan2(n-t,r-e),u=[new ct(e,t,void 0,void 0,void 0,void 0,q.move),new ct(r,n,void 0,void 0,void 0,void 0,q.line),new ct(r-h*Math.cos(f-Math.PI/4),n-h*Math.sin(f-Math.PI/4),void 0,void 0,void 0,void 0,q.line),new ct(r,n,void 0,void 0,void 0,void 0,q.move),new ct(r-h*Math.cos(f+Math.PI/4),n-h*Math.sin(f+Math.PI/4),void 0,void 0,void 0,void 0,q.line)],d=new mt(u,!1,!1,!0);return d.noFill(),d.cap="round",d.join="round",this.scene.add(d),d}makeRectangle(e,t,r,n){const o=new Ae(e,t,r,n);return this.scene.add(o),o}makeRoundedRectangle(e,t,r,n,o){const h=new Ni(e,t,r,n,o);return this.scene.add(h),h}makeCircle(e,t,r,n){const o=new Oi(e,t,r,n);return this.scene.add(o),o}makeEllipse(e,t,r,n,o){const h=new ki(e,t,r,n,o);return this.scene.add(h),h}makeStar(e,t,r,n,o){const h=new gs(e,t,r,n,o);return this.scene.add(h),h}makeCurve(e){const t=arguments.length;if(!Array.isArray(e)){e=[];for(let h=0;h<t;h+=2){const f=arguments[h];if(typeof f!="number")break;const u=arguments[h+1];e.push(new ct(f,u))}}const r=arguments[t-1],n=new mt(e,!(typeof r=="boolean"&&r),!0),o=n.getBoundingClientRect();return n.center().translation.set(o.left+o.width/2,o.top+o.height/2),this.scene.add(n),n}makePolygon(e,t,r,n){const o=new ms(e,t,r,n);return this.scene.add(o),o}makeArcSegment(e,t,r,n,o,h,f){const u=new ps(e,t,r,n,o,h,f);return this.scene.add(u),u}makePoints(e){const t=arguments.length;let r=e;if(!Array.isArray(e)){r=[];for(let o=0;o<t;o+=2){const h=arguments[o];if(typeof h!="number")break;const f=arguments[o+1];r.push(new z(h,f))}}const n=new _s(r);return this.scene.add(n),n}makePath(e){const t=arguments.length;let r=e;if(!Array.isArray(e)){r=[];for(let f=0;f<t;f+=2){const u=arguments[f];if(typeof u!="number")break;const d=arguments[f+1];r.push(new ct(u,d))}}const n=arguments[t-1],o=new mt(r,!(typeof n=="boolean"&&n)),h=o.getBoundingClientRect();return typeof h.top=="number"&&typeof h.left=="number"&&typeof h.right=="number"&&typeof h.bottom=="number"&&o.center().translation.set(h.left+h.width/2,h.top+h.height/2),this.scene.add(o),o}makeText(e,t,r,n){const o=new ne(e,t,r,n);return this.add(o),o}makeLinearGradient(e,t,r,n){const o=Array.prototype.slice.call(arguments,4),h=new wt(e,t,r,n,o);return this.add(h),h}makeRadialGradient(e,t,r){const n=Array.prototype.slice.call(arguments,3),o=new It(e,t,r,n);return this.add(o),o}makeSprite(e,t,r,n,o,h,f){const u=new Li(e,t,r,n,o,h);return f&&u.play(),this.add(u),u}makeImageSequence(e,t,r,n,o){const h=new Mi(e,t,r,n);return o&&h.play(),this.add(h),h}makeTexture(e,t){return new yt(e,t)}makeGroup(e){e instanceof Array||(e=Array.prototype.slice.call(arguments));const t=new At;return this.scene.add(t),t.add(e),t}interpret(e,t,r){const n=e.tagName.toLowerCase();if(r=typeof r<"u"?r:!0,!(n in bt))return null;const o=bt[n].call(this,e);return r?this.add(t&&o instanceof At?o.children:o):o.parent&&o.remove(),o}load(e,t){const r=new At;let n,o,h;const f=(function(u){for(Zt.temp.innerHTML=u,o=0;o<Zt.temp.children.length;o++)n=Zt.temp.children[o],h=this.interpret(n,!1,!1),h!==null&&r.add(h);if(typeof t=="function"){const d=Zt.temp.children.length<=1?Zt.temp.children[0]:Zt.temp.children;t(r,d)}}).bind(this);return/\.svg$/i.test(e)?(Kr(e,f),r):(f(e),r)}},j=Ge;g(j,"nextFrameID",Rt.nextFrameID);g(j,"Types",Rt.Types);g(j,"Version",Rt.Version);g(j,"PublishDate",Rt.PublishDate);g(j,"Identifier",Rt.Identifier);g(j,"Resolution",Rt.Resolution);g(j,"AutoCalculateImportedMatrices",Rt.AutoCalculateImportedMatrices);g(j,"Instances",Rt.Instances);g(j,"uniqueId",Rt.uniqueId);g(j,"Anchor",ct);g(j,"Collection",xe);g(j,"Events",D);g(j,"Group",At);g(j,"Matrix",Ee);g(j,"Path",mt);g(j,"Registry",Ai);g(j,"Shape",ye);g(j,"Text",ne);g(j,"Vector",z);g(j,"Gradient",Lt);g(j,"ImageSequence",Mi);g(j,"LinearGradient",wt);g(j,"RadialGradient",It);g(j,"Sprite",Li);g(j,"Stop",ve);g(j,"Texture",yt);g(j,"ArcSegment",ps);g(j,"Circle",Oi);g(j,"Ellipse",ki);g(j,"Line",ds);g(j,"Points",_s);g(j,"Polygon",ms);g(j,"Rectangle",Ae);g(j,"RoundedRectangle",Ni);g(j,"Star",gs);g(j,"CanvasRenderer",We);g(j,"SVGRenderer",$r);g(j,"WebGLRenderer",Qr);g(j,"Commands",q);g(j,"Utils",Ao);function Lo(){const e=document.body.getBoundingClientRect(),t=this.width=e.width,r=this.height=e.height;this.renderer.setSize(t,r,this.ratio)}function Oo(){const e=this.renderer.domElement.parentElement;if(!e){console.warn("Two.js: Attempting to fit to parent, but no parent found.");return}const t=e.getBoundingClientRect(),r=this.width=t.width,n=this.height=t.height;this.renderer.setSize(r,n,this.ratio)}function ko(e,t){this.width=e,this.height=t,this.trigger(D.Types.resize,e,t)}var $e=Zt.getRequestAnimationFrame();function tn(){for(let e=0;e<j.Instances.length;e++){const t=j.Instances[e];t.playing&&t.update()}j.nextFrameID=$e(tn)}$e.init=function(){tn(),$e.init=function(){}};function No(){return Math.random().toString(36).substr(2,9)}function Mo(e,t,r,n,o){const h=[],f=2*Math.PI/o;for(let u=0;u<o;u++){const d=u*f,_=e+r*Math.cos(d),y=t+n*Math.sin(d);h.push({x:_,y})}return h}function ji(e,t){if(e.length<2)throw new Error("At least two points are required to create a stroked polygon.");const r=t/2,n=[],o=[];function h(f,u,d){const _=u.x-f.x,y=u.y-f.y,P=Math.sqrt(_*_+y*y);if(P===0)return{left:{x:f.x,y:f.y},right:{x:f.x,y:f.y}};const w=-y/P,v=_/P;return{left:{x:f.x+w*d,y:f.y+v*d},right:{x:f.x-w*d,y:f.y-v*d}}}for(let f=0;f<e.length-1;f++){const u=e[f],d=e[f+1],{left:_,right:y}=h(u,d,r);if(n.push(_),o.push(y),f>0){const P=n[n.length-2],w=o[o.length-2],v={x:(P.x+_.x)/2,y:(P.y+_.y)/2},C={x:(w.x+y.x)/2,y:(w.y+y.y)/2};n[n.length-2]=v,o[o.length-2]=C}if(f===e.length-2){const{left:P,right:w}=h(d,u,r);n.push(P),o.push(w)}}return[...n,...o.reverse()]}function Ro(e,t,r){const n=r/2,o=t.x-e.x,h=t.y-e.y,f=Math.hypot(o,h);if(f===0)return[];const u=-h/f,d=o/f,_=u*n,y=d*n,P={x:e.x+_,y:e.y+y},w={x:e.x-_,y:e.y-y},v={x:t.x+_,y:t.y+y},C={x:t.x-_,y:t.y-y};return[P,v,C,w]}function or(e,t){let r=!1;const{x:n,y:o}=e;for(let h=0,f=t.length-1;h<t.length;f=h++){const u=t[h].x,d=t[h].y,_=t[f].x,y=t[f].y;d>o!=y>o&&n<(_-u)*(o-d)/(y-d)+u&&(r=!r)}return r}var xa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bo(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var zi={exports:{}},ar;function Fo(){return ar||(ar=1,function(e){(function(){var t={};t.version="6.4.2.2",t.use_lines=!0,t.use_xyz=!1;var r=!1;e.exports?(e.exports=t,r=!0):typeof document<"u"?window.ClipperLib=t:self.ClipperLib=t;var n;if(r){var o="chrome";n="Netscape"}else{var o=navigator.userAgent.toString().toLowerCase();n=navigator.appName}var h={};o.indexOf("chrome")!=-1&&o.indexOf("chromium")==-1?h.chrome=1:h.chrome=0,o.indexOf("chromium")!=-1?h.chromium=1:h.chromium=0,o.indexOf("safari")!=-1&&o.indexOf("chrome")==-1&&o.indexOf("chromium")==-1?h.safari=1:h.safari=0,o.indexOf("firefox")!=-1?h.firefox=1:h.firefox=0,o.indexOf("firefox/17")!=-1?h.firefox17=1:h.firefox17=0,o.indexOf("firefox/15")!=-1?h.firefox15=1:h.firefox15=0,o.indexOf("firefox/3")!=-1?h.firefox3=1:h.firefox3=0,o.indexOf("opera")!=-1?h.opera=1:h.opera=0,o.indexOf("msie 10")!=-1?h.msie10=1:h.msie10=0,o.indexOf("msie 9")!=-1?h.msie9=1:h.msie9=0,o.indexOf("msie 8")!=-1?h.msie8=1:h.msie8=0,o.indexOf("msie 7")!=-1?h.msie7=1:h.msie7=0,o.indexOf("msie ")!=-1?h.msie=1:h.msie=0,t.biginteger_used=null;var f;function u(i,s,l){t.biginteger_used=1,i!=null&&(typeof i=="number"&&typeof s>"u"?this.fromInt(i):typeof i=="number"?this.fromNumber(i,s,l):s==null&&typeof i!="string"?this.fromString(i,256):this.fromString(i,s))}function d(){return new u(null,void 0,void 0)}function _(i,s,l,a,c,p){for(;--p>=0;){var m=s*this[i++]+l[a]+c;c=Math.floor(m/67108864),l[a++]=m&67108863}return c}function y(i,s,l,a,c,p){for(var m=s&32767,x=s>>15;--p>=0;){var b=this[i]&32767,A=this[i++]>>15,U=x*b+A*m;b=m*b+((U&32767)<<15)+l[a]+(c&1073741823),c=(b>>>30)+(U>>>15)+x*A+(c>>>30),l[a++]=b&1073741823}return c}function P(i,s,l,a,c,p){for(var m=s&16383,x=s>>14;--p>=0;){var b=this[i]&16383,A=this[i++]>>14,U=x*b+A*m;b=m*b+((U&16383)<<14)+l[a]+c,c=(b>>28)+(U>>14)+x*A,l[a++]=b&268435455}return c}n=="Microsoft Internet Explorer"?(u.prototype.am=y,f=30):n!="Netscape"?(u.prototype.am=_,f=26):(u.prototype.am=P,f=28),u.prototype.DB=f,u.prototype.DM=(1<<f)-1,u.prototype.DV=1<<f;var w=52;u.prototype.FV=Math.pow(2,w),u.prototype.F1=w-f,u.prototype.F2=2*f-w;var v="0123456789abcdefghijklmnopqrstuvwxyz",C=new Array,k,L;for(k=48,L=0;L<=9;++L)C[k++]=L;for(k=97,L=10;L<36;++L)C[k++]=L;for(k=65,L=10;L<36;++L)C[k++]=L;function O(i){return v.charAt(i)}function E(i,s){var l=C[i.charCodeAt(s)];return l??-1}function N(i){for(var s=this.t-1;s>=0;--s)i[s]=this[s];i.t=this.t,i.s=this.s}function W(i){this.t=1,this.s=i<0?-1:0,i>0?this[0]=i:i<-1?this[0]=i+this.DV:this.t=0}function F(i){var s=d();return s.fromInt(i),s}function Z(i,s){var l;if(s==16)l=4;else if(s==8)l=3;else if(s==256)l=8;else if(s==2)l=1;else if(s==32)l=5;else if(s==4)l=2;else{this.fromRadix(i,s);return}this.t=0,this.s=0;for(var a=i.length,c=!1,p=0;--a>=0;){var m=l==8?i[a]&255:E(i,a);if(m<0){i.charAt(a)=="-"&&(c=!0);continue}c=!1,p==0?this[this.t++]=m:p+l>this.DB?(this[this.t-1]|=(m&(1<<this.DB-p)-1)<<p,this[this.t++]=m>>this.DB-p):this[this.t-1]|=m<<p,p+=l,p>=this.DB&&(p-=this.DB)}l==8&&i[0]&128&&(this.s=-1,p>0&&(this[this.t-1]|=(1<<this.DB-p)-1<<p)),this.clamp(),c&&u.ZERO.subTo(this,this)}function G(){for(var i=this.s&this.DM;this.t>0&&this[this.t-1]==i;)--this.t}function st(i){if(this.s<0)return"-"+this.negate().toString(i);var s;if(i==16)s=4;else if(i==8)s=3;else if(i==2)s=1;else if(i==32)s=5;else if(i==4)s=2;else return this.toRadix(i);var l=(1<<s)-1,a,c=!1,p="",m=this.t,x=this.DB-m*this.DB%s;if(m-- >0)for(x<this.DB&&(a=this[m]>>x)>0&&(c=!0,p=O(a));m>=0;)x<s?(a=(this[m]&(1<<x)-1)<<s-x,a|=this[--m]>>(x+=this.DB-s)):(a=this[m]>>(x-=s)&l,x<=0&&(x+=this.DB,--m)),a>0&&(c=!0),c&&(p+=O(a));return c?p:"0"}function et(){var i=d();return u.ZERO.subTo(this,i),i}function Q(){return this.s<0?this.negate():this}function ht(i){var s=this.s-i.s;if(s!=0)return s;var l=this.t;if(s=l-i.t,s!=0)return this.s<0?-s:s;for(;--l>=0;)if((s=this[l]-i[l])!=0)return s;return 0}function at(i){var s=1,l;return(l=i>>>16)!=0&&(i=l,s+=16),(l=i>>8)!=0&&(i=l,s+=8),(l=i>>4)!=0&&(i=l,s+=4),(l=i>>2)!=0&&(i=l,s+=2),(l=i>>1)!=0&&(i=l,s+=1),s}function T(){return this.t<=0?0:this.DB*(this.t-1)+at(this[this.t-1]^this.s&this.DM)}function V(i,s){var l;for(l=this.t-1;l>=0;--l)s[l+i]=this[l];for(l=i-1;l>=0;--l)s[l]=0;s.t=this.t+i,s.s=this.s}function R(i,s){for(var l=i;l<this.t;++l)s[l-i]=this[l];s.t=Math.max(this.t-i,0),s.s=this.s}function X(i,s){var l=i%this.DB,a=this.DB-l,c=(1<<a)-1,p=Math.floor(i/this.DB),m=this.s<<l&this.DM,x;for(x=this.t-1;x>=0;--x)s[x+p+1]=this[x]>>a|m,m=(this[x]&c)<<l;for(x=p-1;x>=0;--x)s[x]=0;s[p]=m,s.t=this.t+p+1,s.s=this.s,s.clamp()}function Y(i,s){s.s=this.s;var l=Math.floor(i/this.DB);if(l>=this.t){s.t=0;return}var a=i%this.DB,c=this.DB-a,p=(1<<a)-1;s[0]=this[l]>>a;for(var m=l+1;m<this.t;++m)s[m-l-1]|=(this[m]&p)<<c,s[m-l]=this[m]>>a;a>0&&(s[this.t-l-1]|=(this.s&p)<<c),s.t=this.t-l,s.clamp()}function K(i,s){for(var l=0,a=0,c=Math.min(i.t,this.t);l<c;)a+=this[l]-i[l],s[l++]=a&this.DM,a>>=this.DB;if(i.t<this.t){for(a-=i.s;l<this.t;)a+=this[l],s[l++]=a&this.DM,a>>=this.DB;a+=this.s}else{for(a+=this.s;l<i.t;)a-=i[l],s[l++]=a&this.DM,a>>=this.DB;a-=i.s}s.s=a<0?-1:0,a<-1?s[l++]=this.DV+a:a>0&&(s[l++]=a),s.t=l,s.clamp()}function tt(i,s){var l=this.abs(),a=i.abs(),c=l.t;for(s.t=c+a.t;--c>=0;)s[c]=0;for(c=0;c<a.t;++c)s[c+l.t]=l.am(0,a[c],s,c,0,l.t);s.s=0,s.clamp(),this.s!=i.s&&u.ZERO.subTo(s,s)}function it(i){for(var s=this.abs(),l=i.t=2*s.t;--l>=0;)i[l]=0;for(l=0;l<s.t-1;++l){var a=s.am(l,s[l],i,2*l,0,1);(i[l+s.t]+=s.am(l+1,2*s[l],i,2*l+1,a,s.t-l-1))>=s.DV&&(i[l+s.t]-=s.DV,i[l+s.t+1]=1)}i.t>0&&(i[i.t-1]+=s.am(l,s[l],i,2*l,0,1)),i.s=0,i.clamp()}function lt(i,s,l){var a=i.abs();if(!(a.t<=0)){var c=this.abs();if(c.t<a.t){s!=null&&s.fromInt(0),l!=null&&this.copyTo(l);return}l==null&&(l=d());var p=d(),m=this.s,x=i.s,b=this.DB-at(a[a.t-1]);b>0?(a.lShiftTo(b,p),c.lShiftTo(b,l)):(a.copyTo(p),c.copyTo(l));var A=p.t,U=p[A-1];if(U!=0){var B=U*(1<<this.F1)+(A>1?p[A-2]>>this.F2:0),H=this.FV/B,rt=(1<<this.F1)/B,dt=1<<this.F2,pt=l.t,vt=pt-A,Vt=s??d();for(p.dlShiftTo(vt,Vt),l.compareTo(Vt)>=0&&(l[l.t++]=1,l.subTo(Vt,l)),u.ONE.dlShiftTo(A,Vt),Vt.subTo(p,p);p.t<A;)p[p.t++]=0;for(;--vt>=0;){var oe=l[--pt]==U?this.DM:Math.floor(l[pt]*H+(l[pt-1]+dt)*rt);if((l[pt]+=p.am(0,oe,l,vt,0,A))<oe)for(p.dlShiftTo(vt,Vt),l.subTo(Vt,l);l[pt]<--oe;)l.subTo(Vt,l)}s!=null&&(l.drShiftTo(A,s),m!=x&&u.ZERO.subTo(s,s)),l.t=A,l.clamp(),b>0&&l.rShiftTo(b,l),m<0&&u.ZERO.subTo(l,l)}}}function ft(i){var s=d();return this.abs().divRemTo(i,null,s),this.s<0&&s.compareTo(u.ZERO)>0&&i.subTo(s,s),s}function Xt(i){this.m=i}function Pe(i){return i.s<0||i.compareTo(this.m)>=0?i.mod(this.m):i}function be(i){return i}function we(i){i.divRemTo(this.m,null,i)}function zt(i,s,l){i.multiplyTo(s,l),this.reduce(l)}function xt(i,s){i.squareTo(s),this.reduce(s)}Xt.prototype.convert=Pe,Xt.prototype.revert=be,Xt.prototype.reduce=we,Xt.prototype.mulTo=zt,Xt.prototype.sqrTo=xt;function pn(){if(this.t<1)return 0;var i=this[0];if(!(i&1))return 0;var s=i&3;return s=s*(2-(i&15)*s)&15,s=s*(2-(i&255)*s)&255,s=s*(2-((i&65535)*s&65535))&65535,s=s*(2-i*s%this.DV)%this.DV,s>0?this.DV-s:-s}function Ie(i){this.m=i,this.mp=i.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<i.DB-15)-1,this.mt2=2*i.t}function _n(i){var s=d();return i.abs().dlShiftTo(this.m.t,s),s.divRemTo(this.m,null,s),i.s<0&&s.compareTo(u.ZERO)>0&&this.m.subTo(s,s),s}function mn(i){var s=d();return i.copyTo(s),this.reduce(s),s}function gn(i){for(;i.t<=this.mt2;)i[i.t++]=0;for(var s=0;s<this.m.t;++s){var l=i[s]&32767,a=l*this.mpl+((l*this.mph+(i[s]>>15)*this.mpl&this.um)<<15)&i.DM;for(l=s+this.m.t,i[l]+=this.m.am(0,a,i,s,0,this.m.t);i[l]>=i.DV;)i[l]-=i.DV,i[++l]++}i.clamp(),i.drShiftTo(this.m.t,i),i.compareTo(this.m)>=0&&i.subTo(this.m,i)}function yn(i,s){i.squareTo(s),this.reduce(s)}function xn(i,s,l){i.multiplyTo(s,l),this.reduce(l)}Ie.prototype.convert=_n,Ie.prototype.revert=mn,Ie.prototype.reduce=gn,Ie.prototype.mulTo=xn,Ie.prototype.sqrTo=yn;function vn(){return(this.t>0?this[0]&1:this.s)==0}function Pn(i,s){if(i>4294967295||i<1)return u.ONE;var l=d(),a=d(),c=s.convert(this),p=at(i)-1;for(c.copyTo(l);--p>=0;)if(s.sqrTo(l,a),(i&1<<p)>0)s.mulTo(a,c,l);else{var m=l;l=a,a=m}return s.revert(l)}function bn(i,s){var l;return i<256||s.isEven()?l=new Xt(s):l=new Ie(s),this.exp(i,l)}u.prototype.copyTo=N,u.prototype.fromInt=W,u.prototype.fromString=Z,u.prototype.clamp=G,u.prototype.dlShiftTo=V,u.prototype.drShiftTo=R,u.prototype.lShiftTo=X,u.prototype.rShiftTo=Y,u.prototype.subTo=K,u.prototype.multiplyTo=tt,u.prototype.squareTo=it,u.prototype.divRemTo=lt,u.prototype.invDigit=pn,u.prototype.isEven=vn,u.prototype.exp=Pn,u.prototype.toString=st,u.prototype.negate=et,u.prototype.abs=Q,u.prototype.compareTo=ht,u.prototype.bitLength=T,u.prototype.mod=ft,u.prototype.modPowInt=bn,u.ZERO=F(0),u.ONE=F(1);function wn(){var i=d();return this.copyTo(i),i}function In(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function Cn(){return this.t==0?this.s:this[0]<<24>>24}function Tn(){return this.t==0?this.s:this[0]<<16>>16}function En(i){return Math.floor(Math.LN2*this.DB/Math.log(i))}function Sn(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function An(i){if(i==null&&(i=10),this.signum()==0||i<2||i>36)return"0";var s=this.chunkSize(i),l=Math.pow(i,s),a=F(l),c=d(),p=d(),m="";for(this.divRemTo(a,c,p);c.signum()>0;)m=(l+p.intValue()).toString(i).substr(1)+m,c.divRemTo(a,c,p);return p.intValue().toString(i)+m}function Ln(i,s){this.fromInt(0),s==null&&(s=10);for(var l=this.chunkSize(s),a=Math.pow(s,l),c=!1,p=0,m=0,x=0;x<i.length;++x){var b=E(i,x);if(b<0){i.charAt(x)=="-"&&this.signum()==0&&(c=!0);continue}m=s*m+b,++p>=l&&(this.dMultiply(a),this.dAddOffset(m,0),p=0,m=0)}p>0&&(this.dMultiply(Math.pow(s,p)),this.dAddOffset(m,0)),c&&u.ZERO.subTo(this,this)}function On(i,s,l){if(typeof s=="number")if(i<2)this.fromInt(1);else for(this.fromNumber(i,l),this.testBit(i-1)||this.bitwiseTo(u.ONE.shiftLeft(i-1),Fi,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(s);)this.dAddOffset(2,0),this.bitLength()>i&&this.subTo(u.ONE.shiftLeft(i-1),this);else{var a=new Array,c=i&7;a.length=(i>>3)+1,s.nextBytes(a),c>0?a[0]&=(1<<c)-1:a[0]=0,this.fromString(a,256)}}function kn(){var i=this.t,s=new Array;s[0]=this.s;var l=this.DB-i*this.DB%8,a,c=0;if(i-- >0)for(l<this.DB&&(a=this[i]>>l)!=(this.s&this.DM)>>l&&(s[c++]=a|this.s<<this.DB-l);i>=0;)l<8?(a=(this[i]&(1<<l)-1)<<8-l,a|=this[--i]>>(l+=this.DB-8)):(a=this[i]>>(l-=8)&255,l<=0&&(l+=this.DB,--i)),a&128&&(a|=-256),c==0&&(this.s&128)!=(a&128)&&++c,(c>0||a!=this.s)&&(s[c++]=a);return s}function Nn(i){return this.compareTo(i)==0}function Mn(i){return this.compareTo(i)<0?this:i}function Rn(i){return this.compareTo(i)>0?this:i}function Bn(i,s,l){var a,c,p=Math.min(i.t,this.t);for(a=0;a<p;++a)l[a]=s(this[a],i[a]);if(i.t<this.t){for(c=i.s&this.DM,a=p;a<this.t;++a)l[a]=s(this[a],c);l.t=this.t}else{for(c=this.s&this.DM,a=p;a<i.t;++a)l[a]=s(c,i[a]);l.t=i.t}l.s=s(this.s,i.s),l.clamp()}function Fn(i,s){return i&s}function Xn(i){var s=d();return this.bitwiseTo(i,Fn,s),s}function Fi(i,s){return i|s}function Dn(i){var s=d();return this.bitwiseTo(i,Fi,s),s}function bs(i,s){return i^s}function Yn(i){var s=d();return this.bitwiseTo(i,bs,s),s}function ws(i,s){return i&~s}function Un(i){var s=d();return this.bitwiseTo(i,ws,s),s}function Wn(){for(var i=d(),s=0;s<this.t;++s)i[s]=this.DM&~this[s];return i.t=this.t,i.s=~this.s,i}function Vn(i){var s=d();return i<0?this.rShiftTo(-i,s):this.lShiftTo(i,s),s}function qn(i){var s=d();return i<0?this.lShiftTo(-i,s):this.rShiftTo(i,s),s}function jn(i){if(i==0)return-1;var s=0;return i&65535||(i>>=16,s+=16),i&255||(i>>=8,s+=8),i&15||(i>>=4,s+=4),i&3||(i>>=2,s+=2),i&1||++s,s}function zn(){for(var i=0;i<this.t;++i)if(this[i]!=0)return i*this.DB+jn(this[i]);return this.s<0?this.t*this.DB:-1}function Hn(i){for(var s=0;i!=0;)i&=i-1,++s;return s}function Gn(){for(var i=0,s=this.s&this.DM,l=0;l<this.t;++l)i+=Hn(this[l]^s);return i}function Zn(i){var s=Math.floor(i/this.DB);return s>=this.t?this.s!=0:(this[s]&1<<i%this.DB)!=0}function Jn(i,s){var l=u.ONE.shiftLeft(i);return this.bitwiseTo(l,s,l),l}function Kn(i){return this.changeBit(i,Fi)}function $n(i){return this.changeBit(i,ws)}function Qn(i){return this.changeBit(i,bs)}function tl(i,s){for(var l=0,a=0,c=Math.min(i.t,this.t);l<c;)a+=this[l]+i[l],s[l++]=a&this.DM,a>>=this.DB;if(i.t<this.t){for(a+=i.s;l<this.t;)a+=this[l],s[l++]=a&this.DM,a>>=this.DB;a+=this.s}else{for(a+=this.s;l<i.t;)a+=i[l],s[l++]=a&this.DM,a>>=this.DB;a+=i.s}s.s=a<0?-1:0,a>0?s[l++]=a:a<-1&&(s[l++]=this.DV+a),s.t=l,s.clamp()}function el(i){var s=d();return this.addTo(i,s),s}function il(i){var s=d();return this.subTo(i,s),s}function sl(i){var s=d();return this.multiplyTo(i,s),s}function rl(){var i=d();return this.squareTo(i),i}function nl(i){var s=d();return this.divRemTo(i,s,null),s}function ll(i){var s=d();return this.divRemTo(i,null,s),s}function ol(i){var s=d(),l=d();return this.divRemTo(i,s,l),new Array(s,l)}function al(i){this[this.t]=this.am(0,i-1,this,0,0,this.t),++this.t,this.clamp()}function hl(i,s){if(i!=0){for(;this.t<=s;)this[this.t++]=0;for(this[s]+=i;this[s]>=this.DV;)this[s]-=this.DV,++s>=this.t&&(this[this.t++]=0),++this[s]}}function qe(){}function Is(i){return i}function fl(i,s,l){i.multiplyTo(s,l)}function cl(i,s){i.squareTo(s)}qe.prototype.convert=Is,qe.prototype.revert=Is,qe.prototype.mulTo=fl,qe.prototype.sqrTo=cl;function ul(i){return this.exp(i,new qe)}function dl(i,s,l){var a=Math.min(this.t+i.t,s);for(l.s=0,l.t=a;a>0;)l[--a]=0;var c;for(c=l.t-this.t;a<c;++a)l[a+this.t]=this.am(0,i[a],l,a,0,this.t);for(c=Math.min(i.t,s);a<c;++a)this.am(0,i[a],l,a,0,s-a);l.clamp()}function pl(i,s,l){--s;var a=l.t=this.t+i.t-s;for(l.s=0;--a>=0;)l[a]=0;for(a=Math.max(s-this.t,0);a<i.t;++a)l[this.t+a-s]=this.am(s-a,i[a],l,0,0,this.t+a-s);l.clamp(),l.drShiftTo(1,l)}function Le(i){this.r2=d(),this.q3=d(),u.ONE.dlShiftTo(2*i.t,this.r2),this.mu=this.r2.divide(i),this.m=i}function _l(i){if(i.s<0||i.t>2*this.m.t)return i.mod(this.m);if(i.compareTo(this.m)<0)return i;var s=d();return i.copyTo(s),this.reduce(s),s}function ml(i){return i}function gl(i){for(i.drShiftTo(this.m.t-1,this.r2),i.t>this.m.t+1&&(i.t=this.m.t+1,i.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);i.compareTo(this.r2)<0;)i.dAddOffset(1,this.m.t+1);for(i.subTo(this.r2,i);i.compareTo(this.m)>=0;)i.subTo(this.m,i)}function yl(i,s){i.squareTo(s),this.reduce(s)}function xl(i,s,l){i.multiplyTo(s,l),this.reduce(l)}Le.prototype.convert=_l,Le.prototype.revert=ml,Le.prototype.reduce=gl,Le.prototype.mulTo=xl,Le.prototype.sqrTo=yl;function vl(i,s){var l=i.bitLength(),a,c=F(1),p;if(l<=0)return c;l<18?a=1:l<48?a=3:l<144?a=4:l<768?a=5:a=6,l<8?p=new Xt(s):s.isEven()?p=new Le(s):p=new Ie(s);var m=new Array,x=3,b=a-1,A=(1<<a)-1;if(m[1]=p.convert(this),a>1){var U=d();for(p.sqrTo(m[1],U);x<=A;)m[x]=d(),p.mulTo(U,m[x-2],m[x]),x+=2}var B=i.t-1,H,rt=!0,dt=d(),pt;for(l=at(i[B])-1;B>=0;){for(l>=b?H=i[B]>>l-b&A:(H=(i[B]&(1<<l+1)-1)<<b-l,B>0&&(H|=i[B-1]>>this.DB+l-b)),x=a;!(H&1);)H>>=1,--x;if((l-=x)<0&&(l+=this.DB,--B),rt)m[H].copyTo(c),rt=!1;else{for(;x>1;)p.sqrTo(c,dt),p.sqrTo(dt,c),x-=2;x>0?p.sqrTo(c,dt):(pt=c,c=dt,dt=pt),p.mulTo(dt,m[H],c)}for(;B>=0&&!(i[B]&1<<l);)p.sqrTo(c,dt),pt=c,c=dt,dt=pt,--l<0&&(l=this.DB-1,--B)}return p.revert(c)}function Pl(i){var s=this.s<0?this.negate():this.clone(),l=i.s<0?i.negate():i.clone();if(s.compareTo(l)<0){var a=s;s=l,l=a}var c=s.getLowestSetBit(),p=l.getLowestSetBit();if(p<0)return s;for(c<p&&(p=c),p>0&&(s.rShiftTo(p,s),l.rShiftTo(p,l));s.signum()>0;)(c=s.getLowestSetBit())>0&&s.rShiftTo(c,s),(c=l.getLowestSetBit())>0&&l.rShiftTo(c,l),s.compareTo(l)>=0?(s.subTo(l,s),s.rShiftTo(1,s)):(l.subTo(s,l),l.rShiftTo(1,l));return p>0&&l.lShiftTo(p,l),l}function bl(i){if(i<=0)return 0;var s=this.DV%i,l=this.s<0?i-1:0;if(this.t>0)if(s==0)l=this[0]%i;else for(var a=this.t-1;a>=0;--a)l=(s*l+this[a])%i;return l}function wl(i){var s=i.isEven();if(this.isEven()&&s||i.signum()==0)return u.ZERO;for(var l=i.clone(),a=this.clone(),c=F(1),p=F(0),m=F(0),x=F(1);l.signum()!=0;){for(;l.isEven();)l.rShiftTo(1,l),s?((!c.isEven()||!p.isEven())&&(c.addTo(this,c),p.subTo(i,p)),c.rShiftTo(1,c)):p.isEven()||p.subTo(i,p),p.rShiftTo(1,p);for(;a.isEven();)a.rShiftTo(1,a),s?((!m.isEven()||!x.isEven())&&(m.addTo(this,m),x.subTo(i,x)),m.rShiftTo(1,m)):x.isEven()||x.subTo(i,x),x.rShiftTo(1,x);l.compareTo(a)>=0?(l.subTo(a,l),s&&c.subTo(m,c),p.subTo(x,p)):(a.subTo(l,a),s&&m.subTo(c,m),x.subTo(p,x))}if(a.compareTo(u.ONE)!=0)return u.ZERO;if(x.compareTo(i)>=0)return x.subtract(i);if(x.signum()<0)x.addTo(i,x);else return x;return x.signum()<0?x.add(i):x}var Ut=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],Il=(1<<26)/Ut[Ut.length-1];function Cl(i){var s,l=this.abs();if(l.t==1&&l[0]<=Ut[Ut.length-1]){for(s=0;s<Ut.length;++s)if(l[0]==Ut[s])return!0;return!1}if(l.isEven())return!1;for(s=1;s<Ut.length;){for(var a=Ut[s],c=s+1;c<Ut.length&&a<Il;)a*=Ut[c++];for(a=l.modInt(a);s<c;)if(a%Ut[s++]==0)return!1}return l.millerRabin(i)}function Tl(i){var s=this.subtract(u.ONE),l=s.getLowestSetBit();if(l<=0)return!1;var a=s.shiftRight(l);i=i+1>>1,i>Ut.length&&(i=Ut.length);for(var c=d(),p=0;p<i;++p){c.fromInt(Ut[Math.floor(Math.random()*Ut.length)]);var m=c.modPow(a,this);if(m.compareTo(u.ONE)!=0&&m.compareTo(s)!=0){for(var x=1;x++<l&&m.compareTo(s)!=0;)if(m=m.modPowInt(2,this),m.compareTo(u.ONE)==0)return!1;if(m.compareTo(s)!=0)return!1}}return!0}u.prototype.chunkSize=En,u.prototype.toRadix=An,u.prototype.fromRadix=Ln,u.prototype.fromNumber=On,u.prototype.bitwiseTo=Bn,u.prototype.changeBit=Jn,u.prototype.addTo=tl,u.prototype.dMultiply=al,u.prototype.dAddOffset=hl,u.prototype.multiplyLowerTo=dl,u.prototype.multiplyUpperTo=pl,u.prototype.modInt=bl,u.prototype.millerRabin=Tl,u.prototype.clone=wn,u.prototype.intValue=In,u.prototype.byteValue=Cn,u.prototype.shortValue=Tn,u.prototype.signum=Sn,u.prototype.toByteArray=kn,u.prototype.equals=Nn,u.prototype.min=Mn,u.prototype.max=Rn,u.prototype.and=Xn,u.prototype.or=Dn,u.prototype.xor=Yn,u.prototype.andNot=Un,u.prototype.not=Wn,u.prototype.shiftLeft=Vn,u.prototype.shiftRight=qn,u.prototype.getLowestSetBit=zn,u.prototype.bitCount=Gn,u.prototype.testBit=Zn,u.prototype.setBit=Kn,u.prototype.clearBit=$n,u.prototype.flipBit=Qn,u.prototype.add=el,u.prototype.subtract=il,u.prototype.multiply=sl,u.prototype.divide=nl,u.prototype.remainder=ll,u.prototype.divideAndRemainder=ol,u.prototype.modPow=vl,u.prototype.modInverse=wl,u.prototype.pow=ul,u.prototype.gcd=Pl,u.prototype.isProbablePrime=Cl,u.prototype.square=rl;var ut=u;ut.prototype.IsNegative=function(){return this.compareTo(ut.ZERO)==-1},ut.op_Equality=function(i,s){return i.compareTo(s)==0},ut.op_Inequality=function(i,s){return i.compareTo(s)!=0},ut.op_GreaterThan=function(i,s){return i.compareTo(s)>0},ut.op_LessThan=function(i,s){return i.compareTo(s)<0},ut.op_Addition=function(i,s){return new ut(i,void 0,void 0).add(new ut(s,void 0,void 0))},ut.op_Subtraction=function(i,s){return new ut(i,void 0,void 0).subtract(new ut(s,void 0,void 0))},ut.Int128Mul=function(i,s){return new ut(i,void 0,void 0).multiply(new ut(s,void 0,void 0))},ut.op_Division=function(i,s){return i.divide(s)},ut.prototype.ToDouble=function(){return parseFloat(this.toString())};var Cs=function(i,s){var l;if(typeof Object.getOwnPropertyNames>"u"){for(l in s.prototype)(typeof i.prototype[l]>"u"||i.prototype[l]===Object.prototype[l])&&(i.prototype[l]=s.prototype[l]);for(l in s)typeof i[l]>"u"&&(i[l]=s[l]);i.$baseCtor=s}else{for(var a=Object.getOwnPropertyNames(s.prototype),c=0;c<a.length;c++)typeof Object.getOwnPropertyDescriptor(i.prototype,a[c])>"u"&&Object.defineProperty(i.prototype,a[c],Object.getOwnPropertyDescriptor(s.prototype,a[c]));for(l in s)typeof i[l]>"u"&&(i[l]=s[l]);i.$baseCtor=s}};t.Path=function(){return[]},t.Path.prototype.push=Array.prototype.push,t.Paths=function(){return[]},t.Paths.prototype.push=Array.prototype.push,t.DoublePoint=function(){var i=arguments;this.X=0,this.Y=0,i.length===1?(this.X=i[0].X,this.Y=i[0].Y):i.length===2&&(this.X=i[0],this.Y=i[1])},t.DoublePoint0=function(){this.X=0,this.Y=0},t.DoublePoint0.prototype=t.DoublePoint.prototype,t.DoublePoint1=function(i){this.X=i.X,this.Y=i.Y},t.DoublePoint1.prototype=t.DoublePoint.prototype,t.DoublePoint2=function(i,s){this.X=i,this.Y=s},t.DoublePoint2.prototype=t.DoublePoint.prototype,t.PolyNode=function(){this.m_Parent=null,this.m_polygon=new t.Path,this.m_Index=0,this.m_jointype=0,this.m_endtype=0,this.m_Childs=[],this.IsOpen=!1},t.PolyNode.prototype.IsHoleNode=function(){for(var i=!0,s=this.m_Parent;s!==null;)i=!i,s=s.m_Parent;return i},t.PolyNode.prototype.ChildCount=function(){return this.m_Childs.length},t.PolyNode.prototype.Contour=function(){return this.m_polygon},t.PolyNode.prototype.AddChild=function(i){var s=this.m_Childs.length;this.m_Childs.push(i),i.m_Parent=this,i.m_Index=s},t.PolyNode.prototype.GetNext=function(){return this.m_Childs.length>0?this.m_Childs[0]:this.GetNextSiblingUp()},t.PolyNode.prototype.GetNextSiblingUp=function(){return this.m_Parent===null?null:this.m_Index===this.m_Parent.m_Childs.length-1?this.m_Parent.GetNextSiblingUp():this.m_Parent.m_Childs[this.m_Index+1]},t.PolyNode.prototype.Childs=function(){return this.m_Childs},t.PolyNode.prototype.Parent=function(){return this.m_Parent},t.PolyNode.prototype.IsHole=function(){return this.IsHoleNode()},t.PolyTree=function(){this.m_AllPolys=[],t.PolyNode.call(this)},t.PolyTree.prototype.Clear=function(){for(var i=0,s=this.m_AllPolys.length;i<s;i++)this.m_AllPolys[i]=null;this.m_AllPolys.length=0,this.m_Childs.length=0},t.PolyTree.prototype.GetFirst=function(){return this.m_Childs.length>0?this.m_Childs[0]:null},t.PolyTree.prototype.Total=function(){var i=this.m_AllPolys.length;return i>0&&this.m_Childs[0]!==this.m_AllPolys[0]&&i--,i},Cs(t.PolyTree,t.PolyNode),t.Math_Abs_Int64=t.Math_Abs_Int32=t.Math_Abs_Double=function(i){return Math.abs(i)},t.Math_Max_Int32_Int32=function(i,s){return Math.max(i,s)},h.msie||h.opera||h.safari?t.Cast_Int32=function(i){return i|0}:t.Cast_Int32=function(i){return~~i},typeof Number.toInteger>"u"&&(Number.toInteger=null),h.chrome?t.Cast_Int64=function(i){return i<-2147483648||i>2147483647?i<0?Math.ceil(i):Math.floor(i):~~i}:h.firefox&&typeof Number.toInteger=="function"?t.Cast_Int64=function(i){return Number.toInteger(i)}:h.msie7||h.msie8?t.Cast_Int64=function(i){return parseInt(i,10)}:h.msie?t.Cast_Int64=function(i){return i<-2147483648||i>2147483647?i<0?Math.ceil(i):Math.floor(i):i|0}:t.Cast_Int64=function(i){return i<0?Math.ceil(i):Math.floor(i)},t.Clear=function(i){i.length=0},t.PI=3.141592653589793,t.PI2=2*3.141592653589793,t.IntPoint=function(){var i=arguments,s=i.length;if(this.X=0,this.Y=0,t.use_xyz)if(this.Z=0,s===3)this.X=i[0],this.Y=i[1],this.Z=i[2];else if(s===2)this.X=i[0],this.Y=i[1],this.Z=0;else if(s===1)if(i[0]instanceof t.DoublePoint){var l=i[0];this.X=t.Clipper.Round(l.X),this.Y=t.Clipper.Round(l.Y),this.Z=0}else{var a=i[0];typeof a.Z>"u"&&(a.Z=0),this.X=a.X,this.Y=a.Y,this.Z=a.Z}else this.X=0,this.Y=0,this.Z=0;else if(s===2)this.X=i[0],this.Y=i[1];else if(s===1)if(i[0]instanceof t.DoublePoint){var l=i[0];this.X=t.Clipper.Round(l.X),this.Y=t.Clipper.Round(l.Y)}else{var a=i[0];this.X=a.X,this.Y=a.Y}else this.X=0,this.Y=0},t.IntPoint.op_Equality=function(i,s){return i.X===s.X&&i.Y===s.Y},t.IntPoint.op_Inequality=function(i,s){return i.X!==s.X||i.Y!==s.Y},t.IntPoint0=function(){this.X=0,this.Y=0,t.use_xyz&&(this.Z=0)},t.IntPoint0.prototype=t.IntPoint.prototype,t.IntPoint1=function(i){this.X=i.X,this.Y=i.Y,t.use_xyz&&(typeof i.Z>"u"?this.Z=0:this.Z=i.Z)},t.IntPoint1.prototype=t.IntPoint.prototype,t.IntPoint1dp=function(i){this.X=t.Clipper.Round(i.X),this.Y=t.Clipper.Round(i.Y),t.use_xyz&&(this.Z=0)},t.IntPoint1dp.prototype=t.IntPoint.prototype,t.IntPoint2=function(i,s,l){this.X=i,this.Y=s,t.use_xyz&&(typeof l>"u"?this.Z=0:this.Z=l)},t.IntPoint2.prototype=t.IntPoint.prototype,t.IntRect=function(){var i=arguments,s=i.length;if(s===4)this.left=i[0],this.top=i[1],this.right=i[2],this.bottom=i[3];else if(s===1){var l=i[0];this.left=l.left,this.top=l.top,this.right=l.right,this.bottom=l.bottom}else this.left=0,this.top=0,this.right=0,this.bottom=0},t.IntRect0=function(){this.left=0,this.top=0,this.right=0,this.bottom=0},t.IntRect0.prototype=t.IntRect.prototype,t.IntRect1=function(i){this.left=i.left,this.top=i.top,this.right=i.right,this.bottom=i.bottom},t.IntRect1.prototype=t.IntRect.prototype,t.IntRect4=function(i,s,l,a){this.left=i,this.top=s,this.right=l,this.bottom=a},t.IntRect4.prototype=t.IntRect.prototype,t.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,ctXor:3},t.PolyType={ptSubject:0,ptClip:1},t.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3},t.JoinType={jtSquare:0,jtRound:1,jtMiter:2},t.EndType={etOpenSquare:0,etOpenRound:1,etOpenButt:2,etClosedLine:3,etClosedPolygon:4},t.EdgeSide={esLeft:0,esRight:1},t.Direction={dRightToLeft:0,dLeftToRight:1},t.TEdge=function(){this.Bot=new t.IntPoint0,this.Curr=new t.IntPoint0,this.Top=new t.IntPoint0,this.Delta=new t.IntPoint0,this.Dx=0,this.PolyTyp=t.PolyType.ptSubject,this.Side=t.EdgeSide.esLeft,this.WindDelta=0,this.WindCnt=0,this.WindCnt2=0,this.OutIdx=0,this.Next=null,this.Prev=null,this.NextInLML=null,this.NextInAEL=null,this.PrevInAEL=null,this.NextInSEL=null,this.PrevInSEL=null},t.IntersectNode=function(){this.Edge1=null,this.Edge2=null,this.Pt=new t.IntPoint0},t.MyIntersectNodeSort=function(){},t.MyIntersectNodeSort.Compare=function(i,s){var l=s.Pt.Y-i.Pt.Y;return l>0?1:l<0?-1:0},t.LocalMinima=function(){this.Y=0,this.LeftBound=null,this.RightBound=null,this.Next=null},t.Scanbeam=function(){this.Y=0,this.Next=null},t.Maxima=function(){this.X=0,this.Next=null,this.Prev=null},t.OutRec=function(){this.Idx=0,this.IsHole=!1,this.IsOpen=!1,this.FirstLeft=null,this.Pts=null,this.BottomPt=null,this.PolyNode=null},t.OutPt=function(){this.Idx=0,this.Pt=new t.IntPoint0,this.Next=null,this.Prev=null},t.Join=function(){this.OutPt1=null,this.OutPt2=null,this.OffPt=new t.IntPoint0},t.ClipperBase=function(){this.m_MinimaList=null,this.m_CurrentLM=null,this.m_edges=new Array,this.m_UseFullRange=!1,this.m_HasOpenPaths=!1,this.PreserveCollinear=!1,this.m_Scanbeam=null,this.m_PolyOuts=null,this.m_ActiveEdges=null},t.ClipperBase.horizontal=-9007199254740992,t.ClipperBase.Skip=-2,t.ClipperBase.Unassigned=-1,t.ClipperBase.tolerance=1e-20,t.ClipperBase.loRange=47453132,t.ClipperBase.hiRange=0xfffffffffffff,t.ClipperBase.near_zero=function(i){return i>-t.ClipperBase.tolerance&&i<t.ClipperBase.tolerance},t.ClipperBase.IsHorizontal=function(i){return i.Delta.Y===0},t.ClipperBase.prototype.PointIsVertex=function(i,s){var l=s;do{if(t.IntPoint.op_Equality(l.Pt,i))return!0;l=l.Next}while(l!==s);return!1},t.ClipperBase.prototype.PointOnLineSegment=function(i,s,l,a){return a?i.X===s.X&&i.Y===s.Y||i.X===l.X&&i.Y===l.Y||i.X>s.X==i.X<l.X&&i.Y>s.Y==i.Y<l.Y&&ut.op_Equality(ut.Int128Mul(i.X-s.X,l.Y-s.Y),ut.Int128Mul(l.X-s.X,i.Y-s.Y)):i.X===s.X&&i.Y===s.Y||i.X===l.X&&i.Y===l.Y||i.X>s.X==i.X<l.X&&i.Y>s.Y==i.Y<l.Y&&(i.X-s.X)*(l.Y-s.Y)===(l.X-s.X)*(i.Y-s.Y)},t.ClipperBase.prototype.PointOnPolygon=function(i,s,l){for(var a=s;;){if(this.PointOnLineSegment(i,a.Pt,a.Next.Pt,l))return!0;if(a=a.Next,a===s)break}return!1},t.ClipperBase.prototype.SlopesEqual=t.ClipperBase.SlopesEqual=function(){var i=arguments,s=i.length,l,a,c,p,m,x,b;return s===3?(l=i[0],a=i[1],b=i[2],b?ut.op_Equality(ut.Int128Mul(l.Delta.Y,a.Delta.X),ut.Int128Mul(l.Delta.X,a.Delta.Y)):t.Cast_Int64(l.Delta.Y*a.Delta.X)===t.Cast_Int64(l.Delta.X*a.Delta.Y)):s===4?(c=i[0],p=i[1],m=i[2],b=i[3],b?ut.op_Equality(ut.Int128Mul(c.Y-p.Y,p.X-m.X),ut.Int128Mul(c.X-p.X,p.Y-m.Y)):t.Cast_Int64((c.Y-p.Y)*(p.X-m.X))-t.Cast_Int64((c.X-p.X)*(p.Y-m.Y))===0):(c=i[0],p=i[1],m=i[2],x=i[3],b=i[4],b?ut.op_Equality(ut.Int128Mul(c.Y-p.Y,m.X-x.X),ut.Int128Mul(c.X-p.X,m.Y-x.Y)):t.Cast_Int64((c.Y-p.Y)*(m.X-x.X))-t.Cast_Int64((c.X-p.X)*(m.Y-x.Y))===0)},t.ClipperBase.SlopesEqual3=function(i,s,l){return l?ut.op_Equality(ut.Int128Mul(i.Delta.Y,s.Delta.X),ut.Int128Mul(i.Delta.X,s.Delta.Y)):t.Cast_Int64(i.Delta.Y*s.Delta.X)===t.Cast_Int64(i.Delta.X*s.Delta.Y)},t.ClipperBase.SlopesEqual4=function(i,s,l,a){return a?ut.op_Equality(ut.Int128Mul(i.Y-s.Y,s.X-l.X),ut.Int128Mul(i.X-s.X,s.Y-l.Y)):t.Cast_Int64((i.Y-s.Y)*(s.X-l.X))-t.Cast_Int64((i.X-s.X)*(s.Y-l.Y))===0},t.ClipperBase.SlopesEqual5=function(i,s,l,a,c){return c?ut.op_Equality(ut.Int128Mul(i.Y-s.Y,l.X-a.X),ut.Int128Mul(i.X-s.X,l.Y-a.Y)):t.Cast_Int64((i.Y-s.Y)*(l.X-a.X))-t.Cast_Int64((i.X-s.X)*(l.Y-a.Y))===0},t.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var i=0,s=this.m_edges.length;i<s;++i){for(var l=0,a=this.m_edges[i].length;l<a;++l)this.m_edges[i][l]=null;t.Clear(this.m_edges[i])}t.Clear(this.m_edges),this.m_UseFullRange=!1,this.m_HasOpenPaths=!1},t.ClipperBase.prototype.DisposeLocalMinimaList=function(){for(;this.m_MinimaList!==null;){var i=this.m_MinimaList.Next;this.m_MinimaList=null,this.m_MinimaList=i}this.m_CurrentLM=null},t.ClipperBase.prototype.RangeTest=function(i,s){s.Value?(i.X>t.ClipperBase.hiRange||i.Y>t.ClipperBase.hiRange||-i.X>t.ClipperBase.hiRange||-i.Y>t.ClipperBase.hiRange)&&t.Error("Coordinate outside allowed range in RangeTest()."):(i.X>t.ClipperBase.loRange||i.Y>t.ClipperBase.loRange||-i.X>t.ClipperBase.loRange||-i.Y>t.ClipperBase.loRange)&&(s.Value=!0,this.RangeTest(i,s))},t.ClipperBase.prototype.InitEdge=function(i,s,l,a){i.Next=s,i.Prev=l,i.Curr.X=a.X,i.Curr.Y=a.Y,t.use_xyz&&(i.Curr.Z=a.Z),i.OutIdx=-1},t.ClipperBase.prototype.InitEdge2=function(i,s){i.Curr.Y>=i.Next.Curr.Y?(i.Bot.X=i.Curr.X,i.Bot.Y=i.Curr.Y,t.use_xyz&&(i.Bot.Z=i.Curr.Z),i.Top.X=i.Next.Curr.X,i.Top.Y=i.Next.Curr.Y,t.use_xyz&&(i.Top.Z=i.Next.Curr.Z)):(i.Top.X=i.Curr.X,i.Top.Y=i.Curr.Y,t.use_xyz&&(i.Top.Z=i.Curr.Z),i.Bot.X=i.Next.Curr.X,i.Bot.Y=i.Next.Curr.Y,t.use_xyz&&(i.Bot.Z=i.Next.Curr.Z)),this.SetDx(i),i.PolyTyp=s},t.ClipperBase.prototype.FindNextLocMin=function(i){for(var s;;){for(;t.IntPoint.op_Inequality(i.Bot,i.Prev.Bot)||t.IntPoint.op_Equality(i.Curr,i.Top);)i=i.Next;if(i.Dx!==t.ClipperBase.horizontal&&i.Prev.Dx!==t.ClipperBase.horizontal)break;for(;i.Prev.Dx===t.ClipperBase.horizontal;)i=i.Prev;for(s=i;i.Dx===t.ClipperBase.horizontal;)i=i.Next;if(i.Top.Y!==i.Prev.Bot.Y){s.Prev.Bot.X<i.Bot.X&&(i=s);break}}return i},t.ClipperBase.prototype.ProcessBound=function(i,s){var l,a=i,c;if(a.OutIdx===t.ClipperBase.Skip){if(i=a,s){for(;i.Top.Y===i.Next.Bot.Y;)i=i.Next;for(;i!==a&&i.Dx===t.ClipperBase.horizontal;)i=i.Prev}else{for(;i.Top.Y===i.Prev.Bot.Y;)i=i.Prev;for(;i!==a&&i.Dx===t.ClipperBase.horizontal;)i=i.Next}if(i===a)s?a=i.Next:a=i.Prev;else{s?i=a.Next:i=a.Prev;var p=new t.LocalMinima;p.Next=null,p.Y=i.Bot.Y,p.LeftBound=null,p.RightBound=i,i.WindDelta=0,a=this.ProcessBound(i,s),this.InsertLocalMinima(p)}return a}if(i.Dx===t.ClipperBase.horizontal&&(s?l=i.Prev:l=i.Next,l.Dx===t.ClipperBase.horizontal?l.Bot.X!==i.Bot.X&&l.Top.X!==i.Bot.X&&this.ReverseHorizontal(i):l.Bot.X!==i.Bot.X&&this.ReverseHorizontal(i)),l=i,s){for(;a.Top.Y===a.Next.Bot.Y&&a.Next.OutIdx!==t.ClipperBase.Skip;)a=a.Next;if(a.Dx===t.ClipperBase.horizontal&&a.Next.OutIdx!==t.ClipperBase.Skip){for(c=a;c.Prev.Dx===t.ClipperBase.horizontal;)c=c.Prev;c.Prev.Top.X>a.Next.Top.X&&(a=c.Prev)}for(;i!==a;)i.NextInLML=i.Next,i.Dx===t.ClipperBase.horizontal&&i!==l&&i.Bot.X!==i.Prev.Top.X&&this.ReverseHorizontal(i),i=i.Next;i.Dx===t.ClipperBase.horizontal&&i!==l&&i.Bot.X!==i.Prev.Top.X&&this.ReverseHorizontal(i),a=a.Next}else{for(;a.Top.Y===a.Prev.Bot.Y&&a.Prev.OutIdx!==t.ClipperBase.Skip;)a=a.Prev;if(a.Dx===t.ClipperBase.horizontal&&a.Prev.OutIdx!==t.ClipperBase.Skip){for(c=a;c.Next.Dx===t.ClipperBase.horizontal;)c=c.Next;(c.Next.Top.X===a.Prev.Top.X||c.Next.Top.X>a.Prev.Top.X)&&(a=c.Next)}for(;i!==a;)i.NextInLML=i.Prev,i.Dx===t.ClipperBase.horizontal&&i!==l&&i.Bot.X!==i.Next.Top.X&&this.ReverseHorizontal(i),i=i.Prev;i.Dx===t.ClipperBase.horizontal&&i!==l&&i.Bot.X!==i.Next.Top.X&&this.ReverseHorizontal(i),a=a.Prev}return a},t.ClipperBase.prototype.AddPath=function(i,s,l){t.use_lines?!l&&s===t.PolyType.ptClip&&t.Error("AddPath: Open paths must be subject."):l||t.Error("AddPath: Open paths have been disabled.");var a=i.length-1;if(l)for(;a>0&&t.IntPoint.op_Equality(i[a],i[0]);)--a;for(;a>0&&t.IntPoint.op_Equality(i[a],i[a-1]);)--a;if(l&&a<2||!l&&a<1)return!1;for(var c=new Array,p=0;p<=a;p++)c.push(new t.TEdge);var m=!0;c[1].Curr.X=i[1].X,c[1].Curr.Y=i[1].Y,t.use_xyz&&(c[1].Curr.Z=i[1].Z);var x={Value:this.m_UseFullRange};this.RangeTest(i[0],x),this.m_UseFullRange=x.Value,x.Value=this.m_UseFullRange,this.RangeTest(i[a],x),this.m_UseFullRange=x.Value,this.InitEdge(c[0],c[1],c[a],i[0]),this.InitEdge(c[a],c[0],c[a-1],i[a]);for(var p=a-1;p>=1;--p)x.Value=this.m_UseFullRange,this.RangeTest(i[p],x),this.m_UseFullRange=x.Value,this.InitEdge(c[p],c[p+1],c[p-1],i[p]);for(var b=c[0],A=b,U=b;;){if(A.Curr===A.Next.Curr&&(l||A.Next!==b)){if(A===A.Next)break;A===b&&(b=A.Next),A=this.RemoveEdge(A),U=A;continue}if(A.Prev===A.Next)break;if(l&&t.ClipperBase.SlopesEqual4(A.Prev.Curr,A.Curr,A.Next.Curr,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(A.Prev.Curr,A.Curr,A.Next.Curr))){A===b&&(b=A.Next),A=this.RemoveEdge(A),A=A.Prev,U=A;continue}if(A=A.Next,A===U||!l&&A.Next===b)break}if(!l&&A===A.Next||l&&A.Prev===A.Next)return!1;l||(this.m_HasOpenPaths=!0,b.Prev.OutIdx=t.ClipperBase.Skip),A=b;do this.InitEdge2(A,s),A=A.Next,m&&A.Curr.Y!==b.Curr.Y&&(m=!1);while(A!==b);if(m){if(l)return!1;A.Prev.OutIdx=t.ClipperBase.Skip;var B=new t.LocalMinima;for(B.Next=null,B.Y=A.Bot.Y,B.LeftBound=null,B.RightBound=A,B.RightBound.Side=t.EdgeSide.esRight,B.RightBound.WindDelta=0;A.Bot.X!==A.Prev.Top.X&&this.ReverseHorizontal(A),A.Next.OutIdx!==t.ClipperBase.Skip;)A.NextInLML=A.Next,A=A.Next;return this.InsertLocalMinima(B),this.m_edges.push(c),!0}this.m_edges.push(c);var H,rt=null;for(t.IntPoint.op_Equality(A.Prev.Bot,A.Prev.Top)&&(A=A.Next);A=this.FindNextLocMin(A),A!==rt;){rt===null&&(rt=A);var B=new t.LocalMinima;B.Next=null,B.Y=A.Bot.Y,A.Dx<A.Prev.Dx?(B.LeftBound=A.Prev,B.RightBound=A,H=!1):(B.LeftBound=A,B.RightBound=A.Prev,H=!0),B.LeftBound.Side=t.EdgeSide.esLeft,B.RightBound.Side=t.EdgeSide.esRight,l?B.LeftBound.Next===B.RightBound?B.LeftBound.WindDelta=-1:B.LeftBound.WindDelta=1:B.LeftBound.WindDelta=0,B.RightBound.WindDelta=-B.LeftBound.WindDelta,A=this.ProcessBound(B.LeftBound,H),A.OutIdx===t.ClipperBase.Skip&&(A=this.ProcessBound(A,H));var dt=this.ProcessBound(B.RightBound,!H);dt.OutIdx===t.ClipperBase.Skip&&(dt=this.ProcessBound(dt,!H)),B.LeftBound.OutIdx===t.ClipperBase.Skip?B.LeftBound=null:B.RightBound.OutIdx===t.ClipperBase.Skip&&(B.RightBound=null),this.InsertLocalMinima(B),H||(A=dt)}return!0},t.ClipperBase.prototype.AddPaths=function(i,s,l){for(var a=!1,c=0,p=i.length;c<p;++c)this.AddPath(i[c],s,l)&&(a=!0);return a},t.ClipperBase.prototype.Pt2IsBetweenPt1AndPt3=function(i,s,l){return t.IntPoint.op_Equality(i,l)||t.IntPoint.op_Equality(i,s)||t.IntPoint.op_Equality(l,s)?!1:i.X!==l.X?s.X>i.X==s.X<l.X:s.Y>i.Y==s.Y<l.Y},t.ClipperBase.prototype.RemoveEdge=function(i){i.Prev.Next=i.Next,i.Next.Prev=i.Prev;var s=i.Next;return i.Prev=null,s},t.ClipperBase.prototype.SetDx=function(i){i.Delta.X=i.Top.X-i.Bot.X,i.Delta.Y=i.Top.Y-i.Bot.Y,i.Delta.Y===0?i.Dx=t.ClipperBase.horizontal:i.Dx=i.Delta.X/i.Delta.Y},t.ClipperBase.prototype.InsertLocalMinima=function(i){if(this.m_MinimaList===null)this.m_MinimaList=i;else if(i.Y>=this.m_MinimaList.Y)i.Next=this.m_MinimaList,this.m_MinimaList=i;else{for(var s=this.m_MinimaList;s.Next!==null&&i.Y<s.Next.Y;)s=s.Next;i.Next=s.Next,s.Next=i}},t.ClipperBase.prototype.PopLocalMinima=function(i,s){return s.v=this.m_CurrentLM,this.m_CurrentLM!==null&&this.m_CurrentLM.Y===i?(this.m_CurrentLM=this.m_CurrentLM.Next,!0):!1},t.ClipperBase.prototype.ReverseHorizontal=function(i){var s=i.Top.X;i.Top.X=i.Bot.X,i.Bot.X=s,t.use_xyz&&(s=i.Top.Z,i.Top.Z=i.Bot.Z,i.Bot.Z=s)},t.ClipperBase.prototype.Reset=function(){if(this.m_CurrentLM=this.m_MinimaList,this.m_CurrentLM!==null){this.m_Scanbeam=null;for(var i=this.m_MinimaList;i!==null;){this.InsertScanbeam(i.Y);var s=i.LeftBound;s!==null&&(s.Curr.X=s.Bot.X,s.Curr.Y=s.Bot.Y,t.use_xyz&&(s.Curr.Z=s.Bot.Z),s.OutIdx=t.ClipperBase.Unassigned),s=i.RightBound,s!==null&&(s.Curr.X=s.Bot.X,s.Curr.Y=s.Bot.Y,t.use_xyz&&(s.Curr.Z=s.Bot.Z),s.OutIdx=t.ClipperBase.Unassigned),i=i.Next}this.m_ActiveEdges=null}},t.ClipperBase.prototype.InsertScanbeam=function(i){if(this.m_Scanbeam===null)this.m_Scanbeam=new t.Scanbeam,this.m_Scanbeam.Next=null,this.m_Scanbeam.Y=i;else if(i>this.m_Scanbeam.Y){var s=new t.Scanbeam;s.Y=i,s.Next=this.m_Scanbeam,this.m_Scanbeam=s}else{for(var l=this.m_Scanbeam;l.Next!==null&&i<=l.Next.Y;)l=l.Next;if(i===l.Y)return;var a=new t.Scanbeam;a.Y=i,a.Next=l.Next,l.Next=a}},t.ClipperBase.prototype.PopScanbeam=function(i){return this.m_Scanbeam===null?(i.v=0,!1):(i.v=this.m_Scanbeam.Y,this.m_Scanbeam=this.m_Scanbeam.Next,!0)},t.ClipperBase.prototype.LocalMinimaPending=function(){return this.m_CurrentLM!==null},t.ClipperBase.prototype.CreateOutRec=function(){var i=new t.OutRec;return i.Idx=t.ClipperBase.Unassigned,i.IsHole=!1,i.IsOpen=!1,i.FirstLeft=null,i.Pts=null,i.BottomPt=null,i.PolyNode=null,this.m_PolyOuts.push(i),i.Idx=this.m_PolyOuts.length-1,i},t.ClipperBase.prototype.DisposeOutRec=function(i){var s=this.m_PolyOuts[i];s.Pts=null,s=null,this.m_PolyOuts[i]=null},t.ClipperBase.prototype.UpdateEdgeIntoAEL=function(i){i.NextInLML===null&&t.Error("UpdateEdgeIntoAEL: invalid call");var s=i.PrevInAEL,l=i.NextInAEL;return i.NextInLML.OutIdx=i.OutIdx,s!==null?s.NextInAEL=i.NextInLML:this.m_ActiveEdges=i.NextInLML,l!==null&&(l.PrevInAEL=i.NextInLML),i.NextInLML.Side=i.Side,i.NextInLML.WindDelta=i.WindDelta,i.NextInLML.WindCnt=i.WindCnt,i.NextInLML.WindCnt2=i.WindCnt2,i=i.NextInLML,i.Curr.X=i.Bot.X,i.Curr.Y=i.Bot.Y,i.PrevInAEL=s,i.NextInAEL=l,t.ClipperBase.IsHorizontal(i)||this.InsertScanbeam(i.Top.Y),i},t.ClipperBase.prototype.SwapPositionsInAEL=function(i,s){if(!(i.NextInAEL===i.PrevInAEL||s.NextInAEL===s.PrevInAEL)){if(i.NextInAEL===s){var l=s.NextInAEL;l!==null&&(l.PrevInAEL=i);var a=i.PrevInAEL;a!==null&&(a.NextInAEL=s),s.PrevInAEL=a,s.NextInAEL=i,i.PrevInAEL=s,i.NextInAEL=l}else if(s.NextInAEL===i){var c=i.NextInAEL;c!==null&&(c.PrevInAEL=s);var p=s.PrevInAEL;p!==null&&(p.NextInAEL=i),i.PrevInAEL=p,i.NextInAEL=s,s.PrevInAEL=i,s.NextInAEL=c}else{var m=i.NextInAEL,x=i.PrevInAEL;i.NextInAEL=s.NextInAEL,i.NextInAEL!==null&&(i.NextInAEL.PrevInAEL=i),i.PrevInAEL=s.PrevInAEL,i.PrevInAEL!==null&&(i.PrevInAEL.NextInAEL=i),s.NextInAEL=m,s.NextInAEL!==null&&(s.NextInAEL.PrevInAEL=s),s.PrevInAEL=x,s.PrevInAEL!==null&&(s.PrevInAEL.NextInAEL=s)}i.PrevInAEL===null?this.m_ActiveEdges=i:s.PrevInAEL===null&&(this.m_ActiveEdges=s)}},t.ClipperBase.prototype.DeleteFromAEL=function(i){var s=i.PrevInAEL,l=i.NextInAEL;s===null&&l===null&&i!==this.m_ActiveEdges||(s!==null?s.NextInAEL=l:this.m_ActiveEdges=l,l!==null&&(l.PrevInAEL=s),i.NextInAEL=null,i.PrevInAEL=null)},t.Clipper=function(i){typeof i>"u"&&(i=0),this.m_PolyOuts=null,this.m_ClipType=t.ClipType.ctIntersection,this.m_Scanbeam=null,this.m_Maxima=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=null,this.m_IntersectNodeComparer=null,this.m_ExecuteLocked=!1,this.m_ClipFillType=t.PolyFillType.pftEvenOdd,this.m_SubjFillType=t.PolyFillType.pftEvenOdd,this.m_Joins=null,this.m_GhostJoins=null,this.m_UsingPolyTree=!1,this.ReverseSolution=!1,this.StrictlySimple=!1,t.ClipperBase.call(this),this.m_Scanbeam=null,this.m_Maxima=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=new Array,this.m_IntersectNodeComparer=t.MyIntersectNodeSort.Compare,this.m_ExecuteLocked=!1,this.m_UsingPolyTree=!1,this.m_PolyOuts=new Array,this.m_Joins=new Array,this.m_GhostJoins=new Array,this.ReverseSolution=(1&i)!==0,this.StrictlySimple=(2&i)!==0,this.PreserveCollinear=(4&i)!==0,t.use_xyz&&(this.ZFillFunction=null)},t.Clipper.ioReverseSolution=1,t.Clipper.ioStrictlySimple=2,t.Clipper.ioPreserveCollinear=4,t.Clipper.prototype.Clear=function(){this.m_edges.length!==0&&(this.DisposeAllPolyPts(),t.ClipperBase.prototype.Clear.call(this))},t.Clipper.prototype.InsertMaxima=function(i){var s=new t.Maxima;if(s.X=i,this.m_Maxima===null)this.m_Maxima=s,this.m_Maxima.Next=null,this.m_Maxima.Prev=null;else if(i<this.m_Maxima.X)s.Next=this.m_Maxima,s.Prev=null,this.m_Maxima=s;else{for(var l=this.m_Maxima;l.Next!==null&&i>=l.Next.X;)l=l.Next;if(i===l.X)return;s.Next=l.Next,s.Prev=l,l.Next!==null&&(l.Next.Prev=s),l.Next=s}},t.Clipper.prototype.Execute=function(){var i=arguments,s=i.length,l=i[1]instanceof t.PolyTree;if(s===4&&!l){var a=i[0],c=i[1],p=i[2],m=i[3];if(this.m_ExecuteLocked)return!1;this.m_HasOpenPaths&&t.Error("Error: PolyTree struct is needed for open path clipping."),this.m_ExecuteLocked=!0,t.Clear(c),this.m_SubjFillType=p,this.m_ClipFillType=m,this.m_ClipType=a,this.m_UsingPolyTree=!1;try{var x=this.ExecuteInternal();x&&this.BuildResult(c)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return x}else if(s===4&&l){var a=i[0],b=i[1],p=i[2],m=i[3];if(this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0,this.m_SubjFillType=p,this.m_ClipFillType=m,this.m_ClipType=a,this.m_UsingPolyTree=!0;try{var x=this.ExecuteInternal();x&&this.BuildResult2(b)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return x}else if(s===2&&!l){var a=i[0],c=i[1];return this.Execute(a,c,t.PolyFillType.pftEvenOdd,t.PolyFillType.pftEvenOdd)}else if(s===2&&l){var a=i[0],b=i[1];return this.Execute(a,b,t.PolyFillType.pftEvenOdd,t.PolyFillType.pftEvenOdd)}},t.Clipper.prototype.FixHoleLinkage=function(i){if(!(i.FirstLeft===null||i.IsHole!==i.FirstLeft.IsHole&&i.FirstLeft.Pts!==null)){for(var s=i.FirstLeft;s!==null&&(s.IsHole===i.IsHole||s.Pts===null);)s=s.FirstLeft;i.FirstLeft=s}},t.Clipper.prototype.ExecuteInternal=function(){try{this.Reset(),this.m_SortedEdges=null,this.m_Maxima=null;var i={},s={};if(!this.PopScanbeam(i))return!1;for(this.InsertLocalMinimaIntoAEL(i.v);this.PopScanbeam(s)||this.LocalMinimaPending();){if(this.ProcessHorizontals(),this.m_GhostJoins.length=0,!this.ProcessIntersections(s.v))return!1;this.ProcessEdgesAtTopOfScanbeam(s.v),i.v=s.v,this.InsertLocalMinimaIntoAEL(i.v)}var l,a,c;for(a=0,c=this.m_PolyOuts.length;a<c;a++)l=this.m_PolyOuts[a],!(l.Pts===null||l.IsOpen)&&(l.IsHole^this.ReverseSolution)==this.Area$1(l)>0&&this.ReversePolyPtLinks(l.Pts);for(this.JoinCommonEdges(),a=0,c=this.m_PolyOuts.length;a<c;a++)l=this.m_PolyOuts[a],l.Pts!==null&&(l.IsOpen?this.FixupOutPolyline(l):this.FixupOutPolygon(l));return this.StrictlySimple&&this.DoSimplePolygons(),!0}finally{this.m_Joins.length=0,this.m_GhostJoins.length=0}},t.Clipper.prototype.DisposeAllPolyPts=function(){for(var i=0,s=this.m_PolyOuts.length;i<s;++i)this.DisposeOutRec(i);t.Clear(this.m_PolyOuts)},t.Clipper.prototype.AddJoin=function(i,s,l){var a=new t.Join;a.OutPt1=i,a.OutPt2=s,a.OffPt.X=l.X,a.OffPt.Y=l.Y,t.use_xyz&&(a.OffPt.Z=l.Z),this.m_Joins.push(a)},t.Clipper.prototype.AddGhostJoin=function(i,s){var l=new t.Join;l.OutPt1=i,l.OffPt.X=s.X,l.OffPt.Y=s.Y,t.use_xyz&&(l.OffPt.Z=s.Z),this.m_GhostJoins.push(l)},t.Clipper.prototype.SetZ=function(i,s,l){if(this.ZFillFunction!==null){if(i.Z!==0||this.ZFillFunction===null)return;t.IntPoint.op_Equality(i,s.Bot)?i.Z=s.Bot.Z:t.IntPoint.op_Equality(i,s.Top)?i.Z=s.Top.Z:t.IntPoint.op_Equality(i,l.Bot)?i.Z=l.Bot.Z:t.IntPoint.op_Equality(i,l.Top)?i.Z=l.Top.Z:this.ZFillFunction(s.Bot,s.Top,l.Bot,l.Top,i)}},t.Clipper.prototype.InsertLocalMinimaIntoAEL=function(i){for(var s={},l,a;this.PopLocalMinima(i,s);){l=s.v.LeftBound,a=s.v.RightBound;var c=null;if(l===null?(this.InsertEdgeIntoAEL(a,null),this.SetWindingCount(a),this.IsContributing(a)&&(c=this.AddOutPt(a,a.Bot))):a===null?(this.InsertEdgeIntoAEL(l,null),this.SetWindingCount(l),this.IsContributing(l)&&(c=this.AddOutPt(l,l.Bot)),this.InsertScanbeam(l.Top.Y)):(this.InsertEdgeIntoAEL(l,null),this.InsertEdgeIntoAEL(a,l),this.SetWindingCount(l),a.WindCnt=l.WindCnt,a.WindCnt2=l.WindCnt2,this.IsContributing(l)&&(c=this.AddLocalMinPoly(l,a,l.Bot)),this.InsertScanbeam(l.Top.Y)),a!==null&&(t.ClipperBase.IsHorizontal(a)?(a.NextInLML!==null&&this.InsertScanbeam(a.NextInLML.Top.Y),this.AddEdgeToSEL(a)):this.InsertScanbeam(a.Top.Y)),!(l===null||a===null)){if(c!==null&&t.ClipperBase.IsHorizontal(a)&&this.m_GhostJoins.length>0&&a.WindDelta!==0)for(var p=0,m=this.m_GhostJoins.length;p<m;p++){var x=this.m_GhostJoins[p];this.HorzSegmentsOverlap(x.OutPt1.Pt.X,x.OffPt.X,a.Bot.X,a.Top.X)&&this.AddJoin(x.OutPt1,c,x.OffPt)}if(l.OutIdx>=0&&l.PrevInAEL!==null&&l.PrevInAEL.Curr.X===l.Bot.X&&l.PrevInAEL.OutIdx>=0&&t.ClipperBase.SlopesEqual5(l.PrevInAEL.Curr,l.PrevInAEL.Top,l.Curr,l.Top,this.m_UseFullRange)&&l.WindDelta!==0&&l.PrevInAEL.WindDelta!==0){var b=this.AddOutPt(l.PrevInAEL,l.Bot);this.AddJoin(c,b,l.Top)}if(l.NextInAEL!==a){if(a.OutIdx>=0&&a.PrevInAEL.OutIdx>=0&&t.ClipperBase.SlopesEqual5(a.PrevInAEL.Curr,a.PrevInAEL.Top,a.Curr,a.Top,this.m_UseFullRange)&&a.WindDelta!==0&&a.PrevInAEL.WindDelta!==0){var b=this.AddOutPt(a.PrevInAEL,a.Bot);this.AddJoin(c,b,a.Top)}var A=l.NextInAEL;if(A!==null)for(;A!==a;)this.IntersectEdges(a,A,l.Curr),A=A.NextInAEL}}}},t.Clipper.prototype.InsertEdgeIntoAEL=function(i,s){if(this.m_ActiveEdges===null)i.PrevInAEL=null,i.NextInAEL=null,this.m_ActiveEdges=i;else if(s===null&&this.E2InsertsBeforeE1(this.m_ActiveEdges,i))i.PrevInAEL=null,i.NextInAEL=this.m_ActiveEdges,this.m_ActiveEdges.PrevInAEL=i,this.m_ActiveEdges=i;else{for(s===null&&(s=this.m_ActiveEdges);s.NextInAEL!==null&&!this.E2InsertsBeforeE1(s.NextInAEL,i);)s=s.NextInAEL;i.NextInAEL=s.NextInAEL,s.NextInAEL!==null&&(s.NextInAEL.PrevInAEL=i),i.PrevInAEL=s,s.NextInAEL=i}},t.Clipper.prototype.E2InsertsBeforeE1=function(i,s){return s.Curr.X===i.Curr.X?s.Top.Y>i.Top.Y?s.Top.X<t.Clipper.TopX(i,s.Top.Y):i.Top.X>t.Clipper.TopX(s,i.Top.Y):s.Curr.X<i.Curr.X},t.Clipper.prototype.IsEvenOddFillType=function(i){return i.PolyTyp===t.PolyType.ptSubject?this.m_SubjFillType===t.PolyFillType.pftEvenOdd:this.m_ClipFillType===t.PolyFillType.pftEvenOdd},t.Clipper.prototype.IsEvenOddAltFillType=function(i){return i.PolyTyp===t.PolyType.ptSubject?this.m_ClipFillType===t.PolyFillType.pftEvenOdd:this.m_SubjFillType===t.PolyFillType.pftEvenOdd},t.Clipper.prototype.IsContributing=function(i){var s,l;switch(i.PolyTyp===t.PolyType.ptSubject?(s=this.m_SubjFillType,l=this.m_ClipFillType):(s=this.m_ClipFillType,l=this.m_SubjFillType),s){case t.PolyFillType.pftEvenOdd:if(i.WindDelta===0&&i.WindCnt!==1)return!1;break;case t.PolyFillType.pftNonZero:if(Math.abs(i.WindCnt)!==1)return!1;break;case t.PolyFillType.pftPositive:if(i.WindCnt!==1)return!1;break;default:if(i.WindCnt!==-1)return!1;break}switch(this.m_ClipType){case t.ClipType.ctIntersection:switch(l){case t.PolyFillType.pftEvenOdd:case t.PolyFillType.pftNonZero:return i.WindCnt2!==0;case t.PolyFillType.pftPositive:return i.WindCnt2>0;default:return i.WindCnt2<0}case t.ClipType.ctUnion:switch(l){case t.PolyFillType.pftEvenOdd:case t.PolyFillType.pftNonZero:return i.WindCnt2===0;case t.PolyFillType.pftPositive:return i.WindCnt2<=0;default:return i.WindCnt2>=0}case t.ClipType.ctDifference:if(i.PolyTyp===t.PolyType.ptSubject)switch(l){case t.PolyFillType.pftEvenOdd:case t.PolyFillType.pftNonZero:return i.WindCnt2===0;case t.PolyFillType.pftPositive:return i.WindCnt2<=0;default:return i.WindCnt2>=0}else switch(l){case t.PolyFillType.pftEvenOdd:case t.PolyFillType.pftNonZero:return i.WindCnt2!==0;case t.PolyFillType.pftPositive:return i.WindCnt2>0;default:return i.WindCnt2<0}case t.ClipType.ctXor:if(i.WindDelta===0)switch(l){case t.PolyFillType.pftEvenOdd:case t.PolyFillType.pftNonZero:return i.WindCnt2===0;case t.PolyFillType.pftPositive:return i.WindCnt2<=0;default:return i.WindCnt2>=0}else return!0}return!0},t.Clipper.prototype.SetWindingCount=function(i){for(var s=i.PrevInAEL;s!==null&&(s.PolyTyp!==i.PolyTyp||s.WindDelta===0);)s=s.PrevInAEL;if(s===null){var l=i.PolyTyp===t.PolyType.ptSubject?this.m_SubjFillType:this.m_ClipFillType;i.WindDelta===0?i.WindCnt=l===t.PolyFillType.pftNegative?-1:1:i.WindCnt=i.WindDelta,i.WindCnt2=0,s=this.m_ActiveEdges}else if(i.WindDelta===0&&this.m_ClipType!==t.ClipType.ctUnion)i.WindCnt=1,i.WindCnt2=s.WindCnt2,s=s.NextInAEL;else if(this.IsEvenOddFillType(i)){if(i.WindDelta===0){for(var a=!0,c=s.PrevInAEL;c!==null;)c.PolyTyp===s.PolyTyp&&c.WindDelta!==0&&(a=!a),c=c.PrevInAEL;i.WindCnt=a?0:1}else i.WindCnt=i.WindDelta;i.WindCnt2=s.WindCnt2,s=s.NextInAEL}else s.WindCnt*s.WindDelta<0?Math.abs(s.WindCnt)>1?s.WindDelta*i.WindDelta<0?i.WindCnt=s.WindCnt:i.WindCnt=s.WindCnt+i.WindDelta:i.WindCnt=i.WindDelta===0?1:i.WindDelta:i.WindDelta===0?i.WindCnt=s.WindCnt<0?s.WindCnt-1:s.WindCnt+1:s.WindDelta*i.WindDelta<0?i.WindCnt=s.WindCnt:i.WindCnt=s.WindCnt+i.WindDelta,i.WindCnt2=s.WindCnt2,s=s.NextInAEL;if(this.IsEvenOddAltFillType(i))for(;s!==i;)s.WindDelta!==0&&(i.WindCnt2=i.WindCnt2===0?1:0),s=s.NextInAEL;else for(;s!==i;)i.WindCnt2+=s.WindDelta,s=s.NextInAEL},t.Clipper.prototype.AddEdgeToSEL=function(i){this.m_SortedEdges===null?(this.m_SortedEdges=i,i.PrevInSEL=null,i.NextInSEL=null):(i.NextInSEL=this.m_SortedEdges,i.PrevInSEL=null,this.m_SortedEdges.PrevInSEL=i,this.m_SortedEdges=i)},t.Clipper.prototype.PopEdgeFromSEL=function(i){if(i.v=this.m_SortedEdges,i.v===null)return!1;var s=i.v;return this.m_SortedEdges=i.v.NextInSEL,this.m_SortedEdges!==null&&(this.m_SortedEdges.PrevInSEL=null),s.NextInSEL=null,s.PrevInSEL=null,!0},t.Clipper.prototype.CopyAELToSEL=function(){var i=this.m_ActiveEdges;for(this.m_SortedEdges=i;i!==null;)i.PrevInSEL=i.PrevInAEL,i.NextInSEL=i.NextInAEL,i=i.NextInAEL},t.Clipper.prototype.SwapPositionsInSEL=function(i,s){if(!(i.NextInSEL===null&&i.PrevInSEL===null)&&!(s.NextInSEL===null&&s.PrevInSEL===null)){if(i.NextInSEL===s){var l=s.NextInSEL;l!==null&&(l.PrevInSEL=i);var a=i.PrevInSEL;a!==null&&(a.NextInSEL=s),s.PrevInSEL=a,s.NextInSEL=i,i.PrevInSEL=s,i.NextInSEL=l}else if(s.NextInSEL===i){var l=i.NextInSEL;l!==null&&(l.PrevInSEL=s);var a=s.PrevInSEL;a!==null&&(a.NextInSEL=i),i.PrevInSEL=a,i.NextInSEL=s,s.PrevInSEL=i,s.NextInSEL=l}else{var l=i.NextInSEL,a=i.PrevInSEL;i.NextInSEL=s.NextInSEL,i.NextInSEL!==null&&(i.NextInSEL.PrevInSEL=i),i.PrevInSEL=s.PrevInSEL,i.PrevInSEL!==null&&(i.PrevInSEL.NextInSEL=i),s.NextInSEL=l,s.NextInSEL!==null&&(s.NextInSEL.PrevInSEL=s),s.PrevInSEL=a,s.PrevInSEL!==null&&(s.PrevInSEL.NextInSEL=s)}i.PrevInSEL===null?this.m_SortedEdges=i:s.PrevInSEL===null&&(this.m_SortedEdges=s)}},t.Clipper.prototype.AddLocalMaxPoly=function(i,s,l){this.AddOutPt(i,l),s.WindDelta===0&&this.AddOutPt(s,l),i.OutIdx===s.OutIdx?(i.OutIdx=-1,s.OutIdx=-1):i.OutIdx<s.OutIdx?this.AppendPolygon(i,s):this.AppendPolygon(s,i)},t.Clipper.prototype.AddLocalMinPoly=function(i,s,l){var a,c,p;if(t.ClipperBase.IsHorizontal(s)||i.Dx>s.Dx?(a=this.AddOutPt(i,l),s.OutIdx=i.OutIdx,i.Side=t.EdgeSide.esLeft,s.Side=t.EdgeSide.esRight,c=i,c.PrevInAEL===s?p=s.PrevInAEL:p=c.PrevInAEL):(a=this.AddOutPt(s,l),i.OutIdx=s.OutIdx,i.Side=t.EdgeSide.esRight,s.Side=t.EdgeSide.esLeft,c=s,c.PrevInAEL===i?p=i.PrevInAEL:p=c.PrevInAEL),p!==null&&p.OutIdx>=0&&p.Top.Y<l.Y&&c.Top.Y<l.Y){var m=t.Clipper.TopX(p,l.Y),x=t.Clipper.TopX(c,l.Y);if(m===x&&c.WindDelta!==0&&p.WindDelta!==0&&t.ClipperBase.SlopesEqual5(new t.IntPoint2(m,l.Y),p.Top,new t.IntPoint2(x,l.Y),c.Top,this.m_UseFullRange)){var b=this.AddOutPt(p,l);this.AddJoin(a,b,c.Top)}}return a},t.Clipper.prototype.AddOutPt=function(i,s){if(i.OutIdx<0){var l=this.CreateOutRec();l.IsOpen=i.WindDelta===0;var a=new t.OutPt;return l.Pts=a,a.Idx=l.Idx,a.Pt.X=s.X,a.Pt.Y=s.Y,t.use_xyz&&(a.Pt.Z=s.Z),a.Next=a,a.Prev=a,l.IsOpen||this.SetHoleState(i,l),i.OutIdx=l.Idx,a}else{var l=this.m_PolyOuts[i.OutIdx],c=l.Pts,p=i.Side===t.EdgeSide.esLeft;if(p&&t.IntPoint.op_Equality(s,c.Pt))return c;if(!p&&t.IntPoint.op_Equality(s,c.Prev.Pt))return c.Prev;var a=new t.OutPt;return a.Idx=l.Idx,a.Pt.X=s.X,a.Pt.Y=s.Y,t.use_xyz&&(a.Pt.Z=s.Z),a.Next=c,a.Prev=c.Prev,a.Prev.Next=a,c.Prev=a,p&&(l.Pts=a),a}},t.Clipper.prototype.GetLastOutPt=function(i){var s=this.m_PolyOuts[i.OutIdx];return i.Side===t.EdgeSide.esLeft?s.Pts:s.Pts.Prev},t.Clipper.prototype.SwapPoints=function(i,s){var l=new t.IntPoint1(i.Value);i.Value.X=s.Value.X,i.Value.Y=s.Value.Y,t.use_xyz&&(i.Value.Z=s.Value.Z),s.Value.X=l.X,s.Value.Y=l.Y,t.use_xyz&&(s.Value.Z=l.Z)},t.Clipper.prototype.HorzSegmentsOverlap=function(i,s,l,a){var c;return i>s&&(c=i,i=s,s=c),l>a&&(c=l,l=a,a=c),i<a&&l<s},t.Clipper.prototype.SetHoleState=function(i,s){for(var l=i.PrevInAEL,a=null;l!==null;)l.OutIdx>=0&&l.WindDelta!==0&&(a===null?a=l:a.OutIdx===l.OutIdx&&(a=null)),l=l.PrevInAEL;a===null?(s.FirstLeft=null,s.IsHole=!1):(s.FirstLeft=this.m_PolyOuts[a.OutIdx],s.IsHole=!s.FirstLeft.IsHole)},t.Clipper.prototype.GetDx=function(i,s){return i.Y===s.Y?t.ClipperBase.horizontal:(s.X-i.X)/(s.Y-i.Y)},t.Clipper.prototype.FirstIsBottomPt=function(i,s){for(var l=i.Prev;t.IntPoint.op_Equality(l.Pt,i.Pt)&&l!==i;)l=l.Prev;var a=Math.abs(this.GetDx(i.Pt,l.Pt));for(l=i.Next;t.IntPoint.op_Equality(l.Pt,i.Pt)&&l!==i;)l=l.Next;var c=Math.abs(this.GetDx(i.Pt,l.Pt));for(l=s.Prev;t.IntPoint.op_Equality(l.Pt,s.Pt)&&l!==s;)l=l.Prev;var p=Math.abs(this.GetDx(s.Pt,l.Pt));for(l=s.Next;t.IntPoint.op_Equality(l.Pt,s.Pt)&&l!==s;)l=l.Next;var m=Math.abs(this.GetDx(s.Pt,l.Pt));return Math.max(a,c)===Math.max(p,m)&&Math.min(a,c)===Math.min(p,m)?this.Area(i)>0:a>=p&&a>=m||c>=p&&c>=m},t.Clipper.prototype.GetBottomPt=function(i){for(var s=null,l=i.Next;l!==i;)l.Pt.Y>i.Pt.Y?(i=l,s=null):l.Pt.Y===i.Pt.Y&&l.Pt.X<=i.Pt.X&&(l.Pt.X<i.Pt.X?(s=null,i=l):l.Next!==i&&l.Prev!==i&&(s=l)),l=l.Next;if(s!==null)for(;s!==l;)for(this.FirstIsBottomPt(l,s)||(i=s),s=s.Next;t.IntPoint.op_Inequality(s.Pt,i.Pt);)s=s.Next;return i},t.Clipper.prototype.GetLowermostRec=function(i,s){i.BottomPt===null&&(i.BottomPt=this.GetBottomPt(i.Pts)),s.BottomPt===null&&(s.BottomPt=this.GetBottomPt(s.Pts));var l=i.BottomPt,a=s.BottomPt;return l.Pt.Y>a.Pt.Y?i:l.Pt.Y<a.Pt.Y?s:l.Pt.X<a.Pt.X?i:l.Pt.X>a.Pt.X||l.Next===l?s:a.Next===a||this.FirstIsBottomPt(l,a)?i:s},t.Clipper.prototype.OutRec1RightOfOutRec2=function(i,s){do if(i=i.FirstLeft,i===s)return!0;while(i!==null);return!1},t.Clipper.prototype.GetOutRec=function(i){for(var s=this.m_PolyOuts[i];s!==this.m_PolyOuts[s.Idx];)s=this.m_PolyOuts[s.Idx];return s},t.Clipper.prototype.AppendPolygon=function(i,s){var l=this.m_PolyOuts[i.OutIdx],a=this.m_PolyOuts[s.OutIdx],c;this.OutRec1RightOfOutRec2(l,a)?c=a:this.OutRec1RightOfOutRec2(a,l)?c=l:c=this.GetLowermostRec(l,a);var p=l.Pts,m=p.Prev,x=a.Pts,b=x.Prev;i.Side===t.EdgeSide.esLeft?s.Side===t.EdgeSide.esLeft?(this.ReversePolyPtLinks(x),x.Next=p,p.Prev=x,m.Next=b,b.Prev=m,l.Pts=b):(b.Next=p,p.Prev=b,x.Prev=m,m.Next=x,l.Pts=x):s.Side===t.EdgeSide.esRight?(this.ReversePolyPtLinks(x),m.Next=b,b.Prev=m,x.Next=p,p.Prev=x):(m.Next=x,x.Prev=m,p.Prev=b,b.Next=p),l.BottomPt=null,c===a&&(a.FirstLeft!==l&&(l.FirstLeft=a.FirstLeft),l.IsHole=a.IsHole),a.Pts=null,a.BottomPt=null,a.FirstLeft=l;var A=i.OutIdx,U=s.OutIdx;i.OutIdx=-1,s.OutIdx=-1;for(var B=this.m_ActiveEdges;B!==null;){if(B.OutIdx===U){B.OutIdx=A,B.Side=i.Side;break}B=B.NextInAEL}a.Idx=l.Idx},t.Clipper.prototype.ReversePolyPtLinks=function(i){if(i!==null){var s,l;s=i;do l=s.Next,s.Next=s.Prev,s.Prev=l,s=l;while(s!==i)}},t.Clipper.SwapSides=function(i,s){var l=i.Side;i.Side=s.Side,s.Side=l},t.Clipper.SwapPolyIndexes=function(i,s){var l=i.OutIdx;i.OutIdx=s.OutIdx,s.OutIdx=l},t.Clipper.prototype.IntersectEdges=function(i,s,l){var a=i.OutIdx>=0,c=s.OutIdx>=0;if(t.use_xyz&&this.SetZ(l,i,s),t.use_lines&&(i.WindDelta===0||s.WindDelta===0)){if(i.WindDelta===0&&s.WindDelta===0)return;i.PolyTyp===s.PolyTyp&&i.WindDelta!==s.WindDelta&&this.m_ClipType===t.ClipType.ctUnion?i.WindDelta===0?c&&(this.AddOutPt(i,l),a&&(i.OutIdx=-1)):a&&(this.AddOutPt(s,l),c&&(s.OutIdx=-1)):i.PolyTyp!==s.PolyTyp&&(i.WindDelta===0&&Math.abs(s.WindCnt)===1&&(this.m_ClipType!==t.ClipType.ctUnion||s.WindCnt2===0)?(this.AddOutPt(i,l),a&&(i.OutIdx=-1)):s.WindDelta===0&&Math.abs(i.WindCnt)===1&&(this.m_ClipType!==t.ClipType.ctUnion||i.WindCnt2===0)&&(this.AddOutPt(s,l),c&&(s.OutIdx=-1)));return}if(i.PolyTyp===s.PolyTyp)if(this.IsEvenOddFillType(i)){var p=i.WindCnt;i.WindCnt=s.WindCnt,s.WindCnt=p}else i.WindCnt+s.WindDelta===0?i.WindCnt=-i.WindCnt:i.WindCnt+=s.WindDelta,s.WindCnt-i.WindDelta===0?s.WindCnt=-s.WindCnt:s.WindCnt-=i.WindDelta;else this.IsEvenOddFillType(s)?i.WindCnt2=i.WindCnt2===0?1:0:i.WindCnt2+=s.WindDelta,this.IsEvenOddFillType(i)?s.WindCnt2=s.WindCnt2===0?1:0:s.WindCnt2-=i.WindDelta;var m,x,b,A;i.PolyTyp===t.PolyType.ptSubject?(m=this.m_SubjFillType,b=this.m_ClipFillType):(m=this.m_ClipFillType,b=this.m_SubjFillType),s.PolyTyp===t.PolyType.ptSubject?(x=this.m_SubjFillType,A=this.m_ClipFillType):(x=this.m_ClipFillType,A=this.m_SubjFillType);var U,B;switch(m){case t.PolyFillType.pftPositive:U=i.WindCnt;break;case t.PolyFillType.pftNegative:U=-i.WindCnt;break;default:U=Math.abs(i.WindCnt);break}switch(x){case t.PolyFillType.pftPositive:B=s.WindCnt;break;case t.PolyFillType.pftNegative:B=-s.WindCnt;break;default:B=Math.abs(s.WindCnt);break}if(a&&c)U!==0&&U!==1||B!==0&&B!==1||i.PolyTyp!==s.PolyTyp&&this.m_ClipType!==t.ClipType.ctXor?this.AddLocalMaxPoly(i,s,l):(this.AddOutPt(i,l),this.AddOutPt(s,l),t.Clipper.SwapSides(i,s),t.Clipper.SwapPolyIndexes(i,s));else if(a)(B===0||B===1)&&(this.AddOutPt(i,l),t.Clipper.SwapSides(i,s),t.Clipper.SwapPolyIndexes(i,s));else if(c)(U===0||U===1)&&(this.AddOutPt(s,l),t.Clipper.SwapSides(i,s),t.Clipper.SwapPolyIndexes(i,s));else if((U===0||U===1)&&(B===0||B===1)){var H,rt;switch(b){case t.PolyFillType.pftPositive:H=i.WindCnt2;break;case t.PolyFillType.pftNegative:H=-i.WindCnt2;break;default:H=Math.abs(i.WindCnt2);break}switch(A){case t.PolyFillType.pftPositive:rt=s.WindCnt2;break;case t.PolyFillType.pftNegative:rt=-s.WindCnt2;break;default:rt=Math.abs(s.WindCnt2);break}if(i.PolyTyp!==s.PolyTyp)this.AddLocalMinPoly(i,s,l);else if(U===1&&B===1)switch(this.m_ClipType){case t.ClipType.ctIntersection:H>0&&rt>0&&this.AddLocalMinPoly(i,s,l);break;case t.ClipType.ctUnion:H<=0&&rt<=0&&this.AddLocalMinPoly(i,s,l);break;case t.ClipType.ctDifference:(i.PolyTyp===t.PolyType.ptClip&&H>0&&rt>0||i.PolyTyp===t.PolyType.ptSubject&&H<=0&&rt<=0)&&this.AddLocalMinPoly(i,s,l);break;case t.ClipType.ctXor:this.AddLocalMinPoly(i,s,l);break}else t.Clipper.SwapSides(i,s)}},t.Clipper.prototype.DeleteFromSEL=function(i){var s=i.PrevInSEL,l=i.NextInSEL;s===null&&l===null&&i!==this.m_SortedEdges||(s!==null?s.NextInSEL=l:this.m_SortedEdges=l,l!==null&&(l.PrevInSEL=s),i.NextInSEL=null,i.PrevInSEL=null)},t.Clipper.prototype.ProcessHorizontals=function(){for(var i={};this.PopEdgeFromSEL(i);)this.ProcessHorizontal(i.v)},t.Clipper.prototype.GetHorzDirection=function(i,s){i.Bot.X<i.Top.X?(s.Left=i.Bot.X,s.Right=i.Top.X,s.Dir=t.Direction.dLeftToRight):(s.Left=i.Top.X,s.Right=i.Bot.X,s.Dir=t.Direction.dRightToLeft)},t.Clipper.prototype.ProcessHorizontal=function(i){var s={Dir:null,Left:null,Right:null};this.GetHorzDirection(i,s);for(var l=s.Dir,a=s.Left,c=s.Right,p=i.WindDelta===0,m=i,x=null;m.NextInLML!==null&&t.ClipperBase.IsHorizontal(m.NextInLML);)m=m.NextInLML;m.NextInLML===null&&(x=this.GetMaximaPair(m));var b=this.m_Maxima;if(b!==null)if(l===t.Direction.dLeftToRight){for(;b!==null&&b.X<=i.Bot.X;)b=b.Next;b!==null&&b.X>=m.Top.X&&(b=null)}else{for(;b.Next!==null&&b.Next.X<i.Bot.X;)b=b.Next;b.X<=m.Top.X&&(b=null)}for(var A=null;;){for(var U=i===m,B=this.GetNextInAEL(i,l);B!==null;){if(b!==null)if(l===t.Direction.dLeftToRight)for(;b!==null&&b.X<B.Curr.X;)i.OutIdx>=0&&!p&&this.AddOutPt(i,new t.IntPoint2(b.X,i.Bot.Y)),b=b.Next;else for(;b!==null&&b.X>B.Curr.X;)i.OutIdx>=0&&!p&&this.AddOutPt(i,new t.IntPoint2(b.X,i.Bot.Y)),b=b.Prev;if(l===t.Direction.dLeftToRight&&B.Curr.X>c||l===t.Direction.dRightToLeft&&B.Curr.X<a||B.Curr.X===i.Top.X&&i.NextInLML!==null&&B.Dx<i.NextInLML.Dx)break;if(i.OutIdx>=0&&!p){t.use_xyz&&(l===t.Direction.dLeftToRight?this.SetZ(B.Curr,i,B):this.SetZ(B.Curr,B,i)),A=this.AddOutPt(i,B.Curr);for(var H=this.m_SortedEdges;H!==null;){if(H.OutIdx>=0&&this.HorzSegmentsOverlap(i.Bot.X,i.Top.X,H.Bot.X,H.Top.X)){var rt=this.GetLastOutPt(H);this.AddJoin(rt,A,H.Top)}H=H.NextInSEL}this.AddGhostJoin(A,i.Bot)}if(B===x&&U){i.OutIdx>=0&&this.AddLocalMaxPoly(i,x,i.Top),this.DeleteFromAEL(i),this.DeleteFromAEL(x);return}if(l===t.Direction.dLeftToRight){var dt=new t.IntPoint2(B.Curr.X,i.Curr.Y);this.IntersectEdges(i,B,dt)}else{var dt=new t.IntPoint2(B.Curr.X,i.Curr.Y);this.IntersectEdges(B,i,dt)}var pt=this.GetNextInAEL(B,l);this.SwapPositionsInAEL(i,B),B=pt}if(i.NextInLML===null||!t.ClipperBase.IsHorizontal(i.NextInLML))break;i=this.UpdateEdgeIntoAEL(i),i.OutIdx>=0&&this.AddOutPt(i,i.Bot),s={Dir:l,Left:a,Right:c},this.GetHorzDirection(i,s),l=s.Dir,a=s.Left,c=s.Right}if(i.OutIdx>=0&&A===null){A=this.GetLastOutPt(i);for(var H=this.m_SortedEdges;H!==null;){if(H.OutIdx>=0&&this.HorzSegmentsOverlap(i.Bot.X,i.Top.X,H.Bot.X,H.Top.X)){var rt=this.GetLastOutPt(H);this.AddJoin(rt,A,H.Top)}H=H.NextInSEL}this.AddGhostJoin(A,i.Top)}if(i.NextInLML!==null)if(i.OutIdx>=0){if(A=this.AddOutPt(i,i.Top),i=this.UpdateEdgeIntoAEL(i),i.WindDelta===0)return;var vt=i.PrevInAEL,pt=i.NextInAEL;if(vt!==null&&vt.Curr.X===i.Bot.X&&vt.Curr.Y===i.Bot.Y&&vt.WindDelta===0&&vt.OutIdx>=0&&vt.Curr.Y>vt.Top.Y&&t.ClipperBase.SlopesEqual3(i,vt,this.m_UseFullRange)){var rt=this.AddOutPt(vt,i.Bot);this.AddJoin(A,rt,i.Top)}else if(pt!==null&&pt.Curr.X===i.Bot.X&&pt.Curr.Y===i.Bot.Y&&pt.WindDelta!==0&&pt.OutIdx>=0&&pt.Curr.Y>pt.Top.Y&&t.ClipperBase.SlopesEqual3(i,pt,this.m_UseFullRange)){var rt=this.AddOutPt(pt,i.Bot);this.AddJoin(A,rt,i.Top)}}else i=this.UpdateEdgeIntoAEL(i);else i.OutIdx>=0&&this.AddOutPt(i,i.Top),this.DeleteFromAEL(i)},t.Clipper.prototype.GetNextInAEL=function(i,s){return s===t.Direction.dLeftToRight?i.NextInAEL:i.PrevInAEL},t.Clipper.prototype.IsMinima=function(i){return i!==null&&i.Prev.NextInLML!==i&&i.Next.NextInLML!==i},t.Clipper.prototype.IsMaxima=function(i,s){return i!==null&&i.Top.Y===s&&i.NextInLML===null},t.Clipper.prototype.IsIntermediate=function(i,s){return i.Top.Y===s&&i.NextInLML!==null},t.Clipper.prototype.GetMaximaPair=function(i){return t.IntPoint.op_Equality(i.Next.Top,i.Top)&&i.Next.NextInLML===null?i.Next:t.IntPoint.op_Equality(i.Prev.Top,i.Top)&&i.Prev.NextInLML===null?i.Prev:null},t.Clipper.prototype.GetMaximaPairEx=function(i){var s=this.GetMaximaPair(i);return s===null||s.OutIdx===t.ClipperBase.Skip||s.NextInAEL===s.PrevInAEL&&!t.ClipperBase.IsHorizontal(s)?null:s},t.Clipper.prototype.ProcessIntersections=function(i){if(this.m_ActiveEdges===null)return!0;try{if(this.BuildIntersectList(i),this.m_IntersectList.length===0)return!0;if(this.m_IntersectList.length===1||this.FixupIntersectionOrder())this.ProcessIntersectList();else return!1}catch{this.m_SortedEdges=null,this.m_IntersectList.length=0,t.Error("ProcessIntersections error")}return this.m_SortedEdges=null,!0},t.Clipper.prototype.BuildIntersectList=function(i){if(this.m_ActiveEdges!==null){var s=this.m_ActiveEdges;for(this.m_SortedEdges=s;s!==null;)s.PrevInSEL=s.PrevInAEL,s.NextInSEL=s.NextInAEL,s.Curr.X=t.Clipper.TopX(s,i),s=s.NextInAEL;for(var l=!0;l&&this.m_SortedEdges!==null;){for(l=!1,s=this.m_SortedEdges;s.NextInSEL!==null;){var a=s.NextInSEL,c=new t.IntPoint0;if(s.Curr.X>a.Curr.X){this.IntersectPoint(s,a,c),c.Y<i&&(c=new t.IntPoint2(t.Clipper.TopX(s,i),i));var p=new t.IntersectNode;p.Edge1=s,p.Edge2=a,p.Pt.X=c.X,p.Pt.Y=c.Y,t.use_xyz&&(p.Pt.Z=c.Z),this.m_IntersectList.push(p),this.SwapPositionsInSEL(s,a),l=!0}else s=a}if(s.PrevInSEL!==null)s.PrevInSEL.NextInSEL=null;else break}this.m_SortedEdges=null}},t.Clipper.prototype.EdgesAdjacent=function(i){return i.Edge1.NextInSEL===i.Edge2||i.Edge1.PrevInSEL===i.Edge2},t.Clipper.IntersectNodeSort=function(i,s){return s.Pt.Y-i.Pt.Y},t.Clipper.prototype.FixupIntersectionOrder=function(){this.m_IntersectList.sort(this.m_IntersectNodeComparer),this.CopyAELToSEL();for(var i=this.m_IntersectList.length,s=0;s<i;s++){if(!this.EdgesAdjacent(this.m_IntersectList[s])){for(var l=s+1;l<i&&!this.EdgesAdjacent(this.m_IntersectList[l]);)l++;if(l===i)return!1;var a=this.m_IntersectList[s];this.m_IntersectList[s]=this.m_IntersectList[l],this.m_IntersectList[l]=a}this.SwapPositionsInSEL(this.m_IntersectList[s].Edge1,this.m_IntersectList[s].Edge2)}return!0},t.Clipper.prototype.ProcessIntersectList=function(){for(var i=0,s=this.m_IntersectList.length;i<s;i++){var l=this.m_IntersectList[i];this.IntersectEdges(l.Edge1,l.Edge2,l.Pt),this.SwapPositionsInAEL(l.Edge1,l.Edge2)}this.m_IntersectList.length=0};var El=function(i){return i<0?Math.ceil(i-.5):Math.round(i)},Sl=function(i){return i<0?Math.ceil(i-.5):Math.floor(i+.5)},Al=function(i){return i<0?-Math.round(Math.abs(i)):Math.round(i)},Ll=function(i){return i<0?(i-=.5,i<-2147483648?Math.ceil(i):i|0):(i+=.5,i>2147483647?Math.floor(i):i|0)};h.msie?t.Clipper.Round=El:h.chromium?t.Clipper.Round=Al:h.safari?t.Clipper.Round=Ll:t.Clipper.Round=Sl,t.Clipper.TopX=function(i,s){return s===i.Top.Y?i.Top.X:i.Bot.X+t.Clipper.Round(i.Dx*(s-i.Bot.Y))},t.Clipper.prototype.IntersectPoint=function(i,s,l){l.X=0,l.Y=0;var a,c;if(i.Dx===s.Dx){l.Y=i.Curr.Y,l.X=t.Clipper.TopX(i,l.Y);return}if(i.Delta.X===0)l.X=i.Bot.X,t.ClipperBase.IsHorizontal(s)?l.Y=s.Bot.Y:(c=s.Bot.Y-s.Bot.X/s.Dx,l.Y=t.Clipper.Round(l.X/s.Dx+c));else if(s.Delta.X===0)l.X=s.Bot.X,t.ClipperBase.IsHorizontal(i)?l.Y=i.Bot.Y:(a=i.Bot.Y-i.Bot.X/i.Dx,l.Y=t.Clipper.Round(l.X/i.Dx+a));else{a=i.Bot.X-i.Bot.Y*i.Dx,c=s.Bot.X-s.Bot.Y*s.Dx;var p=(c-a)/(i.Dx-s.Dx);l.Y=t.Clipper.Round(p),Math.abs(i.Dx)<Math.abs(s.Dx)?l.X=t.Clipper.Round(i.Dx*p+a):l.X=t.Clipper.Round(s.Dx*p+c)}if(l.Y<i.Top.Y||l.Y<s.Top.Y){if(i.Top.Y>s.Top.Y)return l.Y=i.Top.Y,l.X=t.Clipper.TopX(s,i.Top.Y),l.X<i.Top.X;l.Y=s.Top.Y,Math.abs(i.Dx)<Math.abs(s.Dx)?l.X=t.Clipper.TopX(i,l.Y):l.X=t.Clipper.TopX(s,l.Y)}l.Y>i.Curr.Y&&(l.Y=i.Curr.Y,Math.abs(i.Dx)>Math.abs(s.Dx)?l.X=t.Clipper.TopX(s,l.Y):l.X=t.Clipper.TopX(i,l.Y))},t.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=function(i){for(var s=this.m_ActiveEdges;s!==null;){var l=this.IsMaxima(s,i);if(l){var a=this.GetMaximaPairEx(s);l=a===null||!t.ClipperBase.IsHorizontal(a)}if(l){this.StrictlySimple&&this.InsertMaxima(s.Top.X);var c=s.PrevInAEL;this.DoMaxima(s),c===null?s=this.m_ActiveEdges:s=c.NextInAEL}else{if(this.IsIntermediate(s,i)&&t.ClipperBase.IsHorizontal(s.NextInLML)?(s=this.UpdateEdgeIntoAEL(s),s.OutIdx>=0&&this.AddOutPt(s,s.Bot),this.AddEdgeToSEL(s)):(s.Curr.X=t.Clipper.TopX(s,i),s.Curr.Y=i),t.use_xyz&&(s.Top.Y===i?s.Curr.Z=s.Top.Z:s.Bot.Y===i?s.Curr.Z=s.Bot.Z:s.Curr.Z=0),this.StrictlySimple){var c=s.PrevInAEL;if(s.OutIdx>=0&&s.WindDelta!==0&&c!==null&&c.OutIdx>=0&&c.Curr.X===s.Curr.X&&c.WindDelta!==0){var p=new t.IntPoint1(s.Curr);t.use_xyz&&this.SetZ(p,c,s);var m=this.AddOutPt(c,p),x=this.AddOutPt(s,p);this.AddJoin(m,x,p)}}s=s.NextInAEL}}for(this.ProcessHorizontals(),this.m_Maxima=null,s=this.m_ActiveEdges;s!==null;){if(this.IsIntermediate(s,i)){var m=null;s.OutIdx>=0&&(m=this.AddOutPt(s,s.Top)),s=this.UpdateEdgeIntoAEL(s);var c=s.PrevInAEL,b=s.NextInAEL;if(c!==null&&c.Curr.X===s.Bot.X&&c.Curr.Y===s.Bot.Y&&m!==null&&c.OutIdx>=0&&c.Curr.Y===c.Top.Y&&t.ClipperBase.SlopesEqual5(s.Curr,s.Top,c.Curr,c.Top,this.m_UseFullRange)&&s.WindDelta!==0&&c.WindDelta!==0){var x=this.AddOutPt(ePrev2,s.Bot);this.AddJoin(m,x,s.Top)}else if(b!==null&&b.Curr.X===s.Bot.X&&b.Curr.Y===s.Bot.Y&&m!==null&&b.OutIdx>=0&&b.Curr.Y===b.Top.Y&&t.ClipperBase.SlopesEqual5(s.Curr,s.Top,b.Curr,b.Top,this.m_UseFullRange)&&s.WindDelta!==0&&b.WindDelta!==0){var x=this.AddOutPt(b,s.Bot);this.AddJoin(m,x,s.Top)}}s=s.NextInAEL}},t.Clipper.prototype.DoMaxima=function(i){var s=this.GetMaximaPairEx(i);if(s===null){i.OutIdx>=0&&this.AddOutPt(i,i.Top),this.DeleteFromAEL(i);return}for(var l=i.NextInAEL;l!==null&&l!==s;)this.IntersectEdges(i,l,i.Top),this.SwapPositionsInAEL(i,l),l=i.NextInAEL;i.OutIdx===-1&&s.OutIdx===-1?(this.DeleteFromAEL(i),this.DeleteFromAEL(s)):i.OutIdx>=0&&s.OutIdx>=0?(i.OutIdx>=0&&this.AddLocalMaxPoly(i,s,i.Top),this.DeleteFromAEL(i),this.DeleteFromAEL(s)):t.use_lines&&i.WindDelta===0?(i.OutIdx>=0&&(this.AddOutPt(i,i.Top),i.OutIdx=t.ClipperBase.Unassigned),this.DeleteFromAEL(i),s.OutIdx>=0&&(this.AddOutPt(s,i.Top),s.OutIdx=t.ClipperBase.Unassigned),this.DeleteFromAEL(s)):t.Error("DoMaxima error")},t.Clipper.ReversePaths=function(i){for(var s=0,l=i.length;s<l;s++)i[s].reverse()},t.Clipper.Orientation=function(i){return t.Clipper.Area(i)>=0},t.Clipper.prototype.PointCount=function(i){if(i===null)return 0;var s=0,l=i;do s++,l=l.Next;while(l!==i);return s},t.Clipper.prototype.BuildResult=function(i){t.Clear(i);for(var s=0,l=this.m_PolyOuts.length;s<l;s++){var a=this.m_PolyOuts[s];if(a.Pts!==null){var c=a.Pts.Prev,p=this.PointCount(c);if(!(p<2)){for(var m=new Array(p),x=0;x<p;x++)m[x]=c.Pt,c=c.Prev;i.push(m)}}}},t.Clipper.prototype.BuildResult2=function(i){i.Clear();for(var s=0,l=this.m_PolyOuts.length;s<l;s++){var a=this.m_PolyOuts[s],c=this.PointCount(a.Pts);if(!(a.IsOpen&&c<2||!a.IsOpen&&c<3)){this.FixHoleLinkage(a);var p=new t.PolyNode;i.m_AllPolys.push(p),a.PolyNode=p,p.m_polygon.length=c;for(var m=a.Pts.Prev,x=0;x<c;x++)p.m_polygon[x]=m.Pt,m=m.Prev}}for(var s=0,l=this.m_PolyOuts.length;s<l;s++){var a=this.m_PolyOuts[s];a.PolyNode!==null&&(a.IsOpen?(a.PolyNode.IsOpen=!0,i.AddChild(a.PolyNode)):a.FirstLeft!==null&&a.FirstLeft.PolyNode!==null?a.FirstLeft.PolyNode.AddChild(a.PolyNode):i.AddChild(a.PolyNode))}},t.Clipper.prototype.FixupOutPolyline=function(i){for(var s=i.Pts,l=s.Prev;s!==l;)if(s=s.Next,t.IntPoint.op_Equality(s.Pt,s.Prev.Pt)){s===l&&(l=s.Prev);var a=s.Prev;a.Next=s.Next,s.Next.Prev=a,s=a}s===s.Prev&&(i.Pts=null)},t.Clipper.prototype.FixupOutPolygon=function(i){var s=null;i.BottomPt=null;for(var l=i.Pts,a=this.PreserveCollinear||this.StrictlySimple;;){if(l.Prev===l||l.Prev===l.Next){i.Pts=null;return}if(t.IntPoint.op_Equality(l.Pt,l.Next.Pt)||t.IntPoint.op_Equality(l.Pt,l.Prev.Pt)||t.ClipperBase.SlopesEqual4(l.Prev.Pt,l.Pt,l.Next.Pt,this.m_UseFullRange)&&(!a||!this.Pt2IsBetweenPt1AndPt3(l.Prev.Pt,l.Pt,l.Next.Pt)))s=null,l.Prev.Next=l.Next,l.Next.Prev=l.Prev,l=l.Prev;else{if(l===s)break;s===null&&(s=l),l=l.Next}}i.Pts=l},t.Clipper.prototype.DupOutPt=function(i,s){var l=new t.OutPt;return l.Pt.X=i.Pt.X,l.Pt.Y=i.Pt.Y,t.use_xyz&&(l.Pt.Z=i.Pt.Z),l.Idx=i.Idx,s?(l.Next=i.Next,l.Prev=i,i.Next.Prev=l,i.Next=l):(l.Prev=i.Prev,l.Next=i,i.Prev.Next=l,i.Prev=l),l},t.Clipper.prototype.GetOverlap=function(i,s,l,a,c){return i<s?l<a?(c.Left=Math.max(i,l),c.Right=Math.min(s,a)):(c.Left=Math.max(i,a),c.Right=Math.min(s,l)):l<a?(c.Left=Math.max(s,l),c.Right=Math.min(i,a)):(c.Left=Math.max(s,a),c.Right=Math.min(i,l)),c.Left<c.Right},t.Clipper.prototype.JoinHorz=function(i,s,l,a,c,p){var m=i.Pt.X>s.Pt.X?t.Direction.dRightToLeft:t.Direction.dLeftToRight,x=l.Pt.X>a.Pt.X?t.Direction.dRightToLeft:t.Direction.dLeftToRight;if(m===x)return!1;if(m===t.Direction.dLeftToRight){for(;i.Next.Pt.X<=c.X&&i.Next.Pt.X>=i.Pt.X&&i.Next.Pt.Y===c.Y;)i=i.Next;p&&i.Pt.X!==c.X&&(i=i.Next),s=this.DupOutPt(i,!p),t.IntPoint.op_Inequality(s.Pt,c)&&(i=s,i.Pt.X=c.X,i.Pt.Y=c.Y,t.use_xyz&&(i.Pt.Z=c.Z),s=this.DupOutPt(i,!p))}else{for(;i.Next.Pt.X>=c.X&&i.Next.Pt.X<=i.Pt.X&&i.Next.Pt.Y===c.Y;)i=i.Next;!p&&i.Pt.X!==c.X&&(i=i.Next),s=this.DupOutPt(i,p),t.IntPoint.op_Inequality(s.Pt,c)&&(i=s,i.Pt.X=c.X,i.Pt.Y=c.Y,t.use_xyz&&(i.Pt.Z=c.Z),s=this.DupOutPt(i,p))}if(x===t.Direction.dLeftToRight){for(;l.Next.Pt.X<=c.X&&l.Next.Pt.X>=l.Pt.X&&l.Next.Pt.Y===c.Y;)l=l.Next;p&&l.Pt.X!==c.X&&(l=l.Next),a=this.DupOutPt(l,!p),t.IntPoint.op_Inequality(a.Pt,c)&&(l=a,l.Pt.X=c.X,l.Pt.Y=c.Y,t.use_xyz&&(l.Pt.Z=c.Z),a=this.DupOutPt(l,!p))}else{for(;l.Next.Pt.X>=c.X&&l.Next.Pt.X<=l.Pt.X&&l.Next.Pt.Y===c.Y;)l=l.Next;!p&&l.Pt.X!==c.X&&(l=l.Next),a=this.DupOutPt(l,p),t.IntPoint.op_Inequality(a.Pt,c)&&(l=a,l.Pt.X=c.X,l.Pt.Y=c.Y,t.use_xyz&&(l.Pt.Z=c.Z),a=this.DupOutPt(l,p))}return m===t.Direction.dLeftToRight===p?(i.Prev=l,l.Next=i,s.Next=a,a.Prev=s):(i.Next=l,l.Prev=i,s.Prev=a,a.Next=s),!0},t.Clipper.prototype.JoinPoints=function(i,s,l){var a=i.OutPt1,c=new t.OutPt,p=i.OutPt2,m=new t.OutPt,x=i.OutPt1.Pt.Y===i.OffPt.Y;if(x&&t.IntPoint.op_Equality(i.OffPt,i.OutPt1.Pt)&&t.IntPoint.op_Equality(i.OffPt,i.OutPt2.Pt)){if(s!==l)return!1;for(c=i.OutPt1.Next;c!==a&&t.IntPoint.op_Equality(c.Pt,i.OffPt);)c=c.Next;var b=c.Pt.Y>i.OffPt.Y;for(m=i.OutPt2.Next;m!==p&&t.IntPoint.op_Equality(m.Pt,i.OffPt);)m=m.Next;var A=m.Pt.Y>i.OffPt.Y;return b===A?!1:b?(c=this.DupOutPt(a,!1),m=this.DupOutPt(p,!0),a.Prev=p,p.Next=a,c.Next=m,m.Prev=c,i.OutPt1=a,i.OutPt2=c,!0):(c=this.DupOutPt(a,!0),m=this.DupOutPt(p,!1),a.Next=p,p.Prev=a,c.Prev=m,m.Next=c,i.OutPt1=a,i.OutPt2=c,!0)}else if(x){for(c=a;a.Prev.Pt.Y===a.Pt.Y&&a.Prev!==c&&a.Prev!==p;)a=a.Prev;for(;c.Next.Pt.Y===c.Pt.Y&&c.Next!==a&&c.Next!==p;)c=c.Next;if(c.Next===a||c.Next===p)return!1;for(m=p;p.Prev.Pt.Y===p.Pt.Y&&p.Prev!==m&&p.Prev!==c;)p=p.Prev;for(;m.Next.Pt.Y===m.Pt.Y&&m.Next!==p&&m.Next!==a;)m=m.Next;if(m.Next===p||m.Next===a)return!1;var U={Left:null,Right:null};if(!this.GetOverlap(a.Pt.X,c.Pt.X,p.Pt.X,m.Pt.X,U))return!1;var B=U.Left,H=U.Right,rt=new t.IntPoint0,dt;return a.Pt.X>=B&&a.Pt.X<=H?(rt.X=a.Pt.X,rt.Y=a.Pt.Y,t.use_xyz&&(rt.Z=a.Pt.Z),dt=a.Pt.X>c.Pt.X):p.Pt.X>=B&&p.Pt.X<=H?(rt.X=p.Pt.X,rt.Y=p.Pt.Y,t.use_xyz&&(rt.Z=p.Pt.Z),dt=p.Pt.X>m.Pt.X):c.Pt.X>=B&&c.Pt.X<=H?(rt.X=c.Pt.X,rt.Y=c.Pt.Y,t.use_xyz&&(rt.Z=c.Pt.Z),dt=c.Pt.X>a.Pt.X):(rt.X=m.Pt.X,rt.Y=m.Pt.Y,t.use_xyz&&(rt.Z=m.Pt.Z),dt=m.Pt.X>p.Pt.X),i.OutPt1=a,i.OutPt2=p,this.JoinHorz(a,c,p,m,rt,dt)}else{for(c=a.Next;t.IntPoint.op_Equality(c.Pt,a.Pt)&&c!==a;)c=c.Next;var pt=c.Pt.Y>a.Pt.Y||!t.ClipperBase.SlopesEqual4(a.Pt,c.Pt,i.OffPt,this.m_UseFullRange);if(pt){for(c=a.Prev;t.IntPoint.op_Equality(c.Pt,a.Pt)&&c!==a;)c=c.Prev;if(c.Pt.Y>a.Pt.Y||!t.ClipperBase.SlopesEqual4(a.Pt,c.Pt,i.OffPt,this.m_UseFullRange))return!1}for(m=p.Next;t.IntPoint.op_Equality(m.Pt,p.Pt)&&m!==p;)m=m.Next;var vt=m.Pt.Y>p.Pt.Y||!t.ClipperBase.SlopesEqual4(p.Pt,m.Pt,i.OffPt,this.m_UseFullRange);if(vt){for(m=p.Prev;t.IntPoint.op_Equality(m.Pt,p.Pt)&&m!==p;)m=m.Prev;if(m.Pt.Y>p.Pt.Y||!t.ClipperBase.SlopesEqual4(p.Pt,m.Pt,i.OffPt,this.m_UseFullRange))return!1}return c===a||m===p||c===m||s===l&&pt===vt?!1:pt?(c=this.DupOutPt(a,!1),m=this.DupOutPt(p,!0),a.Prev=p,p.Next=a,c.Next=m,m.Prev=c,i.OutPt1=a,i.OutPt2=c,!0):(c=this.DupOutPt(a,!0),m=this.DupOutPt(p,!1),a.Next=p,p.Prev=a,c.Prev=m,m.Next=c,i.OutPt1=a,i.OutPt2=c,!0)}},t.Clipper.GetBounds=function(i){for(var s=0,l=i.length;s<l&&i[s].length===0;)s++;if(s===l)return new t.IntRect(0,0,0,0);var a=new t.IntRect;for(a.left=i[s][0].X,a.right=a.left,a.top=i[s][0].Y,a.bottom=a.top;s<l;s++)for(var c=0,p=i[s].length;c<p;c++)i[s][c].X<a.left?a.left=i[s][c].X:i[s][c].X>a.right&&(a.right=i[s][c].X),i[s][c].Y<a.top?a.top=i[s][c].Y:i[s][c].Y>a.bottom&&(a.bottom=i[s][c].Y);return a},t.Clipper.prototype.GetBounds2=function(i){var s=i,l=new t.IntRect;for(l.left=i.Pt.X,l.right=i.Pt.X,l.top=i.Pt.Y,l.bottom=i.Pt.Y,i=i.Next;i!==s;)i.Pt.X<l.left&&(l.left=i.Pt.X),i.Pt.X>l.right&&(l.right=i.Pt.X),i.Pt.Y<l.top&&(l.top=i.Pt.Y),i.Pt.Y>l.bottom&&(l.bottom=i.Pt.Y),i=i.Next;return l},t.Clipper.PointInPolygon=function(i,s){var l=0,a=s.length;if(a<3)return 0;for(var c=s[0],p=1;p<=a;++p){var m=p===a?s[0]:s[p];if(m.Y===i.Y&&(m.X===i.X||c.Y===i.Y&&m.X>i.X==c.X<i.X))return-1;if(c.Y<i.Y!=m.Y<i.Y){if(c.X>=i.X)if(m.X>i.X)l=1-l;else{var x=(c.X-i.X)*(m.Y-i.Y)-(m.X-i.X)*(c.Y-i.Y);if(x===0)return-1;x>0==m.Y>c.Y&&(l=1-l)}else if(m.X>i.X){var x=(c.X-i.X)*(m.Y-i.Y)-(m.X-i.X)*(c.Y-i.Y);if(x===0)return-1;x>0==m.Y>c.Y&&(l=1-l)}}c=m}return l},t.Clipper.prototype.PointInPolygon=function(i,s){var l=0,a=s,c=i.X,p=i.Y,m=s.Pt.X,x=s.Pt.Y;do{s=s.Next;var b=s.Pt.X,A=s.Pt.Y;if(A===p&&(b===c||x===p&&b>c==m<c))return-1;if(x<p!=A<p){if(m>=c)if(b>c)l=1-l;else{var U=(m-c)*(A-p)-(b-c)*(x-p);if(U===0)return-1;U>0==A>x&&(l=1-l)}else if(b>c){var U=(m-c)*(A-p)-(b-c)*(x-p);if(U===0)return-1;U>0==A>x&&(l=1-l)}}m=b,x=A}while(a!==s);return l},t.Clipper.prototype.Poly2ContainsPoly1=function(i,s){var l=i;do{var a=this.PointInPolygon(l.Pt,s);if(a>=0)return a>0;l=l.Next}while(l!==i);return!0},t.Clipper.prototype.FixupFirstLefts1=function(i,s){for(var l,a,c=0,p=this.m_PolyOuts.length;c<p;c++)l=this.m_PolyOuts[c],a=t.Clipper.ParseFirstLeft(l.FirstLeft),l.Pts!==null&&a===i&&this.Poly2ContainsPoly1(l.Pts,s.Pts)&&(l.FirstLeft=s)},t.Clipper.prototype.FixupFirstLefts2=function(i,s){for(var l=s.FirstLeft,a,c,p=0,m=this.m_PolyOuts.length;p<m;p++)a=this.m_PolyOuts[p],!(a.Pts===null||a===s||a===i)&&(c=t.Clipper.ParseFirstLeft(a.FirstLeft),!(c!==l&&c!==i&&c!==s)&&(this.Poly2ContainsPoly1(a.Pts,i.Pts)?a.FirstLeft=i:this.Poly2ContainsPoly1(a.Pts,s.Pts)?a.FirstLeft=s:(a.FirstLeft===i||a.FirstLeft===s)&&(a.FirstLeft=l)))},t.Clipper.prototype.FixupFirstLefts3=function(i,s){for(var l,a,c=0,p=this.m_PolyOuts.length;c<p;c++)l=this.m_PolyOuts[c],a=t.Clipper.ParseFirstLeft(l.FirstLeft),l.Pts!==null&&a===i&&(l.FirstLeft=s)},t.Clipper.ParseFirstLeft=function(i){for(;i!==null&&i.Pts===null;)i=i.FirstLeft;return i},t.Clipper.prototype.JoinCommonEdges=function(){for(var i=0,s=this.m_Joins.length;i<s;i++){var l=this.m_Joins[i],a=this.GetOutRec(l.OutPt1.Idx),c=this.GetOutRec(l.OutPt2.Idx);if(!(a.Pts===null||c.Pts===null)&&!(a.IsOpen||c.IsOpen)){var p;a===c?p=a:this.OutRec1RightOfOutRec2(a,c)?p=c:this.OutRec1RightOfOutRec2(c,a)?p=a:p=this.GetLowermostRec(a,c),this.JoinPoints(l,a,c)&&(a===c?(a.Pts=l.OutPt1,a.BottomPt=null,c=this.CreateOutRec(),c.Pts=l.OutPt2,this.UpdateOutPtIdxs(c),this.Poly2ContainsPoly1(c.Pts,a.Pts)?(c.IsHole=!a.IsHole,c.FirstLeft=a,this.m_UsingPolyTree&&this.FixupFirstLefts2(c,a),(c.IsHole^this.ReverseSolution)==this.Area$1(c)>0&&this.ReversePolyPtLinks(c.Pts)):this.Poly2ContainsPoly1(a.Pts,c.Pts)?(c.IsHole=a.IsHole,a.IsHole=!c.IsHole,c.FirstLeft=a.FirstLeft,a.FirstLeft=c,this.m_UsingPolyTree&&this.FixupFirstLefts2(a,c),(a.IsHole^this.ReverseSolution)==this.Area$1(a)>0&&this.ReversePolyPtLinks(a.Pts)):(c.IsHole=a.IsHole,c.FirstLeft=a.FirstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(a,c))):(c.Pts=null,c.BottomPt=null,c.Idx=a.Idx,a.IsHole=p.IsHole,p===c&&(a.FirstLeft=c.FirstLeft),c.FirstLeft=a,this.m_UsingPolyTree&&this.FixupFirstLefts3(c,a)))}}},t.Clipper.prototype.UpdateOutPtIdxs=function(i){var s=i.Pts;do s.Idx=i.Idx,s=s.Prev;while(s!==i.Pts)},t.Clipper.prototype.DoSimplePolygons=function(){for(var i=0;i<this.m_PolyOuts.length;){var s=this.m_PolyOuts[i++],l=s.Pts;if(!(l===null||s.IsOpen))do{for(var a=l.Next;a!==s.Pts;){if(t.IntPoint.op_Equality(l.Pt,a.Pt)&&a.Next!==l&&a.Prev!==l){var c=l.Prev,p=a.Prev;l.Prev=p,p.Next=l,a.Prev=c,c.Next=a,s.Pts=l;var m=this.CreateOutRec();m.Pts=a,this.UpdateOutPtIdxs(m),this.Poly2ContainsPoly1(m.Pts,s.Pts)?(m.IsHole=!s.IsHole,m.FirstLeft=s,this.m_UsingPolyTree&&this.FixupFirstLefts2(m,s)):this.Poly2ContainsPoly1(s.Pts,m.Pts)?(m.IsHole=s.IsHole,s.IsHole=!m.IsHole,m.FirstLeft=s.FirstLeft,s.FirstLeft=m,this.m_UsingPolyTree&&this.FixupFirstLefts2(s,m)):(m.IsHole=s.IsHole,m.FirstLeft=s.FirstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(s,m)),a=l}a=a.Next}l=l.Next}while(l!==s.Pts)}},t.Clipper.Area=function(i){if(!Array.isArray(i))return 0;var s=i.length;if(s<3)return 0;for(var l=0,a=0,c=s-1;a<s;++a)l+=(i[c].X+i[a].X)*(i[c].Y-i[a].Y),c=a;return-l*.5},t.Clipper.prototype.Area=function(i){var s=i;if(i===null)return 0;var l=0;do l=l+(i.Prev.Pt.X+i.Pt.X)*(i.Prev.Pt.Y-i.Pt.Y),i=i.Next;while(i!==s);return l*.5},t.Clipper.prototype.Area$1=function(i){return this.Area(i.Pts)},t.Clipper.SimplifyPolygon=function(i,s){var l=new Array,a=new t.Clipper(0);return a.StrictlySimple=!0,a.AddPath(i,t.PolyType.ptSubject,!0),a.Execute(t.ClipType.ctUnion,l,s,s),l},t.Clipper.SimplifyPolygons=function(i,s){typeof s>"u"&&(s=t.PolyFillType.pftEvenOdd);var l=new Array,a=new t.Clipper(0);return a.StrictlySimple=!0,a.AddPaths(i,t.PolyType.ptSubject,!0),a.Execute(t.ClipType.ctUnion,l,s,s),l},t.Clipper.DistanceSqrd=function(i,s){var l=i.X-s.X,a=i.Y-s.Y;return l*l+a*a},t.Clipper.DistanceFromLineSqrd=function(i,s,l){var a=s.Y-l.Y,c=l.X-s.X,p=a*s.X+c*s.Y;return p=a*i.X+c*i.Y-p,p*p/(a*a+c*c)},t.Clipper.SlopesNearCollinear=function(i,s,l,a){return Math.abs(i.X-s.X)>Math.abs(i.Y-s.Y)?i.X>s.X==i.X<l.X?t.Clipper.DistanceFromLineSqrd(i,s,l)<a:s.X>i.X==s.X<l.X?t.Clipper.DistanceFromLineSqrd(s,i,l)<a:t.Clipper.DistanceFromLineSqrd(l,i,s)<a:i.Y>s.Y==i.Y<l.Y?t.Clipper.DistanceFromLineSqrd(i,s,l)<a:s.Y>i.Y==s.Y<l.Y?t.Clipper.DistanceFromLineSqrd(s,i,l)<a:t.Clipper.DistanceFromLineSqrd(l,i,s)<a},t.Clipper.PointsAreClose=function(i,s,l){var a=i.X-s.X,c=i.Y-s.Y;return a*a+c*c<=l},t.Clipper.ExcludeOp=function(i){var s=i.Prev;return s.Next=i.Next,i.Next.Prev=s,s.Idx=0,s},t.Clipper.CleanPolygon=function(i,s){typeof s>"u"&&(s=1.415);var l=i.length;if(l===0)return new Array;for(var a=new Array(l),c=0;c<l;++c)a[c]=new t.OutPt;for(var c=0;c<l;++c)a[c].Pt=i[c],a[c].Next=a[(c+1)%l],a[c].Next.Prev=a[c],a[c].Idx=0;for(var p=s*s,m=a[0];m.Idx===0&&m.Next!==m.Prev;)t.Clipper.PointsAreClose(m.Pt,m.Prev.Pt,p)?(m=t.Clipper.ExcludeOp(m),l--):t.Clipper.PointsAreClose(m.Prev.Pt,m.Next.Pt,p)?(t.Clipper.ExcludeOp(m.Next),m=t.Clipper.ExcludeOp(m),l-=2):t.Clipper.SlopesNearCollinear(m.Prev.Pt,m.Pt,m.Next.Pt,p)?(m=t.Clipper.ExcludeOp(m),l--):(m.Idx=1,m=m.Next);l<3&&(l=0);for(var x=new Array(l),c=0;c<l;++c)x[c]=new t.IntPoint1(m.Pt),m=m.Next;return a=null,x},t.Clipper.CleanPolygons=function(i,s){for(var l=new Array(i.length),a=0,c=i.length;a<c;a++)l[a]=t.Clipper.CleanPolygon(i[a],s);return l},t.Clipper.Minkowski=function(i,s,l,a){var c=a?1:0,p=i.length,m=s.length,x=new Array;if(l)for(var b=0;b<m;b++){for(var A=new Array(p),U=0,B=i.length,H=i[U];U<B;U++,H=i[U])A[U]=new t.IntPoint2(s[b].X+H.X,s[b].Y+H.Y);x.push(A)}else for(var b=0;b<m;b++){for(var A=new Array(p),U=0,B=i.length,H=i[U];U<B;U++,H=i[U])A[U]=new t.IntPoint2(s[b].X-H.X,s[b].Y-H.Y);x.push(A)}for(var rt=new Array,b=0;b<m-1+c;b++)for(var U=0;U<p;U++){var dt=new Array;dt.push(x[b%m][U%p]),dt.push(x[(b+1)%m][U%p]),dt.push(x[(b+1)%m][(U+1)%p]),dt.push(x[b%m][(U+1)%p]),t.Clipper.Orientation(dt)||dt.reverse(),rt.push(dt)}return rt},t.Clipper.MinkowskiSum=function(i,s,l){if(s[0]instanceof Array){for(var c=s,m=new t.Paths,p=new t.Clipper,x=0;x<c.length;++x){var b=t.Clipper.Minkowski(i,c[x],!0,l);if(p.AddPaths(b,t.PolyType.ptSubject,!0),l){var a=t.Clipper.TranslatePath(c[x],i[0]);p.AddPath(a,t.PolyType.ptClip,!0)}}return p.Execute(t.ClipType.ctUnion,m,t.PolyFillType.pftNonZero,t.PolyFillType.pftNonZero),m}else{var a=s,c=t.Clipper.Minkowski(i,a,!0,l),p=new t.Clipper;return p.AddPaths(c,t.PolyType.ptSubject,!0),p.Execute(t.ClipType.ctUnion,c,t.PolyFillType.pftNonZero,t.PolyFillType.pftNonZero),c}},t.Clipper.TranslatePath=function(i,s){for(var l=new t.Path,a=0;a<i.length;a++)l.push(new t.IntPoint2(i[a].X+s.X,i[a].Y+s.Y));return l},t.Clipper.MinkowskiDiff=function(i,s){var l=t.Clipper.Minkowski(i,s,!1,!0),a=new t.Clipper;return a.AddPaths(l,t.PolyType.ptSubject,!0),a.Execute(t.ClipType.ctUnion,l,t.PolyFillType.pftNonZero,t.PolyFillType.pftNonZero),l},t.Clipper.PolyTreeToPaths=function(i){var s=new Array;return t.Clipper.AddPolyNodeToPaths(i,t.Clipper.NodeType.ntAny,s),s},t.Clipper.AddPolyNodeToPaths=function(i,s,l){var a=!0;switch(s){case t.Clipper.NodeType.ntOpen:return;case t.Clipper.NodeType.ntClosed:a=!i.IsOpen;break}i.m_polygon.length>0&&a&&l.push(i.m_polygon);for(var c=0,p=i.Childs(),m=p.length,x=p[c];c<m;c++,x=p[c])t.Clipper.AddPolyNodeToPaths(x,s,l)},t.Clipper.OpenPathsFromPolyTree=function(i){for(var s=new t.Paths,l=0,a=i.ChildCount();l<a;l++)i.Childs()[l].IsOpen&&s.push(i.Childs()[l].m_polygon);return s},t.Clipper.ClosedPathsFromPolyTree=function(i){var s=new t.Paths;return t.Clipper.AddPolyNodeToPaths(i,t.Clipper.NodeType.ntClosed,s),s},Cs(t.Clipper,t.ClipperBase),t.Clipper.NodeType={ntAny:0,ntOpen:1,ntClosed:2},t.ClipperOffset=function(i,s){typeof i>"u"&&(i=2),typeof s>"u"&&(s=t.ClipperOffset.def_arc_tolerance),this.m_destPolys=new t.Paths,this.m_srcPoly=new t.Path,this.m_destPoly=new t.Path,this.m_normals=new Array,this.m_delta=0,this.m_sinA=0,this.m_sin=0,this.m_cos=0,this.m_miterLim=0,this.m_StepsPerRad=0,this.m_lowest=new t.IntPoint0,this.m_polyNodes=new t.PolyNode,this.MiterLimit=i,this.ArcTolerance=s,this.m_lowest.X=-1},t.ClipperOffset.two_pi=6.28318530717959,t.ClipperOffset.def_arc_tolerance=.25,t.ClipperOffset.prototype.Clear=function(){t.Clear(this.m_polyNodes.Childs()),this.m_lowest.X=-1},t.ClipperOffset.Round=t.Clipper.Round,t.ClipperOffset.prototype.AddPath=function(i,s,l){var a=i.length-1;if(!(a<0)){var c=new t.PolyNode;if(c.m_jointype=s,c.m_endtype=l,l===t.EndType.etClosedLine||l===t.EndType.etClosedPolygon)for(;a>0&&t.IntPoint.op_Equality(i[0],i[a]);)a--;c.m_polygon.push(i[0]);for(var p=0,m=0,x=1;x<=a;x++)t.IntPoint.op_Inequality(c.m_polygon[p],i[x])&&(p++,c.m_polygon.push(i[x]),(i[x].Y>c.m_polygon[m].Y||i[x].Y===c.m_polygon[m].Y&&i[x].X<c.m_polygon[m].X)&&(m=p));if(!(l===t.EndType.etClosedPolygon&&p<2)&&(this.m_polyNodes.AddChild(c),l===t.EndType.etClosedPolygon))if(this.m_lowest.X<0)this.m_lowest=new t.IntPoint2(this.m_polyNodes.ChildCount()-1,m);else{var b=this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon[this.m_lowest.Y];(c.m_polygon[m].Y>b.Y||c.m_polygon[m].Y===b.Y&&c.m_polygon[m].X<b.X)&&(this.m_lowest=new t.IntPoint2(this.m_polyNodes.ChildCount()-1,m))}}},t.ClipperOffset.prototype.AddPaths=function(i,s,l){for(var a=0,c=i.length;a<c;a++)this.AddPath(i[a],s,l)},t.ClipperOffset.prototype.FixOrientations=function(){if(this.m_lowest.X>=0&&!t.Clipper.Orientation(this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon))for(var i=0;i<this.m_polyNodes.ChildCount();i++){var s=this.m_polyNodes.Childs()[i];(s.m_endtype===t.EndType.etClosedPolygon||s.m_endtype===t.EndType.etClosedLine&&t.Clipper.Orientation(s.m_polygon))&&s.m_polygon.reverse()}else for(var i=0;i<this.m_polyNodes.ChildCount();i++){var s=this.m_polyNodes.Childs()[i];s.m_endtype===t.EndType.etClosedLine&&!t.Clipper.Orientation(s.m_polygon)&&s.m_polygon.reverse()}},t.ClipperOffset.GetUnitNormal=function(i,s){var l=s.X-i.X,a=s.Y-i.Y;if(l===0&&a===0)return new t.DoublePoint2(0,0);var c=1/Math.sqrt(l*l+a*a);return l*=c,a*=c,new t.DoublePoint2(a,-l)},t.ClipperOffset.prototype.DoOffset=function(i){if(this.m_destPolys=new Array,this.m_delta=i,t.ClipperBase.near_zero(i)){for(var s=0;s<this.m_polyNodes.ChildCount();s++){var l=this.m_polyNodes.Childs()[s];l.m_endtype===t.EndType.etClosedPolygon&&this.m_destPolys.push(l.m_polygon)}return}this.MiterLimit>2?this.m_miterLim=2/(this.MiterLimit*this.MiterLimit):this.m_miterLim=.5;var a;this.ArcTolerance<=0?a=t.ClipperOffset.def_arc_tolerance:this.ArcTolerance>Math.abs(i)*t.ClipperOffset.def_arc_tolerance?a=Math.abs(i)*t.ClipperOffset.def_arc_tolerance:a=this.ArcTolerance;var c=3.14159265358979/Math.acos(1-a/Math.abs(i));this.m_sin=Math.sin(t.ClipperOffset.two_pi/c),this.m_cos=Math.cos(t.ClipperOffset.two_pi/c),this.m_StepsPerRad=c/t.ClipperOffset.two_pi,i<0&&(this.m_sin=-this.m_sin);for(var s=0;s<this.m_polyNodes.ChildCount();s++){var l=this.m_polyNodes.Childs()[s];this.m_srcPoly=l.m_polygon;var p=this.m_srcPoly.length;if(!(p===0||i<=0&&(p<3||l.m_endtype!==t.EndType.etClosedPolygon))){if(this.m_destPoly=new Array,p===1){if(l.m_jointype===t.JoinType.jtRound)for(var m=1,x=0,b=1;b<=c;b++){this.m_destPoly.push(new t.IntPoint2(t.ClipperOffset.Round(this.m_srcPoly[0].X+m*i),t.ClipperOffset.Round(this.m_srcPoly[0].Y+x*i)));var A=m;m=m*this.m_cos-this.m_sin*x,x=A*this.m_sin+x*this.m_cos}else for(var m=-1,x=-1,b=0;b<4;++b)this.m_destPoly.push(new t.IntPoint2(t.ClipperOffset.Round(this.m_srcPoly[0].X+m*i),t.ClipperOffset.Round(this.m_srcPoly[0].Y+x*i))),m<0?m=1:x<0?x=1:m=-1;this.m_destPolys.push(this.m_destPoly);continue}this.m_normals.length=0;for(var b=0;b<p-1;b++)this.m_normals.push(t.ClipperOffset.GetUnitNormal(this.m_srcPoly[b],this.m_srcPoly[b+1]));if(l.m_endtype===t.EndType.etClosedLine||l.m_endtype===t.EndType.etClosedPolygon?this.m_normals.push(t.ClipperOffset.GetUnitNormal(this.m_srcPoly[p-1],this.m_srcPoly[0])):this.m_normals.push(new t.DoublePoint1(this.m_normals[p-2])),l.m_endtype===t.EndType.etClosedPolygon){for(var U=p-1,b=0;b<p;b++)U=this.OffsetPoint(b,U,l.m_jointype);this.m_destPolys.push(this.m_destPoly)}else if(l.m_endtype===t.EndType.etClosedLine){for(var U=p-1,b=0;b<p;b++)U=this.OffsetPoint(b,U,l.m_jointype);this.m_destPolys.push(this.m_destPoly),this.m_destPoly=new Array;for(var B=this.m_normals[p-1],b=p-1;b>0;b--)this.m_normals[b]=new t.DoublePoint2(-this.m_normals[b-1].X,-this.m_normals[b-1].Y);this.m_normals[0]=new t.DoublePoint2(-B.X,-B.Y),U=0;for(var b=p-1;b>=0;b--)U=this.OffsetPoint(b,U,l.m_jointype);this.m_destPolys.push(this.m_destPoly)}else{for(var U=0,b=1;b<p-1;++b)U=this.OffsetPoint(b,U,l.m_jointype);var H;if(l.m_endtype===t.EndType.etOpenButt){var b=p-1;H=new t.IntPoint2(t.ClipperOffset.Round(this.m_srcPoly[b].X+this.m_normals[b].X*i),t.ClipperOffset.Round(this.m_srcPoly[b].Y+this.m_normals[b].Y*i)),this.m_destPoly.push(H),H=new t.IntPoint2(t.ClipperOffset.Round(this.m_srcPoly[b].X-this.m_normals[b].X*i),t.ClipperOffset.Round(this.m_srcPoly[b].Y-this.m_normals[b].Y*i)),this.m_destPoly.push(H)}else{var b=p-1;U=p-2,this.m_sinA=0,this.m_normals[b]=new t.DoublePoint2(-this.m_normals[b].X,-this.m_normals[b].Y),l.m_endtype===t.EndType.etOpenSquare?this.DoSquare(b,U):this.DoRound(b,U)}for(var b=p-1;b>0;b--)this.m_normals[b]=new t.DoublePoint2(-this.m_normals[b-1].X,-this.m_normals[b-1].Y);this.m_normals[0]=new t.DoublePoint2(-this.m_normals[1].X,-this.m_normals[1].Y),U=p-1;for(var b=U-1;b>0;--b)U=this.OffsetPoint(b,U,l.m_jointype);l.m_endtype===t.EndType.etOpenButt?(H=new t.IntPoint2(t.ClipperOffset.Round(this.m_srcPoly[0].X-this.m_normals[0].X*i),t.ClipperOffset.Round(this.m_srcPoly[0].Y-this.m_normals[0].Y*i)),this.m_destPoly.push(H),H=new t.IntPoint2(t.ClipperOffset.Round(this.m_srcPoly[0].X+this.m_normals[0].X*i),t.ClipperOffset.Round(this.m_srcPoly[0].Y+this.m_normals[0].Y*i)),this.m_destPoly.push(H)):(U=1,this.m_sinA=0,l.m_endtype===t.EndType.etOpenSquare?this.DoSquare(0,1):this.DoRound(0,1)),this.m_destPolys.push(this.m_destPoly)}}}},t.ClipperOffset.prototype.Execute=function(){var i=arguments,s=i[0]instanceof t.PolyTree;if(s){var l=i[0],a=i[1];l.Clear(),this.FixOrientations(),this.DoOffset(a);var c=new t.Clipper(0);if(c.AddPaths(this.m_destPolys,t.PolyType.ptSubject,!0),a>0)c.Execute(t.ClipType.ctUnion,l,t.PolyFillType.pftPositive,t.PolyFillType.pftPositive);else{var p=t.Clipper.GetBounds(this.m_destPolys),m=new t.Path;if(m.push(new t.IntPoint2(p.left-10,p.bottom+10)),m.push(new t.IntPoint2(p.right+10,p.bottom+10)),m.push(new t.IntPoint2(p.right+10,p.top-10)),m.push(new t.IntPoint2(p.left-10,p.top-10)),c.AddPath(m,t.PolyType.ptSubject,!0),c.ReverseSolution=!0,c.Execute(t.ClipType.ctUnion,l,t.PolyFillType.pftNegative,t.PolyFillType.pftNegative),l.ChildCount()===1&&l.Childs()[0].ChildCount()>0){var x=l.Childs()[0];l.Childs()[0]=x.Childs()[0],l.Childs()[0].m_Parent=l;for(var b=1;b<x.ChildCount();b++)l.AddChild(x.Childs()[b])}else l.Clear()}}else{var l=i[0],a=i[1];t.Clear(l),this.FixOrientations(),this.DoOffset(a);var c=new t.Clipper(0);if(c.AddPaths(this.m_destPolys,t.PolyType.ptSubject,!0),a>0)c.Execute(t.ClipType.ctUnion,l,t.PolyFillType.pftPositive,t.PolyFillType.pftPositive);else{var p=t.Clipper.GetBounds(this.m_destPolys),m=new t.Path;m.push(new t.IntPoint2(p.left-10,p.bottom+10)),m.push(new t.IntPoint2(p.right+10,p.bottom+10)),m.push(new t.IntPoint2(p.right+10,p.top-10)),m.push(new t.IntPoint2(p.left-10,p.top-10)),c.AddPath(m,t.PolyType.ptSubject,!0),c.ReverseSolution=!0,c.Execute(t.ClipType.ctUnion,l,t.PolyFillType.pftNegative,t.PolyFillType.pftNegative),l.length>0&&l.splice(0,1)}}},t.ClipperOffset.prototype.OffsetPoint=function(i,s,l){if(this.m_sinA=this.m_normals[s].X*this.m_normals[i].Y-this.m_normals[i].X*this.m_normals[s].Y,Math.abs(this.m_sinA*this.m_delta)<1){var a=this.m_normals[s].X*this.m_normals[i].X+this.m_normals[i].Y*this.m_normals[s].Y;if(a>0)return this.m_destPoly.push(new t.IntPoint2(t.ClipperOffset.Round(this.m_srcPoly[i].X+this.m_normals[s].X*this.m_delta),t.ClipperOffset.Round(this.m_srcPoly[i].Y+this.m_normals[s].Y*this.m_delta))),s}else this.m_sinA>1?this.m_sinA=1:this.m_sinA<-1&&(this.m_sinA=-1);if(this.m_sinA*this.m_delta<0)this.m_destPoly.push(new t.IntPoint2(t.ClipperOffset.Round(this.m_srcPoly[i].X+this.m_normals[s].X*this.m_delta),t.ClipperOffset.Round(this.m_srcPoly[i].Y+this.m_normals[s].Y*this.m_delta))),this.m_destPoly.push(new t.IntPoint1(this.m_srcPoly[i])),this.m_destPoly.push(new t.IntPoint2(t.ClipperOffset.Round(this.m_srcPoly[i].X+this.m_normals[i].X*this.m_delta),t.ClipperOffset.Round(this.m_srcPoly[i].Y+this.m_normals[i].Y*this.m_delta)));else switch(l){case t.JoinType.jtMiter:{var c=1+(this.m_normals[i].X*this.m_normals[s].X+this.m_normals[i].Y*this.m_normals[s].Y);c>=this.m_miterLim?this.DoMiter(i,s,c):this.DoSquare(i,s);break}case t.JoinType.jtSquare:this.DoSquare(i,s);break;case t.JoinType.jtRound:this.DoRound(i,s);break}return s=i,s},t.ClipperOffset.prototype.DoSquare=function(i,s){var l=Math.tan(Math.atan2(this.m_sinA,this.m_normals[s].X*this.m_normals[i].X+this.m_normals[s].Y*this.m_normals[i].Y)/4);this.m_destPoly.push(new t.IntPoint2(t.ClipperOffset.Round(this.m_srcPoly[i].X+this.m_delta*(this.m_normals[s].X-this.m_normals[s].Y*l)),t.ClipperOffset.Round(this.m_srcPoly[i].Y+this.m_delta*(this.m_normals[s].Y+this.m_normals[s].X*l)))),this.m_destPoly.push(new t.IntPoint2(t.ClipperOffset.Round(this.m_srcPoly[i].X+this.m_delta*(this.m_normals[i].X+this.m_normals[i].Y*l)),t.ClipperOffset.Round(this.m_srcPoly[i].Y+this.m_delta*(this.m_normals[i].Y-this.m_normals[i].X*l))))},t.ClipperOffset.prototype.DoMiter=function(i,s,l){var a=this.m_delta/l;this.m_destPoly.push(new t.IntPoint2(t.ClipperOffset.Round(this.m_srcPoly[i].X+(this.m_normals[s].X+this.m_normals[i].X)*a),t.ClipperOffset.Round(this.m_srcPoly[i].Y+(this.m_normals[s].Y+this.m_normals[i].Y)*a)))},t.ClipperOffset.prototype.DoRound=function(i,s){for(var l=Math.atan2(this.m_sinA,this.m_normals[s].X*this.m_normals[i].X+this.m_normals[s].Y*this.m_normals[i].Y),a=Math.max(t.Cast_Int32(t.ClipperOffset.Round(this.m_StepsPerRad*Math.abs(l))),1),c=this.m_normals[s].X,p=this.m_normals[s].Y,m,x=0;x<a;++x)this.m_destPoly.push(new t.IntPoint2(t.ClipperOffset.Round(this.m_srcPoly[i].X+c*this.m_delta),t.ClipperOffset.Round(this.m_srcPoly[i].Y+p*this.m_delta))),m=c,c=c*this.m_cos-this.m_sin*p,p=m*this.m_sin+p*this.m_cos;this.m_destPoly.push(new t.IntPoint2(t.ClipperOffset.Round(this.m_srcPoly[i].X+this.m_normals[i].X*this.m_delta),t.ClipperOffset.Round(this.m_srcPoly[i].Y+this.m_normals[i].Y*this.m_delta)))},t.Error=function(i){try{throw new Error(i)}catch(s){alert(s.message)}},t.JS={},t.JS.AreaOfPolygon=function(i,s){return s||(s=1),t.Clipper.Area(i)/(s*s)},t.JS.AreaOfPolygons=function(i,s){s||(s=1);for(var l=0,a=0;a<i.length;a++)l+=t.Clipper.Area(i[a]);return l/(s*s)},t.JS.BoundsOfPath=function(i,s){return t.JS.BoundsOfPaths([i],s)},t.JS.BoundsOfPaths=function(i,s){s||(s=1);var l=t.Clipper.GetBounds(i);return l.left/=s,l.bottom/=s,l.right/=s,l.top/=s,l},t.JS.Clean=function(a,s){if(!(a instanceof Array))return[];var l=a[0]instanceof Array,a=t.JS.Clone(a);if(typeof s!="number"||s===null)return t.Error("Delta is not a number in Clean()."),a;if(a.length===0||a.length===1&&a[0].length===0||s<0)return a;l||(a=[a]);for(var c=a.length,p,m,x,b,A,U,B,H=[],rt=0;rt<c;rt++)if(m=a[rt],p=m.length,p!==0){if(p<3){x=m,H.push(x);continue}for(x=m,b=s*s,A=m[0],U=1,B=1;B<p;B++)(m[B].X-A.X)*(m[B].X-A.X)+(m[B].Y-A.Y)*(m[B].Y-A.Y)<=b||(x[U]=m[B],A=m[B],U++);A=m[U-1],(m[0].X-A.X)*(m[0].X-A.X)+(m[0].Y-A.Y)*(m[0].Y-A.Y)<=b&&U--,U<p&&x.splice(U,p-U),x.length&&H.push(x)}return!l&&H.length?H=H[0]:!l&&H.length===0?H=[]:l&&H.length===0&&(H=[[]]),H},t.JS.Clone=function(i){if(!(i instanceof Array))return[];if(i.length===0)return[];if(i.length===1&&i[0].length===0)return[[]];var s=i[0]instanceof Array;s||(i=[i]);var l=i.length,a,c,p,m,x=new Array(l);for(c=0;c<l;c++){for(a=i[c].length,m=new Array(a),p=0;p<a;p++)m[p]={X:i[c][p].X,Y:i[c][p].Y};x[c]=m}return s||(x=x[0]),x},t.JS.Lighten=function(i,s){if(!(i instanceof Array))return[];if(typeof s!="number"||s===null)return t.Error("Tolerance is not a number in Lighten()."),t.JS.Clone(i);if(i.length===0||i.length===1&&i[0].length===0||s<0)return t.JS.Clone(i);var l=i[0]instanceof Array;l||(i=[i]);var a,c,p,m,x,b,A,U,B,H,rt,dt,pt,vt,Vt,oe,Oe,Ol=i.length,kl=s*s,ke=[];for(a=0;a<Ol;a++)if(p=i[a],b=p.length,b!==0){for(m=0;m<1e6;m++){for(x=[],b=p.length,p[b-1].X!==p[0].X||p[b-1].Y!==p[0].Y?(dt=1,p.push({X:p[0].X,Y:p[0].Y}),b=p.length):dt=0,rt=[],c=0;c<b-2;c++)A=p[c],B=p[c+1],U=p[c+2],oe=A.X,Oe=A.Y,pt=U.X-oe,vt=U.Y-Oe,(pt!==0||vt!==0)&&(Vt=((B.X-oe)*pt+(B.Y-Oe)*vt)/(pt*pt+vt*vt),Vt>1?(oe=U.X,Oe=U.Y):Vt>0&&(oe+=pt*Vt,Oe+=vt*Vt)),pt=B.X-oe,vt=B.Y-Oe,H=pt*pt+vt*vt,H<=kl&&(rt[c+1]=1,c++);for(x.push({X:p[0].X,Y:p[0].Y}),c=1;c<b-1;c++)rt[c]||x.push({X:p[c].X,Y:p[c].Y});if(x.push({X:p[b-1].X,Y:p[b-1].Y}),dt&&p.pop(),rt.length)p=x;else break}b=x.length,x[b-1].X===x[0].X&&x[b-1].Y===x[0].Y&&x.pop(),x.length>2&&ke.push(x)}return l||(ke=ke[0]),typeof ke>"u"&&(ke=[]),ke},t.JS.PerimeterOfPath=function(i,s,l){if(typeof i>"u")return 0;var a=Math.sqrt,c=0,p,m,x=0,b=0,A=0,U=0,B=i.length;if(B<2)return 0;for(s&&(i[B]=i[0],B++);--B;)p=i[B],x=p.X,b=p.Y,m=i[B-1],A=m.X,U=m.Y,c+=a((x-A)*(x-A)+(b-U)*(b-U));return s&&i.pop(),c/l},t.JS.PerimeterOfPaths=function(i,s,l){l||(l=1);for(var a=0,c=0;c<i.length;c++)a+=t.JS.PerimeterOfPath(i[c],s,l);return a},t.JS.ScaleDownPath=function(i,s){var l,a;for(s||(s=1),l=i.length;l--;)a=i[l],a.X=a.X/s,a.Y=a.Y/s},t.JS.ScaleDownPaths=function(i,s){var l,a,c;for(s||(s=1),l=i.length;l--;)for(a=i[l].length;a--;)c=i[l][a],c.X=c.X/s,c.Y=c.Y/s},t.JS.ScaleUpPath=function(i,s){var l,a,c=Math.round;for(s||(s=1),l=i.length;l--;)a=i[l],a.X=c(a.X*s),a.Y=c(a.Y*s)},t.JS.ScaleUpPaths=function(i,s){var l,a,c,p=Math.round;for(s||(s=1),l=i.length;l--;)for(a=i[l].length;a--;)c=i[l][a],c.X=p(c.X*s),c.Y=p(c.Y*s)},t.ExPolygons=function(){return[]},t.ExPolygon=function(){this.outer=null,this.holes=null},t.JS.AddOuterPolyNodeToExPolygons=function(i,s){var l=new t.ExPolygon;l.outer=i.Contour();var a=i.Childs(),c=a.length;l.holes=new Array(c);var p,m,x,b,A,U;for(x=0;x<c;x++)for(p=a[x],l.holes[x]=p.Contour(),b=0,A=p.Childs(),U=A.length;b<U;b++)m=A[b],t.JS.AddOuterPolyNodeToExPolygons(m,s);s.push(l)},t.JS.ExPolygonsToPaths=function(i){var s,l,a,c,p=new t.Paths;for(s=0,a=i.length;s<a;s++)for(p.push(i[s].outer),l=0,c=i[s].holes.length;l<c;l++)p.push(i[s].holes[l]);return p},t.JS.PolyTreeToExPolygons=function(i){var s=new t.ExPolygons,l,a,c,p;for(a=0,c=i.Childs(),p=c.length;a<p;a++)l=c[a],t.JS.AddOuterPolyNodeToExPolygons(l,s);return s}})()}(zi)),zi.exports}var Xo=Fo();const Re=Bo(Xo);function Do(e,t){const n=e.map(_=>({X:_.x*1e6,Y:_.y*1e6})),o=t.map(_=>({X:_.x*1e6,Y:_.y*1e6})),h=new Re.Clipper,f=[];if(h.AddPath(n,Re.PolyType.ptSubject,!0),h.AddPath(o,Re.PolyType.ptClip,!0),!h.Execute(Re.ClipType.ctIntersection,f,Re.PolyFillType.pftNonZero,Re.PolyFillType.pftNonZero))throw new Error("   .");return f.map(_=>_.map(y=>({x:y.X/1e6,y:y.Y/1e6})))}function hr(e){for(var t=e.length,r=0,n=0;n<t;n++)r+=e[n%t].x*e[(n+1)%t].y-e[n%t].y*e[(n+1)%t].x;return Math.abs(r/2)}const en=document.getElementById("stateViewerContent"),sn={COLOR:"#000000",STROKE:3,DASHLINE:[],SNAP_RIGHT:!0,SHIFT:!1,SHIFTTOOL:!1,RCLICK2ERASE:!0,SNAP_DEG:2.5,PEN_MIN_DIST:1,TEXT_RES:1.5,IMAGE_GLOBAL_PADDING:Math.min(window.innerWidth,window.innerHeight)*.25,MIN_SELECT_PERCENT:.1,EXPORT_IMAGE_SCALE:3,LITTLE_MOVE_MULTIPLIER:.4,CLIPBOARD_PREFIX:"[aris_is_love]!",SAVE_EXTENSION:".aris"};let re={...sn};const fr={COLOR:" ",STROKE:" ",SNAP_RIGHT:"45     45 ",SNAP_DEG:"   ",RCLICK2ERASE:"  ",PEN_MIN_DIST:"   ",TEXT_RES:"  ",IMAGE_GLOBAL_PADDING:"/      ",MIN_SELECT_PERCENT:"    ",EXPORT_IMAGE_SCALE:"  ",LITTLE_MOVE_MULTIPLIER:"Shift   ",CLIPBOARD_PREFIX:"    ",SAVE_EXTENSION:"  "};function Yo(e,t){const r=document.createElement("tr"),n=document.createElement("td"),o=document.createElement("td"),h=document.createElement("input");if(h.style.width="100%",typeof t=="string")h.type="text",h.value=t;else if(typeof t=="boolean")h.type="checkbox",h.checked=t;else if(typeof t=="number")h.type="number",h.value=t.toString();else return null;if(n.innerText=e,n.style.fontSize=".8rem",n.style.fontFamily="monospace",h.oninput=()=>{re[e]=h.type=="text"?h.value:h.type=="number"?parseFloat(h.value):h.checked},h.setAttribute("data-svc-key",e),o.appendChild(h),r.appendChild(n),r.appendChild(o),e in fr){const f=document.createElement("div");f.style.display="flex",f.style.flexDirection="column",f.style.alignItems="flex-start",f.style.justifyContent="center";const u=document.createElement("span");u.innerText=e;const d=document.createElement("span");d.innerText=fr[e],d.style.fontSize=".6rem",d.style.color="#666",d.style.fontFamily="var(--Font-base)",f.appendChild(u),f.appendChild(d),n.innerHTML="",n.appendChild(f)}return r}function Dt(e){return re[e]}function Se(e,t){re[e]=t,console.log(`State updated: ${e} = ${t}`);const r=en.querySelector(`input[data-svc-key="${e}"]`);r&&(typeof t=="string"?r.value=t:typeof t=="boolean"?r.checked=t:typeof t=="number"&&(r.value=t.toString())),localStorage.setItem("state",JSON.stringify(re))}if(localStorage.getItem("state"))try{re=JSON.parse(localStorage.getItem("state"))}catch{re={...sn}}window.getState=Dt;window.setState=Se;window.state=re;function va(){return re.SHIFT||re.SHIFTTOOL}for(const e in re){const t=Yo(e,re[e]);if(t)for(const r of[t])en.appendChild(r)}var wr;(wr=document.getElementById("st-saf"))==null||wr.addEventListener("click",()=>{const e=document.createElement("a");e.href=URL.createObjectURL(new Blob([JSON.stringify(re)],{type:"application/json"})),e.download="canvas_config.json",e.click()});var Ir;(Ir=document.getElementById("st-lff"))==null||Ir.addEventListener("click",()=>{const e=document.createElement("input");e.type="file",e.accept=".json",e.addEventListener("change",t=>{const r=t.target;if(!r)return;const n=r.files;if(!n||n.length==0)return;const o=n[0],h=new FileReader;h.onload=f=>{var d;const u=(d=f.target)==null?void 0:d.result;if(u)try{const _=JSON.parse(u);for(const y in _)Se(y,_[y])}catch(_){console.error(_),alert("    .")}},h.readAsText(o)}),e.click()});class Uo{constructor(t){qt(this,"id");qt(this,"root");qt(this,"two");qt(this,"twoElements",{});qt(this,"cachecdPolygon",{});qt(this,"canvasData",{});qt(this,"focused",!0);qt(this,"renderRequested",!1);qt(this,"history",[[]]);qt(this,"lastID",0);console.log("Instance created"),this.id=No(),this.root=document.createElement("div"),this.root.id=this.id,this.root.className="instance",this.two=new j({fullscreen:!0}),this.two.appendTo(this.root),t.appendChild(this.root),this.setupRequestFrame()}getNewID(){return this.lastID++}setFocused(t){this.focused=t}focus(){this.focused=!0}blur(){this.focused=!1}requestRender(){this.renderRequested=!0}setupRequestFrame(){const t=()=>{if(!this.focused)return requestAnimationFrame(t);this.renderRequested&&(this.renderRequested=!1,this.two.update()),requestAnimationFrame(t)};t()}appendRectangle(t){const r=[new j.Anchor(t.x,t.y),new j.Anchor(t.x+t.width,t.y),new j.Anchor(t.x+t.width,t.y+t.height),new j.Anchor(t.x,t.y+t.height)],n=this.two.makePath(r);n.fill=t.fillColor,n.stroke=t.strokeColor,n.linewidth=t.strokeWidth;const o=this.getNewID();return this.twoElements[o]=n,this.cachecdPolygon[o]=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}],o}appendCircle(t){const r=Mo(t.x,t.y,t.xRadius,t.yRadius,360),n=[...r].map(f=>new j.Anchor(f.x,f.y)),o=this.two.makePath(n);o.fill=t.fillColor,o.stroke=t.strokeColor,o.linewidth=t.strokeWidth;const h=this.getNewID();return this.twoElements[h]=o,this.cachecdPolygon[h]=[...r],h}appendTriangle(t){const r=this.two.makePath([new j.Anchor(t.x1,t.y1),new j.Anchor(t.x2,t.y2),new j.Anchor(t.x3,t.y3)]);r.fill=t.fillColor,r.stroke=t.strokeColor,r.linewidth=t.strokeWidth;const n=this.getNewID();return this.twoElements[n]=r,this.cachecdPolygon[n]=[{x:t.x1,y:t.y1},{x:t.x2,y:t.y2},{x:t.x3,y:t.y3}],n}appendPenPath(t){const r=ji([...t.points],t.strokeWidth),n=this.getNewID();this.cachecdPolygon[n]=[...r];const o=this.two.makePath(t.points.map(h=>new j.Anchor(h.x,h.y)),!1,!0);return o.stroke=t.strokeColor,o.linewidth=t.strokeWidth,o.fill="transparent",this.twoElements[n]=o,this.canvasData[n]="PEN",n}appendLine(t){const r=this.two.makePath([new j.Anchor(t.x1,t.y1),new j.Anchor(t.x2,t.y2)]);r.stroke=t.strokeColor,r.linewidth=t.strokeWidth,r.dashes=t.dashArray||[];const n=this.getNewID();return this.twoElements[n]=r,this.cachecdPolygon[n]=Ro({x:t.x1,y:t.y1},{x:t.x2,y:t.y2},t.strokeWidth),n}appendImage(t){const r=new j.Texture(t.image,()=>{}),n=this.two.makeSprite(r,t.x,t.y);n.width=t.width,n.height=t.height,n.rotation=t.rotate,n.position=new j.Vector(t.x,t.y);const o=t.width/r.image.width,h=t.height/r.image.height;n.scale=new j.Vector(o,h);const f=this.getNewID();this.twoElements[f]=n;let u=t.width/2,d=t.height/2;return this.cachecdPolygon[f]=[{x:t.x-u,y:t.y-d},{x:t.x+u,y:t.y-d},{x:t.x+u,y:t.y+d},{x:t.x-u,y:t.y+d}],f}toTop(t){if(Array.isArray(t)){for(const n of t)this.toTop(n);return}const r=this.twoElements[t];this.two.scene.add(r)}clear(){this.two.clear(),this.twoElements=[]}setTransform(t,r,n){const o=this.twoElements[t];if(typeof n>"u"){o.translation.set(r,r);return}o.translation.set(r,n)}transform(t,r,n){this.twoElements[t].translation.add(new j.Vector(r,n))}rotate(t,r){const n=this.twoElements[t];n.rotation+=r}rotateAbout(t,r,n,o){const h=this.twoElements[t],f=h.translation.x,u=h.translation.y,d=f-n,_=u-o,y=Math.cos(r),P=Math.sin(r),w=d*y-_*P,v=d*P+_*y;h.translation.set(w+n,v+o);const C=typeof h.scale=="number"?h.scale:h.scale.x,k=typeof h.scale=="number"?h.scale:h.scale.y,L=C>=0?1:-1,O=k>=0?1:-1;h.rotation+=r*L*O}setRotate(t,r){const n=this.twoElements[t];n.rotation=r}setScale(t,r,n){const o=this.twoElements[t];if(typeof n>"u"){o.scale=r;return}else o.scale=new j.Vector(r,n)}scaleAboutSelf(t,r,n){const o=this.twoElements[t],h=o.scale;typeof h=="number"?o.scale=new j.Vector(h*r,h*r):o.scale=new j.Vector(h.x*r,h.y*n)}scaleAboutRect(t,r,n,o){const h=this.twoElements[t],f=h.translation,u=h.scale;typeof u=="number"?h.scale=new j.Vector(u*n,u*o):h.scale=new j.Vector(u.x*n,u.y*o),h.translation.x=f.x*n+(1-n)*r.x,h.translation.y=f.y*o+(1-o)*r.y}flipX(t,r){const n=this.twoElements[t],o=n.translation,h=n.scale;typeof h=="number"?n.scale=new j.Vector(-h,h):n.scale=new j.Vector(-h.x,h.y),n.translation.x=2*r-o.x,this.cachePolygon(t)}flipY(t,r){const n=this.twoElements[t],o=n.translation,h=n.scale;typeof h=="number"?n.scale=new j.Vector(h,-h):n.scale=new j.Vector(h.x,-h.y),n.translation.y=2*r-o.y,this.cachePolygon(t)}cloneObject(t){const r=this.twoElements[t],n=this.two.makePath(r.vertices.map(h=>new j.Anchor(h.x,h.y)),!1,!0);n.fill=r.fill,n.stroke=r.stroke,n.linewidth=r.linewidth+0,n.translation=new j.Vector(r.translation.x,r.translation.y),n.rotation=r.rotation+0,n.scale=new j.Vector(typeof r.scale=="number"?r.scale+0:r.scale.x+0,typeof r.scale=="number"?r.scale+0:r.scale.y+0),n.dashes=[...r.dashes];const o=this.getNewID();return this.twoElements[o]=n,this.cachecdPolygon[o]=[...this.cachecdPolygon[t]],this.canvasData[o]=this.canvasData[t],o}cachePolygon(t){const r=this.twoElements[t],n=typeof r.scale=="number"?r.scale:r.scale.x,o=typeof r.scale=="number"?r.scale:r.scale.y;this.cachecdPolygon[t]=r.vertices.map(h=>{const f=Math.cos(r.rotation),u=Math.sin(r.rotation),d=h.x*n,_=h.y*o,y=d*f-_*u,P=d*u+_*f;return{x:y+r.position.x,y:P+r.position.y}})}removeElement(t){this.twoElements[t].remove(),delete this.twoElements[t],delete this.cachecdPolygon[t]}removeAt(t){const r=[];for(const n in this.twoElements)or(t,this.cachecdPolygon[n])&&(this.removeElement(Number(n)),r.push(Number(n)));return r}lassoSelect(t){const r=[];for(const n in this.twoElements){const o=Do(this.cachecdPolygon[Number(n)],t);if(o.length==0)continue;let h=0;const f=hr(this.cachecdPolygon[Number(n)]);for(const u of o)h+=hr(u);h>=f*Dt("MIN_SELECT_PERCENT")&&r.push(Number(n))}return r}pointSelect(t){let r=-1,n=-1;for(const o in this.twoElements)or(t,this.cachecdPolygon[Number(o)])&&Number(o)>r&&(r=Number(o),n=Number(o));return n!==-1?[n]:[]}saveAsHistory(){const t=Object.keys(this.twoElements).map(r=>this.exportElement(Number(r)));this.history.push(t),this.history.length>100&&this.history.shift()}undo(){if(this.history.length<=1)return;this.history.pop();const t=this.history[this.history.length-1];this.clear();for(const r of t)if(r.type==="image")this.appendImage(r);else{const n=this.getNewID();this.twoElements[n]=r.isPen?this.two.makePath(r.points.map(h=>new j.Anchor(h.x,h.y)),!1,!0):this.two.makePath(r.points.map(h=>new j.Anchor(h.x,h.y)));const o=this.twoElements[n];o.fill=r.fillColor,o.stroke=r.strokeColor,o.linewidth=r.strokeWidth,o.dashes=r.dash,o.rotation=r.rotation,o.scale=r.scale}}exportElement(t,r){const n=this.twoElements[t],o=n.position;if(n instanceof j.Sprite){let h=n.texture.image;return r?new Promise(async f=>{const u=document.createElement("canvas"),d=u.getContext("2d");u.width=h.width,u.height=h.height,d.drawImage(h,0,0);const _=u.toDataURL("image/webp"),y=await fetch(_).then(P=>P.arrayBuffer());f({type:"image",x:o.x,y:o.y,width:n.width*(typeof n.scale=="number"?n.scale:n.scale.x),height:n.height*(typeof n.scale=="number"?n.scale:n.scale.y),rotate:n.rotation,image:y,scale:typeof n.scale=="number"?n.scale:{x:n.scale.x,y:n.scale.y},canvasData:this.canvasData[t]})}):{type:"image",x:o.x,y:o.y,width:n.texture.image.width*(typeof n.scale=="number"?n.scale:n.scale.x),height:n.texture.image.height*(typeof n.scale=="number"?n.scale:n.scale.y),rotate:n.rotation,image:h,scale:typeof n.scale=="number"?n.scale:{x:n.scale.x,y:n.scale.y}}}return{type:"path",points:n.vertices.map(h=>({x:h.x+o.x,y:h.y+o.y})),rotation:n.rotation,scale:typeof n.scale=="number"?n.scale:{x:n.scale.x,y:n.scale.y},fillColor:n.fill,strokeColor:n.stroke,strokeWidth:n.linewidth,dash:n.dashes,isPen:this.canvasData[t]==="PEN",cnavasData:this.canvasData[t]}}async getClipboardData(t){const r=[];for(const n of t)r.push(await this.exportElement(n,!0));return r}exportAsImage(){const t=this.two.renderer.domElement,r=new XMLSerializer().serializeToString(t),n=document.createElement("canvas"),o=n.getContext("2d");if(!o)return Promise.reject("Failed to get 2d context");const h=new Image,f=new Blob([r],{type:"image/svg+xml"}),u=URL.createObjectURL(f);return new Promise(d=>{h.onload=()=>{n.width=h.width*Dt("EXPORT_IMAGE_SCALE"),n.height=h.height*Dt("EXPORT_IMAGE_SCALE"),o.drawImage(h,0,0,n.width,n.height),URL.revokeObjectURL(u),d(n.toDataURL("image/png"))},h.src=u})}async exportAsJSON(){return await Promise.all(Object.keys(this.twoElements).map(r=>this.exportElement(Number(r),!0)))}async importFromJSON(t){this.clear();for(const r of t)if(r.type==="image"){const n=new Image,o=new Blob([r.image],{type:"image/webp"});await new Promise(h=>{n.onload=()=>{n.onload=null;const u=this.appendImage({x:r.x,y:r.y,width:r.width,height:r.height,image:n,rotate:r.rotate});this.twoElements[u].rotation=r.rotate,typeof r.scale=="number"?this.twoElements[u].scale=new j.Vector(r.scale,r.scale):this.twoElements[u].scale=new j.Vector(r.scale.x,r.scale.y),h()};const f=URL.createObjectURL(o);n.src=f})}else{const n=this.getNewID();this.twoElements[n]=r.isPen?this.two.makePath(r.points.map(u=>new j.Anchor(u.x,u.y)),!1,!0):this.two.makePath(r.points.map(u=>new j.Anchor(u.x,u.y)));const o=this.twoElements[n];o.fill=r.fillColor,o.stroke=r.strokeColor,o.linewidth=r.strokeWidth,o.dashes=r.dash,o.rotation=r.rotation,o.scale=r.scale;const h=r.points.map(u=>({x:u.x,y:u.y})),f=ji(h,r.strokeWidth);this.cachecdPolygon[n]=[...f],this.canvasData[n]=r.isPen?"PEN":"PATH"}this.requestRender()}async importFromClipboard(t){let r=[];for(const n of t)if(n.type==="image"){const o=new Image,h=new Blob([n.image],{type:"image/webp"});await new Promise(f=>{o.onload=()=>{o.onload=null;const d=this.appendImage({x:n.x,y:n.y,width:n.width,height:n.height,image:o,rotate:n.rotate});r.push(d),this.twoElements[d].rotation=n.rotate,typeof n.scale=="number"?this.twoElements[d].scale=new j.Vector(n.scale,n.scale):this.twoElements[d].scale=new j.Vector(n.scale.x,n.scale.y),f()};const u=URL.createObjectURL(h);o.src=u})}else{const o=this.getNewID();r.push(o),this.twoElements[o]=n.isPen?this.two.makePath(n.points.map(d=>new j.Anchor(d.x,d.y)),!1,!0):this.two.makePath(n.points.map(d=>new j.Anchor(d.x,d.y)));const h=this.twoElements[o];h.fill=n.fillColor,h.stroke=n.strokeColor,h.linewidth=n.strokeWidth,h.dashes=n.dash,h.rotation=n.rotation,h.scale=n.scale;const f=n.points.map(d=>({x:d.x,y:d.y})),u=ji(f,n.strokeWidth);this.cachecdPolygon[o]=[...u],this.canvasData[o]=n.isPen?"PEN":"PATH"}return this.requestRender(),this.saveAsHistory(),r}destroy(){this.two.clear(),this.two.unbind(),this.root.remove()}}class Wo{constructor(t){qt(this,"root");qt(this,"instances",[]);qt(this,"focusedInstance",-1);console.log("InstanceManager created"),this.root=t}createInstance(){const t=new Uo(this.root);return t.root.style.display="none",this.instances.push(t),this.instances.length-1}focusInstance(t){this.focusedInstance!=-1&&(this.instances[this.focusedInstance].root.style.display="none"),this.focusedInstance=t,this.instances[this.focusedInstance].root.style.display="block"}nextInstance(){this.focusedInstance+1<this.instances.length?this.focusInstance(this.focusedInstance+1):(this.createInstance(),this.focusInstance(this.focusedInstance+1))}prevInstance(){this.focusedInstance-1>=0&&this.focusInstance(this.focusedInstance-1)}get focused(){return this.instances[this.focusedInstance]}clear(){this.instances.forEach(t=>t.destroy()),this.instances=[],this.focusedInstance=-1}}const Vo="modulepreload",qo=function(e,t){return new URL(e,t).href},cr={},rn=function(t,r,n){let o=Promise.resolve();if(r&&r.length>0){const f=document.getElementsByTagName("link"),u=document.querySelector("meta[property=csp-nonce]"),d=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));o=Promise.allSettled(r.map(_=>{if(_=qo(_,n),_ in cr)return;cr[_]=!0;const y=_.endsWith(".css"),P=y?'[rel="stylesheet"]':"";if(!!n)for(let C=f.length-1;C>=0;C--){const k=f[C];if(k.href===_&&(!y||k.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${_}"]${P}`))return;const v=document.createElement("link");if(v.rel=y?"stylesheet":Vo,y||(v.as="script"),v.crossOrigin="",v.href=_,d&&v.setAttribute("nonce",d),document.head.appendChild(v),y)return new Promise((C,k)=>{v.addEventListener("load",C),v.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${_}`)))})}))}function h(f){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=f,window.dispatchEvent(u),!u.defaultPrevented)throw f}return o.then(f=>{for(const u of f||[])u.status==="rejected"&&h(u.reason);return t().catch(h)})};function jo(){let e=0;const t=document.querySelectorAll(".colorwrp");t.forEach((r,n)=>{r.children[0].style.background=r.children[1].value,r.addEventListener("click",()=>{e==n?r.children[1].click():t[e].classList.remove("focus"),e=n,r.classList.add("focus"),Se("COLOR",r.children[1].value)}),r.children[1].addEventListener("input",()=>{r.children[0].style.background=r.children[1].value,Se("COLOR",r.children[1].value)})})}function zo(){var t,r;const e=()=>{const n=document.getElementById("pageindi");n&&(n.innerText=`${ue.focusedInstance+1}/${ue.instances.length}`)};(t=document.getElementById("right"))==null||t.addEventListener("click",()=>{ue.nextInstance(),e()}),(r=document.getElementById("left"))==null||r.addEventListener("click",()=>{ue.prevInstance(),e()})}function Ho(){const e=document.querySelectorAll("#strokes > .strkel"),t=document.getElementById("selstk"),r=[3,9,15];e.forEach((n,o)=>{n.addEventListener("click",()=>{t&&(t.style.left=`calc(1.5rem * ${o})`),Se("STROKE",r[o])})})}let nn={};function Pa(e,t){console.log(`Function registered: ${e}`),nn[e]=t}let Ri={},Hi=null;function ba(e,t,r=!1){console.log(`Tool registered: ${e}`),Ri[e]=t,r&&ln(e)}function ln(e,t=!1){console.log(`Tool applied: ${e}`),Hi&&Hi(),Hi=Ri[e].apply(t)}let fi=0;function Go(e){const t=document.querySelector(`.tool-button[data-tool="${e}"]`);t&&t.click()}function Zo(){jo(),Ho(),zo();const e=document.querySelectorAll(".tool-button");e.forEach((t,r)=>{const n=t.getAttribute("data-tool");n&&t.addEventListener("click",()=>{fi===r&&!Ri[n].callEvenSelected||(e[fi].classList.remove("active"),t.classList.add("active"),console.log(`Tool selected: ${n}`),ln(n,fi===r),fi=r)})}),document.querySelectorAll(".function-button").forEach(t=>{const r=t.getAttribute("data-function");r&&t.addEventListener("click",()=>{console.log(`Function selected: ${r}`),nn[r]()})}),document.addEventListener("keydown",t=>{t.keyCode===16&&Se("SHIFT",!0)}),document.addEventListener("keyup",t=>{t.keyCode===16&&Se("SHIFT",!1)})}rn(()=>import("./index-BW9lNdkz.js").then(e=>e.i),[],import.meta.url);rn(()=>import("./index-WdRkcSPz.js"),[],import.meta.url);let ss;try{ss=new TextDecoder}catch{}let J,Te,M=0;const Jo=105,Ko=57342,$o=57343,ur=57337,dr=6,Be={};let je=11281e4,pe=1681e4,_t={},St,Ti,Ei=0,Qe=0,Mt,ie,Ot=[],rs=[],jt,Wt,Ze,pr={useRecords:!1,mapsAsObjects:!0},ti=!1,on=2;try{new Function("")}catch{on=1/0}class ei{constructor(t){if(t&&((t.keyMap||t._keyMap)&&!t.useRecords&&(t.useRecords=!1,t.mapsAsObjects=!0),t.useRecords===!1&&t.mapsAsObjects===void 0&&(t.mapsAsObjects=!0),t.getStructures&&(t.getShared=t.getStructures),t.getShared&&!t.structures&&((t.structures=[]).uninitialized=!0),t.keyMap)){this.mapKey=new Map;for(let[r,n]of Object.entries(t.keyMap))this.mapKey.set(n,r)}Object.assign(this,t)}decodeKey(t){return this.keyMap&&this.mapKey.get(t)||t}encodeKey(t){return this.keyMap&&this.keyMap.hasOwnProperty(t)?this.keyMap[t]:t}encodeKeys(t){if(!this._keyMap)return t;let r=new Map;for(let[n,o]of Object.entries(t))r.set(this._keyMap.hasOwnProperty(n)?this._keyMap[n]:n,o);return r}decodeKeys(t){if(!this._keyMap||t.constructor.name!="Map")return t;if(!this._mapKey){this._mapKey=new Map;for(let[n,o]of Object.entries(this._keyMap))this._mapKey.set(o,n)}let r={};return t.forEach((n,o)=>r[se(this._mapKey.has(o)?this._mapKey.get(o):o)]=n),r}mapDecode(t,r){let n=this.decode(t);if(this._keyMap)switch(n.constructor.name){case"Array":return n.map(o=>this.decodeKeys(o))}return n}decode(t,r){if(J)return cn(()=>(as(),this?this.decode(t,r):ei.prototype.decode.call(pr,t,r)));Te=r>-1?r:t.length,M=0,Qe=0,Ti=null,Mt=null,J=t;try{Wt=t.dataView||(t.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength))}catch(n){throw J=null,t instanceof Uint8Array?n:new Error("Source must be a Uint8Array or Buffer but was a "+(t&&typeof t=="object"?t.constructor.name:typeof t))}if(this instanceof ei){if(_t=this,jt=this.sharedValues&&(this.pack?new Array(this.maxPrivatePackedValues||16).concat(this.sharedValues):this.sharedValues),this.structures)return St=this.structures,ci();(!St||St.length>0)&&(St=[])}else _t=pr,(!St||St.length>0)&&(St=[]),jt=null;return ci()}decodeMultiple(t,r){let n,o=0;try{let h=t.length;ti=!0;let f=this?this.decode(t,h):vs.decode(t,h);if(r){if(r(f)===!1)return;for(;M<h;)if(o=M,r(ci())===!1)return}else{for(n=[f];M<h;)o=M,n.push(ci());return n}}catch(h){throw h.lastPosition=o,h.values=n,h}finally{ti=!1,as()}}}function ci(){try{let e=gt();if(Mt){if(M>=Mt.postBundlePosition){let t=new Error("Unexpected bundle position");throw t.incomplete=!0,t}M=Mt.postBundlePosition,Mt=null}if(M==Te)St=null,J=null,ie&&(ie=null);else if(M>Te){let t=new Error("Unexpected end of CBOR data");throw t.incomplete=!0,t}else if(!ti)throw new Error("Data read, but end of buffer not reached");return e}catch(e){throw as(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer"))&&(e.incomplete=!0),e}}function gt(){let e=J[M++],t=e>>5;if(e=e&31,e>23)switch(e){case 24:e=J[M++];break;case 25:if(t==7)return ia();e=Wt.getUint16(M),M+=2;break;case 26:if(t==7){let r=Wt.getFloat32(M);if(_t.useFloat32>2){let n=xs[(J[M]&127)<<1|J[M+1]>>7];return M+=4,(n*r+(r>0?.5:-.5)>>0)/n}return M+=4,r}e=Wt.getUint32(M),M+=4;break;case 27:if(t==7){let r=Wt.getFloat64(M);return M+=8,r}if(t>1){if(Wt.getUint32(M)>0)throw new Error("JavaScript does not support arrays, maps, or strings with length over 4294967295");e=Wt.getUint32(M+4)}else _t.int64AsNumber?(e=Wt.getUint32(M)*4294967296,e+=Wt.getUint32(M+4)):e=Wt.getBigUint64(M);M+=8;break;case 31:switch(t){case 2:case 3:throw new Error("Indefinite length not supported for byte or text strings");case 4:let r=[],n,o=0;for(;(n=gt())!=Be;){if(o>=je)throw new Error(`Array length exceeds ${je}`);r[o++]=n}return t==4?r:t==3?r.join(""):Buffer.concat(r);case 5:let h;if(_t.mapsAsObjects){let f={},u=0;if(_t.keyMap)for(;(h=gt())!=Be;){if(u++>=pe)throw new Error(`Property count exceeds ${pe}`);f[se(_t.decodeKey(h))]=gt()}else for(;(h=gt())!=Be;){if(u++>=pe)throw new Error(`Property count exceeds ${pe}`);f[se(h)]=gt()}return f}else{Ze&&(_t.mapsAsObjects=!0,Ze=!1);let f=new Map;if(_t.keyMap){let u=0;for(;(h=gt())!=Be;){if(u++>=pe)throw new Error(`Map size exceeds ${pe}`);f.set(_t.decodeKey(h),gt())}}else{let u=0;for(;(h=gt())!=Be;){if(u++>=pe)throw new Error(`Map size exceeds ${pe}`);f.set(h,gt())}}return f}case 7:return Be;default:throw new Error("Invalid major type for indefinite length "+t)}default:throw new Error("Unknown token "+e)}switch(t){case 0:return e;case 1:return~e;case 2:return ea(e);case 3:if(Qe>=M)return Ti.slice(M-Ei,(M+=e)-Ei);if(Qe==0&&Te<140&&e<32){let o=e<16?an(e):ta(e);if(o!=null)return o}return Qo(e);case 4:if(e>=je)throw new Error(`Array length exceeds ${je}`);let r=new Array(e);for(let o=0;o<e;o++)r[o]=gt();return r;case 5:if(e>=pe)throw new Error(`Map size exceeds ${je}`);if(_t.mapsAsObjects){let o={};if(_t.keyMap)for(let h=0;h<e;h++)o[se(_t.decodeKey(gt()))]=gt();else for(let h=0;h<e;h++)o[se(gt())]=gt();return o}else{Ze&&(_t.mapsAsObjects=!0,Ze=!1);let o=new Map;if(_t.keyMap)for(let h=0;h<e;h++)o.set(_t.decodeKey(gt()),gt());else for(let h=0;h<e;h++)o.set(gt(),gt());return o}case 6:if(e>=ur){let o=St[e&8191];if(o)return o.read||(o.read=ns(o)),o.read();if(e<65536){if(e==$o){let h=De(),f=gt(),u=gt();os(f,u);let d={};if(_t.keyMap)for(let _=2;_<h;_++){let y=_t.decodeKey(u[_-2]);d[se(y)]=gt()}else for(let _=2;_<h;_++){let y=u[_-2];d[se(y)]=gt()}return d}else if(e==Ko){let h=De(),f=gt();for(let u=2;u<h;u++)os(f++,gt());return gt()}else if(e==ur)return aa();if(_t.getShared&&(ys(),o=St[e&8191],o))return o.read||(o.read=ns(o)),o.read()}}let n=Ot[e];if(n)return n.handlesRead?n(gt):n(gt());{let o=gt();for(let h=0;h<rs.length;h++){let f=rs[h](e,o);if(f!==void 0)return f}return new Ve(o,e)}case 7:switch(e){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;case 31:default:let o=(jt||Ce())[e];if(o!==void 0)return o;throw new Error("Unknown token "+e)}default:if(isNaN(e)){let o=new Error("Unexpected end of CBOR data");throw o.incomplete=!0,o}throw new Error("Unknown CBOR token "+e)}}const _r=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function ns(e){if(!e)throw new Error("Structure is required in record definition");function t(){let r=J[M++];if(r=r&31,r>23)switch(r){case 24:r=J[M++];break;case 25:r=Wt.getUint16(M),M+=2;break;case 26:r=Wt.getUint32(M),M+=4;break;default:throw new Error("Expected array header, but got "+J[M-1])}let n=this.compiledReader;for(;n;){if(n.propertyCount===r)return n(gt);n=n.next}if(this.slowReads++>=on){let h=this.length==r?this:this.slice(0,r);return n=_t.keyMap?new Function("r","return {"+h.map(f=>_t.decodeKey(f)).map(f=>_r.test(f)?se(f)+":r()":"["+JSON.stringify(f)+"]:r()").join(",")+"}"):new Function("r","return {"+h.map(f=>_r.test(f)?se(f)+":r()":"["+JSON.stringify(f)+"]:r()").join(",")+"}"),this.compiledReader&&(n.next=this.compiledReader),n.propertyCount=r,this.compiledReader=n,n(gt)}let o={};if(_t.keyMap)for(let h=0;h<r;h++)o[se(_t.decodeKey(this[h]))]=gt();else for(let h=0;h<r;h++)o[se(this[h])]=gt();return o}return e.slowReads=0,t}function se(e){if(typeof e=="string")return e==="__proto__"?"__proto_":e;if(typeof e=="number"||typeof e=="boolean"||typeof e=="bigint")return e.toString();if(e==null)return e+"";throw new Error("Invalid property name type "+typeof e)}let Qo=ls;function ls(e){let t;if(e<16&&(t=an(e)))return t;if(e>64&&ss)return ss.decode(J.subarray(M,M+=e));const r=M+e,n=[];for(t="";M<r;){const o=J[M++];if(!(o&128))n.push(o);else if((o&224)===192){const h=J[M++]&63;n.push((o&31)<<6|h)}else if((o&240)===224){const h=J[M++]&63,f=J[M++]&63;n.push((o&31)<<12|h<<6|f)}else if((o&248)===240){const h=J[M++]&63,f=J[M++]&63,u=J[M++]&63;let d=(o&7)<<18|h<<12|f<<6|u;d>65535&&(d-=65536,n.push(d>>>10&1023|55296),d=56320|d&1023),n.push(d)}else n.push(o);n.length>=4096&&(t+=Bt.apply(String,n),n.length=0)}return n.length>0&&(t+=Bt.apply(String,n)),t}let Bt=String.fromCharCode;function ta(e){let t=M,r=new Array(e);for(let n=0;n<e;n++){const o=J[M++];if((o&128)>0){M=t;return}r[n]=o}return Bt.apply(String,r)}function an(e){if(e<4)if(e<2){if(e===0)return"";{let t=J[M++];if((t&128)>1){M-=1;return}return Bt(t)}}else{let t=J[M++],r=J[M++];if((t&128)>0||(r&128)>0){M-=2;return}if(e<3)return Bt(t,r);let n=J[M++];if((n&128)>0){M-=3;return}return Bt(t,r,n)}else{let t=J[M++],r=J[M++],n=J[M++],o=J[M++];if((t&128)>0||(r&128)>0||(n&128)>0||(o&128)>0){M-=4;return}if(e<6){if(e===4)return Bt(t,r,n,o);{let h=J[M++];if((h&128)>0){M-=5;return}return Bt(t,r,n,o,h)}}else if(e<8){let h=J[M++],f=J[M++];if((h&128)>0||(f&128)>0){M-=6;return}if(e<7)return Bt(t,r,n,o,h,f);let u=J[M++];if((u&128)>0){M-=7;return}return Bt(t,r,n,o,h,f,u)}else{let h=J[M++],f=J[M++],u=J[M++],d=J[M++];if((h&128)>0||(f&128)>0||(u&128)>0||(d&128)>0){M-=8;return}if(e<10){if(e===8)return Bt(t,r,n,o,h,f,u,d);{let _=J[M++];if((_&128)>0){M-=9;return}return Bt(t,r,n,o,h,f,u,d,_)}}else if(e<12){let _=J[M++],y=J[M++];if((_&128)>0||(y&128)>0){M-=10;return}if(e<11)return Bt(t,r,n,o,h,f,u,d,_,y);let P=J[M++];if((P&128)>0){M-=11;return}return Bt(t,r,n,o,h,f,u,d,_,y,P)}else{let _=J[M++],y=J[M++],P=J[M++],w=J[M++];if((_&128)>0||(y&128)>0||(P&128)>0||(w&128)>0){M-=12;return}if(e<14){if(e===12)return Bt(t,r,n,o,h,f,u,d,_,y,P,w);{let v=J[M++];if((v&128)>0){M-=13;return}return Bt(t,r,n,o,h,f,u,d,_,y,P,w,v)}}else{let v=J[M++],C=J[M++];if((v&128)>0||(C&128)>0){M-=14;return}if(e<15)return Bt(t,r,n,o,h,f,u,d,_,y,P,w,v,C);let k=J[M++];if((k&128)>0){M-=15;return}return Bt(t,r,n,o,h,f,u,d,_,y,P,w,v,C,k)}}}}}function ea(e){return _t.copyBuffers?Uint8Array.prototype.slice.call(J,M,M+=e):J.subarray(M,M+=e)}let hn=new Float32Array(1),ui=new Uint8Array(hn.buffer,0,4);function ia(){let e=J[M++],t=J[M++],r=(e&127)>>2;if(r===31)return t||e&3?NaN:e&128?-1/0:1/0;if(r===0){let n=((e&3)<<8|t)/16777216;return e&128?-n:n}return ui[3]=e&128|(r>>1)+56,ui[2]=(e&7)<<5|t>>3,ui[1]=t<<5,ui[0]=0,hn[0]}new Array(4096);class Ve{constructor(t,r){this.value=t,this.tag=r}}Ot[0]=e=>new Date(e);Ot[1]=e=>new Date(Math.round(e*1e3));Ot[2]=e=>{let t=BigInt(0);for(let r=0,n=e.byteLength;r<n;r++)t=BigInt(e[r])+(t<<BigInt(8));return t};Ot[3]=e=>BigInt(-1)-Ot[2](e);Ot[4]=e=>+(e[1]+"e"+e[0]);Ot[5]=e=>e[1]*Math.exp(e[0]*Math.log(2));const os=(e,t)=>{e=e-57344;let r=St[e];r&&r.isShared&&((St.restoreStructures||(St.restoreStructures=[]))[e]=r),St[e]=t,t.read=ns(t)};Ot[Jo]=e=>{let t=e.length,r=e[1];os(e[0],r);let n={};for(let o=2;o<t;o++){let h=r[o-2];n[se(h)]=e[o]}return n};Ot[14]=e=>Mt?Mt[0].slice(Mt.position0,Mt.position0+=e):new Ve(e,14);Ot[15]=e=>Mt?Mt[1].slice(Mt.position1,Mt.position1+=e):new Ve(e,15);let sa={Error,RegExp};Ot[27]=e=>(sa[e[0]]||Error)(e[1],e[2]);const fn=e=>{if(J[M++]!=132){let r=new Error("Packed values structure must be followed by a 4 element array");throw J.length<M&&(r.incomplete=!0),r}let t=e();if(!t||!t.length){let r=new Error("Packed values structure must be followed by a 4 element array");throw r.incomplete=!0,r}return jt=jt?t.concat(jt.slice(t.length)):t,jt.prefixes=e(),jt.suffixes=e(),e()};fn.handlesRead=!0;Ot[51]=fn;Ot[dr]=e=>{if(!jt)if(_t.getShared)ys();else return new Ve(e,dr);if(typeof e=="number")return jt[16+(e>=0?2*e:-2*e-1)];let t=new Error("No support for non-integer packed references yet");throw e===void 0&&(t.incomplete=!0),t};Ot[28]=e=>{ie||(ie=new Map,ie.id=0);let t=ie.id++,r=M,n=J[M],o;n>>5==4?o=[]:o={};let h={target:o};ie.set(t,h);let f=e();return h.used?(Object.getPrototypeOf(o)!==Object.getPrototypeOf(f)&&(M=r,o=f,ie.set(t,{target:o}),f=e()),Object.assign(o,f)):(h.target=f,f)};Ot[28].handlesRead=!0;Ot[29]=e=>{let t=ie.get(e);return t.used=!0,t.target};Ot[258]=e=>new Set(e);(Ot[259]=e=>(_t.mapsAsObjects&&(_t.mapsAsObjects=!1,Ze=!0),e())).handlesRead=!0;function Fe(e,t){return typeof e=="string"?e+t:e instanceof Array?e.concat(t):Object.assign({},e,t)}function Ce(){if(!jt)if(_t.getShared)ys();else throw new Error("No packed values available");return jt}const ra=1399353956;rs.push((e,t)=>{if(e>=225&&e<=255)return Fe(Ce().prefixes[e-224],t);if(e>=28704&&e<=32767)return Fe(Ce().prefixes[e-28672],t);if(e>=1879052288&&e<=2147483647)return Fe(Ce().prefixes[e-1879048192],t);if(e>=216&&e<=223)return Fe(t,Ce().suffixes[e-216]);if(e>=27647&&e<=28671)return Fe(t,Ce().suffixes[e-27639]);if(e>=1811940352&&e<=1879048191)return Fe(t,Ce().suffixes[e-1811939328]);if(e==ra)return{packedValues:jt,structures:St.slice(0),version:t};if(e==55799)return t});const na=new Uint8Array(new Uint16Array([1]).buffer)[0]==1,mr=[Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array>"u"?{name:"BigUint64Array"}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array>"u"?{name:"BigInt64Array"}:BigInt64Array,Float32Array,Float64Array],la=[64,68,69,70,71,72,77,78,79,85,86];for(let e=0;e<mr.length;e++)oa(mr[e],la[e]);function oa(e,t){let r="get"+e.name.slice(0,-5),n;typeof e=="function"?n=e.BYTES_PER_ELEMENT:e=null;for(let o=0;o<2;o++){if(!o&&n==1)continue;let h=n==2?1:n==4?2:n==8?3:0;Ot[o?t:t-4]=n==1||o==na?f=>{if(!e)throw new Error("Could not find typed array for code "+t);return!_t.copyBuffers&&(n===1||n===2&&!(f.byteOffset&1)||n===4&&!(f.byteOffset&3)||n===8&&!(f.byteOffset&7))?new e(f.buffer,f.byteOffset,f.byteLength>>h):new e(Uint8Array.prototype.slice.call(f,0).buffer)}:f=>{if(!e)throw new Error("Could not find typed array for code "+t);let u=new DataView(f.buffer,f.byteOffset,f.byteLength),d=f.length>>h,_=new e(d),y=u[r];for(let P=0;P<d;P++)_[P]=y.call(u,P<<h,o);return _}}}function aa(){let e=De(),t=M+gt();for(let n=2;n<e;n++){let o=De();M+=o}let r=M;return M=t,Mt=[ls(De()),ls(De())],Mt.position0=0,Mt.position1=0,Mt.postBundlePosition=M,M=r,gt()}function De(){let e=J[M++]&31;if(e>23)switch(e){case 24:e=J[M++];break;case 25:e=Wt.getUint16(M),M+=2;break;case 26:e=Wt.getUint32(M),M+=4;break}return e}function ys(){if(_t.getShared){let e=cn(()=>(J=null,_t.getShared()))||{},t=e.structures||[];_t.sharedVersion=e.version,jt=_t.sharedValues=e.packedValues,St===!0?_t.structures=St=t:St.splice.apply(St,[0,t.length].concat(t))}}function cn(e){let t=Te,r=M,n=Ei,o=Qe,h=Ti,f=ie,u=Mt,d=new Uint8Array(J.slice(0,Te)),_=St,y=_t,P=ti,w=e();return Te=t,M=r,Ei=n,Qe=o,Ti=h,ie=f,Mt=u,J=d,ti=P,St=_,_t=y,Wt=new DataView(J.buffer,J.byteOffset,J.byteLength),w}function as(){J=null,ie=null,St=null}const xs=new Array(147);for(let e=0;e<256;e++)xs[e]=+("1e"+Math.floor(45.15-e*.30103));let vs=new ei({useRecords:!1});const ha=vs.decode;vs.decodeMultiple;let bi;try{bi=new TextEncoder}catch{}let hs,un;const Bi=typeof globalThis=="object"&&globalThis.Buffer,ii=typeof Bi<"u",Gi=ii?Bi.allocUnsafeSlow:Uint8Array,gr=ii?Bi:Uint8Array,yr=256,xr=ii?4294967296:2144337920;let Zi,S,Pt,I=0,me,kt=null;const fa=61440,ca=/[\u0080-\uFFFF]/,Ht=Symbol("record-id");class ua extends ei{constructor(t){super(t),this.offset=0;let r,n,o,h,f;t=t||{};let u=gr.prototype.utf8Write?function(T,V,R){return S.utf8Write(T,V,R)}:bi&&bi.encodeInto?function(T,V){return bi.encodeInto(T,S.subarray(V)).written}:!1,d=this,_=t.structures||t.saveStructures,y=t.maxSharedStructures;if(y==null&&(y=_?128:0),y>8190)throw new Error("Maximum maxSharedStructure is 8190");let P=t.sequential;P&&(y=0),this.structures||(this.structures=[]),this.saveStructures&&(this.saveShared=this.saveStructures);let w,v,C=t.sharedValues,k;if(C){k=Object.create(null);for(let T=0,V=C.length;T<V;T++)k[C[T]]=T}let L=[],O=0,E=0;this.mapEncode=function(T,V){if(this._keyMap&&!this._mapped)switch(T.constructor.name){case"Array":T=T.map(R=>this.encodeKeys(R));break}return this.encode(T,V)},this.encode=function(T,V){if(S||(S=new Gi(8192),Pt=new DataView(S.buffer,0,8192),I=0),me=S.length-10,me-I<2048?(S=new Gi(S.length),Pt=new DataView(S.buffer,0,S.length),me=S.length-10,I=0):V===br&&(I=I+7&2147483640),r=I,d.useSelfDescribedHeader&&(Pt.setUint32(I,3654940416),I+=3),f=d.structuredClone?new Map:null,d.bundleStrings&&typeof T!="string"?(kt=[],kt.size=1/0):kt=null,n=d.structures,n){if(n.uninitialized){let X=d.getShared()||{};d.structures=n=X.structures||[],d.sharedVersion=X.version;let Y=d.sharedValues=X.packedValues;if(Y){k={};for(let K=0,tt=Y.length;K<tt;K++)k[Y[K]]=K}}let R=n.length;if(R>y&&!P&&(R=y),!n.transitions){n.transitions=Object.create(null);for(let X=0;X<R;X++){let Y=n[X];if(!Y)continue;let K,tt=n.transitions;for(let it=0,lt=Y.length;it<lt;it++){tt[Ht]===void 0&&(tt[Ht]=X);let ft=Y[it];K=tt[ft],K||(K=tt[ft]=Object.create(null)),tt=K}tt[Ht]=X|1048576}}P||(n.nextId=R)}if(o&&(o=!1),h=n||[],v=k,t.pack){let R=new Map;if(R.values=[],R.encoder=d,R.maxValues=t.maxPrivatePackedValues||(k?16:1/0),R.objectMap=k||!1,R.samplingPackedValues=w,wi(T,R),R.values.length>0){S[I++]=216,S[I++]=51,fe(4);let X=R.values;N(X),fe(0),fe(0),v=Object.create(k||null);for(let Y=0,K=X.length;Y<K;Y++)v[X[Y]]=Y}}Zi=V&Ki;try{if(Zi)return;if(N(T),kt&&Pr(r,N),d.offset=I,f&&f.idsToInsert){I+=f.idsToInsert.length*2,I>me&&F(I),d.offset=I;let R=_a(S.subarray(r,I),f.idsToInsert);return f=null,R}return V&br?(S.start=r,S.end=I,S):S.subarray(r,I)}finally{if(n){if(E<10&&E++,n.length>y&&(n.length=y),O>1e4)n.transitions=null,E=0,O=0,L.length>0&&(L=[]);else if(L.length>0&&!P){for(let R=0,X=L.length;R<X;R++)L[R][Ht]=void 0;L=[]}}if(o&&d.saveShared){d.structures.length>y&&(d.structures=d.structures.slice(0,y));let R=S.subarray(r,I);return d.updateSharedData()===!1?d.encode(T):R}V&ma&&(I=r)}},this.findCommonStringsToPack=()=>(w=new Map,k||(k=Object.create(null)),T=>{let V=T&&T.threshold||4,R=this.pack?T.maxPrivatePackedValues||16:0;C||(C=this.sharedValues=[]);for(let[X,Y]of w)Y.count>V&&(k[X]=R++,C.push(X),o=!0);for(;this.saveShared&&this.updateSharedData()===!1;);w=null});const N=T=>{I>me&&(S=F(I));var V=typeof T,R;if(V==="string"){if(v){let tt=v[T];if(tt>=0){tt<16?S[I++]=tt+224:(S[I++]=198,tt&1?N(15-tt>>1):N(tt-16>>1));return}else if(w&&!t.pack){let it=w.get(T);it?it.count++:w.set(T,{count:1})}}let X=T.length;if(kt&&X>=4&&X<1024){if((kt.size+=X)>fa){let it,lt=(kt[0]?kt[0].length*3+kt[1].length:0)+10;I+lt>me&&(S=F(I+lt)),S[I++]=217,S[I++]=223,S[I++]=249,S[I++]=kt.position?132:130,S[I++]=26,it=I-r,I+=4,kt.position&&Pr(r,N),kt=["",""],kt.size=0,kt.position=it}let tt=ca.test(T);kt[tt?0:1]+=T,S[I++]=tt?206:207,N(X);return}let Y;X<32?Y=1:X<256?Y=2:X<65536?Y=3:Y=5;let K=X*3;if(I+K>me&&(S=F(I+K)),X<64||!u){let tt,it,lt,ft=I+Y;for(tt=0;tt<X;tt++)it=T.charCodeAt(tt),it<128?S[ft++]=it:it<2048?(S[ft++]=it>>6|192,S[ft++]=it&63|128):(it&64512)===55296&&((lt=T.charCodeAt(tt+1))&64512)===56320?(it=65536+((it&1023)<<10)+(lt&1023),tt++,S[ft++]=it>>18|240,S[ft++]=it>>12&63|128,S[ft++]=it>>6&63|128,S[ft++]=it&63|128):(S[ft++]=it>>12|224,S[ft++]=it>>6&63|128,S[ft++]=it&63|128);R=ft-I-Y}else R=u(T,I+Y,K);R<24?S[I++]=96|R:R<256?(Y<2&&S.copyWithin(I+2,I+1,I+1+R),S[I++]=120,S[I++]=R):R<65536?(Y<3&&S.copyWithin(I+3,I+2,I+2+R),S[I++]=121,S[I++]=R>>8,S[I++]=R&255):(Y<5&&S.copyWithin(I+5,I+3,I+3+R),S[I++]=122,Pt.setUint32(I,R),I+=4),I+=R}else if(V==="number")if(!this.alwaysUseFloat&&T>>>0===T)T<24?S[I++]=T:T<256?(S[I++]=24,S[I++]=T):T<65536?(S[I++]=25,S[I++]=T>>8,S[I++]=T&255):(S[I++]=26,Pt.setUint32(I,T),I+=4);else if(!this.alwaysUseFloat&&T>>0===T)T>=-24?S[I++]=31-T:T>=-256?(S[I++]=56,S[I++]=~T):T>=-65536?(S[I++]=57,Pt.setUint16(I,~T),I+=2):(S[I++]=58,Pt.setUint32(I,~T),I+=4);else{let X;if((X=this.useFloat32)>0&&T<4294967296&&T>=-2147483648){S[I++]=250,Pt.setFloat32(I,T);let Y;if(X<4||(Y=T*xs[(S[I]&127)<<1|S[I+1]>>7])>>0===Y){I+=4;return}else I--}S[I++]=251,Pt.setFloat64(I,T),I+=8}else if(V==="object")if(!T)S[I++]=246;else{if(f){let Y=f.get(T);if(Y){if(S[I++]=216,S[I++]=29,S[I++]=25,!Y.references){let K=f.idsToInsert||(f.idsToInsert=[]);Y.references=[],K.push(Y)}Y.references.push(I-r),I+=2;return}else f.set(T,{offset:I-r})}let X=T.constructor;if(X===Object)W(T);else if(X===Array){R=T.length,R<24?S[I++]=128|R:fe(R);for(let Y=0;Y<R;Y++)N(T[Y])}else if(X===Map)if((this.mapsAsObjects?this.useTag259ForMaps!==!1:this.useTag259ForMaps)&&(S[I++]=217,S[I++]=1,S[I++]=3),R=T.size,R<24?S[I++]=160|R:R<256?(S[I++]=184,S[I++]=R):R<65536?(S[I++]=185,S[I++]=R>>8,S[I++]=R&255):(S[I++]=186,Pt.setUint32(I,R),I+=4),d.keyMap)for(let[Y,K]of T)N(d.encodeKey(Y)),N(K);else for(let[Y,K]of T)N(Y),N(K);else{for(let Y=0,K=hs.length;Y<K;Y++){let tt=un[Y];if(T instanceof tt){let it=hs[Y],lt=it.tag;lt==null&&(lt=it.getTag&&it.getTag.call(this,T)),lt<24?S[I++]=192|lt:lt<256?(S[I++]=216,S[I++]=lt):lt<65536?(S[I++]=217,S[I++]=lt>>8,S[I++]=lt&255):lt>-1&&(S[I++]=218,Pt.setUint32(I,lt),I+=4),it.encode.call(this,T,N,F);return}}if(T[Symbol.iterator]){if(Zi){let Y=new Error("Iterable should be serialized as iterator");throw Y.iteratorNotHandled=!0,Y}S[I++]=159;for(let Y of T)N(Y);S[I++]=255;return}if(T[Symbol.asyncIterator]||Ji(T)){let Y=new Error("Iterable/blob should be serialized as iterator");throw Y.iteratorNotHandled=!0,Y}if(this.useToJSON&&T.toJSON){const Y=T.toJSON();if(Y!==T)return N(Y)}W(T)}}else if(V==="boolean")S[I++]=T?245:244;else if(V==="bigint"){if(T<BigInt(1)<<BigInt(64)&&T>=0)S[I++]=27,Pt.setBigUint64(I,T);else if(T>-(BigInt(1)<<BigInt(64))&&T<0)S[I++]=59,Pt.setBigUint64(I,-T-BigInt(1));else if(this.largeBigIntToFloat)S[I++]=251,Pt.setFloat64(I,Number(T));else{T>=BigInt(0)?S[I++]=194:(S[I++]=195,T=BigInt(-1)-T);let X=[];for(;T;)X.push(Number(T&BigInt(255))),T>>=BigInt(8);fs(new Uint8Array(X.reverse()),F);return}I+=8}else if(V==="undefined")S[I++]=247;else throw new Error("Unknown type: "+V)},W=this.useRecords===!1?this.variableMapSize?T=>{let V=Object.keys(T),R=Object.values(T),X=V.length;if(X<24?S[I++]=160|X:X<256?(S[I++]=184,S[I++]=X):X<65536?(S[I++]=185,S[I++]=X>>8,S[I++]=X&255):(S[I++]=186,Pt.setUint32(I,X),I+=4),d.keyMap)for(let Y=0;Y<X;Y++)N(d.encodeKey(V[Y])),N(R[Y]);else for(let Y=0;Y<X;Y++)N(V[Y]),N(R[Y])}:T=>{S[I++]=185;let V=I-r;I+=2;let R=0;if(d.keyMap)for(let X in T)(typeof T.hasOwnProperty!="function"||T.hasOwnProperty(X))&&(N(d.encodeKey(X)),N(T[X]),R++);else for(let X in T)(typeof T.hasOwnProperty!="function"||T.hasOwnProperty(X))&&(N(X),N(T[X]),R++);S[V+++r]=R>>8,S[V+r]=R&255}:(T,V)=>{let R,X=h.transitions||(h.transitions=Object.create(null)),Y=0,K=0,tt,it;if(this.keyMap){it=Object.keys(T).map(ft=>this.encodeKey(ft)),K=it.length;for(let ft=0;ft<K;ft++){let Xt=it[ft];R=X[Xt],R||(R=X[Xt]=Object.create(null),Y++),X=R}}else for(let ft in T)(typeof T.hasOwnProperty!="function"||T.hasOwnProperty(ft))&&(R=X[ft],R||(X[Ht]&1048576&&(tt=X[Ht]&65535),R=X[ft]=Object.create(null),Y++),X=R,K++);let lt=X[Ht];if(lt!==void 0)lt&=65535,S[I++]=217,S[I++]=lt>>8|224,S[I++]=lt&255;else if(it||(it=X.__keys__||(X.__keys__=Object.keys(T))),tt===void 0?(lt=h.nextId++,lt||(lt=0,h.nextId=1),lt>=yr&&(h.nextId=(lt=y)+1)):lt=tt,h[lt]=it,lt<y){S[I++]=217,S[I++]=lt>>8|224,S[I++]=lt&255,X=h.transitions;for(let ft=0;ft<K;ft++)(X[Ht]===void 0||X[Ht]&1048576)&&(X[Ht]=lt),X=X[it[ft]];X[Ht]=lt|1048576,o=!0}else{if(X[Ht]=lt,Pt.setUint32(I,3655335680),I+=3,Y&&(O+=E*Y),L.length>=yr-y&&(L.shift()[Ht]=void 0),L.push(X),fe(K+2),N(57344+lt),N(it),V)return;for(let ft in T)(typeof T.hasOwnProperty!="function"||T.hasOwnProperty(ft))&&N(T[ft]);return}if(K<24?S[I++]=128|K:fe(K),!V)for(let ft in T)(typeof T.hasOwnProperty!="function"||T.hasOwnProperty(ft))&&N(T[ft])},F=T=>{let V;if(T>16777216){if(T-r>xr)throw new Error("Encoded buffer would be larger than maximum buffer size");V=Math.min(xr,Math.round(Math.max((T-r)*(T>67108864?1.25:2),4194304)/4096)*4096)}else V=(Math.max(T-r<<2,S.length-1)>>12)+1<<12;let R=new Gi(V);return Pt=new DataView(R.buffer,0,V),S.copy?S.copy(R,0,r,T):R.set(S.slice(r,T)),I-=r,r=0,me=R.length-10,S=R};let Z=100,G=1e3;this.encodeAsIterable=function(T,V){return ht(T,V,st)},this.encodeAsAsyncIterable=function(T,V){return ht(T,V,at)};function*st(T,V,R){let X=T.constructor;if(X===Object){let Y=d.useRecords!==!1;Y?W(T,!0):vr(Object.keys(T).length,160);for(let K in T){let tt=T[K];Y||N(K),tt&&typeof tt=="object"?V[K]?yield*st(tt,V[K]):yield*et(tt,V,K):N(tt)}}else if(X===Array){let Y=T.length;fe(Y);for(let K=0;K<Y;K++){let tt=T[K];tt&&(typeof tt=="object"||I-r>Z)?V.element?yield*st(tt,V.element):yield*et(tt,V,"element"):N(tt)}}else if(T[Symbol.iterator]&&!T.buffer){S[I++]=159;for(let Y of T)Y&&(typeof Y=="object"||I-r>Z)?V.element?yield*st(Y,V.element):yield*et(Y,V,"element"):N(Y);S[I++]=255}else Ji(T)?(vr(T.size,64),yield S.subarray(r,I),yield T,Q()):T[Symbol.asyncIterator]?(S[I++]=159,yield S.subarray(r,I),yield T,Q(),S[I++]=255):N(T);R&&I>r?yield S.subarray(r,I):I-r>Z&&(yield S.subarray(r,I),Q())}function*et(T,V,R){let X=I-r;try{N(T),I-r>Z&&(yield S.subarray(r,I),Q())}catch(Y){if(Y.iteratorNotHandled)V[R]={},I=r+X,yield*st.call(this,T,V[R]);else throw Y}}function Q(){Z=G,d.encode(null,Ki)}function ht(T,V,R){return V&&V.chunkThreshold?Z=G=V.chunkThreshold:Z=100,T&&typeof T=="object"?(d.encode(null,Ki),R(T,d.iterateProperties||(d.iterateProperties={}),!0)):[d.encode(T)]}async function*at(T,V){for(let R of st(T,V,!0)){let X=R.constructor;if(X===gr||X===Uint8Array)yield R;else if(Ji(R)){let Y=R.stream().getReader(),K;for(;!(K=await Y.read()).done;)yield K.value}else if(R[Symbol.asyncIterator])for await(let Y of R)Q(),Y?yield*at(Y,V.async||(V.async={})):yield d.encode(Y);else yield R}}}useBuffer(t){S=t,Pt=new DataView(S.buffer,S.byteOffset,S.byteLength),I=0}clearSharedData(){this.structures&&(this.structures=[]),this.sharedValues&&(this.sharedValues=void 0)}updateSharedData(){let t=this.sharedVersion||0;this.sharedVersion=t+1;let r=this.structures.slice(0),n=new dn(r,this.sharedValues,this.sharedVersion),o=this.saveShared(n,h=>(h&&h.version||0)==t);return o===!1?(n=this.getShared()||{},this.structures=n.structures||[],this.sharedValues=n.packedValues,this.sharedVersion=n.version,this.structures.nextId=this.structures.length):r.forEach((h,f)=>this.structures[f]=h),o}}function vr(e,t){e<24?S[I++]=t|e:e<256?(S[I++]=t|24,S[I++]=e):e<65536?(S[I++]=t|25,S[I++]=e>>8,S[I++]=e&255):(S[I++]=t|26,Pt.setUint32(I,e),I+=4)}class dn{constructor(t,r,n){this.structures=t,this.packedValues=r,this.version=n}}function fe(e){e<24?S[I++]=128|e:e<256?(S[I++]=152,S[I++]=e):e<65536?(S[I++]=153,S[I++]=e>>8,S[I++]=e&255):(S[I++]=154,Pt.setUint32(I,e),I+=4)}const da=typeof Blob>"u"?function(){}:Blob;function Ji(e){if(e instanceof da)return!0;let t=e[Symbol.toStringTag];return t==="Blob"||t==="File"}function wi(e,t){switch(typeof e){case"string":if(e.length>3){if(t.objectMap[e]>-1||t.values.length>=t.maxValues)return;let n=t.get(e);if(n)++n.count==2&&t.values.push(e);else if(t.set(e,{count:1}),t.samplingPackedValues){let o=t.samplingPackedValues.get(e);o?o.count++:t.samplingPackedValues.set(e,{count:1})}}break;case"object":if(e)if(e instanceof Array)for(let n=0,o=e.length;n<o;n++)wi(e[n],t);else{let n=!t.encoder.useRecords;for(var r in e)e.hasOwnProperty(r)&&(n&&wi(r,t),wi(e[r],t))}break;case"function":console.log(e)}}const pa=new Uint8Array(new Uint16Array([1]).buffer)[0]==1;un=[Date,Set,Error,RegExp,Ve,ArrayBuffer,Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array>"u"?function(){}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array>"u"?function(){}:BigInt64Array,Float32Array,Float64Array,dn];hs=[{tag:1,encode(e,t){let r=e.getTime()/1e3;(this.useTimestamp32||e.getMilliseconds()===0)&&r>=0&&r<4294967296?(S[I++]=26,Pt.setUint32(I,r),I+=4):(S[I++]=251,Pt.setFloat64(I,r),I+=8)}},{tag:258,encode(e,t){let r=Array.from(e);t(r)}},{tag:27,encode(e,t){t([e.name,e.message])}},{tag:27,encode(e,t){t(["RegExp",e.source,e.flags])}},{getTag(e){return e.tag},encode(e,t){t(e.value)}},{encode(e,t,r){fs(e,r)}},{getTag(e){if(e.constructor===Uint8Array&&(this.tagUint8Array||ii&&this.tagUint8Array!==!1))return 64},encode(e,t,r){fs(e,r)}},ae(68,1),ae(69,2),ae(70,4),ae(71,8),ae(72,1),ae(77,2),ae(78,4),ae(79,8),ae(85,4),ae(86,8),{encode(e,t){let r=e.packedValues||[],n=e.structures||[];if(r.values.length>0){S[I++]=216,S[I++]=51,fe(4);let o=r.values;t(o),fe(0),fe(0),packedObjectMap=Object.create(sharedPackedObjectMap||null);for(let h=0,f=o.length;h<f;h++)packedObjectMap[o[h]]=h}{Pt.setUint32(I,3655335424),I+=3;let o=n.slice(0);o.unshift(57344),o.push(new Ve(e.version,1399353956)),t(o)}}}];function ae(e,t){return!pa&&t>1&&(e-=4),{tag:e,encode:function(n,o){let h=n.byteLength,f=n.byteOffset||0,u=n.buffer||n;o(ii?Bi.from(u,f,h):new Uint8Array(u,f,h))}}}function fs(e,t){let r=e.byteLength;r<24?S[I++]=64+r:r<256?(S[I++]=88,S[I++]=r):r<65536?(S[I++]=89,S[I++]=r>>8,S[I++]=r&255):(S[I++]=90,Pt.setUint32(I,r),I+=4),I+r>=S.length&&t(I+r),S.set(e.buffer?e:new Uint8Array(e),I),I+=r}function _a(e,t){let r,n=t.length*2,o=e.length-n;t.sort((h,f)=>h.offset>f.offset?1:-1);for(let h=0;h<t.length;h++){let f=t[h];f.id=h;for(let u of f.references)e[u++]=h>>8,e[u]=h&255}for(;r=t.pop();){let h=r.offset;e.copyWithin(h+n,h,o),n-=2;let f=h+n;e[f++]=216,e[f++]=28,o=h}return e}function Pr(e,t){Pt.setUint32(kt.position+e,I-kt.position-e+1);let r=kt;kt=null,t(r[0]),t(r[1])}let Ps=new ua({useRecords:!1});const wa=Ps.encode;Ps.encodeAsIterable;Ps.encodeAsAsyncIterable;const br=512,ma=1024,Ki=2048;let ue;const ga=()=>{var n,o,h;const e=document.getElementById("drawnLayer");if(!e)return;const t=new Wo(e);window.manager=t,ue=t,Zo(),t.createInstance(),t.focusInstance(0);try{let f={width:0,height:0};const u=(d,_)=>{const y=new Image;y.onload=()=>{y.onload=null;const P=y.width/f.width,w=document.createElement("canvas"),v=w.getContext("2d");if(!v)return;w.width=y.width,w.height=y.height,v.drawImage(y,0,0);const C=v.getImageData(_.start.x*P,_.start.y*P,(_.end.x-_.start.x)*P,(_.end.y-_.start.y)*P),k=document.createElement("canvas"),L=k.getContext("2d");if(!L)return;k.width=(_.end.x-_.start.x)*P,k.height=(_.end.y-_.start.y)*P,L.putImageData(C,0,0);const O=new Image;O.onload=()=>{O.onload=null;let[E,N]=[O.width,O.height];E/=P,N/=P,console.log(E,N),E>window.innerWidth-Dt("IMAGE_GLOBAL_PADDING")&&(N*=(window.innerWidth-Dt("IMAGE_GLOBAL_PADDING"))/E,E=window.innerWidth-Dt("IMAGE_GLOBAL_PADDING")),N>window.innerHeight-Dt("IMAGE_GLOBAL_PADDING")&&(E*=(window.innerHeight-Dt("IMAGE_GLOBAL_PADDING"))/N,N=window.innerHeight-Dt("IMAGE_GLOBAL_PADDING")),ue.focused.appendImage({width:E,height:N,image:O,rotate:0,x:window.innerWidth/2,y:window.innerHeight/2}),ue.focused.requestRender(),fetch("image://imager/"+d+"?qr=rm")},O.src=k.toDataURL()},y.src="image://imager/"+d+"?qr=get"};require("electron").ipcRenderer.on("cap",d=>{fetch("image://png/list?_="+Date.now()).then(_=>_.json()).then(_=>{for(const y of _)fetch("image://png/"+y+"?qr=pos").then(P=>P.json()).then(P=>{u(y,P)})})}),require("electron").ipcRenderer.on("screen",(d,_)=>{f=_})}catch{}const r=f=>{var d;const u=(d=f.clipboardData)==null?void 0:d.items;if(u)for(let _=0;_<u.length;_++){if(u[_].type==="text/plain"){u[_].getAsString(w=>{if(!w.startsWith(Dt("CLIPBOARD_PREFIX")))return;const v=w.slice(Dt("CLIPBOARD_PREFIX").length),C=new Uint8Array(v.length);for(let L=0;L<v.length;L++)C[L]=v.charCodeAt(L);const k=ha(C);ue.focused.importFromClipboard(k).then(L=>{Go("SEL"),setTimeout(()=>{console.log(L),Ri.SEL.handleSelect(L)})})});continue}if(u[_].type.indexOf("image")===-1)continue;const y=u[_].getAsFile();if(!y)continue;const P=new FileReader;P.onload=w=>{var C;const v=new Image;v.onload=()=>{v.onload=null;const[k,L]=[v.width,v.height];let O=1;k>window.innerWidth-Dt("IMAGE_GLOBAL_PADDING")&&(O=(window.innerWidth-Dt("IMAGE_GLOBAL_PADDING"))/k),L*O>window.innerHeight-Dt("IMAGE_GLOBAL_PADDING")&&(O=(window.innerHeight-Dt("IMAGE_GLOBAL_PADDING"))/L),ue.focused.appendImage({x:window.innerWidth/2,y:window.innerHeight/2,width:k*O,height:L*O,image:v,rotate:0}),ue.focused.requestRender()},v.src=(C=w.target)==null?void 0:C.result},P.readAsDataURL(y)}};document.addEventListener("paste",r),(n=document.getElementById("stv"))==null||n.addEventListener("click",f=>{const u=f.target;u.style.display="none"}),(o=document.getElementById("stvc"))==null||o.addEventListener("click",f=>{f.stopPropagation()}),(h=document.getElementById("cfg"))==null||h.addEventListener("click",f=>{f.stopPropagation();const u=document.getElementById("stv");u&&(u.style.display="flex")}),setInterval(()=>{[...document.querySelectorAll('input:not([data-pvap="true"])'),...document.querySelectorAll('textarea:not([data-pvap="true"])')].forEach(u=>{u.setAttribute("data-pvap","true"),u.addEventListener("paste",d=>{d.stopPropagation(),d.stopImmediatePropagation()})})},50)};ga();export{rn as _,Go as a,ba as b,xa as c,ha as d,wa as e,Bo as f,Dt as g,va as i,ue as m,Pa as r,Se as s,Ri as t};
