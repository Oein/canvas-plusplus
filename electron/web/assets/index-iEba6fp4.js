var nn=Object.defineProperty;var ln=(e,t,r)=>t in e?nn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var St=(e,t,r)=>ln(e,typeof t!="symbol"?t+"":t,r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const h of o)if(h.type==="childList")for(const u of h.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function r(o){const h={};return o.integrity&&(h.integrity=o.integrity),o.referrerPolicy&&(h.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?h.credentials="include":o.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function l(o){if(o.ep)return;o.ep=!0;const h=r(o);fetch(o.href,h)}})();var os=Object.defineProperty,on=(e,t,r)=>t in e?os(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,as=(e,t)=>{for(var r in t)os(e,r,{get:t[r],enumerable:!0})},g=(e,t,r)=>(on(e,typeof t!="symbol"?t+"":t,r),r),F={move:"M",line:"L",curve:"C",arc:"A",close:"Z"},hs={};as(hs,{HALF_PI:()=>gt,NumArray:()=>Ht,TWO_PI:()=>Pt,decomposeMatrix:()=>ce,getComputedMatrix:()=>cs,getPoT:()=>ds,lerp:()=>Lt,mod:()=>Nt,setMatrix:()=>us,toFixed:()=>dt});var ut;typeof window<"u"?ut=window:typeof global<"u"?ut=global:typeof self<"u"&&(ut=self);var fs,Pt=Math.PI*2,gt=Math.PI*.5;function ce(e,t,r,l,o,h){let u;return arguments.length<=1?(u=e.a,t=e.b,r=e.c,l=e.d,o=e.e,h=e.f):u=e,{translateX:o,translateY:h,scaleX:Math.sqrt(u*u+t*t),scaleY:Math.sqrt(r*r+l*l),rotation:180*Math.atan2(t,u)/Math.PI}}function us(e){fs=e}function cs(e,t){t=t&&t.identity()||new fs;let r=e;const l=[];for(;r&&r._matrix;)l.push(r._matrix),r=r.parent;l.reverse();for(let o=0;o<l.length;o++){const u=l[o].elements;t.multiply(u[0],u[1],u[2],u[3],u[4],u[5],u[6],u[7],u[8],u[9])}return t}function Lt(e,t,r){return r*(t-e)+e}var Je=[2,4,8,16,32,64,128,256,512,1024,2048,4096];function ds(e){let t=0;for(;Je[t]&&Je[t]<e;)t++;return Je[t]}function Nt(e,t){for(;e<0;)e+=t;return e%t}var Ht=ut.Float32Array||Array,an=Math.floor;function dt(e){return an(e*1e6)/1e6}var ps={};as(ps,{Curve:()=>de,getAnchorsFromArcData:()=>fn,getComponentOnCubicBezier:()=>xe,getControlPoints:()=>vs,getCurveBoundingBox:()=>ms,getCurveFromPoints:()=>ys,getCurveLength:()=>_s,getReflection:()=>ni,integrate:()=>gs,subdivide:()=>ui});var O=class{constructor(){g(this,"_events",{}),g(this,"_bound",!1)}addEventListener(e,t){return(this._events[e]||(this._events[e]=[])).push(t),this._bound=!0,this}on(){return this.addEventListener.apply(this,arguments)}bind(){return this.addEventListener.apply(this,arguments)}removeEventListener(e,t){if(!this._events)return this;if(!e&&!t)return this._events={},this._bound=!1,this;const r=e?[e]:Object.keys(this._events);for(let l=0,o=r.length;l<o;l++){e=r[l];let h=this._events[e];if(h){let u=[];if(t)for(let c=0,p=h.length;c<p;c++){let _=h[c];_=_.handler?_.handler:_,t!==_&&u.push(_)}this._events[e]=u}}return this}off(){return this.removeEventListener.apply(this,arguments)}unbind(){return this.removeEventListener.apply(this,arguments)}dispatchEvent(e){if(!this._events)return this;const t=Array.prototype.slice.call(arguments,1),r=this._events[e];if(r)for(let l=0;l<r.length;l++)r[l].call(this,...t);return this}trigger(){return this.dispatchEvent.apply(this,arguments)}listen(e,t,r){const l=this;e&&(o.obj=e,o.name=t,o.handler=r,e.on(t,o));function o(){r.apply(l,arguments)}return l}ignore(e,t,r){return e.off(t,r),this}};g(O,"Types",{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change",remove:"remove",insert:"insert",order:"order",load:"load"});g(O,"Methods",["addEventListener","on","removeEventListener","off","unbind","dispatchEvent","trigger","listen","ignore"]);var wi={x:{enumerable:!0,get:function(){return this._x},set:function(e){this._x!==e&&(this._x=e,this._bound&&this.dispatchEvent(O.Types.change))}},y:{enumerable:!0,get:function(){return this._y},set:function(e){this._y!==e&&(this._y=e,this._bound&&this.dispatchEvent(O.Types.change))}}},Dt=class extends O{constructor(e=0,t=0){super(),g(this,"_x",0),g(this,"_y",0);for(let r in wi)Object.defineProperty(this,r,wi[r]);this.x=e,this.y=t}static add(e,t){return new Dt(e.x+t.x,e.y+t.y)}static sub(e,t){return new Dt(e.x-t.x,e.y-t.y)}static subtract(e,t){return Dt.sub(e,t)}static ratioBetween(e,t){return(e.x*t.x+e.y*t.y)/(e.length()*t.length())}static angleBetween(e,t){if(arguments.length>=4){const o=arguments[0]-arguments[2],h=arguments[1]-arguments[3];return Math.atan2(h,o)}const r=e.x-t.x,l=e.y-t.y;return Math.atan2(l,r)}static distanceBetween(e,t){return Math.sqrt(Dt.distanceBetweenSquared(e,t))}static distanceBetweenSquared(e,t){const r=e.x-t.x,l=e.y-t.y;return r*r+l*l}set(e,t){return this.x=e,this.y=t,this}copy(e){return this.x=e.x,this.y=e.y,this}clear(){return this.x=0,this.y=0,this}clone(){return new Dt(this.x,this.y)}add(e,t){return arguments.length<=0?this:(arguments.length<=1?typeof e=="number"?(this.x+=e,this.y+=e):e&&typeof e.x=="number"&&typeof e.y=="number"&&(this.x+=e.x,this.y+=e.y):(this.x+=e,this.y+=t),this)}addSelf(e){return this.add.apply(this,arguments)}sub(e,t){return arguments.length<=0?this:(arguments.length<=1?typeof e=="number"?(this.x-=e,this.y-=e):e&&typeof e.x=="number"&&typeof e.y=="number"&&(this.x-=e.x,this.y-=e.y):(this.x-=e,this.y-=t),this)}subtract(){return this.sub.apply(this,arguments)}subSelf(e){return this.sub.apply(this,arguments)}subtractSelf(e){return this.sub.apply(this,arguments)}multiply(e,t){return arguments.length<=0?this:(arguments.length<=1?typeof e=="number"?(this.x*=e,this.y*=e):e&&typeof e.x=="number"&&typeof e.y=="number"&&(this.x*=e.x,this.y*=e.y):(this.x*=e,this.y*=t),this)}multiplySelf(e){return this.multiply.apply(this,arguments)}multiplyScalar(e){return this.multiply(e)}divide(e,t){return arguments.length<=0?this:(arguments.length<=1?typeof e=="number"?(this.x/=e,this.y/=e):e&&typeof e.x=="number"&&typeof e.y=="number"&&(this.x/=e.x,this.y/=e.y):(this.x/=e,this.y/=t),isNaN(this.x)&&(this.x=0),isNaN(this.y)&&(this.y=0),this)}divideSelf(e){return this.divide.apply(this,arguments)}divideScalar(e){return this.divide(e)}negate(){return this.multiply(-1)}dot(e){return this.x*e.x+this.y*e.y}length(){return Math.sqrt(this.lengthSquared())}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return this.divideScalar(this.length())}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}setLength(e){return this.normalize().multiplyScalar(e)}equals(e,t){return t=typeof t>"u"?1e-4:t,this.distanceTo(e)<t}lerp(e,t){const r=(e.x-this.x)*t+this.x,l=(e.y-this.y)*t+this.y;return this.set(r,l)}isZero(e){return e=typeof e>"u"?1e-4:e,this.length()<e}toString(){return this.x+", "+this.y}toObject(){return{x:this.x,y:this.y}}rotate(e){const t=this.x,r=this.y,l=Math.cos(e),o=Math.sin(e);return this.x=t*l-r*o,this.y=t*o+r*l,this}},R=Dt;g(R,"zero",new Dt);g(R,"left",new Dt(-1,0));g(R,"right",new Dt(1,0));g(R,"up",new Dt(0,-1));g(R,"down",new Dt(0,1));var K=class extends R{constructor(e=0,t=0,r=0,l=0,o=0,h=0,u=F.move){super(e,t),g(this,"controls",{left:new R,right:new R}),g(this,"_command",F.move),g(this,"_relative",!0),g(this,"_rx",0),g(this,"_ry",0),g(this,"_xAxisRotation",0),g(this,"_largeArcFlag",0),g(this,"_sweepFlag",1);for(let p in Ci)Object.defineProperty(this,p,Ci[p]);this.command=u,this.relative=!0;const c=K.makeBroadcast(this);this.controls.left.set(r,l).addEventListener(O.Types.change,c),this.controls.right.set(o,h).addEventListener(O.Types.change,c)}static makeBroadcast(e){return t;function t(){e._bound&&e.dispatchEvent(O.Types.change)}}copy(e){return this.x=e.x,this.y=e.y,typeof e.command=="string"&&(this.command=e.command),e.controls&&(e.controls.left&&this.controls.left.copy(e.controls.left),e.controls.right&&this.controls.right.copy(e.controls.right)),typeof e.relative=="boolean"&&(this.relative=e.relative),typeof e.rx=="number"&&(this.rx=e.rx),typeof e.ry=="number"&&(this.ry=e.ry),typeof e.xAxisRotation=="number"&&(this.xAxisRotation=e.xAxisRotation),typeof e.largeArcFlag=="number"&&(this.largeArcFlag=e.largeArcFlag),typeof e.sweepFlag=="number"&&(this.sweepFlag=e.sweepFlag),this}clone(){return new K().copy(this)}toObject(){return{x:this.x,y:this.y,command:this.command,relative:this.relative,controls:{left:this.controls.left.toObject(),right:this.controls.right.toObject()},rx:this.rx,ry:this.ry,xAxisRotation:this.xAxisRotation,largeArcFlag:this.largeArcFlag,sweepFlag:this.sweepFlag}}toString(){return JSON.stringify(this.toObject())}},Ci={command:{enumerable:!0,get:function(){return this._command},set:function(e){this._command!==e&&(this._command=e,this._bound&&this.dispatchEvent(O.Types.change))}},relative:{enumerable:!0,get:function(){return this._relative},set:function(e){this._relative!==!!e&&(this._relative=!!e,this._bound&&this.dispatchEvent(O.Types.change))}},rx:{enumerable:!0,get:function(){return this._rx},set:function(e){this._rx!==e&&(this._rx=e,this._bound&&this.dispatchEvent(O.Types.change))}},ry:{enumerable:!0,get:function(){return this._ry},set:function(e){this._ry!==e&&(this._ry=e,this._bound&&this.dispatchEvent(O.Types.change))}},xAxisRotation:{enumerable:!0,get:function(){return this._xAxisRotation},set:function(e){this._xAxisRotation!==e&&(this._xAxisRotation=e,this._bound&&this.dispatchEvent(O.Types.change))}},largeArcFlag:{enumerable:!0,get:function(){return this._largeArcFlag},set:function(e){this._largeArcFlag!==e&&(this._largeArcFlag=e,this._bound&&this.dispatchEvent(O.Types.change))}},sweepFlag:{get:function(){return this._sweepFlag},set:function(e){this._sweepFlag!==e&&(this._sweepFlag=e,this._bound&&this.dispatchEvent(O.Types.change))}}},hn=0,yt={nextFrameID:null,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Version:"v0.8.14",PublishDate:"2024-06-11T02:06:29.216Z",Identifier:"two-",Resolution:12,AutoCalculateImportedMatrices:!0,Instances:[],uniqueId:function(){return hn++}},de={CollinearityEpsilon:Math.pow(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:.25,angle:0,epsilon:Number.EPSILON},abscissas:[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],weights:[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]]};function xe(e,t,r,l,o){const h=1-e;return h*h*h*t+3*h*h*e*r+3*h*e*e*l+e*e*e*o}function ui(e,t,r,l,o,h,u,c,p){p=p||de.RecursionLimit;const _=p+1;if(Math.abs(e-u)<.001&&Math.abs(t-c)<.001)return[new K(u,c)];const x=[];for(let w=0;w<_;w++){const b=w/_,P=xe(b,e,r,o,u),C=xe(b,t,l,h,c);x.push(new K(P,C))}return x}function _s(e,t,r,l,o,h,u,c,p){if(e===r&&t===l&&o===u&&h===c){const L=u-e,A=c-t;return Math.sqrt(L*L+A*A)}const _=9*(r-o)+3*(u-e),x=6*(e+o)-12*r,w=3*(r-e),b=9*(l-h)+3*(c-t),P=6*(t+h)-12*l,C=3*(l-t);function S(L){const A=(_*L+x)*L+w,I=(b*L+P)*L+C;return Math.sqrt(A*A+I*I)}return gs(S,0,1,p||de.RecursionLimit)}function ms(e,t,r,l,o,h,u,c){const p=[],_=[[],[]];let x,w,b,P,C,S,L,A;for(let k=0;k<2;++k){if(k==0?(w=6*e-12*r+6*o,x=-3*e+9*r-9*o+3*u,b=3*r-3*e):(w=6*t-12*l+6*h,x=-3*t+9*l-9*h+3*c,b=3*l-3*t),Math.abs(x)<1e-12){if(Math.abs(w)<1e-12)continue;P=-b/w,0<P&&P<1&&p.push(P);continue}L=w*w-4*b*x,A=Math.sqrt(L),!(L<0)&&(C=(-w+A)/(2*x),0<C&&C<1&&p.push(C),S=(-w-A)/(2*x),0<S&&S<1&&p.push(S))}let I=p.length,X=I,M;for(;I--;)P=p[I],M=1-P,_[0][I]=M*M*M*e+3*M*M*P*r+3*M*P*P*o+P*P*P*u,_[1][I]=M*M*M*t+3*M*M*P*l+3*M*P*P*h+P*P*P*c;return _[0][X]=e,_[1][X]=t,_[0][X+1]=u,_[1][X+1]=c,_[0].length=_[1].length=X+2,{min:{x:Math.min.apply(0,_[0]),y:Math.min.apply(0,_[1])},max:{x:Math.max.apply(0,_[0]),y:Math.max.apply(0,_[1])}}}function gs(e,t,r,l){let o=de.abscissas[l-2],h=de.weights[l-2],u=.5*(r-t),c=u+t,p=0,_=l+1>>1,x=l&1?h[p++]*e(c):0;for(;p<_;){const w=u*o[p];x+=h[p++]*(e(c+w)+e(c-w))}return u*x}function ys(e,t){const r=e.length,l=r-1;for(let o=0;o<r;o++){const h=e[o],u=t?Nt(o-1,r):Math.max(o-1,0),c=t?Nt(o+1,r):Math.min(o+1,l),p=e[u],_=h,x=e[c];vs(p,_,x),_.command=o===0?F.move:F.curve}}function vs(e,t,r){const l=R.angleBetween(e,t),o=R.angleBetween(r,t);let h=R.distanceBetween(e,t),u=R.distanceBetween(r,t),c=(l+o)/2;return h<1e-4||u<1e-4?(typeof t.relative=="boolean"&&!t.relative&&(t.controls.left.copy(t),t.controls.right.copy(t)),t):(h*=.33,u*=.33,o<l?c+=gt:c-=gt,t.controls.left.x=Math.cos(c)*h,t.controls.left.y=Math.sin(c)*h,c-=Math.PI,t.controls.right.x=Math.cos(c)*u,t.controls.right.y=Math.sin(c)*u,typeof t.relative=="boolean"&&!t.relative&&(t.controls.left.x+=t.x,t.controls.left.y+=t.y,t.controls.right.x+=t.x,t.controls.right.y+=t.y),t)}function ni(e,t,r){return new R(2*e.x-(t.x+e.x)-(r?e.x:0),2*e.y-(t.y+e.y)-(r?e.y:0))}function fn(e,t,r,l,o,h,u){const c=yt.Resolution;for(let p=0;p<c;p++){let _=(p+1)/c;u&&(_=1-_);const x=_*h+o,w=r*Math.cos(x),b=l*Math.sin(x),P=new K(w,b);P.command=F.line}}var un=ut.devicePixelRatio||1;function cn(e){return e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1}function ci(e){return un/cn(e)}var Ii=Array.prototype.slice;function dn(e){if(e==null)return!1;const t=e.length;return typeof t=="number"&&t>=0&&t<4294967296}var W={isNaN:function(e){return typeof e=="number"&&e!==+e},isElement:function(e){return!!(e&&e.nodeType===1)},isObject:function(e){const t=typeof e;return t==="function"||t==="object"&&!!e},extend:function(e){const t=Ii.call(arguments,1);for(let r=0;r<t.length;r++){const l=t[r];for(let o in l)e[o]=l[o]}return e},defaults:function(e){const t=Ii.call(arguments,1);for(let r=0;r<t.length;r++){const l=t[r];for(let o in l)e[o]===void 0&&(e[o]=l[o])}return e},each:function(e,t,r){const l=r||this,o=!dn(e)&&Object.keys(e),h=(o||e).length;for(let u=0;u<h;u++){const c=o?o[u]:u;t.call(l,e[c],c,e)}return e},performance:ut.performance&&ut.performance.now?ut.performance:Date},Ue=class extends O{constructor(){super(),g(this,"_flagId",!1),g(this,"_flagClassName",!1),g(this,"_renderer",{}),g(this,"_id",""),g(this,"_className",""),g(this,"classList",[]);for(let e in Ti)Object.defineProperty(this,e,Ti[e])}flagReset(){this._flagId=this._flagClassName=!1}},Ti={renderer:{enumerable:!1,get:function(){return this._renderer}},id:{enumerable:!0,get:function(){return this._id},set:function(e){const t=this._id;e!==this._id&&(this._id=e,this._flagId=!0,this.parent&&(delete this.parent.children.ids[t],this.parent.children.ids[this._id]=this))}},className:{enumerable:!0,get:function(){return this._className},set:function(e){this._className!==e&&(this._flagClassName=!0,this.classList=e.split(/\s+?/),this._className=e)}}},pn=Math.cos,_n=Math.sin,Ai=Math.tan,Ke=[],Rt=class extends O{constructor(e,t,r,l,o,h){super(),g(this,"elements",new Ht(9)),g(this,"manual",!1);let u=e;Array.isArray(u)||(u=Array.prototype.slice.call(arguments)),this.identity(),u.length>0&&this.set(u)}static Multiply(e,t,r){if(t.length<=3){const k=e;let U,D,Z;const V=t[0]||0,q=t[1]||0,J=t[2]||0;return U=k[0]*V+k[1]*q+k[2]*J,D=k[3]*V+k[4]*q+k[5]*J,Z=k[6]*V+k[7]*q+k[8]*J,[U,D,Z]}const l=e[0],o=e[1],h=e[2],u=e[3],c=e[4],p=e[5],_=e[6],x=e[7],w=e[8],b=t[0],P=t[1],C=t[2],S=t[3],L=t[4],A=t[5],I=t[6],X=t[7],M=t[8];return r=r||new Ht(9),r[0]=l*b+o*S+h*I,r[1]=l*P+o*L+h*X,r[2]=l*C+o*A+h*M,r[3]=u*b+c*S+p*I,r[4]=u*P+c*L+p*X,r[5]=u*C+c*A+p*M,r[6]=_*b+x*S+w*I,r[7]=_*P+x*L+w*X,r[8]=_*C+x*A+w*M,r}set(e,t,r,l,o,h,u,c,p){if(typeof t>"u"){const _=e;e=_[0],t=_[1],r=_[2],l=_[3],o=_[4],h=_[5],u=_[6],c=_[7],p=_[8]}return this.elements[0]=e,this.elements[1]=t,this.elements[2]=r,this.elements[3]=l,this.elements[4]=o,this.elements[5]=h,this.elements[6]=u,this.elements[7]=c,this.elements[8]=p,this.trigger(O.Types.change)}copy(e){return this.elements[0]=e.elements[0],this.elements[1]=e.elements[1],this.elements[2]=e.elements[2],this.elements[3]=e.elements[3],this.elements[4]=e.elements[4],this.elements[5]=e.elements[5],this.elements[6]=e.elements[6],this.elements[7]=e.elements[7],this.elements[8]=e.elements[8],this.manual=e.manual,this.trigger(O.Types.change)}identity(){return this.elements[0]=Rt.Identity[0],this.elements[1]=Rt.Identity[1],this.elements[2]=Rt.Identity[2],this.elements[3]=Rt.Identity[3],this.elements[4]=Rt.Identity[4],this.elements[5]=Rt.Identity[5],this.elements[6]=Rt.Identity[6],this.elements[7]=Rt.Identity[7],this.elements[8]=Rt.Identity[8],this.trigger(O.Types.change)}multiply(e,t,r,l,o,h,u,c,p){if(typeof t>"u")return this.elements[0]*=e,this.elements[1]*=e,this.elements[2]*=e,this.elements[3]*=e,this.elements[4]*=e,this.elements[5]*=e,this.elements[6]*=e,this.elements[7]*=e,this.elements[8]*=e,this.trigger(O.Types.change);if(typeof r>"u"&&(r=1),typeof l>"u"){e=e||0,t=t||0,r=r||0,o=this.elements;const rt=o[0]*e+o[1]*t+o[2]*r,$=o[3]*e+o[4]*t+o[5]*r,ct=o[6]*e+o[7]*t+o[8]*r;return[rt,$,ct]}const _=this.elements,x=[e,t,r,l,o,h,u,c,p],w=_[0],b=_[1],P=_[2],C=_[3],S=_[4],L=_[5],A=_[6],I=_[7],X=_[8],M=x[0],k=x[1],U=x[2],D=x[3],Z=x[4],V=x[5],q=x[6],J=x[7],j=x[8];return this.elements[0]=w*M+b*D+P*q,this.elements[1]=w*k+b*Z+P*J,this.elements[2]=w*U+b*V+P*j,this.elements[3]=C*M+S*D+L*q,this.elements[4]=C*k+S*Z+L*J,this.elements[5]=C*U+S*V+L*j,this.elements[6]=A*M+I*D+X*q,this.elements[7]=A*k+I*Z+X*J,this.elements[8]=A*U+I*V+X*j,this.trigger(O.Types.change)}inverse(e){const t=this.elements;e=e||new Rt;const r=t[0],l=t[1],o=t[2],h=t[3],u=t[4],c=t[5],p=t[6],_=t[7],x=t[8],w=x*u-c*_,b=-x*h+c*p,P=_*h-u*p;let C=r*w+l*b+o*P;return C?(C=1/C,e.elements[0]=w*C,e.elements[1]=(-x*l+o*_)*C,e.elements[2]=(c*l-o*u)*C,e.elements[3]=b*C,e.elements[4]=(x*r-o*p)*C,e.elements[5]=(-c*r+o*h)*C,e.elements[6]=P*C,e.elements[7]=(-_*r+l*p)*C,e.elements[8]=(u*r-l*h)*C,e):null}scale(e,t){return arguments.length<=1&&(t=e),this.multiply(e,0,0,0,t,0,0,0,1)}rotate(e){const t=pn(e),r=_n(e);return this.multiply(t,-r,0,r,t,0,0,0,1)}translate(e,t){return this.multiply(1,0,e,0,1,t,0,0,1)}skewX(e){const t=Ai(e);return this.multiply(1,t,0,0,1,0,0,0,1)}skewY(e){const t=Ai(e);return this.multiply(1,0,0,t,1,0,0,0,1)}toString(e){return Ke.length=0,this.toTransformArray(e,Ke),Ke.map(dt).join(" ")}toTransformArray(e,t){const r=this.elements,l=!!t,o=r[0],h=r[1],u=r[2],c=r[3],p=r[4],_=r[5];if(e){const x=r[6],w=r[7],b=r[8];if(l){t[0]=o,t[1]=c,t[2]=x,t[3]=h,t[4]=p,t[5]=w,t[6]=u,t[7]=_,t[8]=b;return}return[o,c,x,h,p,w,u,_,b]}if(l){t[0]=o,t[1]=c,t[2]=h,t[3]=p,t[4]=u,t[5]=_;return}return[o,c,h,p,u,_]}toArray(e,t){const r=this.elements,l=!!t,o=r[0],h=r[1],u=r[2],c=r[3],p=r[4],_=r[5];if(e){const x=r[6],w=r[7],b=r[8];if(l){t[0]=o,t[1]=h,t[2]=u,t[3]=c,t[4]=p,t[5]=_,t[6]=x,t[7]=w,t[8]=b;return}return[o,h,u,c,p,_,x,w,b]}if(l){t[0]=o,t[1]=h,t[2]=u,t[3]=c,t[4]=p,t[5]=_;return}return[o,h,u,c,p,_]}toObject(){return{elements:this.toArray(!0),manual:!!this.manual}}clone(){return new Rt().copy(this)}},se=Rt;g(se,"Identity",[1,0,0,0,1,0,0,0,1]);us(se);var jt=class extends Ue{constructor(){super(),g(this,"_flagMatrix",!0),g(this,"_flagScale",!1),g(this,"_matrix",null),g(this,"_worldMatrix",null),g(this,"_position",null),g(this,"_rotation",0),g(this,"_scale",1),g(this,"_skewX",0),g(this,"_skewY",0);for(let e in Ce)Object.defineProperty(this,e,Ce[e]);this._renderer.flagMatrix=xs.bind(this),this.isShape=!0,this.id=yt.Identifier+yt.uniqueId(),this.matrix=new se,this.worldMatrix=new se,this.position=new R,this.rotation=0,this.scale=1,this.skewX=0,this.skewY=0}get renderer(){return this._renderer}set renderer(e){this._renderer=e}get translation(){return Ce.position.get.apply(this,arguments)}set translation(e){Ce.position.set.apply(this,arguments)}addTo(e){return e.add(this),this}remove(){return this.parent?(this.parent.remove(this),this):this}clone(e){const t=new jt;return t.position.copy(this.position),t.rotation=this.rotation,t.scale=this.scale,t.skewX=this.skewX,t.skewY=this.skewY,this.matrix.manual&&t.matrix.copy(this.matrix),e&&e.add(t),t._update()}_update(e){return!this._matrix.manual&&this._flagMatrix&&(this._matrix.identity().translate(this.position.x,this.position.y),this._scale instanceof R?this._matrix.scale(this._scale.x,this._scale.y):this._matrix.scale(this._scale),this._matrix.rotate(this.rotation),this._matrix.skewX(this.skewX),this._matrix.skewY(this.skewY)),e&&this.parent&&this.parent._update&&this.parent._update(),this}flagReset(){return this._flagMatrix=this._flagScale=!1,super.flagReset.call(this),this}},Ce={position:{enumerable:!0,get:function(){return this._position},set:function(e){this._position&&this._position.unbind(O.Types.change,this._renderer.flagMatrix),this._position=e,this._position.bind(O.Types.change,this._renderer.flagMatrix),xs.call(this)}},rotation:{enumerable:!0,get:function(){return this._rotation},set:function(e){this._rotation=e,this._flagMatrix=!0}},scale:{enumerable:!0,get:function(){return this._scale},set:function(e){this._scale instanceof R&&this._scale.unbind(O.Types.change,this._renderer.flagMatrix),this._scale=e,this._scale instanceof R&&this._scale.bind(O.Types.change,this._renderer.flagMatrix),this._flagMatrix=!0,this._flagScale=!0}},skewX:{enumerable:!0,get:function(){return this._skewX},set:function(e){this._skewX=e,this._flagMatrix=!0}},skewY:{enumerable:!0,get:function(){return this._skewY},set:function(e){this._skewY=e,this._flagMatrix=!0}},matrix:{enumerable:!0,get:function(){return this._matrix},set:function(e){this._matrix=e,this._flagMatrix=!0}},worldMatrix:{enumerable:!0,get:function(){return cs(this,this._worldMatrix),this._worldMatrix},set:function(e){this._worldMatrix=e}}};function xs(){this._flagMatrix=!0}var Jt=class extends Array{constructor(){super(),g(this,"_events",new O),arguments[0]&&Array.isArray(arguments[0])?arguments[0].length>0&&this.push.apply(this,arguments[0]):arguments.length>0&&this.push.apply(this,arguments)}get _bound(){return this._events._bound}set _bound(e){this._events._bound=e}addEventListener(){return this._events.addEventListener.apply(this,arguments)}on(){return this._events.on.apply(this,arguments)}bind(){return this._events.bind.apply(this,arguments)}removeEventListener(){return this._events.removeEventListener.apply(this,arguments)}off(){return this._events.off.apply(this,arguments)}unbind(){return this._events.unbind.apply(this,arguments)}dispatchEvent(){return this._events.dispatchEvent.apply(this,arguments)}trigger(){return this._events.trigger.apply(this,arguments)}listen(){return this._events.listen.apply(this,arguments)}ignore(){return this._events.ignore.apply(this,arguments)}pop(){const e=super.pop.apply(this,arguments);return this.trigger(O.Types.remove,[e]),e}shift(){const e=super.shift.apply(this,arguments);return this.trigger(O.Types.remove,[e]),e}push(){const e=super.push.apply(this,arguments);return this.trigger(O.Types.insert,arguments),e}unshift(){const e=super.unshift.apply(this,arguments);return this.trigger(O.Types.insert,arguments),e}splice(){const e=super.splice.apply(this,arguments);if(this.trigger(O.Types.remove,e),arguments.length>2){const t=this.slice(arguments[0],arguments[0]+arguments.length-2);this.trigger(O.Types.insert,t),this.trigger(O.Types.order)}return e}sort(){return super.sort.apply(this,arguments),this.trigger(O.Types.order),this}reverse(){return super.reverse.apply(this,arguments),this.trigger(O.Types.order),this}indexOf(){return super.indexOf.apply(this,arguments)}map(e,t){const r=[];for(let l=0;l<this.length;l++){const o=this[l];let h;t?h=e.call(t,o,l):h=e(o,l),r.push(h)}return r}},Ps=class extends Jt{constructor(e){e=Array.isArray(e)?e:Array.prototype.slice.call(arguments),super(e),g(this,"ids",{}),this.attach(e),this.on(O.Types.insert,this.attach),this.on(O.Types.remove,this.detach)}attach(e){for(let t=0;t<e.length;t++){const r=e[t];r&&r.id&&(this.ids[r.id]=r)}return this}detach(e){for(let t=0;t<e.length;t++)delete this.ids[e[t].id];return this}},Ie=Math.min,Te=Math.max,bs=class extends jt{constructor(e){super(),g(this,"_flagAdditions",!1),g(this,"_flagSubtractions",!1),g(this,"_flagOrder",!1),g(this,"_flagOpacity",!0),g(this,"_flagBeginning",!1),g(this,"_flagEnding",!1),g(this,"_flagLength",!1),g(this,"_flagMask",!1),g(this,"_fill","#fff"),g(this,"_stroke","#000"),g(this,"_linewidth",1),g(this,"_opacity",1),g(this,"_visible",!0),g(this,"_cap","round"),g(this,"_join","round"),g(this,"_miter",4),g(this,"_closed",!0),g(this,"_curved",!1),g(this,"_automatic",!0),g(this,"_beginning",0),g(this,"_ending",1),g(this,"_length",0),g(this,"_mask",null);for(let t in Si)Object.defineProperty(this,t,Si[t]);this._renderer.type="group",this.additions=[],this.subtractions=[],this.children=Array.isArray(e)?e:Array.prototype.slice.call(arguments)}static InsertChildren(e){for(let t=0;t<e.length;t++)Li.call(this,e[t],this)}static RemoveChildren(e){for(let t=0;t<e.length;t++)Li.call(this,e[t])}static OrderChildren(e){this._flagOrder=!0}clone(e){const t=new bs,r=this.children.map(function(l){return l.clone()});return t.add(r),t.opacity=this.opacity,this.mask&&(t.mask=this.mask),t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale,t.className=this.className,this.matrix.manual&&t.matrix.copy(this.matrix),e&&e.add(t),t._update()}toObject(){const e={children:[],translation:this.translation.toObject(),rotation:this.rotation,scale:this.scale instanceof R?this.scale.toObject():this.scale,opacity:this.opacity,className:this.className,mask:this.mask?this.mask.toObject():null};return this.matrix.manual&&(e.matrix=this.matrix.toObject()),W.each(this.children,function(t,r){e.children[r]=t.toObject()},this),e}corner(){const e=this.getBoundingClientRect(!0);for(let t=0;t<this.children.length;t++){const r=this.children[t];r.translation.x-=e.left,r.translation.y-=e.top}return this.mask&&(this.mask.translation.x-=e.left,this.mask.translation.y-=e.top),this}center(){const e=this.getBoundingClientRect(!0),t=e.left+e.width/2-this.translation.x,r=e.top+e.height/2-this.translation.y;for(let l=0;l<this.children.length;l++){const o=this.children[l];o.isShape&&(o.translation.x-=t,o.translation.y-=r)}return this.mask&&(this.mask.translation.x-=t,this.mask.translation.y-=r),this}getById(e){let t=null;function r(l){if(l.id===e)return l;if(l.children){for(let o=0;o<l.children.length;o++)if(t=r(l.children[o]),t)return t}return null}return r(this)}getByClassName(e){const t=[];function r(l){if(Array.prototype.indexOf.call(l.classList,e)>=0&&t.push(l),l.children)for(let o=0;o<l.children.length;o++){const h=l.children[o];r(h)}return t}return r(this)}getByType(e){const t=[];function r(l){if(l instanceof e&&t.push(l),l.children)for(let o=0;o<l.children.length;o++){const h=l.children[o];r(h)}return t}return r(this)}add(e){e instanceof Array?e=e.slice():e=Array.prototype.slice.call(arguments);for(let t=0;t<e.length;t++){const r=e[t];if(!(r&&r.id))continue;const l=Array.prototype.indexOf.call(this.children,r);l>=0&&this.children.splice(l,1),this.children.push(r)}return this}remove(e){const t=arguments.length,r=this.parent;if(t<=0&&r)return r.remove(this),this;e instanceof Array?e=e.slice():e=Array.prototype.slice.call(arguments);for(let l=0;l<e.length;l++){const o=e[l];if(!o||!this.children.ids[o.id])continue;const h=this.children.indexOf(o);h>=0&&this.children.splice(h,1)}return this}getBoundingClientRect(e){let t,r,l,o,h,u;this._update(!0);let c=1/0,p=-1/0,_=1/0,x=-1/0;const w=/texture|gradient/i;r=e?this.matrix:this.worldMatrix;for(let b=0;b<this.children.length;b++){const P=this.children[b];if(!(!P.visible||w.test(P._renderer.type))&&(t=P.getBoundingClientRect(e),l=typeof t.top!="number"||W.isNaN(t.top)||!isFinite(t.top),o=typeof t.left!="number"||W.isNaN(t.left)||!isFinite(t.left),h=typeof t.right!="number"||W.isNaN(t.right)||!isFinite(t.right),u=typeof t.bottom!="number"||W.isNaN(t.bottom)||!isFinite(t.bottom),!(l||o||h||u)))if(e){const[C,S]=r.multiply(t.left,t.top),[L,A]=r.multiply(t.right,t.top),[I,X]=r.multiply(t.left,t.bottom),[M,k]=r.multiply(t.right,t.bottom);_=Ie(S,A,X,k),c=Ie(C,L,I,M),p=Te(C,L,I,M),x=Te(S,A,X,k)}else _=Ie(t.top,_),c=Ie(t.left,c),p=Te(t.right,p),x=Te(t.bottom,x)}return{top:_,left:c,right:p,bottom:x,width:p-c,height:x-_}}noFill(){return this.children.forEach(function(e){e.noFill()}),this}noStroke(){return this.children.forEach(function(e){e.noStroke()}),this}subdivide(){const e=arguments;return this.children.forEach(function(t){t.subdivide.apply(t,e)}),this}_update(){let e,t,r;if(this._flagBeginning||this._flagEnding){const l=Math.min(this._beginning,this._ending),o=Math.max(this._beginning,this._ending),h=this.length;let u=0;const c=l*h,p=o*h;for(e=0;e<this.children.length;e++)r=this.children[e],t=r.length,c>u+t?(r.beginning=1,r.ending=1):p<u?(r.beginning=0,r.ending=0):c>u&&c<u+t?(r.beginning=(c-u)/t,r.ending=1):p>u&&p<u+t?(r.beginning=0,r.ending=(p-u)/t):(r.beginning=0,r.ending=1),u+=t}return super._update.apply(this,arguments)}flagReset(){return this._flagAdditions&&(this.additions.length=0,this._flagAdditions=!1),this._flagSubtractions&&(this.subtractions.length=0,this._flagSubtractions=!1),this._flagOrder=this._flagMask=this._flagOpacity=this._flagBeginning=this._flagEnding=!1,super.flagReset.call(this),this}},_t=bs;g(_t,"Children",Ps);g(_t,"Properties",["fill","stroke","linewidth","cap","join","miter","closed","curved","automatic"]);var Si={visible:{enumerable:!0,get:function(){return this._visible},set:function(e){this._flagVisible=this._visible!==e||this._flagVisible,this._visible=e}},opacity:{enumerable:!0,get:function(){return this._opacity},set:function(e){this._flagOpacity=this._opacity!==e||this._flagOpacity,this._opacity=e}},beginning:{enumerable:!0,get:function(){return this._beginning},set:function(e){this._flagBeginning=this._beginning!==e||this._flagBeginning,this._beginning=e}},ending:{enumerable:!0,get:function(){return this._ending},set:function(e){this._flagEnding=this._ending!==e||this._flagEnding,this._ending=e}},length:{enumerable:!0,get:function(){if(this._flagLength||this._length<=0){if(this._length=0,!this.children)return this._length;for(let e=0;e<this.children.length;e++){const t=this.children[e];this._length+=t.length}}return this._length}},fill:{enumerable:!0,get:function(){return this._fill},set:function(e){this._fill=e;for(let t=0;t<this.children.length;t++){const r=this.children[t];r.fill=e}}},stroke:{enumerable:!0,get:function(){return this._stroke},set:function(e){this._stroke=e;for(let t=0;t<this.children.length;t++){const r=this.children[t];r.stroke=e}}},linewidth:{enumerable:!0,get:function(){return this._linewidth},set:function(e){this._linewidth=e;for(let t=0;t<this.children.length;t++){const r=this.children[t];r.linewidth=e}}},join:{enumerable:!0,get:function(){return this._join},set:function(e){this._join=e;for(let t=0;t<this.children.length;t++){const r=this.children[t];r.join=e}}},miter:{enumerable:!0,get:function(){return this._miter},set:function(e){this._miter=e;for(let t=0;t<this.children.length;t++){const r=this.children[t];r.miter=e}}},cap:{enumerable:!0,get:function(){return this._cap},set:function(e){this._cap=e;for(let t=0;t<this.children.length;t++){const r=this.children[t];r.cap=e}}},closed:{enumerable:!0,get:function(){return this._closed},set:function(e){this._closed=e;for(let t=0;t<this.children.length;t++){const r=this.children[t];r.closed=e}}},curved:{enumerable:!0,get:function(){return this._curved},set:function(e){this._curved=e;for(let t=0;t<this.children.length;t++){const r=this.children[t];r.curved=e}}},automatic:{enumerable:!0,get:function(){return this._automatic},set:function(e){this._automatic=e;for(let t=0;t<this.children.length;t++){const r=this.children[t];r.automatic=e}}},children:{enumerable:!0,get:function(){return this._children},set:function(e){const t=_t.InsertChildren.bind(this),r=_t.RemoveChildren.bind(this),l=_t.OrderChildren.bind(this);this._children&&(this._children.unbind(),this._children.length>0&&r(this._children)),this._children=new Ps(e),this._children.bind(O.Types.insert,t),this._children.bind(O.Types.remove,r),this._children.bind(O.Types.order,l),e.length>0&&t(e)}},mask:{enumerable:!0,get:function(){return this._mask},set:function(e){this._mask=e,this._flagMask=!0,W.isObject(e)&&!e.clip&&(e.clip=!0)}}};function Li(e,t){const r=e.parent;let l;if(r===t){o();return}if(r&&r.children.ids[e.id]&&(l=Array.prototype.indexOf.call(r.children,e),r.children.splice(l,1),h()),t){o();return}h(),r._flagAdditions&&r.additions.length===0&&(r._flagAdditions=!1),r._flagSubtractions&&r.subtractions.length===0&&(r._flagSubtractions=!1),delete e.parent;function o(){t.subtractions.length>0&&(l=Array.prototype.indexOf.call(t.subtractions,e),l>=0&&t.subtractions.splice(l,1)),t.additions.length>0&&(l=Array.prototype.indexOf.call(t.additions,e),l>=0&&t.additions.splice(l,1)),e.parent=t,t.additions.push(e),t._flagAdditions=!0}function h(){l=Array.prototype.indexOf.call(r.additions,e),l>=0&&r.additions.splice(l,1),l=Array.prototype.indexOf.call(r.subtractions,e),l<0&&(r.subtractions.push(e),r._flagSubtractions=!0)}}var $e=[],li=Math.max,mn=Math.min,Ei=Math.abs,Ae=Math.sin,Se=Math.cos,gn=Math.acos,De=Math.sqrt,pt={isHidden:/(undefined|none|transparent)/i,alignments:{left:"start",middle:"center",right:"end"},baselines:{top:"top",middle:"middle",bottom:"bottom",baseline:"alphabetic"},shim:function(e,t){return e.tagName=e.nodeName=t||"canvas",e.nodeType=1,e.getAttribute=function(r){return this[r]},e.setAttribute=function(r,l){return this[r]=l,this},e},group:{renderChild:function(e){pt[e._renderer.type].render.call(e,this.ctx,!0,this.clip)},render:function(e){if(!this._visible)return this;this._update();const t=this._matrix.elements,r=this.parent;this._renderer.opacity=this._opacity*(r&&r._renderer?r._renderer.opacity:1);const l=this._mask,o=Le(t),h=!o||!!l;if(this._renderer.context||(this._renderer.context={}),this._renderer.context.ctx=e,h&&(e.save(),o||e.transform(t[0],t[3],t[1],t[4],t[2],t[5])),l&&pt[l._renderer.type].render.call(l,e,!0),this._opacity>0&&this._scale!==0)for(let u=0;u<this.children.length;u++){const c=this.children[u];pt[c._renderer.type].render.call(c,e)}return h&&e.restore(),this.flagReset()}},path:{render:function(e,t,r){let l,o,h,u,c,p,_,x,w,b,P,C,S,L,A,I,X,M,k,U,D,Z,V,q,J,j,rt,$,ct,ot,Mt,xt,bt,Bt;if(Bt=this.parent&&this.parent._renderer?this.parent._renderer.opacity:1,ct=this._mask,ot=this._clip,c=this._opacity*(Bt||1),p=this._visible,!t&&(!p||ot||c===0))return this;this._update(),l=this._matrix.elements,o=this._stroke,h=this._linewidth,u=this._fill,_=this._cap,x=this._join,w=this._miter,b=this._closed,P=this._renderer.vertices,C=P.length,S=C-1,Mt=Le(l),bt=this.dashes,Mt||(e.save(),e.transform(l[0],l[3],l[1],l[4],l[2],l[5])),ct&&pt[ct._renderer.type].render.call(ct,e,!0),u&&(typeof u=="string"?e.fillStyle=u:(pt[u._renderer.type].render.call(u,e,this),e.fillStyle=u._renderer.effect)),o&&(typeof o=="string"?e.strokeStyle=o:(pt[o._renderer.type].render.call(o,e,this),e.strokeStyle=o._renderer.effect),h&&(e.lineWidth=h),w&&(e.miterLimit=w),x&&(e.lineJoin=x),!b&&_&&(e.lineCap=_)),typeof c=="number"&&(e.globalAlpha=c),bt&&bt.length>0&&(e.lineDashOffset=bt.offset||0,e.setLineDash(bt)),e.beginPath();let Wt,$t,Tt,Qt,te,ee,At;for(let nt=0;nt<C;nt++)switch(I=P[nt],rt=I.x,$=I.y,I.command){case F.close:e.closePath();break;case F.arc:Wt=I.rx,$t=I.ry,Tt=I.xAxisRotation,Qt=I.largeArcFlag,te=I.sweepFlag,L=b?Nt(nt-1,C):li(nt-1,0),A=P[L],ee=A.x,At=A.y,pt.renderSvgArcCommand(e,ee,At,Wt,$t,Qt,te,Tt,rt,$);break;case F.curve:L=b?Nt(nt-1,C):Math.max(nt-1,0),A=P[L],V=A.controls&&A.controls.right||R.zero,q=I.controls&&I.controls.left||R.zero,A._relative?(D=V.x+A.x,Z=V.y+A.y):(D=V.x,Z=V.y),I._relative?(k=q.x+I.x,U=q.y+I.y):(k=q.x,U=q.y),e.bezierCurveTo(D,Z,k,U,rt,$),nt>=S&&b&&(X=M,J=I.controls&&I.controls.right||R.zero,j=X.controls&&X.controls.left||R.zero,I._relative?(D=J.x+I.x,Z=J.y+I.y):(D=J.x,Z=J.y),X._relative?(k=j.x+X.x,U=j.y+X.y):(k=j.x,U=j.y),rt=X.x,$=X.y,e.bezierCurveTo(D,Z,k,U,rt,$));break;case F.line:e.lineTo(rt,$);break;case F.move:M=I,e.moveTo(rt,$);break}return b&&e.closePath(),!ot&&!r&&(pt.isHidden.test(u)||(xt=u._renderer&&u._renderer.offset,xt&&(e.save(),e.translate(-u._renderer.offset.x,-u._renderer.offset.y),e.scale(u._renderer.scale.x,u._renderer.scale.y)),e.fill(),xt&&e.restore()),pt.isHidden.test(o)||(xt=o._renderer&&o._renderer.offset,xt&&(e.save(),e.translate(-o._renderer.offset.x,-o._renderer.offset.y),e.scale(o._renderer.scale.x,o._renderer.scale.y),e.lineWidth=h/o._renderer.scale.x),e.stroke(),xt&&e.restore())),Mt||e.restore(),ot&&!r&&e.clip(),bt&&bt.length>0&&e.setLineDash($e),this.flagReset()}},points:{render:function(e,t,r){let l,o,h,u,c,p,_,x,w,b,P,C,S,L,A,I;if(I=this.parent&&this.parent._renderer?this.parent._renderer.opacity:1,c=this._opacity*(I||1),p=this._visible,!t&&(!p||c===0))return this;this._update(),l=this._matrix.elements,o=this._stroke,h=this._linewidth,u=this._fill,x=this._renderer.collection,w=x.length,S=Le(l),A=this.dashes,_=this._size,S||(e.save(),e.transform(l[0],l[3],l[1],l[4],l[2],l[5])),u&&(typeof u=="string"?e.fillStyle=u:(pt[u._renderer.type].render.call(u,e,this),e.fillStyle=u._renderer.effect)),o&&(typeof o=="string"?e.strokeStyle=o:(pt[o._renderer.type].render.call(o,e,this),e.strokeStyle=o._renderer.effect),h&&(e.lineWidth=h)),typeof c=="number"&&(e.globalAlpha=c),A&&A.length>0&&(e.lineDashOffset=A.offset||0,e.setLineDash(A)),e.beginPath();let X=_*.5,M;this._sizeAttenuation||(M=this.worldMatrix.elements,M=ce(M[0],M[3],M[1],M[4],M[2],M[5]),X/=Math.max(M.scaleX,M.scaleY));for(let k=0;k<w;k++)b=x[k],P=b.x,C=b.y,e.moveTo(P+X,C),e.arc(P,C,X,0,Pt);return r||(pt.isHidden.test(u)||(L=u._renderer&&u._renderer.offset,L&&(e.save(),e.translate(-u._renderer.offset.x,-u._renderer.offset.y),e.scale(u._renderer.scale.x,u._renderer.scale.y)),e.fill(),L&&e.restore()),pt.isHidden.test(o)||(L=o._renderer&&o._renderer.offset,L&&(e.save(),e.translate(-o._renderer.offset.x,-o._renderer.offset.y),e.scale(o._renderer.scale.x,o._renderer.scale.y),e.lineWidth=h/o._renderer.scale.x),e.stroke(),L&&e.restore())),S||e.restore(),A&&A.length>0&&e.setLineDash($e),this.flagReset()}},text:{render:function(e,t,r){const l=this.parent&&this.parent._renderer?this.parent._renderer.opacity:1,o=this._opacity*l,h=this._visible,u=this._mask,c=this._clip;if(!t&&(!h||c||o===0))return this;this._update();const p=this._matrix.elements,_=this._stroke,x=this._linewidth,w=this._fill,b=this._decoration,P=this._direction,C=Le(p),S=w._renderer&&w._renderer.offset&&_._renderer&&_._renderer.offset,L=this.dashes,A=pt.alignments[this._alignment]||this._alignment,I=pt.baselines[this._baseline]||this._baseline;let X,M,k,U,D,Z,V,q,J,j,rt;if(C||(e.save(),e.transform(p[0],p[3],p[1],p[4],p[2],p[5])),u&&pt[u._renderer.type].render.call(u,e,!0),S||(e.font=[this._style,this._weight,this._size+"px/"+this._leading+"px",this._family].join(" ")),e.textAlign=A,e.textBaseline=I,e.direction=P,w&&(typeof w=="string"?e.fillStyle=w:(pt[w._renderer.type].render.call(w,e,this),e.fillStyle=w._renderer.effect)),_&&(typeof _=="string"?e.strokeStyle=_:(pt[_._renderer.type].render.call(_,e,this),e.strokeStyle=_._renderer.effect),x&&(e.lineWidth=x)),typeof o=="number"&&(e.globalAlpha=o),L&&L.length>0&&(e.lineDashOffset=L.offset||0,e.setLineDash(L)),!c&&!r&&(pt.isHidden.test(w)||(w._renderer&&w._renderer.offset?(Z=w._renderer.scale.x,V=w._renderer.scale.y,e.save(),e.translate(-w._renderer.offset.x,-w._renderer.offset.y),e.scale(Z,V),X=this._size/w._renderer.scale.y,M=this._leading/w._renderer.scale.y,e.font=[this._style,this._weight,X+"px/",M+"px",this._family].join(" "),k=w._renderer.offset.x/w._renderer.scale.x,U=w._renderer.offset.y/w._renderer.scale.y,e.fillText(this.value,k,U),e.restore()):e.fillText(this.value,0,0)),pt.isHidden.test(_)||(_._renderer&&_._renderer.offset?(Z=_._renderer.scale.x,V=_._renderer.scale.y,e.save(),e.translate(-_._renderer.offset.x,-_._renderer.offset.y),e.scale(Z,V),X=this._size/_._renderer.scale.y,M=this._leading/_._renderer.scale.y,e.font=[this._style,this._weight,X+"px/",M+"px",this._family].join(" "),k=_._renderer.offset.x/_._renderer.scale.x,U=_._renderer.offset.y/_._renderer.scale.y,D=x/_._renderer.scale.x,e.lineWidth=D,e.strokeText(this.value,k,U),e.restore()):e.strokeText(this.value,0,0))),/(underline|strikethrough)/i.test(b)){const $=e.measureText(this.value);let ct=1;switch(b){case"underline":J=$.actualBoundingBoxDescent,rt=$.actualBoundingBoxDescent;break;case"strikethrough":J=0,rt=0,ct=.5;break}switch(I){case"top":J+=this._size*ct,rt+=this._size*ct;break;case"baseline":case"bottom":J-=this._size*ct,rt-=this._size*ct;break}switch(A){case"left":case"start":q=0,j=$.width;break;case"right":case"end":q=-$.width,j=0;break;default:q=-$.width/2,j=$.width/2}e.lineWidth=Math.max(Math.floor(this._size/15),1),e.strokeStyle=e.fillStyle,e.beginPath(),e.moveTo(q,J),e.lineTo(j,rt),e.stroke()}return C||e.restore(),c&&!r&&e.clip(),L&&L.length>0&&e.setLineDash($e),this.flagReset()}},"linear-gradient":{render:function(e,t){if(t){if(this._update(),!this._renderer.effect||this._flagEndPoints||this._flagStops||this._flagUnits){let r,l=this.left._x,o=this.left._y,h=this.right._x,u=this.right._y;/objectBoundingBox/i.test(this._units)&&(r=t.getBoundingClientRect(!0),l=(l-.5)*r.width,o=(o-.5)*r.height,h=(h-.5)*r.width,u=(u-.5)*r.height),this._renderer.effect=e.createLinearGradient(l,o,h,u);for(let c=0;c<this.stops.length;c++){const p=this.stops[c];this._renderer.effect.addColorStop(p._offset,p._color)}}return this.flagReset()}}},"radial-gradient":{render:function(e,t){if(t){if(this._update(),!this._renderer.effect||this._flagCenter||this._flagFocal||this._flagRadius||this._flagStops||this._flagUnits){let r,l=this.center._x,o=this.center._y,h=this.focal._x,u=this.focal._y,c=this._radius;/objectBoundingBox/i.test(this._units)&&(r=t.getBoundingClientRect(!0),l=(l-.5)*r.width*.5,o=(o-.5)*r.height*.5,h=(h-.5)*r.width*.5,u=(u-.5)*r.height*.5,c*=Math.min(r.width,r.height)),this._renderer.effect=e.createRadialGradient(l,o,0,h,u,c);for(let p=0;p<this.stops.length;p++){const _=this.stops[p];this._renderer.effect.addColorStop(_._offset,_._color)}}return this.flagReset()}}},texture:{render:function(e){this._update();const t=this.image;return(!this._renderer.effect||(this._flagLoaded||this._flagImage||this._flagVideo||this._flagRepeat)&&this.loaded)&&(this._renderer.effect=e.createPattern(this.image,this._repeat)),(this._flagOffset||this._flagLoaded||this._flagScale)&&(this._renderer.offset instanceof R||(this._renderer.offset=new R),this._renderer.offset.x=-this._offset.x,this._renderer.offset.y=-this._offset.y,t&&(this._renderer.offset.x+=t.width/2,this._renderer.offset.y+=t.height/2,this._scale instanceof R?(this._renderer.offset.x*=this._scale.x,this._renderer.offset.y*=this._scale.y):(this._renderer.offset.x*=this._scale,this._renderer.offset.y*=this._scale))),(this._flagScale||this._flagLoaded)&&(this._renderer.scale instanceof R||(this._renderer.scale=new R),this._scale instanceof R?this._renderer.scale.copy(this._scale):this._renderer.scale.set(this._scale,this._scale)),this.flagReset()}},renderSvgArcCommand:function(e,t,r,l,o,h,u,c,p,_){c=c*Math.PI/180,l=Ei(l),o=Ei(o);const x=(t-p)/2,w=(r-_)/2,b=Se(c)*x+Ae(c)*w,P=-Ae(c)*x+Se(c)*w,C=b*b,S=P*P;let L=l*l,A=o*o;const I=C/L+S/A;if(I>1){const $=De(I);l=$*l,o=$*o,L=l*l,A=o*o}const X=L*S+A*C,M=(L*A-X)/X;let k=De(li(0,M));h===u&&(k=-k);const U=k*l*P/o,D=-k*o*b/l,Z=Se(c)*U-Ae(c)*D+(t+p)/2,V=Ae(c)*U+Se(c)*D+(r+_)/2,q=Oi(1,0,(b-U)/l,(P-D)/o),J=Oi((b-U)/l,(P-D)/o,(-b-U)/l,(-P-D)/o)%Pt,j=q+J;yn(e,Z,V,l,o,q,j,u===0,c)}},_e=class extends O{constructor(e){super();const t=e.smoothing!==!1;this.domElement=e.domElement||document.createElement("canvas"),this.ctx=this.domElement.getContext("2d"),this.overdraw=e.overdraw||!1,typeof this.ctx.imageSmoothingEnabled<"u"&&(this.ctx.imageSmoothingEnabled=t),this.scene=new _t,this.scene.parent=this}setSize(e,t,r){return this.width=e,this.height=t,this.ratio=typeof r>"u"?ci(this.ctx):r,this.domElement.width=e*this.ratio,this.domElement.height=t*this.ratio,this.domElement.style&&W.extend(this.domElement.style,{width:e+"px",height:t+"px"}),this.trigger(O.Types.resize,e,t,r)}render(){const e=this.ratio===1;return e||(this.ctx.save(),this.ctx.scale(this.ratio,this.ratio)),this.overdraw||this.ctx.clearRect(0,0,this.width,this.height),pt.group.render.call(this.scene,this.ctx),e||this.ctx.restore(),this}};g(_e,"Utils",pt);function yn(e,t,r,l,o,h,u,c,p){const _=u-h,x=de.Tolerance.epsilon,w=Math.abs(_)<x;let b=Nt(_,Pt);b<x&&(w?b=0:b=Pt),c===!0&&!w&&(b===Pt?b=-Pt:b=b-Pt);for(let P=0;P<yt.Resolution;P++){const C=P/(yt.Resolution-1),S=h+C*b;let L=t+l*Math.cos(S),A=r+o*Math.sin(S);if(p!==0){const I=Math.cos(p),X=Math.sin(p),M=L-t,k=A-r;L=M*I-k*X+t,A=M*X+k*I+r}e.lineTo(L,A)}}function Oi(e,t,r,l){const o=e*r+t*l,h=De(e*e+t*t)*De(r*r+l*l);let u=gn(li(-1,mn(1,o/h)));return e*l-t*r<0&&(u=-u),u}function Le(e){return e[0]==1&&e[3]==0&&e[1]==0&&e[4]==1&&e[2]==0&&e[5]==0}var Ot={Image:null,isHeadless:!1,shim:function(e,t){return _e.Utils.shim(e),typeof t<"u"&&(Ot.Image=t),Ot.isHeadless=!0,e}},Et={hasEventListeners:typeof ut.addEventListener=="function",bind:function(e,t,r,l){return this.hasEventListeners?e.addEventListener(t,r,!!l):e.attachEvent("on"+t,r),Et},unbind:function(e,t,r,l){return Et.hasEventListeners?e.removeEventListeners(t,r,!!l):e.detachEvent("on"+t,r),Et},getRequestAnimationFrame:function(){const e=["ms","moz","webkit","o"];let t=0,r=ut.requestAnimationFrame;if(!r){for(let o=0;o<e.length;o++)r=ut[e[o]+"RequestAnimationFrame"]||r;r=r||l}function l(o,h){const u=new Date().getTime(),c=Math.max(0,16-(u-t)),p=ut.setTimeout(_,c);t=u+c;function _(){o(u+c)}return p}return r}},ue=ut.document?ut.document.createElement("div"):{};ue.id="help-two-load";Object.defineProperty(Et,"temp",{enumerable:!0,get:function(){return W.isElement(ue)&&!ut.document.head.contains(ue)&&(ue.style.display="none",ut.document.head.appendChild(ue)),ue}});var kt=class extends Error{constructor(e){super(),g(this,"name","Two.js"),g(this,"message"),this.message=e}},qe=class{constructor(){g(this,"map",{})}add(e,t){return this.map[e]=t,this}remove(e){return delete this.map[e],this}get(e){return this.map[e]}contains(e){return e in this.map}};function ki(e,t){if(t===0||t===1)return!0;const l=e._length*t;let o=0;for(let h=0;h<e._lengths.length;h++){const u=e._lengths[h];if(o>=l)return l-o>=0;o+=u}return!1}function We(e,t){const r=e._length;if(t<=0)return 0;if(t>=r)return e._lengths.length-1;for(let l=0,o=0;l<e._lengths.length;l++){if(o+e._lengths[l]>=t)return t-=o,Math.max(l-1,0)+t/e._lengths[l];o+=e._lengths[l]}return-1}function oi(e,t,r){let l,o,h,u,c,p,_,x;const w=t.controls&&t.controls.right,b=e.controls&&e.controls.left;return l=t.x,c=t.y,o=(w||t).x,p=(w||t).y,h=(b||e).x,_=(b||e).y,u=e.x,x=e.y,w&&t._relative&&(o+=t.x,p+=t.y),b&&e._relative&&(h+=e.x,_+=e.y),_s(l,c,o,p,h,_,u,x,r)}function Ni(e,t,r){let l,o,h,u,c,p,_,x;const w=t.controls&&t.controls.right,b=e.controls&&e.controls.left;return l=t.x,c=t.y,o=(w||t).x,p=(w||t).y,h=(b||e).x,_=(b||e).y,u=e.x,x=e.y,w&&t._relative&&(o+=t.x,p+=t.y),b&&e._relative&&(h+=e.x,_+=e.y),ui(l,c,o,p,h,_,u,x,r)}var Zt=class extends Ue{constructor(e,t,r){super(),g(this,"_flagOffset",!0),g(this,"_flagOpacity",!0),g(this,"_flagColor",!0),g(this,"_offset",0),g(this,"_opacity",1),g(this,"_color","#fff");for(let l in Mi)Object.defineProperty(this,l,Mi[l]);this._renderer.type="stop",this.offset=typeof e=="number"?e:Zt.Index<=0?0:1,this.opacity=typeof r=="number"?r:1,this.color=typeof t=="string"?t:Zt.Index<=0?"#fff":"#000",Zt.Index=(Zt.Index+1)%2}clone(e){const t=new Zt;return W.each(Zt.Properties,function(r){t[r]=this[r]},this),e&&e.stops&&e.stops.push(t),t}toObject(){const e={};return W.each(Zt.Properties,function(t){e[t]=this[t]},this),e}flagReset(){return this._flagOffset=this._flagColor=this._flagOpacity=!1,super.flagReset.call(this),this}},Kt=Zt;g(Kt,"Index",0);g(Kt,"Properties",["offset","opacity","color"]);var Mi={offset:{enumerable:!0,get:function(){return this._offset},set:function(e){this._offset=e,this._flagOffset=!0,this.parent&&(this.parent._flagStops=!0)}},opacity:{enumerable:!0,get:function(){return this._opacity},set:function(e){this._opacity=e,this._flagOpacity=!0,this.parent&&(this.parent._flagStops=!0)}},color:{enumerable:!0,get:function(){return this._color},set:function(e){this._color=e,this._flagColor=!0,this.parent&&(this.parent._flagStops=!0)}}},Oe=class extends Ue{constructor(e){super(),g(this,"_flagStops",!1),g(this,"_flagSpread",!1),g(this,"_flagUnits",!1),g(this,"_spread",""),g(this,"_units","");for(let t in Xi)Object.defineProperty(this,t,Xi[t]);this._renderer.type="gradient",this.id=yt.Identifier+yt.uniqueId(),this.classList=[],this._renderer.flagStops=vn.bind(this),this._renderer.bindStops=xn.bind(this),this._renderer.unbindStops=Pn.bind(this),this.spread="pad",this.units="objectBoundingBox",e&&(this.stops=e)}clone(e){const t=this.stops.map(function(l){return l.clone()}),r=new Oe(t);return W.each(Oe.Properties,function(l){r[l]=this[l]},this),e&&e.add(r),r}toObject(){const e={stops:this.stops.map(function(t){return t.toObject()})};return W.each(Oe.Properties,function(t){e[t]=this[t]},this),e}_update(){return(this._flagSpread||this._flagStops)&&this.trigger(O.Types.change),this}flagReset(){return this._flagSpread=this._flagUnits=this._flagStops=!1,super.flagReset.call(this),this}},mt=Oe;g(mt,"Stop",Kt);g(mt,"Properties",["spread","stops","renderer","units"]);var Xi={spread:{enumerable:!0,get:function(){return this._spread},set:function(e){this._spread=e,this._flagSpread=!0}},units:{enumerable:!0,get:function(){return this._units},set:function(e){this._units=e,this._flagUnits=!0}},stops:{enumerable:!0,get:function(){return this._stops},set:function(e){const t=this._renderer.bindStops,r=this._renderer.unbindStops;this._stops&&this._stops.unbind(O.Types.insert,t).unbind(O.Types.remove,r),this._stops=new Jt((e||[]).slice(0)),this._stops.bind(O.Types.insert,t).bind(O.Types.remove,r),t(this._stops)}}};function vn(){this._flagStops=!0}function xn(e){let t=e.length;for(;t--;)e[t].bind(O.Types.change,this._renderer.flagStops),e[t].parent=this;this._renderer.flagStops()}function Pn(e){let t=e.length;for(;t--;)e[t].unbind(O.Types.change,this._renderer.flagStops),delete e[t].parent;this._renderer.flagStops()}var ws=class extends mt{constructor(e,t,r,l,o){super(o),g(this,"_flagEndPoints",!1),g(this,"_left",null),g(this,"_right",null);for(let h in Fi)Object.defineProperty(this,h,Fi[h]);this._renderer.type="linear-gradient",this._renderer.flagEndPoints=bn.bind(this),this.left=new R,this.right=new R,typeof e=="number"&&(this.left.x=e),typeof t=="number"&&(this.left.y=t),typeof r=="number"&&(this.right.x=r),typeof l=="number"&&(this.right.y=l)}clone(e){const t=this.stops.map(function(l){return l.clone()}),r=new ws(this.left._x,this.left._y,this.right._x,this.right._y,t);return W.each(mt.Properties,function(l){r[l]=this[l]},this),e&&e.add(r),r}toObject(){const e=super.toObject.call(this);return e.left=this.left.toObject(),e.right=this.right.toObject(),e}_update(){return(this._flagEndPoints||this._flagSpread||this._flagStops)&&this.trigger(O.Types.change),this}flagReset(){return this._flagEndPoints=!1,super.flagReset.call(this),this}},ht=ws;g(ht,"Properties",["left","right"]);g(ht,"Stop",Kt);var Fi={left:{enumerable:!0,get:function(){return this._left},set:function(e){this._left instanceof R&&this._left.unbind(O.Types.change,this._renderer.flagEndPoints),this._left=e,this._left.bind(O.Types.change,this._renderer.flagEndPoints),this._flagEndPoints=!0}},right:{enumerable:!0,get:function(){return this._right},set:function(e){this._right instanceof R&&this._right.unbind(O.Types.change,this._renderer.flagEndPoints),this._right=e,this._right.bind(O.Types.change,this._renderer.flagEndPoints),this._flagEndPoints=!0}}};function bn(){this._flagEndPoints=!0}var ke=class extends mt{constructor(e,t,r,l,o,h){super(l),g(this,"_flagRadius",!1),g(this,"_flagCenter",!1),g(this,"_flagFocal",!1),g(this,"_radius",0),g(this,"_center",null),g(this,"_focal",null);for(let u in Ri)Object.defineProperty(this,u,Ri[u]);this._renderer.type="radial-gradient",this._renderer.flagCenter=wn.bind(this),this._renderer.flagFocal=Cn.bind(this),this.center=new R,this.radius=typeof r=="number"?r:1,this.focal=new R,typeof e=="number"&&(this.center.x=e),typeof t=="number"&&(this.center.y=t),this.focal.copy(this.center),typeof o=="number"&&(this.focal.x=o),typeof h=="number"&&(this.focal.y=h)}clone(e){const t=this.stops.map(function(l){return l.clone()}),r=new ke(this.center._x,this.center._y,this._radius,t,this.focal._x,this.focal._y);return W.each(mt.Properties.concat(ke.Properties),function(l){r[l]=this[l]},this),e&&e.add(r),r}toObject(){const e=super.toObject.call(this);return W.each(ke.Properties,function(t){e[t]=this[t]},this),e.center=this.center.toObject(),e.focal=this.focal.toObject(),e}_update(){return(this._flagRadius||this._flatCenter||this._flagFocal||this._flagSpread||this._flagStops)&&this.trigger(O.Types.change),this}flagReset(){return this._flagRadius=this._flagCenter=this._flagFocal=!1,super.flagReset.call(this),this}},ft=ke;g(ft,"Stop",Kt);g(ft,"Properties",["center","radius","focal"]);var Ri={radius:{enumerable:!0,get:function(){return this._radius},set:function(e){this._radius=e,this._flagRadius=!0}},center:{enumerable:!0,get:function(){return this._center},set:function(e){this._center&&this._center.unbind(O.Types.change,this._renderer.flagCenter),this._center=e,this._center.bind(O.Types.change,this._renderer.flagCenter),this._flagCenter=!0}},focal:{enumerable:!0,get:function(){return this._focal},set:function(e){this._focal&&this._focal.unbind(O.Types.change,this._renderer.flagFocal),this._focal=e,this._focal.bind(O.Types.change,this._renderer.flagFocal),this._flagFocal=!0}}};function wn(){this._flagCenter=!0}function Cn(){this._flagFocal=!0}var Ne,Cs={video:/\.(mp4|webm|ogg)$/i,image:/\.(jpe?g|png|gif|tiff|webp)$/i,effect:/texture|gradient/i};ut.document&&(Ne=document.createElement("a"));var vt=class extends Ue{constructor(e,t){super(),g(this,"_flagSrc",!1),g(this,"_flagImage",!1),g(this,"_flagVideo",!1),g(this,"_flagLoaded",!1),g(this,"_flagRepeat",!1),g(this,"_flagOffset",!1),g(this,"_flagScale",!1),g(this,"_src",""),g(this,"_image",null),g(this,"_loaded",!1),g(this,"_repeat","no-repeat"),g(this,"_scale",1),g(this,"_offset",null),this._renderer={};for(let r in Bi)Object.defineProperty(this,r,Bi[r]);if(this._renderer.type="texture",this._renderer.flagOffset=In.bind(this),this._renderer.flagScale=Tn.bind(this),this.id=yt.Identifier+yt.uniqueId(),this.classList=[],this.loaded=!1,this.repeat="no-repeat",this.offset=new R,typeof t=="function"){const r=(function(){this.unbind(O.Types.load,r),typeof t=="function"&&t()}).bind(this);this.bind(O.Types.load,r)}if(typeof e=="string")this.src=e;else if(typeof e=="object"){const r=Object.prototype.toString.call(e);(r==="[object HTMLImageElement]"||r==="[object HTMLCanvasElement]"||r==="[object HTMLVideoElement]"||r==="[object Image]")&&(this.image=e)}this._update()}static getAbsoluteURL(e){return Ne?(Ne.href=e,Ne.href):e}static loadHeadlessBuffer(e,t){e.image.onload=t,e.image.src=e.src}static getTag(e){return e&&e.nodeName&&e.nodeName.toLowerCase()||"img"}static getImage(e){const t=vt.getAbsoluteURL(e);if(vt.ImageRegistry.contains(t))return vt.ImageRegistry.get(t);let r;return Ot.Image?(r=new Ot.Image,_e.Utils.shim(r,"img")):ut.document?Cs.video.test(t)?r=document.createElement("video"):r=document.createElement("img"):console.warn("Two.js: no prototypical image defined for Two.Texture"),r.crossOrigin="anonymous",r.referrerPolicy="no-referrer",r}static load(e,t){let r=e.image,l=vt.getTag(r);e._flagImage&&(/canvas/i.test(l)?vt.Register.canvas(e,t):(e._src=!Ot.isHeadless&&r.getAttribute("two-src")||r.src,vt.Register[l](e,t))),e._flagSrc&&(r||(r=vt.getImage(e.src),e.image=r),l=vt.getTag(r),vt.Register[l](e,t))}clone(){const e=new vt(this.src);return e.repeat=this.repeat,e.offset.copy(this.origin),e.scale=this.scale,e}toObject(){return{src:this.src,repeat:this.repeat,origin:this.origin.toObject(),scale:typeof this.scale=="number"?this.scale:this.scale.toObject()}}_update(){return(this._flagSrc||this._flagImage)&&(this.trigger(O.Types.change),(this._flagSrc||this._flagImage)&&(this.loaded=!1,vt.load(this,(function(){this.loaded=!0,this.trigger(O.Types.change).trigger(O.Types.load)}).bind(this)))),this._image&&this._image.readyState>=4&&(this._flagVideo=!0),this}flagReset(){return this._flagSrc=this._flagImage=this._flagLoaded=this._flagRepeat=this._flagVideo=this._flagScale=this._flagOffset=!1,super.flagReset.call(this),this}},st=vt;g(st,"Properties",["src","loaded","repeat","scale","offset","image"]);g(st,"RegularExpressions",Cs);g(st,"ImageRegistry",new qe);g(st,"Register",{canvas:function(e,t){e._src="#"+e.id,vt.ImageRegistry.add(e.src,e.image),typeof t=="function"&&t()},img:function(e,t){const r=e.image,l=function(h){!Ot.isHeadless&&r.removeEventListener&&typeof r.removeEventListener=="function"&&(r.removeEventListener("load",l,!1),r.removeEventListener("error",o,!1)),typeof t=="function"&&t()},o=function(h){throw!Ot.isHeadless&&typeof r.removeEventListener=="function"&&(r.removeEventListener("load",l,!1),r.removeEventListener("error",o,!1)),new kt("unable to load "+e.src)};typeof r.width=="number"&&r.width>0&&typeof r.height=="number"&&r.height>0?l():!Ot.isHeadless&&typeof r.addEventListener=="function"&&(r.addEventListener("load",l,!1),r.addEventListener("error",o,!1)),e._src=vt.getAbsoluteURL(e._src),!(!Ot.isHeadless&&r&&r.getAttribute("two-src"))&&(Ot.isHeadless||r.setAttribute("two-src",e.src),vt.ImageRegistry.add(e.src,r),Ot.isHeadless?vt.loadHeadlessBuffer(e,l):e.image.src=e.src)},video:function(e,t){if(Ot.isHeadless)throw new kt("video textures are not implemented in headless environments.");const r=function(o){e.image.removeEventListener("canplaythrough",r,!1),e.image.removeEventListener("error",l,!1),e.image.width=e.image.videoWidth,e.image.height=e.image.videoHeight,typeof t=="function"&&t()},l=function(o){throw e.image.removeEventListener("canplaythrough",r,!1),e.image.removeEventListener("error",l,!1),new kt("unable to load "+e.src)};e._src=vt.getAbsoluteURL(e._src),e.image.getAttribute("two-src")||(e.image.setAttribute("two-src",e.src),vt.ImageRegistry.add(e.src,e.image)),e.image.readyState>=4?r():(e.image.addEventListener("canplaythrough",r,!1),e.image.addEventListener("error",l,!1),e.image.src=e.src,e.image.load())}});var Bi={src:{enumerable:!0,get:function(){return this._src},set:function(e){this._src=e,this._flagSrc=!0}},loaded:{enumerable:!0,get:function(){return this._loaded},set:function(e){this._loaded=e,this._flagLoaded=!0}},repeat:{enumerable:!0,get:function(){return this._repeat},set:function(e){this._repeat=e,this._flagRepeat=!0}},image:{enumerable:!0,get:function(){return this._image},set:function(e){const t=st.getTag(e);let r;switch(t){case"canvas":r="#"+e.id;break;default:r=e.src}st.ImageRegistry.contains(r)?this._image=st.ImageRegistry.get(e.src):this._image=e,this._flagImage=!0}},offset:{enumerable:!0,get:function(){return this._offset},set:function(e){this._offset&&this._offset.unbind(O.Types.change,this._renderer.flagOffset),this._offset=e,this._offset.bind(O.Types.change,this._renderer.flagOffset),this._flagOffset=!0}},scale:{enumerable:!0,get:function(){return this._scale},set:function(e){this._scale instanceof R&&this._scale.unbind(O.Types.change,this._renderer.flagScale),this._scale=e,this._scale instanceof R&&this._scale.bind(O.Types.change,this._renderer.flagScale),this._flagScale=!0}}};function In(){this._flagOffset=!0}function Tn(){this._flagScale=!0}var ae=Math.min,he=Math.max,An=Math.ceil,Sn=Math.floor,Ln=new R,ge=class extends jt{constructor(e,t,r,l){super(),g(this,"_flagVertices",!0),g(this,"_flagLength",!0),g(this,"_flagFill",!0),g(this,"_flagStroke",!0),g(this,"_flagLinewidth",!0),g(this,"_flagOpacity",!0),g(this,"_flagVisible",!0),g(this,"_flagCap",!0),g(this,"_flagJoin",!0),g(this,"_flagMiter",!0),g(this,"_flagMask",!1),g(this,"_flagClip",!1),g(this,"_length",0),g(this,"_fill","#fff"),g(this,"_stroke","#000"),g(this,"_linewidth",1),g(this,"_opacity",1),g(this,"_visible",!0),g(this,"_cap","round"),g(this,"_join","round"),g(this,"_miter",4),g(this,"_closed",!0),g(this,"_curved",!1),g(this,"_automatic",!0),g(this,"_beginning",0),g(this,"_ending",1),g(this,"_mask",null),g(this,"_clip",!1),g(this,"_dashes",null);for(let o in Yi)Object.defineProperty(this,o,Yi[o]);this._renderer.type="path",this._renderer.flagVertices=Is.bind(this),this._renderer.bindVertices=Ts.bind(this),this._renderer.unbindVertices=As.bind(this),this._renderer.flagFill=Ss.bind(this),this._renderer.flagStroke=Ls.bind(this),this._renderer.vertices=[],this._renderer.collection=[],this.closed=!!t,this.curved=!!r,this.beginning=0,this.ending=1,this.fill="#fff",this.stroke="#000",this.linewidth=1,this.opacity=1,this.className="",this.visible=!0,this.cap="butt",this.join="miter",this.miter=4,this.vertices=e,this.automatic=!l,this.dashes=[],this.dashes.offset=0}clone(e){const t=new ge;for(let r=0;r<this.vertices.length;r++)t.vertices.push(this.vertices[r].clone());for(let r=0;r<ge.Properties.length;r++){const l=ge.Properties[r];t[l]=this[l]}return t.className=this.className,t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale,t.skewX=this.skewX,t.skewY=this.skewY,this.matrix.manual&&t.matrix.copy(this.matrix),e&&e.add(t),t._update()}toObject(){const e={vertices:this.vertices.map(function(t){return t.toObject()})};return W.each(ge.Properties,function(t){typeof this[t]<"u"&&(this[t].toObject?e[t]=this[t].toObject():e[t]=this[t])},this),e.className=this.className,e.translation=this.translation.toObject(),e.rotation=this.rotation,e.scale=this.scale instanceof R?this.scale.toObject():this.scale,e.skewX=this.skewX,e.skewY=this.skewY,this.matrix.manual&&(e.matrix=this.matrix.toObject()),e}noFill(){return this.fill="none",this}noStroke(){return this.stroke="none",this}corner(){const e=this.getBoundingClientRect(!0),t=e.width/2,r=e.height/2,l=e.left+e.width/2,o=e.top+e.height/2;for(let h=0;h<this.vertices.length;h++){const u=this.vertices[h];u.x-=l,u.y-=o,u.x+=t,u.y+=r}return this.mask&&(this.mask.translation.x-=l,this.mask.translation.x+=t,this.mask.translation.y-=o,this.mask.translation.y+=r),this}center(){const e=this.getBoundingClientRect(!0),t=e.left+e.width/2-this.translation.x,r=e.top+e.height/2-this.translation.y;for(let l=0;l<this.vertices.length;l++){const o=this.vertices[l];o.x-=t,o.y-=r}return this.mask&&(this.mask.translation.x-=t,this.mask.translation.y-=r),this}getBoundingClientRect(e){let t,r,l,o,h,u,c=1/0,p=-1/0,_=1/0,x=-1/0;if(this._update(!0),t=e?this.matrix:this.worldMatrix,r=(this.linewidth||0)/2,l=this._renderer.vertices.length,this.linewidth>0||this.stroke&&!/(transparent|none)/i.test(this.stroke))if(this.matrix.manual){const{scaleX:w,scaleY:b}=ce(t.elements[0],t.elements[3],t.elements[1],t.elements[4],t.elements[2],t.elements[5]);typeof w=="number"&&typeof b=="number"&&(r=Math.max(w,b)*(this.linewidth||0)/2)}else r*=typeof this.scale=="number"?this.scale:Math.max(this.scale.x,this.scale.y);if(l<=0)return{width:0,height:0};for(o=0;o<l;o++){u=this._renderer.vertices[o],h=this._renderer.vertices[(o+l-1)%l];const[w,b]=t.multiply(h.x,h.y),[P,C]=t.multiply(u.x,u.y);if(h.controls&&u.controls){let S=h.controls.right.x,L=h.controls.right.y;h.relative&&(S+=h.x,L+=h.y);let[A,I]=t.multiply(S,L),X=u.controls.left.x,M=u.controls.left.y;u.relative&&(X+=u.x,M+=u.y);let[k,U]=t.multiply(X,M);const D=ms(w,b,A,I,k,U,P,C);_=ae(D.min.y-r,_),c=ae(D.min.x-r,c),p=he(D.max.x+r,p),x=he(D.max.y+r,x)}else o<=1&&(_=ae(b-r,_),c=ae(w-r,c),p=he(w+r,p),x=he(b+r,x)),_=ae(C-r,_),c=ae(P-r,c),p=he(P+r,p),x=he(C+r,x)}return{top:_,left:c,right:p,bottom:x,width:p-c,height:x-_}}getPointAt(e,t){let r,l,o,h,u,c,p,_,x,w,b,P,C,S,L,A=this.length*Math.min(Math.max(e,0),1);const I=this.vertices.length,X=I-1;let M=null,k=null;for(let ot=0,Mt=this._lengths.length,xt=0;ot<Mt;ot++){if(xt+this._lengths[ot]>=A){this._closed?(r=Nt(ot,I),l=Nt(ot-1,I),ot===0&&(r=l,l=ot)):(r=ot,l=Math.min(Math.max(ot-1,0),X)),M=this.vertices[r],k=this.vertices[l],A-=xt,this._lengths[ot]!==0?e=A/this._lengths[ot]:e=0;break}xt+=this._lengths[ot]}if(M===null||k===null)return null;if(M){if(!k)return M}else return k;L=k.controls&&k.controls.right,S=M.controls&&M.controls.left,u=k.x,w=k.y,c=(L||k).x,b=(L||k).y,p=(S||M).x,P=(S||M).y,_=M.x,C=M.y,L&&k.relative&&(c+=k.x,b+=k.y),S&&M.relative&&(p+=M.x,P+=M.y),h=xe(e,u,c,p,_),x=xe(e,w,b,P,C);const U=Lt(u,c,e),D=Lt(w,b,e),Z=Lt(c,p,e),V=Lt(b,P,e),q=Lt(p,_,e),J=Lt(P,C,e),j=Lt(U,Z,e),rt=Lt(D,V,e),$=Lt(Z,q,e),ct=Lt(V,J,e);return W.isObject(t)?(t.x=h,t.y=x,t instanceof K&&(t.controls.left.x=j,t.controls.left.y=rt,t.controls.right.x=$,t.controls.right.y=ct,(typeof t.relative!="boolean"||t.relative)&&(t.controls.left.x-=h,t.controls.left.y-=x,t.controls.right.x-=h,t.controls.right.y-=x)),t.t=e,t):(o=new K(h,x,j-h,rt-x,$-h,ct-x,this._curved?F.curve:F.line),o.t=e,o)}plot(){if(this.curved)return ys(this._collection,this.closed),this;for(let e=0;e<this._collection.length;e++)this._collection[e].command=e===0?F.move:F.line;return this}subdivide(e){this._update();const t=this.vertices.length-1,r=this._closed||this.vertices[t]._command===F.close;let l=this.vertices[t],o=[],h;return W.each(this.vertices,function(u,c){if(c<=0&&!r){l=u;return}if(u.command===F.move){o.push(new K(l.x,l.y)),c>0&&(o[o.length-1].command=F.line),l=u;return}h=Ni(u,l,e),o=o.concat(h),W.each(h,function(p,_){_<=0&&l.command===F.move?p.command=F.move:p.command=F.line}),c>=t&&(this._closed&&this._automatic?(l=u,h=Ni(u,l,e),o=o.concat(h),W.each(h,function(p,_){_<=0&&l.command===F.move?p.command=F.move:p.command=F.line})):r&&o.push(new K(u.x,u.y)),o[o.length-1].command=r?F.close:F.line),l=u},this),this._automatic=!1,this._curved=!1,this.vertices=o,this}_updateLength(e,t){t||this._update();const r=this.vertices.length,l=r-1,o=!1;let h=this.vertices[l],u=0;return typeof this._lengths>"u"&&(this._lengths=[]),W.each(this.vertices,function(c,p){if(p<=0&&!o||c.command===F.move){h=c,this._lengths[p]=0;return}this._lengths[p]=oi(c,h,e),u+=this._lengths[p],p>=l&&o&&(h=this.vertices[(p+1)%r],this._lengths[p+1]=oi(c,h,e),u+=this._lengths[p+1]),h=c},this),this._length=u,this._flagLength=!1,this}_update(){if(this._flagVertices){this._automatic&&this.plot(),this._flagLength&&this._updateLength(void 0,!0);const e=this._collection.length,t=this._closed,r=Math.min(this._beginning,this._ending),l=Math.max(this._beginning,this._ending),o=We(this,r*this._length),h=We(this,l*this._length),u=An(o),c=Sn(h);let p,_,x,w,b,P;for(this._renderer.vertices.length=0,P=0;P<e;P++)this._renderer.collection.length<=P&&this._renderer.collection.push(new K),P>c&&!_?(b=this._renderer.collection[P].copy(this._collection[P]),this.getPointAt(l,b),b.command=this._renderer.collection[P].command,this._renderer.vertices.push(b),_=b,x=this._collection[P-1],x&&x.controls&&(b.relative?b.controls.right.clear():b.controls.right.copy(b),x.relative?this._renderer.collection[P-1].controls.right.copy(x.controls.right).lerp(R.zero,1-b.t):this._renderer.collection[P-1].controls.right.copy(x.controls.right).lerp(x,1-b.t))):P>=u&&P<=c&&(b=this._renderer.collection[P].copy(this._collection[P]),this._renderer.vertices.push(b),P===c&&ki(this,l)?(_=b,!t&&_.controls&&(_.relative?_.controls.right.clear():_.controls.right.copy(_))):P===u&&ki(this,r)&&(p=b,p.command=F.move,!t&&p.controls&&(p.relative?p.controls.left.clear():p.controls.left.copy(p))));u>0&&!p&&(P=u-1,b=this._renderer.collection[P].copy(this._collection[P]),this.getPointAt(r,b),b.command=F.move,this._renderer.vertices.unshift(b),w=this._collection[P+1],w&&w.controls&&(b.controls.left.clear(),w.relative?this._renderer.collection[P+1].controls.left.copy(w.controls.left).lerp(R.zero,b.t):(Ln.copy(w),this._renderer.collection[P+1].controls.left.copy(w.controls.left).lerp(w,b.t))))}return jt.prototype._update.apply(this,arguments),this}flagReset(){return this._flagVertices=this._flagLength=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagCap=this._flagJoin=this._flagMiter=this._flagClip=!1,jt.prototype.flagReset.call(this),this}},it=ge;g(it,"Properties",["fill","stroke","linewidth","opacity","visible","cap","join","miter","closed","curved","automatic","beginning","ending"]);g(it,"Utils",{getCurveLength:oi});var Yi={linewidth:{enumerable:!0,get:function(){return this._linewidth},set:function(e){this._linewidth=e,this._flagLinewidth=!0}},opacity:{enumerable:!0,get:function(){return this._opacity},set:function(e){this._opacity=e,this._flagOpacity=!0}},visible:{enumerable:!0,get:function(){return this._visible},set:function(e){this._visible=e,this._flagVisible=!0}},cap:{enumerable:!0,get:function(){return this._cap},set:function(e){this._cap=e,this._flagCap=!0}},join:{enumerable:!0,get:function(){return this._join},set:function(e){this._join=e,this._flagJoin=!0}},miter:{enumerable:!0,get:function(){return this._miter},set:function(e){this._miter=e,this._flagMiter=!0}},fill:{enumerable:!0,get:function(){return this._fill},set:function(e){(this._fill instanceof mt||this._fill instanceof ht||this._fill instanceof ft||this._fill instanceof st)&&this._fill.unbind(O.Types.change,this._renderer.flagFill),this._fill=e,this._flagFill=!0,(this._fill instanceof mt||this._fill instanceof ht||this._fill instanceof ft||this._fill instanceof st)&&this._fill.bind(O.Types.change,this._renderer.flagFill)}},stroke:{enumerable:!0,get:function(){return this._stroke},set:function(e){(this._stroke instanceof mt||this._stroke instanceof ht||this._stroke instanceof ft||this._stroke instanceof st)&&this._stroke.unbind(O.Types.change,this._renderer.flagStroke),this._stroke=e,this._flagStroke=!0,(this._stroke instanceof mt||this._stroke instanceof ht||this._stroke instanceof ft||this._stroke instanceof st)&&this._stroke.bind(O.Types.change,this._renderer.flagStroke)}},length:{get:function(){return this._flagLength&&this._updateLength(),this._length}},closed:{enumerable:!0,get:function(){return this._closed},set:function(e){this._closed=!!e,this._flagVertices=!0}},curved:{enumerable:!0,get:function(){return this._curved},set:function(e){this._curved=!!e,this._flagVertices=!0}},automatic:{enumerable:!0,get:function(){return this._automatic},set:function(e){if(e===this._automatic)return;this._automatic=!!e;const t=this._automatic?"ignore":"listen";W.each(this.vertices,function(r){r[t]()})}},beginning:{enumerable:!0,get:function(){return this._beginning},set:function(e){this._beginning=e,this._flagVertices=!0}},ending:{enumerable:!0,get:function(){return this._ending},set:function(e){this._ending=e,this._flagVertices=!0}},vertices:{enumerable:!0,get:function(){return this._collection},set:function(e){const t=this._renderer.bindVertices,r=this._renderer.unbindVertices;this._collection&&this._collection.unbind(O.Types.insert,t).unbind(O.Types.remove,r),e instanceof Jt?this._collection=e:this._collection=new Jt(e||[]),this._collection.bind(O.Types.insert,t).bind(O.Types.remove,r),t(this._collection)}},mask:{enumerable:!0,get:function(){return this._mask},set:function(e){this._mask=e,this._flagMask=!0,W.isObject(e)&&!e.clip&&(e.clip=!0)}},clip:{enumerable:!0,get:function(){return this._clip},set:function(e){this._clip=e,this._flagClip=!0}},dashes:{enumerable:!0,get:function(){return this._dashes},set:function(e){typeof e.offset!="number"&&(e.offset=this.dashes&&this._dashes.offset||0),this._dashes=e}}};function Is(){this._flagVertices=!0,this._flagLength=!0,this.parent&&(this.parent._flagLength=!0)}function Ts(e){let t=e.length;for(;t--;)e[t].bind(O.Types.change,this._renderer.flagVertices);this._renderer.flagVertices()}function As(e){let t=e.length;for(;t--;)e[t].unbind(O.Types.change,this._renderer.flagVertices);this._renderer.flagVertices()}function Ss(){this._flagFill=!0}function Ls(){this._flagStroke=!0}var Es=class extends it{constructor(e,t,r,l){const o=[new K,new K,new K,new K];super(o,!0,!1,!0),g(this,"_flagWidth",0),g(this,"_flagHeight",0),g(this,"_width",0),g(this,"_height",0),g(this,"_origin",null);for(let h in Di)Object.defineProperty(this,h,Di[h]);this.width=typeof r=="number"?r:1,this.height=typeof l=="number"?l:1,this.origin=new R,typeof e=="number"&&(this.translation.x=e),typeof t=="number"&&(this.translation.y=t),this._update()}_update(){if(this._flagVertices||this._flagWidth||this._flagHeight){const e=this._width/2,t=this._height/2;!this._closed&&this.vertices.length===4&&this.vertices.push(new K),this.vertices[0].set(-e,-t).sub(this._origin).command=F.move,this.vertices[1].set(e,-t).sub(this._origin).command=F.line,this.vertices[2].set(e,t).sub(this._origin).command=F.line,this.vertices[3].set(-e,t).sub(this._origin).command=F.line,this.vertices[4]&&(this.vertices[4].set(-e,-t).sub(this._origin).command=F.line)}return super._update.call(this),this}flagReset(){return this._flagWidth=this._flagHeight=!1,super.flagReset.call(this),this}clone(e){const t=new Es(0,0,this.width,this.height);t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale,t.skewX=this.skewX,t.skewY=this.skewY,this.matrix.manual&&t.matrix.copy(this.matrix);for(let r=0;r<it.Properties.length;r++){const l=it.Properties[r];t[l]=this[l]}return e&&e.add(t),t}toObject(){const e=super.toObject.call(this);return e.width=this.width,e.height=this.height,e.origin=this.origin.toObject(),e}},re=Es;g(re,"Properties",["width","height"]);var Di={width:{enumerable:!0,get:function(){return this._width},set:function(e){this._width=e,this._flagWidth=!0}},height:{enumerable:!0,get:function(){return this._height},set:function(e){this._height=e,this._flagHeight=!0}},origin:{enumerable:!0,get:function(){return this._origin},set:function(e){this._origin&&this._origin.unbind(O.Types.change,this._renderer.flagVertices),this._origin=e,this._origin.bind(O.Types.change,this._renderer.flagVertices),this._renderer.flagVertices()}}},Os=class extends re{constructor(e,t,r,l,o,h){super(t,r,0,0),g(this,"_flagTexture",!1),g(this,"_flagColumns",!1),g(this,"_flagRows",!1),g(this,"_flagFrameRate",!1),g(this,"_flagIndex",!1),g(this,"_amount",1),g(this,"_duration",0),g(this,"_startTime",0),g(this,"_playing",!1),g(this,"_firstFrame",0),g(this,"_lastFrame",0),g(this,"_loop",!0),g(this,"_texture",null),g(this,"_columns",1),g(this,"_rows",1),g(this,"_frameRate",0),g(this,"_index",0),g(this,"_origin",null);for(let u in Wi)Object.defineProperty(this,u,Wi[u]);this.noStroke(),this.noFill(),e instanceof st?this.texture=e:typeof e=="string"&&(this.texture=new st(e)),this.origin=new R,this._update(),typeof l=="number"&&(this.columns=l),typeof o=="number"&&(this.rows=o),typeof h=="number"&&(this.frameRate=h),this.index=0}play(e,t,r){return this._playing=!0,this._firstFrame=0,this._lastFrame=this.amount-1,this._startTime=W.performance.now(),typeof e=="number"&&(this._firstFrame=e),typeof t=="number"&&(this._lastFrame=t),typeof r=="function"?this._onLastFrame=r:delete this._onLastFrame,this._index!==this._firstFrame&&(this._startTime-=1e3*Math.abs(this._index-this._firstFrame)/this._frameRate),this}pause(){return this._playing=!1,this}stop(){return this._playing=!1,this._index=0,this}clone(e){const t=new Os(this.texture,this.translation.x,this.translation.y,this.columns,this.rows,this.frameRate);return this.playing&&(t.play(this._firstFrame,this._lastFrame),t._loop=this._loop),e&&e.add(t),t}toObject(){const e=super.toObject.call(this);return e.texture=this.texture.toObject(),e.columns=this.columns,e.rows=this.rows,e.frameRate=this.frameRate,e.index=this.index,e._firstFrame=this._firstFrame,e._lastFrame=this._lastFrame,e._loop=this._loop,e}_update(){const e=this._texture,t=this._columns,r=this._rows;let l,o,h,u,c,p,_,x,w;if(e&&((this._flagColumns||this._flagRows)&&(this._amount=this._columns*this._rows),this._flagFrameRate&&(this._duration=1e3*this._amount/this._frameRate),this._flagTexture&&(this.fill=e),e.loaded)){_=e.image.width,x=e.image.height,l=_/t,o=x/r,u=this._amount,this.width!==l&&(this.width=l),this.height!==o&&(this.height=o),this._playing&&this._frameRate>0&&(W.isNaN(this._lastFrame)&&(this._lastFrame=u-1),h=W.performance.now()-this._startTime,w=this._lastFrame+1,c=1e3*(w-this._firstFrame)/this._frameRate,this._loop?h=h%c:h=Math.min(h,c),p=Lt(this._firstFrame,w,h/c),p=Math.floor(p),p!==this._index&&(this._index=p,p>=this._lastFrame-1&&this._onLastFrame&&this._onLastFrame()));const b=this._index%t,P=Math.floor(this._index/t),C=-l*b+(_-l)/2,S=-o*P+(x-o)/2;C!==e.offset.x&&(e.offset.x=C),S!==e.offset.y&&(e.offset.y=S)}return super._update.call(this),this}flagReset(){return this._flagTexture=this._flagColumns=this._flagRows=this._flagFrameRate=!1,super.flagReset.call(this),this}},Ve=Os;g(Ve,"Properties",["texture","columns","rows","frameRate","index"]);var Wi={texture:{enumerable:!0,get:function(){return this._texture},set:function(e){this._texture=e,this._flagTexture=!0}},columns:{enumerable:!0,get:function(){return this._columns},set:function(e){this._columns=e,this._flagColumns=!0}},rows:{enumerable:!0,get:function(){return this._rows},set:function(e){this._rows=e,this._flagRows=!0}},frameRate:{enumerable:!0,get:function(){return this._frameRate},set:function(e){this._frameRate=e,this._flagFrameRate=!0}},index:{enumerable:!0,get:function(){return this._index},set:function(e){this._index=e,this._flagIndex=!0}}},Qe=Math.cos,ti=Math.sin,Me=class extends it{constructor(e,t,r,l){const o=l?Math.max(l,2):4,h=[];for(let u=0;u<o;u++)h.push(new K(0,0,0,0,0,0));super(h,!0,!0,!0),g(this,"_flagRadius",!1),g(this,"_radius",0);for(let u in Ui)Object.defineProperty(this,u,Ui[u]);typeof r=="number"&&(this.radius=r),this._update(),typeof e=="number"&&(this.translation.x=e),typeof t=="number"&&(this.translation.y=t)}_update(){if(this._flagVertices||this._flagRadius){let e=this.vertices.length;!this._closed&&e>2&&(e-=1);const t=4/3*Math.tan(Math.PI/(e*2)),r=this._radius,l=r*t;for(let o=0;o<this.vertices.length;o++){const u=o/e*Pt,c=r*Qe(u),p=r*ti(u),_=l*Qe(u-gt),x=l*ti(u-gt),w=l*Qe(u+gt),b=l*ti(u+gt),P=this.vertices[o];P.command=o===0?F.move:F.curve,P.set(c,p),P.controls.left.set(_,x),P.controls.right.set(w,b)}}return super._update.call(this),this}flagReset(){return this._flagRadius=!1,super.flagReset.call(this),this}clone(e){const t=new Me(0,0,this.radius,this.vertices.length);t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale,t.skewX=this.skewX,t.skewY=this.skewY,this.matrix.manual&&t.matrix.copy(this.matrix);for(let r=0;r<it.Properties.length;r++){const l=it.Properties[r];t[l]=this[l]}return e&&e.add(t),t}toObject(){const e=super.toObject.call(this);for(let t=0;t<Me.Properties.length;t++){const r=Me.Properties[t];e[r]=this[r]}return e}},He=Me;g(He,"Properties",["radius"]);var Ui={radius:{enumerable:!0,get:function(){return this._radius},set:function(e){this._radius=e,this._flagRadius=!0}}},ei=Math.cos,ii=Math.sin,Xe=class extends it{constructor(e,t,r,l,o){typeof l!="number"&&typeof r=="number"&&(l=r);const h=o?Math.max(o,2):4,u=[];for(let c=0;c<h;c++)u.push(new K);super(u,!0,!0,!0),g(this,"_flagWidth",!1),g(this,"_flagHeight",!1),g(this,"_width",0),g(this,"_height",0);for(let c in qi)Object.defineProperty(this,c,qi[c]);typeof r=="number"&&(this.width=r*2),typeof l=="number"&&(this.height=l*2),this._update(),typeof e=="number"&&(this.translation.x=e),typeof t=="number"&&(this.translation.y=t)}_update(){if(this._flagVertices||this._flagWidth||this._flagHeight){let e=this.vertices.length;!this._closed&&e>2&&(e-=1);const t=4/3*Math.tan(Math.PI/(this.vertices.length*2)),r=this._width/2,l=this._height/2;for(let o=0;o<this.vertices.length;o++){const u=o/e*Pt,c=r*ei(u),p=l*ii(u),_=r*t*ei(u-gt),x=l*t*ii(u-gt),w=r*t*ei(u+gt),b=l*t*ii(u+gt),P=this.vertices[o];P.command=o===0?F.move:F.curve,P.set(c,p),P.controls.left.set(_,x),P.controls.right.set(w,b)}}return super._update.call(this),this}flagReset(){return this._flagWidth=this._flagHeight=!1,super.flagReset.call(this),this}clone(e){const t=this.width/2,r=this.height/2,l=this.vertices.length,o=new Xe(0,0,t,r,l);o.translation.copy(this.translation),o.rotation=this.rotation,o.scale=this.scale,o.skewX=this.skewX,o.skewY=this.skewY,this.matrix.manual&&o.matrix.copy(this.matrix);for(let h=0;h<it.Properties.length;h++){const u=it.Properties[h];o[u]=this[u]}return e&&e.add(o),o}toObject(){const e=super.toObject.call(this);for(let t=0;t<Xe.Properties.length;t++){const r=Xe.Properties[t];e[r]=this[r]}return e}},ze=Xe;g(ze,"Properties",["width","height"]);var qi={width:{enumerable:!0,get:function(){return this._width},set:function(e){this._width=e,this._flagWidth=!0}},height:{enumerable:!0,get:function(){return this._height},set:function(e){this._height=e,this._flagHeight=!0}}},di=class extends it{constructor(e,t,r,l){const o=[new K(e,t),new K(r,l)];super(o);for(let h in Vi)Object.defineProperty(this,h,Vi[h]);this.vertices[0].command=F.move,this.vertices[1].command=F.line,this.automatic=!1}},Vi={left:{enumerable:!0,get:function(){return this.vertices[0]},set:function(e){if(W.isObject(e))this.vertices.splice(0,1,e);else{const t=new kt("Two.Line.x argument is not an object.");console.warn(t.name,t.message)}}},right:{enumerable:!0,get:function(){return this.vertices[1]},set:function(e){if(W.isObject(e))this.vertices.splice(1,1,e);else{const t=new kt("Two.Line.y argument is not an object.");console.warn(t.name,t.message)}}}},Fe=class extends it{constructor(e,t,r,l,o){typeof o>"u"&&typeof r=="number"&&typeof l=="number"&&(o=Math.floor(Math.min(r,l)/12));const h=[];for(let u=0;u<10;u++)h.push(new K(0,0,0,0,0,0,u===0?F.move:F.curve));super(h),g(this,"_flagWidth",!1),g(this,"_flagHeight",!1),g(this,"_flagRadius",!1),g(this,"_width",0),g(this,"_height",0),g(this,"_radius",12);for(let u in Hi)Object.defineProperty(this,u,Hi[u]);this.closed=!0,this.automatic=!1,this._renderer.flagRadius=En.bind(this),typeof r=="number"&&(this.width=r),typeof l=="number"&&(this.height=l),typeof o=="number"&&(this.radius=o),this._update(),typeof e=="number"&&(this.translation.x=e),typeof t=="number"&&(this.translation.y=t)}_update(){if(this._flagVertices||this._flagWidth||this._flagHeight||this._flagRadius){const e=this._width,t=this._height;let r,l;this._radius instanceof R?(r=this._radius.x,l=this._radius.y):(r=this._radius,l=this._radius);let o,h=e/2,u=t/2;o=this.vertices[0],o.x=-(h-r),o.y=-u,o=this.vertices[1],o.x=h-r,o.y=-u,o.controls.left.clear(),o.controls.right.x=r,o.controls.right.y=0,o=this.vertices[2],o.x=h,o.y=-(u-l),o.controls.right.clear(),o.controls.left.clear(),o=this.vertices[3],o.x=h,o.y=u-l,o.controls.left.clear(),o.controls.right.x=0,o.controls.right.y=l,o=this.vertices[4],o.x=h-r,o.y=u,o.controls.right.clear(),o.controls.left.clear(),o=this.vertices[5],o.x=-(h-r),o.y=u,o.controls.left.clear(),o.controls.right.x=-r,o.controls.right.y=0,o=this.vertices[6],o.x=-h,o.y=u-l,o.controls.left.clear(),o.controls.right.clear(),o=this.vertices[7],o.x=-h,o.y=-(u-l),o.controls.left.clear(),o.controls.right.x=0,o.controls.right.y=-l,o=this.vertices[8],o.x=-(h-r),o.y=-u,o.controls.left.clear(),o.controls.right.clear(),o=this.vertices[9],o.copy(this.vertices[8])}return super._update.call(this),this}flagReset(){return this._flagWidth=this._flagHeight=this._flagRadius=!1,super.flagReset.call(this),this}clone(e){const t=this.width,r=this.height,l=this.radius,o=new Fe(0,0,t,r,l);o.translation.copy(this.translation),o.rotation=this.rotation,o.scale=this.scale,o.skewX=this.skewX,o.skewY=this.skewY,this.matrix.manual&&o.matrix.copy(this.matrix);for(let h=0;h<it.Properties.length;h++){const u=it.Properties[h];o[u]=this[u]}return e&&e.add(o),o}toObject(){const e=super.toObject.call(this);for(let t=0;t<Fe.Properties.length;t++){const r=Fe.Properties[t];e[r]=this[r]}return e.radius=typeof this.radius=="number"?this.radius:this.radius.toObject(),e}},Ge=Fe;g(Ge,"Properties",["width","height","radius"]);var Hi={width:{enumerable:!0,get:function(){return this._width},set:function(e){this._width=e,this._flagWidth=!0}},height:{enumerable:!0,get:function(){return this._height},set:function(e){this._height=e,this._flagHeight=!0}},radius:{enumerable:!0,get:function(){return this._radius},set:function(e){this._radius instanceof R&&this._radius.unbind(O.Types.change,this._renderer.flagRadius),this._radius=e,this._radius instanceof R&&this._radius.bind(O.Types.change,this._renderer.flagRadius),this._flagRadius=!0}}};function En(){this._flagRadius=!0}var ai,zi=Math.min,Gi=Math.max;ut.document&&(ai=document.createElement("canvas"));var qt=class extends jt{constructor(e,t,r,l){super(),g(this,"_flagValue",!0),g(this,"_flagFamily",!0),g(this,"_flagSize",!0),g(this,"_flagLeading",!0),g(this,"_flagAlignment",!0),g(this,"_flagBaseline",!0),g(this,"_flagStyle",!0),g(this,"_flagWeight",!0),g(this,"_flagDecoration",!0),g(this,"_flagFill",!0),g(this,"_flagStroke",!0),g(this,"_flagLinewidth",!0),g(this,"_flagOpacity",!0),g(this,"_flagVisible",!0),g(this,"_flagMask",!1),g(this,"_flagClip",!1),g(this,"_flagDirection",!0),g(this,"_value",""),g(this,"_family","sans-serif"),g(this,"_size",13),g(this,"_leading",17),g(this,"_alignment","center"),g(this,"_baseline","middle"),g(this,"_style","normal"),g(this,"_weight",500),g(this,"_decoration","none"),g(this,"_direction","ltr"),g(this,"_fill","#000"),g(this,"_stroke","none"),g(this,"_linewidth",1),g(this,"_opacity",1),g(this,"_visible",!0),g(this,"_mask",null),g(this,"_clip",!1),g(this,"_dashes",null);for(let o in Zi)Object.defineProperty(this,o,Zi[o]);if(this._renderer.type="text",this._renderer.flagFill=On.bind(this),this._renderer.flagStroke=kn.bind(this),this.value=e,typeof t=="number"&&(this.translation.x=t),typeof r=="number"&&(this.translation.y=r),this.dashes=[],this.dashes.offset=0,!W.isObject(l))return this;for(let o=0;o<qt.Properties.length;o++){const h=qt.Properties[o];h in l&&(this[h]=l[h])}}static Measure(e){if(ai){const t=ai.getContext("2d");t.font=[e._style,e._weight,`${e._size}px/${e._leading}px`,e._family].join(" ");const r=t.measureText(e.value,0,0),l=r.actualBoundingBoxDescent+r.actualBoundingBoxAscent;return{width:r.width,height:l}}else{const t=this.value.length*this.size*qt.Ratio,r=this.leading;return console.warn("Two.Text: unable to accurately measure text, so using an approximation."),{width:t,height:r}}}clone(e){const t=new qt(this.value);t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale;for(let r=0;r<qt.Properties.length;r++){const l=qt.Properties[r];t[l]=this[l]}return this.matrix.manual&&t.matrix.copy(this.matrix),e&&e.add(t),t._update()}toObject(){const e={translation:this.translation.toObject(),rotation:this.rotation,scale:this.scale};this.matrix.manual&&(e.matrix=this.matrix.toObject());for(let t=0;t<qt.Properties.length;t++){const r=qt.Properties[t];e[r]=this[r]}return e}noFill(){return this.fill="none",this}noStroke(){return this.stroke="none",this.linewidth=0,this}getBoundingClientRect(e){let t,r,l,o,h;this._update(!0),t=e?this.matrix:this.worldMatrix;const{width:u,height:c}=qt.Measure(this),p=(this._linewidth||0)/2;switch(this.alignment){case"left":r=-p,l=u+p;break;case"right":r=-(u+p),l=p;break;default:r=-(u/2+p),l=u/2+p}switch(this.baseline){case"middle":o=-(c/2+p),h=c/2+p;break;default:o=-(c+p),h=p}const[_,x]=t.multiply(r,o),[w,b]=t.multiply(r,h),[P,C]=t.multiply(l,o),[S,L]=t.multiply(l,h);return o=zi(x,b,C,L),r=zi(_,w,P,S),l=Gi(_,w,P,S),h=Gi(x,b,C,L),{top:o,left:r,right:l,bottom:h,width:l-r,height:h-o}}flagReset(){return super.flagReset.call(this),this._flagValue=this._flagFamily=this._flagSize=this._flagLeading=this._flagAlignment=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagClip=this._flagDecoration=this._flagClassName=this._flagBaseline=this._flagWeight=this._flagStyle=this._flagDirection=!1,this}},Yt=qt;g(Yt,"Ratio",.6);g(Yt,"Properties",["value","family","size","leading","alignment","linewidth","style","weight","decoration","direction","baseline","opacity","visible","fill","stroke"]);var Zi={value:{enumerable:!0,get:function(){return this._value},set:function(e){this._value=e,this._flagValue=!0}},family:{enumerable:!0,get:function(){return this._family},set:function(e){this._family=e,this._flagFamily=!0}},size:{enumerable:!0,get:function(){return this._size},set:function(e){this._size=e,this._flagSize=!0}},leading:{enumerable:!0,get:function(){return this._leading},set:function(e){this._leading=e,this._flagLeading=!0}},alignment:{enumerable:!0,get:function(){return this._alignment},set:function(e){this._alignment=e,this._flagAlignment=!0}},linewidth:{enumerable:!0,get:function(){return this._linewidth},set:function(e){this._linewidth=e,this._flagLinewidth=!0}},style:{enumerable:!0,get:function(){return this._style},set:function(e){this._style=e,this._flagStyle=!0}},weight:{enumerable:!0,get:function(){return this._weight},set:function(e){this._weight=e,this._flagWeight=!0}},decoration:{enumerable:!0,get:function(){return this._decoration},set:function(e){this._decoration=e,this._flagDecoration=!0}},direction:{enumerable:!0,get:function(){return this._direction},set:function(e){this._direction=e,this._flagDirection=!0}},baseline:{enumerable:!0,get:function(){return this._baseline},set:function(e){this._baseline=e,this._flagBaseline=!0}},opacity:{enumerable:!0,get:function(){return this._opacity},set:function(e){this._opacity=e,this._flagOpacity=!0}},visible:{enumerable:!0,get:function(){return this._visible},set:function(e){this._visible=e,this._flagVisible=!0}},fill:{enumerable:!0,get:function(){return this._fill},set:function(e){(this._fill instanceof mt||this._fill instanceof ht||this._fill instanceof ft||this._fill instanceof st)&&this._fill.unbind(O.Types.change,this._renderer.flagFill),this._fill=e,this._flagFill=!0,(this._fill instanceof mt||this._fill instanceof ht||this._fill instanceof ft||this._fill instanceof st)&&this._fill.bind(O.Types.change,this._renderer.flagFill)}},stroke:{enumerable:!0,get:function(){return this._stroke},set:function(e){(this._stroke instanceof mt||this._stroke instanceof ht||this._stroke instanceof ft||this._stroke instanceof st)&&this._stroke.unbind(O.Types.change,this._renderer.flagStroke),this._stroke=e,this._flagStroke=!0,(this._stroke instanceof mt||this._stroke instanceof ht||this._stroke instanceof ft||this._stroke instanceof st)&&this._stroke.bind(O.Types.change,this._renderer.flagStroke)}},mask:{enumerable:!0,get:function(){return this._mask},set:function(e){this._mask=e,this._flagMask=!0,W.isObject(e)&&!e.clip&&(e.clip=!0)}},clip:{enumerable:!0,get:function(){return this._clip},set:function(e){this._clip=e,this._flagClip=!0}},dashes:{enumerable:!0,get:function(){return this._dashes},set:function(e){typeof e.offset!="number"&&(e.offset=this.dashes&&this._dashes.offset||0),this._dashes=e}}};function On(){this._flagFill=!0}function kn(){this._flagStroke=!0}var Vt={path:/[+-]?(?:\d*\.\d+|\d+)(?:[eE][+-]\d+)?/g,cssBackgroundImage:/url\(['"]?#([\w\d-_]*)['"]?\)/i,unitSuffix:/[a-zA-Z%]*/i},Nn={start:"left",middle:"center",end:"right"},ji=["id","class","transform","xmlns","viewBox"],Mn=["x","y","width","height","href","xlink:href"];function Xn(e){return Nn[e]}function Fn(e){const t=e.getAttribute("dominant-baseline"),r=e.getAttribute("alignment-baseline");return t||r}function Pe(e){return e.replace(/svg:/ig,"").toLowerCase()}function Ji(e,t){if(t.x+=e.translateX,t.y+=e.translateY,t.x*=e.scaleX,t.y*=e.scaleY,e.rotation!==0){const r=t.length();t.x=r*Math.cos(e.rotation),t.y=r*Math.sin(e.rotation)}}function Rn(e,t){t||(t={});const r=e.split(";");for(let l=0;l<r.length;l++){const o=r[l].split(":"),h=o[0],u=o[1];typeof h>"u"||typeof u>"u"||(t[h]=u.replace(/\s/,""))}return t}function Bn(e){const t={},r=Yn(e),l=Math.max(r.length,e.style.length);for(let o=0;o<l;o++){const h=e.style[o],u=r[o];h&&(t[h]=e.style[h]),u&&(t[u]=e.getAttribute(u))}return t}function Yn(e){const t=e.getAttributeNames();for(let r=0;r<ji.length;r++){const l=ji[r],o=Array.prototype.indexOf.call(t,l);o>=0&&t.splice(o,1)}return t}function Dn(e,t){const r=t.split(/[\s,]/),l=-parseFloat(r[0]),o=-parseFloat(r[1]),h=parseFloat(r[2]),u=parseFloat(r[3]);if(l&&o)for(let w=0;w<e.children.length;w++){const b=e.children[w];"translation"in b?b.translation.add(l,o):"x"in b?b.x=l:"y"in b&&(b.y=o)}const c=typeof e.x=="number",p=typeof e.y=="number",_=typeof e.width=="number",x=typeof e.height=="number";return c&&(e.translation.x+=e.x),p&&(e.translation.y+=e.y),(_||x)&&(e.scale=new R(1,1)),_&&(e.scale.x=e.width/h),x&&(e.scale.y=e.height/u),e.mask=new re(0,0,h,u),e.mask.origin.set(-h/2,-u/2),e}function Xt(e,t,r){const l={},o={},h={};let u,c,p,_,x,w,b,P,C,S,L,A,I,X,M,k,U;if(e===null)return l;if(ut.getComputedStyle){const D=ut.getComputedStyle(e);for(u=D.length;u--;)p=D[u],_=D[p],typeof _<"u"&&(l[p]=_)}for(u=0;u<e.attributes.length;u++)w=e.attributes[u],/style/i.test(w.nodeName)?Rn(w.value,h):o[w.nodeName]=w.value;typeof l.opacity<"u"&&(l["stroke-opacity"]=l.opacity,l["fill-opacity"]=l.opacity,delete l.opacity),r&&W.defaults(l,r),W.extend(l,h,o),l.visible=!(typeof l.display>"u"&&/none/i.test(l.display))||typeof l.visibility>"u"&&/hidden/i.test(l.visibility);for(p in l)switch(_=l[p],p){case"gradientTransform":if(/none/i.test(_)||(c=e.gradientTransform&&e.gradientTransform.baseVal&&e.gradientTransform.baseVal.length>0?e.gradientTransform.baseVal[0].matrix:e.getCTM?e.getCTM():null,c===null))break;switch(b=ce(c),t._renderer.type){case"linear-gradient":Ji(b,t.left),Ji(b,t.right);break;case"radial-gradient":t.center.x+=b.translateX,t.center.y+=b.translateY,t.focal.x+=b.translateX,t.focal.y+=b.translateY,t.radius*=Math.max(b.scaleX,b.scaleY);break}break;case"transform":if(/none/i.test(_)||(c=e.transform&&e.transform.baseVal&&e.transform.baseVal.length>0?e.transform.baseVal[0].matrix:e.getCTM?e.getCTM():null,c===null))break;b=ce(c),t.translation.set(b.translateX,b.translateY),t.rotation=Math.PI*(b.rotation/180),t.scale=new R(b.scaleX,b.scaleY),P=parseFloat((l.x+"").replace("px")),C=parseFloat((l.y+"").replace("px")),P&&(t.translation.x=P),C&&(t.translation.y=C);break;case"visible":if(t instanceof _t){t._visible=_;break}t.visible=_;break;case"stroke-linecap":if(t instanceof _t){t._cap=_;break}t.cap=_;break;case"stroke-linejoin":if(t instanceof _t){t._join=_;break}t.join=_;break;case"stroke-miterlimit":if(t instanceof _t){t._miter=_;break}t.miter=_;break;case"stroke-width":if(t instanceof _t){t._linewidth=parseFloat(_);break}t.linewidth=parseFloat(_);break;case"opacity":case"stroke-opacity":case"fill-opacity":if(t instanceof _t){t._opacity=parseFloat(_);break}t.opacity=parseFloat(_);break;case"clip-path":if(Vt.cssBackgroundImage.test(_)&&(S=_.replace(Vt.cssBackgroundImage,"$1"),at.defs.current&&at.defs.current.contains(S)&&(A=at.defs.current.get(S),A&&A.childNodes.length>0)))switch(A=A.childNodes[0],I=Pe(A.nodeName),t.mask=at[I].call(this,A,{}),t._renderer.type){case"text":case"path":t.position.add(t.mask.position),t.mask.position.clear();break}break;case"fill":case"stroke":x=(t instanceof _t?"_":"")+p,Vt.cssBackgroundImage.test(_)?(S=_.replace(Vt.cssBackgroundImage,"$1"),at.defs.current&&at.defs.current.contains(S)?(A=at.defs.current.get(S),A.object||(I=Pe(A.nodeName),A.object=at[I].call(this,A,{})),A=A.object):(L=Un(this),A=L.getById(S)),t[x]=A):t[x]=_;break;case"id":t.id=_;break;case"class":case"className":t.classList=_.split(" "),t._flagClassName=!0;break;case"x":case"y":if(X=t instanceof mt,M=t instanceof ht,k=t instanceof ft,X||M||k)break;_.match("[a-z%]$")&&!_.endsWith("px")&&(U=new kt("only pixel values are supported with the "+p+" attribute."),console.warn(U.name,U.message)),t.translation[p]=parseFloat(_);break;case"font-family":t instanceof Yt&&(t.family=_);break;case"font-size":t instanceof Yt&&(t.size=_);break;case"font-weight":t instanceof Yt&&(t.weight=_);break;case"font-style":t instanceof Yt&&(t.style=_);break;case"text-decoration":t instanceof Yt&&(t.decoration=_);break;case"line-height":t instanceof Yt&&(t.leading=_);break}return Object.keys(e.dataset).length&&(t.dataset=e.dataset),l}function Wn(e,t){for(let r=0,l=e.childNodes.length;r<l;r++){const o=e.childNodes[r];!o.id||Pe(e.nodeName)==="#text"||t.add(o.id,o)}}function Un(e){for(;e.parent;)e=e.parent;return e.scene}var at={svg:function(e){const t=at.defs.current=new qe,r=e.getElementsByTagName("defs");for(let C=0;C<r.length;C++)Wn(r[C],t);const l=at.g.call(this,e),o=e.getAttribute("viewBox"),h=e.getAttribute("x"),u=e.getAttribute("y"),c=e.getAttribute("width"),p=e.getAttribute("height");l.defs=t;const _=o!==null,x=h!==null,w=u!==null,b=c!==null,P=p!==null;return x&&(l.x=parseFloat(h.replace(Vt.unitSuffix,""))),w&&(l.y=parseFloat(u.replace(Vt.unitSuffix,""))),b&&(l.width=parseFloat(c.replace(Vt.unitSuffix,""))),P&&(l.height=parseFloat(p.replace(Vt.unitSuffix,""))),_&&Dn(l,o),delete at.defs.current,l},defs:function(e){return null},use:function(e,t){let r;const l=e.getAttribute("href")||e.getAttribute("xlink:href");if(!l)return r=new kt("encountered <use /> with no href."),console.warn(r.name,r.message),null;const o=l.slice(1);if(!at.defs.current.contains(o))return r=new kt("unable to find element for reference "+l+"."),console.warn(r.name,r.message),null;const u=at.defs.current.get(o).cloneNode(!0);for(let p=0;p<e.attributes.length;p++){const _=e.attributes[p],x=Mn.includes(_.nodeName),w=!u.hasAttribute(_.nodeName);(x||w)&&u.setAttribute(_.nodeName,_.value)}const c=Pe(u.nodeName);return at[c].call(this,u,t)},g:function(e,t){const r=new _t;Xt.call(this,e,r,t),this.add(r);const l=Bn.call(this,e);for(let o=0,h=e.childNodes.length;o<h;o++){const u=e.childNodes[o],c=u.nodeName;if(!c)return;const p=Pe(c);if(p in at){const _=at[p].call(r,u,l);_&&!_.parent&&r.add(_)}}return r},polygon:function(e,t){let r;typeof e=="string"?r=e:r=e.getAttribute("points");const l=[];r.replace(/(-?[\d.eE-]+)[,|\s](-?[\d.eE-]+)/g,function(h,u,c){l.push(new K(parseFloat(u),parseFloat(c)))});const o=new it(l,!0).noStroke();return o.fill="black",Xt.call(this,e,o,t),o},polyline:function(e,t){const r=at.polygon.call(this,e,t);return r.closed=!1,r},path:function(e,t){let r;typeof e=="string"?(r=e,e=null):r=e.getAttribute("d");let l=[],o=!1,h=!1;if(r){let c=new K,p,_,x=r.match(/[a-df-z][^a-df-z]*/ig);const w=x.length-1;W.each(x.slice(0),function(b,P){const C=b.slice(1).trim().match(Vt.path),S=b[0],L=S.toLowerCase();let A,I,X,M,k;const U=[];switch(P===0&&(x=[]),L){case"h":case"v":C.length>1&&(A=1);break;case"m":case"l":case"t":C.length>2&&(A=2);break;case"s":case"q":C.length>4&&(A=4);break;case"c":C.length>6&&(A=6);break;case"a":C.length>7&&(A=7);break}if(A){for(I=0,X=C.length,k=0;I<X;I+=A){if(M=S,k>0)switch(S){case"m":M="l";break;case"M":M="L";break}U.push(M+C.slice(I,I+A).join(" ")),k++}x=Array.prototype.concat.apply(x,U)}else x.push(b)}),W.each(x,function(b,P){let C,S,L;const A=b[0],I=A.toLowerCase();_=b.slice(1).trim().match(Vt.path),h=A===I;let X,M,k,U,D,Z,V,q,J,j,rt,$,ct,ot,Mt,xt,bt;switch(I){case"z":if(P>=w)o=!0;else{S=c.x,L=c.y,C=new K(S,L,void 0,void 0,void 0,void 0,F.close);for(let Bt=l.length-1;Bt>=0;Bt--){const Wt=l[Bt];if(/m/i.test(Wt.command)){c=Wt;break}}}break;case"m":case"l":p=void 0,S=parseFloat(_[0]),L=parseFloat(_[1]),C=new K(S,L,void 0,void 0,void 0,void 0,/m/i.test(I)?F.move:F.line),h&&C.addSelf(c),c=C;break;case"h":case"v":j=/h/i.test(I)?"x":"y",rt=/x/i.test(j)?"y":"x",C=new K(void 0,void 0,void 0,void 0,void 0,void 0,F.line),C[j]=parseFloat(_[0]),C[rt]=c[rt],h&&(C[j]+=c[j]),c=C;break;case"c":case"s":X=c.x,M=c.y,p||(p=new R),/c/i.test(I)?(k=parseFloat(_[0]),U=parseFloat(_[1]),D=parseFloat(_[2]),Z=parseFloat(_[3]),V=parseFloat(_[4]),q=parseFloat(_[5])):(J=ni(c,p,h),k=J.x,U=J.y,D=parseFloat(_[0]),Z=parseFloat(_[1]),V=parseFloat(_[2]),q=parseFloat(_[3])),h&&(k+=X,U+=M,D+=X,Z+=M,V+=X,q+=M),c.controls.right.set(k-c.x,U-c.y),C=new K(V,q,D-V,Z-q,void 0,void 0,F.curve),c=C,p=C.controls.left;break;case"t":case"q":X=c.x,M=c.y,p||(p=new R),/q/i.test(I)?(k=parseFloat(_[0]),U=parseFloat(_[1]),D=parseFloat(_[0]),Z=parseFloat(_[1]),V=parseFloat(_[2]),q=parseFloat(_[3])):(J=ni(c,p,h),k=J.x,U=J.y,D=J.x,Z=J.y,V=parseFloat(_[0]),q=parseFloat(_[1])),h&&(k+=X,U+=M,D+=X,Z+=M,V+=X,q+=M),c.controls.right.set((k-c.x)*.33,(U-c.y)*.33),C=new K(V,q,D-V,Z-q,void 0,void 0,F.curve),c=C,p=C.controls.left;break;case"a":X=c.x,M=c.y,ct=parseFloat(_[0]),ot=parseFloat(_[1]),Mt=parseFloat(_[2]),xt=parseFloat(_[3]),bt=parseFloat(_[4]),V=parseFloat(_[5]),q=parseFloat(_[6]),h&&(V+=X,q+=M),$=new K(V,q),$.command=F.arc,$.rx=ct,$.ry=ot,$.xAxisRotation=Mt,$.largeArcFlag=xt,$.sweepFlag=bt,C=$,c=$,p=void 0;break}C&&(Array.isArray(C)?l=l.concat(C):l.push(C))})}r=new it(l,o,void 0,!0).noStroke(),r.fill="black";const u=r.getBoundingClientRect(!0);return u.centroid={x:u.left+u.width/2,y:u.top+u.height/2},W.each(r.vertices,function(c){c.subSelf(u.centroid)}),Xt.call(this,e,r,t),r.translation.addSelf(u.centroid),r},circle:function(e,t){const r=parseFloat(e.getAttribute("cx")),l=parseFloat(e.getAttribute("cy")),o=parseFloat(e.getAttribute("r")),h=new He(0,0,o).noStroke();return h.fill="black",Xt.call(this,e,h,t),h.translation.x=r,h.translation.y=l,h},ellipse:function(e,t){const r=parseFloat(e.getAttribute("cx")),l=parseFloat(e.getAttribute("cy")),o=parseFloat(e.getAttribute("rx")),h=parseFloat(e.getAttribute("ry")),u=new ze(0,0,o,h).noStroke();return u.fill="black",Xt.call(this,e,u,t),u.translation.x=r,u.translation.y=l,u},rect:function(e,t){const r=parseFloat(e.getAttribute("rx")),l=parseFloat(e.getAttribute("ry"));if(!W.isNaN(r)||!W.isNaN(l))return at["rounded-rect"](e);const o=parseFloat(e.getAttribute("width")),h=parseFloat(e.getAttribute("height")),u=o/2,c=h/2,p=new re(0,0,o,h).noStroke();return p.fill="black",Xt.call(this,e,p,t),p.translation.x+=u,p.translation.y+=c,p},"rounded-rect":function(e,t){const r=parseFloat(e.getAttribute("rx"))||0,l=parseFloat(e.getAttribute("ry"))||0,o=parseFloat(e.getAttribute("width")),h=parseFloat(e.getAttribute("height")),u=o/2,c=h/2,p=new R(r,l),_=new Ge(0,0,o,h,p).noStroke();return _.fill="black",Xt.call(this,e,_,t),_.translation.x+=u,_.translation.y+=c,_},line:function(e,t){const r=parseFloat(e.getAttribute("x1")),l=parseFloat(e.getAttribute("y1")),o=parseFloat(e.getAttribute("x2")),h=parseFloat(e.getAttribute("y2")),u=new di(r,l,o,h).noFill();return Xt.call(this,e,u,t),u},lineargradient:function(e,t){let r=e.getAttribute("gradientUnits"),l=e.getAttribute("spreadMethod");r||(r="objectBoundingBox"),l||(l="pad");let o=parseFloat(e.getAttribute("x1")||0),h=parseFloat(e.getAttribute("y1")||0),u=parseFloat(e.getAttribute("x2")||0),c=parseFloat(e.getAttribute("y2")||0);const p=(u+o)/2,_=(c+h)/2;/userSpaceOnUse/i.test(r)&&(o-=p,h-=_,u-=p,c-=_);const x=[];for(let b=0;b<e.children.length;b++){const P=e.children[b];let C=P.getAttribute("offset");/%/ig.test(C)&&(C=parseFloat(C.replace(/%/ig,""))/100),C=parseFloat(C);let S=P.getAttribute("stop-color"),L=P.getAttribute("stop-opacity"),A=P.getAttribute("style"),I;S===null&&(I=A?A.match(/stop-color:\s?([#a-fA-F0-9]*)/):!1,S=I&&I.length>1?I[1]:void 0),L===null?(I=A?A.match(/stop-opacity:\s?([0-9.-]*)/):!1,L=I&&I.length>1?parseFloat(I[1]):1):L=parseFloat(L),x.push(new Kt(C,S,L))}const w=new ht(o,h,u,c,x);return w.spread=l,w.units=r,Xt.call(this,e,w,t),w},radialgradient:function(e,t){let r=e.getAttribute("gradientUnits"),l=e.getAttribute("spreadMethod");r||(r="objectBoundingBox"),l||(l="pad");let o=parseFloat(e.getAttribute("cx"))||0,h=parseFloat(e.getAttribute("cy"))||0,u=parseFloat(e.getAttribute("r")),c=parseFloat(e.getAttribute("fx")),p=parseFloat(e.getAttribute("fy"));W.isNaN(c)&&(c=o),W.isNaN(p)&&(p=h);const _=Math.abs(o+c)/2,x=Math.abs(h+p)/2;/userSpaceOnUse/i.test(r)&&(o-=_,h-=x,c-=_,p-=x);const w=[];for(let P=0;P<e.children.length;P++){const C=e.children[P];let S=C.getAttribute("offset");/%/ig.test(S)&&(S=parseFloat(S.replace(/%/ig,""))/100),S=parseFloat(S);let L=C.getAttribute("stop-color"),A=C.getAttribute("stop-opacity"),I=C.getAttribute("style"),X;L===null&&(X=I?I.match(/stop-color:\s?([#a-fA-F0-9]*)/):!1,L=X&&X.length>1?X[1]:void 0),A===null?(X=I?I.match(/stop-opacity:\s?([0-9.-]*)/):!1,A=X&&X.length>1?parseFloat(X[1]):1):A=parseFloat(A),w.push(new Kt(S,L,A))}const b=new ft(o,h,u,w,c,p);return b.spread=l,b.units=r,Xt.call(this,e,b,t),b},text:function(e,t){const r=Xn(e.getAttribute("text-anchor"))||"left",l=Fn(e)||"baseline",o=e.textContent,h=new Yt(o);return Xt.call(this,e,h,t),h.alignment=r,h.baseline=l,h},clippath:function(e,t){return at.defs.current&&!at.defs.current.contains(e.id)&&at.defs.current.add(e.id,e),null},image:function(e,t){let r;const l=e.getAttribute("href")||e.getAttribute("xlink:href");if(!l)return r=new kt("encountered <image /> with no href."),console.warn(r.name,r.message),null;const o=parseFloat(e.getAttribute("x"))||0,h=parseFloat(e.getAttribute("y"))||0,u=parseFloat(e.getAttribute("width")),c=parseFloat(e.getAttribute("height")),p=new Ve(l,o,h);return W.isNaN(u)||(p.width=u),W.isNaN(c)||(p.height=c),Xt.call(this,e,p,t),p}};function ks(e,t){const r=new XMLHttpRequest;return r.open("GET",e),r.onreadystatechange=function(){r.readyState===4&&r.status===200&&t(r.responseText)},r.send(),r}var hi=class extends re{constructor(e,t,r,l){super(t,r,0,0),g(this,"_flagTextures",!1),g(this,"_flagFrameRate",!1),g(this,"_flagIndex",!1),g(this,"_amount",1),g(this,"_duration",0),g(this,"_index",0),g(this,"_startTime",0),g(this,"_playing",!1),g(this,"_firstFrame",0),g(this,"_lastFrame",0),g(this,"_loop",!0),g(this,"_textures",null),g(this,"_frameRate",0),g(this,"_origin",null);for(let o in Ki)Object.defineProperty(this,o,Ki[o]);this._renderer.flagTextures=qn.bind(this),this._renderer.bindTextures=Vn.bind(this),this._renderer.unbindTextures=Hn.bind(this),this.noStroke(),this.noFill(),Array.isArray(e)?this.textures=e.map($i.bind(this)):this.textures=[$i(e)],this.origin=new R,this._update(),typeof l=="number"?this.frameRate=l:this.frameRate=hi.DefaultFrameRate,this.index=0}play(e,t,r){return this._playing=!0,this._firstFrame=0,this._lastFrame=this.amount-1,this._startTime=W.performance.now(),typeof e=="number"&&(this._firstFrame=e),typeof t=="number"&&(this._lastFrame=t),typeof r=="function"?this._onLastFrame=r:delete this._onLastFrame,this._index!==this._firstFrame&&(this._startTime-=1e3*Math.abs(this._index-this._firstFrame)/this._frameRate),this}pause(){return this._playing=!1,this}stop(){return this._playing=!1,this._index=this._firstFrame,this}clone(e){const t=new hi(this.textures,this.translation.x,this.translation.y,this.frameRate);return t._loop=this._loop,this._playing&&t.play(),e&&e.add(t),t}toObject(){const e=super.toObject.call(this);return e.textures=this.textures.map(function(t){return t.toObject()}),e.frameRate=this.frameRate,e.index=this.index,e._firstFrame=this._firstFrame,e._lastFrame=this._lastFrame,e._loop=this._loop,e}_update(){const e=this._textures;let t,r,l,o,h,u,c,p;return e&&(this._flagTextures&&(this._amount=e.length),this._flagFrameRate&&(this._duration=1e3*this._amount/this._frameRate),this._playing&&this._frameRate>0?(o=this._amount,W.isNaN(this._lastFrame)&&(this._lastFrame=o-1),l=W.performance.now()-this._startTime,p=this._lastFrame+1,h=1e3*(p-this._firstFrame)/this._frameRate,this._loop?l=l%h:l=Math.min(l,h),c=Lt(this._firstFrame,p,l/h),c=Math.floor(c),c!==this._index&&(this._index=c,u=e[this._index],u.loaded&&(t=u.image.width,r=u.image.height,this.width!==t&&(this.width=t),this.height!==r&&(this.height=r),this.fill=u,c>=this._lastFrame-1&&this._onLastFrame&&this._onLastFrame()))):(this._flagIndex||!(this.fill instanceof st))&&(u=e[this._index],u.loaded&&(t=u.image.width,r=u.image.height,this.width!==t&&(this.width=t),this.height!==r&&(this.height=r)),this.fill=u)),super._update.call(this),this}flagReset(){return this._flagTextures=this._flagFrameRate=!1,super.flagReset.call(this),this}},Ze=hi;g(Ze,"Properties",["textures","frameRate","index"]);g(Ze,"DefaultFrameRate",30);var Ki={frameRate:{enumerable:!0,get:function(){return this._frameRate},set:function(e){this._frameRate=e,this._flagFrameRate=!0}},index:{enumerable:!0,get:function(){return this._index},set:function(e){this._index=e,this._flagIndex=!0}},textures:{enumerable:!0,get:function(){return this._textures},set:function(e){const t=this._renderer.bindTextures,r=this._renderer.unbindTextures;this._textures&&this._textures.unbind(O.Types.insert,t).unbind(O.Types.remove,r),this._textures=new Jt((e||[]).slice(0)),this._textures.bind(O.Types.insert,t).bind(O.Types.remove,r),t(this._textures)}}};function qn(){this._flagTextures=!0}function Vn(e){let t=e.length;for(;t--;)e[t].bind(O.Types.change,this._renderer.flagTextures);this._renderer.flagTextures()}function Hn(e){let t=e.length;for(;t--;)e[t].unbind(O.Types.change,this._renderer.flagTextures);this._renderer.flagTextures()}function $i(e){if(e instanceof st)return e;if(typeof e=="string")return new st(e)}var Re=class extends it{constructor(e,t,r,l,o,h,u){const c=u||yt.Resolution*3,p=[];for(let _=0;_<c;_++)p.push(new K);super(p,!0,!1,!0),g(this,"_flagStartAngle",!1),g(this,"_flagEndAngle",!1),g(this,"_flagInnerRadius",!1),g(this,"_flagOuterRadius",!1),g(this,"_startAngle",0),g(this,"_endAngle",Pt),g(this,"_innerRadius",0),g(this,"_outerRadius",0);for(let _ in Qi)Object.defineProperty(this,_,Qi[_]);typeof r=="number"&&(this.innerRadius=r),typeof l=="number"&&(this.outerRadius=l),typeof o=="number"&&(this.startAngle=o),typeof h=="number"&&(this.endAngle=h),this._update(),typeof e=="number"&&(this.translation.x=e),typeof t=="number"&&(this.translation.y=t)}_update(){if(this._flagVertices||this._flagStartAngle||this._flagEndAngle||this._flagInnerRadius||this._flagOuterRadius){const e=this._startAngle,t=this._endAngle,r=this._innerRadius,l=this._outerRadius,o=Nt(e,Pt)===Nt(t,Pt),h=r>0,u=this.vertices;let c=h?u.length/2:u.length,p,_=0,x,w,b,P,C,S,L,A,I;for(o?c--:h||(c-=2),x=0,w=c-1;x<c;x++){switch(b=x/w,P=u[_],C=b*(t-e)+e,S=(t-e)/c,L=l*Math.cos(C),A=l*Math.sin(C),x){case 0:p=F.move;break;default:p=F.curve}P.command=p,P.x=L,P.y=A,P.controls.left.clear(),P.controls.right.clear(),P.command===F.curve&&(I=l*S/Math.PI,P.controls.left.x=I*Math.cos(C-gt),P.controls.left.y=I*Math.sin(C-gt),P.controls.right.x=I*Math.cos(C+gt),P.controls.right.y=I*Math.sin(C+gt),x===1&&P.controls.left.multiplyScalar(2),x===w&&P.controls.right.multiplyScalar(2)),_++}if(h){for(o?(u[_].command=F.close,_++):(c--,w=c-1),x=0;x<c;x++)b=x/w,P=u[_],C=(1-b)*(t-e)+e,S=(t-e)/c,L=r*Math.cos(C),A=r*Math.sin(C),p=F.curve,x<=0&&(p=o?F.move:F.line),P.command=p,P.x=L,P.y=A,P.controls.left.clear(),P.controls.right.clear(),P.command===F.curve&&(I=r*S/Math.PI,P.controls.left.x=I*Math.cos(C+gt),P.controls.left.y=I*Math.sin(C+gt),P.controls.right.x=I*Math.cos(C-gt),P.controls.right.y=I*Math.sin(C-gt),x===1&&P.controls.left.multiplyScalar(2),x===w&&P.controls.right.multiplyScalar(2)),_++;u[_].copy(u[0]),u[_].command=F.line}else o||(u[_].command=F.line,u[_].x=0,u[_].y=0,_++,u[_].copy(u[0]),u[_].command=F.line)}return super._update.call(this),this}flagReset(){return super.flagReset.call(this),this._flagStartAngle=this._flagEndAngle=this._flagInnerRadius=this._flagOuterRadius=!1,this}clone(e){const t=this.innerRadius,r=this.outerRadius,l=this.startAngle,o=this.endAngle,h=this.vertices.length,u=new Re(0,0,t,r,l,o,h);u.translation.copy(this.translation),u.rotation=this.rotation,u.scale=this.scale,u.skewX=this.skewX,u.skewY=this.skewY,this.matrix.manual&&u.matrix.copy(this.matrix);for(let c=0;c<it.Properties.length;c++){const p=it.Properties[c];u[p]=this[p]}return e&&e.add(u),u}toObject(){const e=super.toObject.call(this);for(let t=0;t<Re.Properties.length;t++){const r=Re.Properties[t];e[r]=this[r]}return e}},pi=Re;g(pi,"Properties",["startAngle","endAngle","innerRadius","outerRadius"]);var Qi={startAngle:{enumerable:!0,get:function(){return this._startAngle},set:function(e){this._startAngle=e,this._flagStartAngle=!0}},endAngle:{enumerable:!0,get:function(){return this._endAngle},set:function(e){this._endAngle=e,this._flagEndAngle=!0}},innerRadius:{enumerable:!0,get:function(){return this._innerRadius},set:function(e){this._innerRadius=e,this._flagInnerRadius=!0}},outerRadius:{enumerable:!0,get:function(){return this._outerRadius},set:function(e){this._outerRadius=e,this._flagOuterRadius=!0}}},zn=Math.ceil,Gn=Math.floor,ye=class extends jt{constructor(e){super(),g(this,"_flagVertices",!0),g(this,"_flagLength",!0),g(this,"_flagFill",!0),g(this,"_flagStroke",!0),g(this,"_flagLinewidth",!0),g(this,"_flagOpacity",!0),g(this,"_flagVisible",!0),g(this,"_flagSize",!0),g(this,"_flagSizeAttenuation",!0),g(this,"_length",0),g(this,"_fill","#fff"),g(this,"_stroke","#000"),g(this,"_linewidth",1),g(this,"_opacity",1),g(this,"_visible",!0),g(this,"_size",1),g(this,"_sizeAttenuation",!1),g(this,"_beginning",0),g(this,"_ending",1),g(this,"_dashes",null),g(this,"noFill",it.prototype.noFill),g(this,"noStroke",it.prototype.noStroke),g(this,"corner",it.prototype.corner),g(this,"center",it.prototype.center),g(this,"getBoundingClientRect",it.prototype.getBoundingClientRect),g(this,"_updateLength",it.prototype._updateLength);for(let t in ts)Object.defineProperty(this,t,ts[t]);this._renderer.type="points",this._renderer.flagVertices=Is.bind(this),this._renderer.bindVertices=Ts.bind(this),this._renderer.unbindVertices=As.bind(this),this._renderer.flagFill=Ss.bind(this),this._renderer.flagStroke=Ls.bind(this),this._renderer.vertices=null,this._renderer.collection=null,this.sizeAttenuation=!1,this.beginning=0,this.ending=1,this.fill="#fff",this.stroke="#000",this.className="",this.visible=!0,this.vertices=e,this.dashes=[],this.dashes.offset=0}clone(e){const t=new ye;for(let r=0;r<this.vertices.length;r++)t.vertices.push(this.vertices[r].clone());for(let r=0;r<ye.Properties.length;r++){const l=ye.Properties[r];t[l]=this[l]}return t.className=this.className,t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale,t.skewX=this.skewX,t.skewY=this.skewY,this.matrix.manual&&t.matrix.copy(this.matrix),e&&e.add(t),t._update()}toObject(){const e={vertices:this.vertices.map(function(t){return t.toObject()})};return W.each(ye.Properties,function(t){e[t]=this[t]},this),e.className=this.className,e.translation=this.translation.toObject(),e.rotation=this.rotation,e.scale=this.scale instanceof R?this.scale.toObject():this.scale,e.skewX=this.skewX,e.skewY=this.skewY,this.matrix.manual&&(e.matrix=this.matrix.toObject()),e}subdivide(e){this._update();let t=[];for(let r=0;r<this.vertices.length;r++){const l=this.vertices[r],o=this.vertices[r-1];if(!o)continue;const h=l.x,u=l.y,c=o.x,p=o.y,_=ui(h,u,h,u,c,p,c,p,e);t=t.concat(_)}return this.vertices=t,this}_update(){if(this._flagVertices){this._flagLength&&this._updateLength(void 0,!0);const e=Math.min(this._beginning,this._ending),t=Math.max(this._beginning,this._ending),r=We(this,e*this._length),l=We(this,t*this._length),o=zn(r),h=Gn(l);let u=0,c;this._renderer.vertices=[],this._renderer.collection=[];for(let p=0;p<this._collection.length;p++)p>=o&&p<=h&&(c=this._collection[p],this._renderer.collection.push(c),this._renderer.vertices[u*2+0]=c.x,this._renderer.vertices[u*2+1]=c.y,u++)}return super._update.apply(this,arguments),this}flagReset(){return this._flagVertices=this._flagLength=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagSize=this._flagSizeAttenuation=!1,super.flagReset.call(this),this}},_i=ye;g(_i,"Properties",["fill","stroke","linewidth","opacity","visible","size","sizeAttenuation","beginning","ending"]);var ts={linewidth:{enumerable:!0,get:function(){return this._linewidth},set:function(e){this._linewidth=e,this._flagLinewidth=!0}},opacity:{enumerable:!0,get:function(){return this._opacity},set:function(e){this._opacity=e,this._flagOpacity=!0}},visible:{enumerable:!0,get:function(){return this._visible},set:function(e){this._visible=e,this._flagVisible=!0}},size:{enumerable:!0,get:function(){return this._size},set:function(e){this._size=e,this._flagSize=!0}},sizeAttenuation:{enumerable:!0,get:function(){return this._sizeAttenuation},set:function(e){this._sizeAttenuation=e,this._flagSizeAttenuation=!0}},fill:{enumerable:!0,get:function(){return this._fill},set:function(e){(this._fill instanceof mt||this._fill instanceof ht||this._fill instanceof ft||this._fill instanceof st)&&this._fill.unbind(O.Types.change,this._renderer.flagFill),this._fill=e,this._flagFill=!0,(this._fill instanceof mt||this._fill instanceof ht||this._fill instanceof ft||this._fill instanceof st)&&this._fill.bind(O.Types.change,this._renderer.flagFill)}},stroke:{enumerable:!0,get:function(){return this._stroke},set:function(e){(this._stroke instanceof mt||this._stroke instanceof ht||this._stroke instanceof ft||this._stroke instanceof st)&&this._stroke.unbind(O.Types.change,this._renderer.flagStroke),this._stroke=e,this._flagStroke=!0,(this._stroke instanceof mt||this._stroke instanceof ht||this._stroke instanceof ft||this._stroke instanceof st)&&this._stroke.bind(O.Types.change,this._renderer.flagStroke)}},length:{get:function(){return this._flagLength&&this._updateLength(),this._length}},beginning:{enumerable:!0,get:function(){return this._beginning},set:function(e){this._beginning=e,this._flagVertices=!0}},ending:{enumerable:!0,get:function(){return this._ending},set:function(e){this._ending=e,this._flagVertices=!0}},vertices:{enumerable:!0,get:function(){return this._collection},set:function(e){const t=this._renderer.bindVertices,r=this._renderer.unbindVertices;this._collection&&this._collection.unbind(O.Types.insert,t).unbind(O.Types.remove,r),e instanceof Jt?this._collection=e:this._collection=new Jt(e||[]),this._collection.bind(O.Types.insert,t).bind(O.Types.remove,r),t(this._collection)}},dashes:{enumerable:!0,get:function(){return this._dashes},set:function(e){typeof e.offset!="number"&&(e.offset=this.dashes&&this._dashes.offset||0),this._dashes=e}}},Zn=Math.cos,jn=Math.sin,Be=class extends it{constructor(e,t,r,l){l=Math.max(l||0,3),super(),g(this,"_flagWidth",!1),g(this,"_flagHeight",!1),g(this,"_flagSides",!1),g(this,"_radius",0),g(this,"_width",0),g(this,"_height",0),g(this,"_sides",0);for(let o in es)Object.defineProperty(this,o,es[o]);this.closed=!0,this.automatic=!1,typeof r=="number"&&(this.radius=r),typeof l=="number"&&(this.sides=l),this._update(),typeof e=="number"&&(this.translation.x=e),typeof t=="number"&&(this.translation.y=t)}_update(){if(this._flagVertices||this._flagWidth||this._flagHeight||this._flagSides){const e=this._sides,t=e+1;let r=this.vertices.length;r>e&&(this.vertices.splice(e-1,r-e),r=e);for(let l=0;l<t;l++){const o=(l+.5)/e,h=Pt*o+Math.PI/2,u=this._width*Zn(h)/2,c=this._height*jn(h)/2;l>=r?this.vertices.push(new K(u,c)):this.vertices[l].set(u,c),this.vertices[l].command=l===0?F.move:F.line}}return super._update.call(this),this}flagReset(){return this._flagWidth=this._flagHeight=this._flagSides=!1,super.flagReset.call(this),this}clone(e){const t=new Be(0,0,0,this.sides);t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale,t.skewX=this.skewX,t.skewY=this.skewY,t.width=this.width,t.height=this.height,this.matrix.manual&&t.matrix.copy(this.matrix);for(let r=0;r<it.Properties.length;r++){const l=it.Properties[r];t[l]=this[l]}return e&&e.add(t),t}toObject(){const e=super.toObject.call(this);for(let t=0;t<Be.Properties.length;t++){const r=Be.Properties[t];e[r]=this[r]}return e}},mi=Be;g(mi,"Properties",["width","height","sides"]);var es={radius:{enumerable:!0,get:function(){return this._radius},set:function(e){this._radius=e,this.width=e*2,this.height=e*2}},width:{enumerable:!0,get:function(){return this._width},set:function(e){this._width=e,this._flagWidth=!0,this._radius=Math.max(this.width,this.height)/2}},height:{enumerable:!0,get:function(){return this._height},set:function(e){this._height=e,this._flagHeight=!0,this._radius=Math.max(this.width,this.height)/2}},sides:{enumerable:!0,get:function(){return this._sides},set:function(e){this._sides=e,this._flagSides=!0}}},Jn=Math.cos,Kn=Math.sin,Ye=class extends it{constructor(e,t,r,l,o){arguments.length<=3&&(l=r,r=l/2),(typeof o!="number"||o<=0)&&(o=5),super(),g(this,"_flagInnerRadius",!1),g(this,"_flagOuterRadius",!1),g(this,"_flagSides",!1),g(this,"_innerRadius",0),g(this,"_outerRadius",0),g(this,"_sides",0);for(let h in is)Object.defineProperty(this,h,is[h]);this.closed=!0,this.automatic=!1,typeof r=="number"&&(this.innerRadius=r),typeof l=="number"&&(this.outerRadius=l),typeof o=="number"&&(this.sides=o),this._update(),typeof e=="number"&&(this.translation.x=e),typeof t=="number"&&(this.translation.y=t)}_update(){if(this._flagVertices||this._flagInnerRadius||this._flagOuterRadius||this._flagSides){const e=this._sides*2,t=e+1;let r=this.vertices.length;r>e&&(this.vertices.splice(e-1,r-e),r=e);for(let l=0;l<t;l++){const o=(l+.5)/e,h=Pt*o,u=(l%2?this._outerRadius:this._innerRadius)/2,c=u*Jn(h),p=u*Kn(h);l>=r?this.vertices.push(new K(c,p)):this.vertices[l].set(c,p),this.vertices[l].command=l===0?F.move:F.line}}return super._update.call(this),this}flagReset(){return this._flagInnerRadius=this._flagOuterRadius=this._flagSides=!1,super.flagReset.call(this),this}clone(e){const t=this.innerRadius,r=this.outerRadius,l=this.sides,o=new Ye(0,0,t,r,l);o.translation.copy(this.translation),o.rotation=this.rotation,o.scale=this.scale,o.skewX=this.skewX,o.skewY=this.skewY,this.matrix.manual&&o.matrix.copy(this.matrix);for(let h=0;h<it.Properties.length;h++){const u=it.Properties[h];o[u]=this[u]}return e&&e.add(o),o}toObject(){const e=super.toObject.call(this);for(let t=0;t<Ye.Properties.length;t++){const r=Ye.Properties[t];e[r]=this[r]}return e}},gi=Ye;g(gi,"Properties",["innerRadius","outerRadius","sides"]);var is={innerRadius:{enumerable:!0,get:function(){return this._innerRadius},set:function(e){this._innerRadius=e,this._flagInnerRadius=!0}},outerRadius:{enumerable:!0,get:function(){return this._outerRadius},set:function(e){this._outerRadius=e,this._flagOuterRadius=!0}},sides:{enumerable:!0,get:function(){return this._sides},set:function(e){this._sides=e,this._flagSides=!0}}},z={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",alignments:{left:"start",center:"middle",right:"end"},baselines:{top:"hanging",middle:"middle",bottom:"ideographic",baseline:"alphabetic"},createElement:function(e,t){const r=e,l=document.createElementNS(z.ns,r);return r==="svg"&&(t=W.defaults(t||{},{version:z.version})),t&&Object.keys(t).length>0&&z.setAttributes(l,t),l},setAttributes:function(e,t){const r=Object.keys(t);for(let l=0;l<r.length;l++)/href/.test(r[l])?e.setAttributeNS(z.xlink,r[l],t[r[l]]):e.setAttribute(r[l],t[r[l]]);return this},removeAttributes:function(e,t){for(let r in t)e.removeAttribute(r);return this},toString:function(e,t){let r=e.length,l=r-1,o,h="";for(let u=0;u<r;u++){const c=e[u],p=t?Nt(u-1,r):Math.max(u-1,0),_=e[p];let x,w,b,P,C,S,L,A,I,X,M,k,U,D,Z,V=dt(c.x),q=dt(c.y);switch(c.command){case F.close:x=F.close;break;case F.arc:M=c.rx,k=c.ry,U=c.xAxisRotation,D=c.largeArcFlag,Z=c.sweepFlag,x=F.arc+" "+M+" "+k+" "+U+" "+D+" "+Z+" "+V+" "+q;break;case F.curve:L=_.controls&&_.controls.right||R.zero,A=c.controls&&c.controls.left||R.zero,_.relative?(b=dt(L.x+_.x),P=dt(L.y+_.y)):(b=dt(L.x),P=dt(L.y)),c.relative?(C=dt(A.x+c.x),S=dt(A.y+c.y)):(C=dt(A.x),S=dt(A.y)),x=(u===0?F.move:F.curve)+" "+b+" "+P+" "+C+" "+S+" "+V+" "+q;break;case F.move:o=c,x=F.move+" "+V+" "+q;break;default:x=c.command+" "+V+" "+q}u>=l&&t&&(c.command===F.curve&&(w=o,I=c.controls&&c.controls.right||c,X=w.controls&&w.controls.left||w,c.relative?(b=dt(I.x+c.x),P=dt(I.y+c.y)):(b=dt(I.x),P=dt(I.y)),w.relative?(C=dt(X.x+w.x),S=dt(X.y+w.y)):(C=dt(X.x),S=dt(X.y)),V=dt(w.x),q=dt(w.y),x+=" C "+b+" "+P+" "+C+" "+S+" "+V+" "+q),c.command!==F.close&&(x+=" Z")),h+=x+" "}return h},pointsToString:function(e,t){let r="";const l=t*.5;for(let o=0;o<e.length;o++){const h=e[o].x,u=e[o].y-l;r+=F.move+" "+h+" "+u+" ",r+="a "+l+" "+l+" 0 1 0 0.001 0 Z"}return r},getClip:function(e,t){let r=e._renderer.clip;return r||(r=e._renderer.clip=z.createElement("clipPath",{"clip-rule":"nonzero"})),r.parentNode===null&&t.defs.appendChild(r),r},defs:{update:function(e){const{defs:t}=e;if(t._flagUpdate){const r=Array.prototype.slice.call(t.children,0);for(let l=0;l<r.length;l++){const o=r[l],h=o.id,u=`[fill="url(#${h})"],[stroke="url(#${h})"],[clip-path="url(#${h})"]`;e.querySelector(u)||t.removeChild(o)}t._flagUpdate=!1}}},group:{appendChild:function(e){const t=e._renderer.elem;if(!t)return;const r=t.nodeName;!r||/(radial|linear)gradient/i.test(r)||e._clip||this.elem.appendChild(t)},removeChild:function(e){const t=e._renderer.elem;!t||t.parentNode!=this.elem||!t.nodeName||e._clip||this.elem.removeChild(t)},orderChild:function(e){this.elem.appendChild(e._renderer.elem)},renderChild:function(e){z[e._renderer.type].render.call(e,this)},render:function(e){if(!this._visible&&!this._flagVisible||this._opacity===0&&!this._flagOpacity)return this;this._update(),this._renderer.elem||(this._renderer.elem=z.createElement("g",{id:this.id}),e.appendChild(this._renderer.elem));const t=this._matrix.manual||this._flagMatrix,r={domElement:e,elem:this._renderer.elem};t&&this._renderer.elem.setAttribute("transform","matrix("+this._matrix.toString()+")");for(let l=0;l<this.children.length;l++){const o=this.children[l];z[o._renderer.type].render.call(o,e)}return this._flagId&&this._renderer.elem.setAttribute("id",this._id),this._flagOpacity&&this._renderer.elem.setAttribute("opacity",this._opacity),this._flagVisible&&this._renderer.elem.setAttribute("display",this._visible?"inline":"none"),this._flagClassName&&this._renderer.elem.setAttribute("class",this.classList.join(" ")),this._flagAdditions&&this.additions.forEach(z.group.appendChild,r),this._flagSubtractions&&this.subtractions.forEach(z.group.removeChild,r),this._flagOrder&&this.children.forEach(z.group.orderChild,r),this._flagMask&&(this._mask?(z[this._mask._renderer.type].render.call(this._mask,e),this._renderer.elem.setAttribute("clip-path","url(#"+this._mask.id+")")):this._renderer.elem.removeAttribute("clip-path")),this.dataset&&Object.assign(this._renderer.elem.dataset,this.dataset),this.flagReset()}},path:{render:function(e){if(this._opacity===0&&!this._flagOpacity)return this;this._update();const t={};if((this._matrix.manual||this._flagMatrix)&&(t.transform="matrix("+this._matrix.toString()+")"),this._flagId&&(t.id=this._id),this._flagVertices){const l=z.toString(this._renderer.vertices,this._closed);t.d=l}if(this._fill&&this._fill._renderer&&(this._renderer.hasFillEffect=!0,this._fill._update(),z[this._fill._renderer.type].render.call(this._fill,e,!0)),this._flagFill&&(t.fill=this._fill&&this._fill.id?"url(#"+this._fill.id+")":this._fill,this._renderer.hasFillEffect&&typeof this._fill.id>"u"&&(e.defs._flagUpdate=!0,delete this._renderer.hasFillEffect)),this._stroke&&this._stroke._renderer&&(this._renderer.hasStrokeEffect=!0,this._stroke._update(),z[this._stroke._renderer.type].render.call(this._stroke,e,!0)),this._flagStroke&&(t.stroke=this._stroke&&this._stroke.id?"url(#"+this._stroke.id+")":this._stroke,this._renderer.hasStrokeEffect&&typeof this._stroke.id>"u"&&(e.defs._flagUpdate=!0,delete this._renderer.hasStrokeEffect)),this._flagLinewidth&&(t["stroke-width"]=this._linewidth),this._flagOpacity&&(t["stroke-opacity"]=this._opacity,t["fill-opacity"]=this._opacity),this._flagClassName&&(t.class=this.classList.join(" ")),this._flagVisible&&(t.visibility=this._visible?"visible":"hidden"),this._flagCap&&(t["stroke-linecap"]=this._cap),this._flagJoin&&(t["stroke-linejoin"]=this._join),this._flagMiter&&(t["stroke-miterlimit"]=this._miter),this.dashes&&this.dashes.length>0&&(t["stroke-dasharray"]=this.dashes.join(" "),t["stroke-dashoffset"]=this.dashes.offset||0),this._renderer.elem?z.setAttributes(this._renderer.elem,t):(t.id=this._id,this._renderer.elem=z.createElement("path",t),e.appendChild(this._renderer.elem)),this._flagClip){const l=z.getClip(this,e),o=this._renderer.elem;this._clip?(o.removeAttribute("id"),l.setAttribute("id",this.id),l.appendChild(o)):(l.removeAttribute("id"),o.setAttribute("id",this.id),this.parent._renderer.elem.appendChild(o))}return this._flagMask&&(this._mask?(z[this._mask._renderer.type].render.call(this._mask,e),this._renderer.elem.setAttribute("clip-path","url(#"+this._mask.id+")")):this._renderer.elem.removeAttribute("clip-path")),this.flagReset()}},points:{render:function(e){if(this._opacity===0&&!this._flagOpacity)return this;this._update();const t={};if((this._matrix.manual||this._flagMatrix)&&(t.transform="matrix("+this._matrix.toString()+")"),this._flagId&&(t.id=this._id),this._flagVertices||this._flagSize||this._flagSizeAttenuation){let l=this._size;if(!this._sizeAttenuation){const h=this.worldMatrix.elements,u=ce(h[0],h[3],h[1],h[4],h[2],h[5]);l/=Math.max(u.scaleX,u.scaleY)}const o=z.pointsToString(this._renderer.collection,l);t.d=o}return this._fill&&this._fill._renderer&&(this._renderer.hasFillEffect=!0,this._fill._update(),z[this._fill._renderer.type].render.call(this._fill,e,!0)),this._flagFill&&(t.fill=this._fill&&this._fill.id?"url(#"+this._fill.id+")":this._fill,this._renderer.hasFillEffect&&typeof this._fill.id>"u"&&(e.defs._flagUpdate=!0,delete this._renderer.hasFillEffect)),this._stroke&&this._stroke._renderer&&(this._renderer.hasStrokeEffect=!0,this._stroke._update(),z[this._stroke._renderer.type].render.call(this._stroke,e,!0)),this._flagStroke&&(t.stroke=this._stroke&&this._stroke.id?"url(#"+this._stroke.id+")":this._stroke,this._renderer.hasStrokeEffect&&typeof this._stroke.id>"u"&&(e.defs._flagUpdate=!0,delete this._renderer.hasStrokeEffect)),this._flagLinewidth&&(t["stroke-width"]=this._linewidth),this._flagOpacity&&(t["stroke-opacity"]=this._opacity,t["fill-opacity"]=this._opacity),this._flagClassName&&(t.class=this.classList.join(" ")),this._flagVisible&&(t.visibility=this._visible?"visible":"hidden"),this.dashes&&this.dashes.length>0&&(t["stroke-dasharray"]=this.dashes.join(" "),t["stroke-dashoffset"]=this.dashes.offset||0),this._renderer.elem?z.setAttributes(this._renderer.elem,t):(t.id=this._id,this._renderer.elem=z.createElement("path",t),e.appendChild(this._renderer.elem)),this.flagReset()}},text:{render:function(e){this._update();const t={};if((this._matrix.manual||this._flagMatrix)&&(t.transform="matrix("+this._matrix.toString()+")"),this._flagId&&(t.id=this._id),this._flagFamily&&(t["font-family"]=this._family),this._flagSize&&(t["font-size"]=this._size),this._flagLeading&&(t["line-height"]=this._leading),this._flagAlignment&&(t["text-anchor"]=z.alignments[this._alignment]||this._alignment),this._flagBaseline&&(t["dominant-baseline"]=z.baselines[this._baseline]||this._baseline),this._flagStyle&&(t["font-style"]=this._style),this._flagWeight&&(t["font-weight"]=this._weight),this._flagDecoration&&(t["text-decoration"]=this._decoration),this._flagDirection&&(t.direction=this._direction),this._fill&&this._fill._renderer&&(this._renderer.hasFillEffect=!0,this._fill._update(),z[this._fill._renderer.type].render.call(this._fill,e,!0)),this._flagFill&&(t.fill=this._fill&&this._fill.id?"url(#"+this._fill.id+")":this._fill,this._renderer.hasFillEffect&&typeof this._fill.id>"u"&&(e.defs._flagUpdate=!0,delete this._renderer.hasFillEffect)),this._stroke&&this._stroke._renderer&&(this._renderer.hasStrokeEffect=!0,this._stroke._update(),z[this._stroke._renderer.type].render.call(this._stroke,e,!0)),this._flagStroke&&(t.stroke=this._stroke&&this._stroke.id?"url(#"+this._stroke.id+")":this._stroke,this._renderer.hasStrokeEffect&&typeof this._stroke.id>"u"&&(e.defs._flagUpdate=!0,delete this._renderer.hasStrokeEffect)),this._flagLinewidth&&(t["stroke-width"]=this._linewidth),this._flagOpacity&&(t.opacity=this._opacity),this._flagClassName&&(t.class=this.classList.join(" ")),this._flagVisible&&(t.visibility=this._visible?"visible":"hidden"),this.dashes&&this.dashes.length>0&&(t["stroke-dasharray"]=this.dashes.join(" "),t["stroke-dashoffset"]=this.dashes.offset||0),this._renderer.elem?z.setAttributes(this._renderer.elem,t):(t.id=this._id,this._renderer.elem=z.createElement("text",t),e.appendChild(this._renderer.elem)),this._flagClip){const l=z.getClip(this,e),o=this._renderer.elem;this._clip?(o.removeAttribute("id"),l.setAttribute("id",this.id),l.appendChild(o)):(l.removeAttribute("id"),o.setAttribute("id",this.id),this.parent._renderer.elem.appendChild(o))}return this._flagMask&&(this._mask?(z[this._mask._renderer.type].render.call(this._mask,e),this._renderer.elem.setAttribute("clip-path","url(#"+this._mask.id+")")):this._renderer.elem.removeAttribute("clip-path")),this._flagValue&&(this._renderer.elem.textContent=this._value),this.flagReset()}},"linear-gradient":{render:function(e,t){t||this._update();const r={};if(this._flagId&&(r.id=this._id),this._flagEndPoints&&(r.x1=this.left._x,r.y1=this.left._y,r.x2=this.right._x,r.y2=this.right._y),this._flagSpread&&(r.spreadMethod=this._spread),this._flagUnits&&(r.gradientUnits=this._units),this._renderer.elem?z.setAttributes(this._renderer.elem,r):(r.id=this._id,this._renderer.elem=z.createElement("linearGradient",r)),this._renderer.elem.parentNode===null&&e.defs.appendChild(this._renderer.elem),this._flagStops){const l=this._renderer.elem.childNodes.length!==this.stops.length;if(l)for(;this._renderer.elem.lastChild;)this._renderer.elem.removeChild(this._renderer.elem.lastChild);for(let o=0;o<this.stops.length;o++){const h=this.stops[o],u={};h._flagOffset&&(u.offset=100*h._offset+"%"),h._flagColor&&(u["stop-color"]=h._color),h._flagOpacity&&(u["stop-opacity"]=h._opacity),h._renderer.elem?z.setAttributes(h._renderer.elem,u):h._renderer.elem=z.createElement("stop",u),l&&this._renderer.elem.appendChild(h._renderer.elem),h.flagReset()}}return this.flagReset()}},"radial-gradient":{render:function(e,t){t||this._update();const r={};if(this._flagId&&(r.id=this._id),this._flagCenter&&(r.cx=this.center._x,r.cy=this.center._y),this._flagFocal&&(r.fx=this.focal._x,r.fy=this.focal._y),this._flagRadius&&(r.r=this._radius),this._flagSpread&&(r.spreadMethod=this._spread),this._flagUnits&&(r.gradientUnits=this._units),this._renderer.elem?z.setAttributes(this._renderer.elem,r):(r.id=this._id,this._renderer.elem=z.createElement("radialGradient",r)),this._renderer.elem.parentNode===null&&e.defs.appendChild(this._renderer.elem),this._flagStops){const l=this._renderer.elem.childNodes.length!==this.stops.length;if(l)for(;this._renderer.elem.lastChild;)this._renderer.elem.removeChild(this._renderer.elem.lastChild);for(let o=0;o<this.stops.length;o++){const h=this.stops[o],u={};h._flagOffset&&(u.offset=100*h._offset+"%"),h._flagColor&&(u["stop-color"]=h._color),h._flagOpacity&&(u["stop-opacity"]=h._opacity),h._renderer.elem?z.setAttributes(h._renderer.elem,u):h._renderer.elem=z.createElement("stop",u),l&&this._renderer.elem.appendChild(h._renderer.elem),h.flagReset()}}return this.flagReset()}},texture:{render:function(e,t){t||this._update();const r={},l={x:0,y:0},o=this.image;if(this._flagId&&(r.id=this._id),this._flagLoaded&&this.loaded)switch(o.nodeName.toLowerCase()){case"canvas":l.href=l["xlink:href"]=o.toDataURL("image/png");break;case"img":case"image":l.href=l["xlink:href"]=this.src;break}if((this._flagOffset||this._flagLoaded||this._flagScale)&&(r.x=this._offset.x,r.y=this._offset.y,o&&(r.x-=o.width/2,r.y-=o.height/2,this._scale instanceof R?(r.x*=this._scale.x,r.y*=this._scale.y):(r.x*=this._scale,r.y*=this._scale)),r.x>0&&(r.x*=-1),r.y>0&&(r.y*=-1)),(this._flagScale||this._flagLoaded||this._flagRepeat)&&(r.width=0,r.height=0,o)){switch(r.width=o.width,r.height=o.height,this._repeat){case"no-repeat":r.width+=1,r.height+=1;break}this._scale instanceof R?(r.width*=this._scale.x,r.height*=this._scale.y):(r.width*=this._scale,r.height*=this._scale),l.width=r.width,l.height=r.height}return(this._flagScale||this._flagLoaded)&&(this._renderer.image?z.setAttributes(this._renderer.image,l):this._renderer.image=z.createElement("image",l)),this._renderer.elem?Object.keys(r).length!==0&&z.setAttributes(this._renderer.elem,r):(r.id=this._id,r.patternUnits="userSpaceOnUse",this._renderer.elem=z.createElement("pattern",r)),this._renderer.elem.parentNode===null&&e.defs.appendChild(this._renderer.elem),this._renderer.elem&&this._renderer.image&&!this._renderer.appended&&(this._renderer.elem.appendChild(this._renderer.image),this._renderer.appended=!0),this.flagReset()}}},Ns=class extends O{constructor(e){super(),this.domElement=e.domElement||z.createElement("svg"),this.scene=new _t,this.scene.parent=this,this.defs=z.createElement("defs"),this.defs._flagUpdate=!1,this.domElement.appendChild(this.defs),this.domElement.defs=this.defs,this.domElement.style.overflow="hidden"}setSize(e,t){return this.width=e,this.height=t,z.setAttributes(this.domElement,{width:e,height:t}),this.trigger(O.Types.resize,e,t)}render(){return z.group.render.call(this.scene,this.domElement),z.defs.update(this.domElement),this}};g(Ns,"Utils",z);var Ft={create:function(e,t,r){const l=e.createShader(e[r]);if(e.shaderSource(l,t),e.compileShader(l),!e.getShaderParameter(l,e.COMPILE_STATUS)){const h=e.getShaderInfoLog(l);throw e.deleteShader(l),new kt("unable to compile shader "+l+": "+h)}return l},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},path:{vertex:`
      precision mediump float;
      attribute vec2 a_position;

      uniform mat3 u_matrix;
      uniform vec2 u_resolution;
      uniform vec4 u_rect;

      varying vec2 v_textureCoords;

      void main() {
        vec2 rectCoords = (a_position * (u_rect.zw - u_rect.xy)) + u_rect.xy;
        vec2 projected = (u_matrix * vec3(rectCoords, 1.0)).xy;
        vec2 normal = projected / u_resolution;
        vec2 clipspace = (normal * 2.0) - 1.0;

        gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);
        v_textureCoords = a_position;
      }
    `,fragment:`
      precision mediump float;

      uniform sampler2D u_image;
      varying vec2 v_textureCoords;

      void main() {
        vec4 texel = texture2D(u_image, v_textureCoords);
        if (texel.a == 0.0) {
          discard;
        }
        gl_FragColor = texel;
      }
    `},points:{vertex:`
      precision mediump float;
      attribute vec2 a_position;

      uniform float u_size;
      uniform mat3 u_matrix;
      uniform vec2 u_resolution;

      varying vec2 v_textureCoords;

      void main() {
        vec2 projected = (u_matrix * vec3(a_position, 1.0)).xy;
        vec2 normal = projected / u_resolution;
        vec2 clipspace = (normal * 2.0) - 1.0;

        gl_PointSize = u_size;
        gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);
        v_textureCoords = a_position;
      }
    `,fragment:`
      precision mediump float;

      uniform sampler2D u_image;

      void main() {
        vec4 texel = texture2D(u_image, gl_PointCoord);
        if (texel.a == 0.0) {
          discard;
        }
        gl_FragColor = texel;
      }
    `}},Ee=se.Multiply,$n=[1,0,0,0,1,0,0,0,1],Gt=new Ht(9),Qn=_e.Utils,ss=new R,fi=new Ht([0,0,1,0,0,1,0,1,1,0,1,1]),G={precision:.9,isHidden:/(undefined|none|transparent)/i,canvas:ut.document?ut.document.createElement("canvas"):{getContext:function(){}},alignments:{left:"start",middle:"center",right:"end"},matrix:new se,group:{removeChild:function(e,t){if(e.children)for(let r=0;r<e.children.length;r++)G.group.removeChild(e.children[r],t);e._renderer.texture&&(t.deleteTexture(e._renderer.texture),delete e._renderer.texture),e._renderer.positionBuffer&&(t.deleteBuffer(e._renderer.positionBuffer),delete e._renderer.positionBuffer)},render:function(e,t){if(!this._visible)return;this._update();const r=this.parent,l=r._matrix&&r._matrix.manual||r._flagMatrix,o=this._matrix.manual||this._flagMatrix;(l||o)&&(this._renderer.matrix||(this._renderer.matrix=new Ht(9)),this._matrix.toTransformArray(!0,Gt),Ee(Gt,r._renderer.matrix,this._renderer.matrix),this._renderer.scale instanceof R||(this._renderer.scale=new R),this._scale instanceof R?(this._renderer.scale.x=this._scale.x,this._renderer.scale.y=this._scale.y):(this._renderer.scale.x=this._scale,this._renderer.scale.y=this._scale),/renderer/i.test(r._renderer.type)||(this._renderer.scale.x*=r._renderer.scale.x,this._renderer.scale.y*=r._renderer.scale.y),l&&(this._flagMatrix=!0)),this._mask&&(e.clear(e.STENCIL_BUFFER_BIT),e.enable(e.STENCIL_TEST),e.stencilFunc(e.ALWAYS,1,0),e.stencilOp(e.KEEP,e.KEEP,e.REPLACE),e.colorMask(!1,!1,!1,!1),G[this._mask._renderer.type].render.call(this._mask,e,t,this),e.stencilFunc(e.EQUAL,1,255),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.colorMask(!0,!0,!0,!0)),this._flagOpacity=r._flagOpacity||this._flagOpacity,this._renderer.opacity=this._opacity*(r&&r._renderer?r._renderer.opacity:1);let h;if(this._flagSubtractions)for(h=0;h<this.subtractions.length;h++)G.group.removeChild(this.subtractions[h],e);for(h=0;h<this.children.length;h++){const u=this.children[h];G[u._renderer.type].render.call(u,e,t)}return this._mask&&e.disable(e.STENCIL_TEST),this.flagReset()}},path:{updateCanvas:function(e,t){let r,l,o,h,u,c,p,_,x,w,b,P,C,S;const L=t._renderer.vertices,A=this.canvas,I=this.ctx,X=e.renderer.ratio,M=ss.copy(t._renderer.scale).multiply(X),k=t._stroke,U=t._linewidth,D=t._fill,Z=t._renderer.opacity||t._opacity,V=t._cap,q=t._join,J=t._miter,j=t._closed,rt=t.dashes,$=L.length,ct=$-1;A.width=Math.max(Math.ceil(t._renderer.rect.width*M.x),1),A.height=Math.max(Math.ceil(t._renderer.rect.height*M.y),1);const ot=t._renderer.rect.centroid,Mt=ot.x,xt=ot.y;I.clearRect(0,0,A.width,A.height),D&&(typeof D=="string"?I.fillStyle=D:(G[D._renderer.type].render.call(D,I,t),I.fillStyle=D._renderer.effect)),k&&(typeof k=="string"?I.strokeStyle=k:(G[k._renderer.type].render.call(k,I,t),I.strokeStyle=k._renderer.effect),U&&(I.lineWidth=U),J&&(I.miterLimit=J),q&&(I.lineJoin=q),!j&&V&&(I.lineCap=V)),typeof Z=="number"&&(I.globalAlpha=Z),rt&&rt.length>0&&(I.lineDashOffset=rt.offset||0,I.setLineDash(rt));let bt,Bt,Wt,$t,Tt,Qt,te,ee;I.save(),I.scale(M.x,M.y),I.translate(Mt,xt),I.beginPath();for(let At=0;At<L.length;At++){const nt=L[At];switch(P=nt.x,C=nt.y,nt.command){case F.close:I.closePath();break;case F.arc:Bt=nt.rx,Wt=nt.ry,$t=nt.xAxisRotation,Tt=nt.largeArcFlag,Qt=nt.sweepFlag,r=j?Nt(At-1,$):Math.max(At-1,0),l=L[r],te=l.x,ee=l.y,Qn.renderSvgArcCommand(I,te,ee,Bt,Wt,Tt,Qt,$t,P,C);break;case F.curve:r=j?Nt(At-1,$):Math.max(At-1,0),l=L[r],_=l.controls&&l.controls.right||R.zero,x=nt.controls&&nt.controls.left||R.zero,l._relative?(c=_.x+l.x,p=_.y+l.y):(c=_.x,p=_.y),nt._relative?(h=x.x+nt.x,u=x.y+nt.y):(h=x.x,u=x.y),I.bezierCurveTo(c,p,h,u,P,C),At>=ct&&j&&(o=bt,w=nt.controls&&nt.controls.right||R.zero,b=o.controls&&o.controls.left||R.zero,nt._relative?(c=w.x+nt.x,p=w.y+nt.y):(c=w.x,p=w.y),o._relative?(h=b.x+o.x,u=b.y+o.y):(h=b.x,u=b.y),P=o.x,C=o.y,I.bezierCurveTo(c,p,h,u,P,C));break;case F.line:I.lineTo(P,C);break;case F.move:bt=nt,I.moveTo(P,C);break}}j&&I.closePath(),G.isHidden.test(D)||(S=D._renderer&&D._renderer.offset,S&&(I.save(),I.translate(-D._renderer.offset.x,-D._renderer.offset.y),I.scale(D._renderer.scale.x,D._renderer.scale.y)),I.fill(),S&&I.restore()),G.isHidden.test(k)||(S=k._renderer&&k._renderer.offset,S&&(I.save(),I.translate(-k._renderer.offset.x,-k._renderer.offset.y),I.scale(k._renderer.scale.x,k._renderer.scale.y),I.lineWidth=U/k._renderer.scale.x),I.stroke(),S&&I.restore()),I.restore()},getBoundingClientRect:function(e,t,r){let l=1/0,o=-1/0,h=1/0,u=-1/0,c,p;e.forEach(function(_){const x=_.x,w=_.y,b=_.controls;let P,C,S,L,A,I;h=Math.min(w,h),l=Math.min(x,l),o=Math.max(x,o),u=Math.max(w,u),_.controls&&(A=b.left,I=b.right,!(!A||!I)&&(P=_._relative?A.x+x:A.x,C=_._relative?A.y+w:A.y,S=_._relative?I.x+x:I.x,L=_._relative?I.y+w:I.y,!(!P||!C||!S||!L)&&(h=Math.min(C,L,h),l=Math.min(P,S,l),o=Math.max(P,S,o),u=Math.max(C,L,u))))}),typeof t=="number"&&(h-=t,l-=t,o+=t,u+=t),c=o-l,p=u-h,r.top=h,r.left=l,r.right=o,r.bottom=u,r.width=c,r.height=p,r.centroid||(r.centroid={}),r.centroid.x=-l,r.centroid.y=-h},render:function(e,t,r){if(!this._visible||!this._opacity)return this;this._update();const l=r||this.parent,o=t[this._renderer.type],h=l._matrix.manual||l._flagMatrix,u=this._matrix.manual||this._flagMatrix,c=this._renderer.parent!==l,p=this._flagVertices||this._flagFill||this._fill instanceof ht&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagEndPoints)||this._fill instanceof ft&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagRadius||this._fill._flagCenter||this._fill._flagFocal)||this._fill instanceof st&&(this._fill._flagLoaded&&this._fill.loaded||this._fill._flagImage||this._fill._flagVideo||this._fill._flagRepeat||this._fill._flagOffset||this._fill._flagScale)||this._stroke instanceof ht&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagEndPoints)||this._stroke instanceof ft&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagRadius||this._stroke._flagCenter||this._stroke._flagFocal)||this._stroke instanceof st&&(this._stroke._flagLoaded&&this._stroke.loaded||this._stroke._flagImage||this._stroke._flagVideo||this._stroke._flagRepeat||this._stroke._flagOffset||this._fill._flagScale)||this._flagStroke||this._flagLinewidth||this._flagOpacity||l._flagOpacity||this._flagVisible||this._flagCap||this._flagJoin||this._flagMiter||this._flagScale||this.dashes&&this.dashes.length>0||!this._renderer.texture;if((h||u||c)&&(this._renderer.matrix||(this._renderer.matrix=new Ht(9)),this._matrix.toTransformArray(!0,Gt),Ee(Gt,l._renderer.matrix,this._renderer.matrix),this._renderer.scale instanceof R||(this._renderer.scale=new R),this._scale instanceof R?(this._renderer.scale.x=this._scale.x*l._renderer.scale.x,this._renderer.scale.y=this._scale.y*l._renderer.scale.y):(this._renderer.scale.x=this._scale*l._renderer.scale.x,this._renderer.scale.y=this._scale*l._renderer.scale.y),c&&(this._renderer.parent=l)),this._mask&&(e.clear(e.STENCIL_BUFFER_BIT),e.enable(e.STENCIL_TEST),e.stencilFunc(e.ALWAYS,1,0),e.stencilOp(e.KEEP,e.KEEP,e.REPLACE),e.colorMask(!1,!1,!1,!1),G[this._mask._renderer.type].render.call(this._mask,e,t,this),e.stencilFunc(e.EQUAL,1,255),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.colorMask(!0,!0,!0,!0)),p?(this._renderer.rect||(this._renderer.rect={}),this._renderer.opacity=this._opacity*l._renderer.opacity,G.path.getBoundingClientRect(this._renderer.vertices,this._linewidth,this._renderer.rect),G.updateTexture.call(G,e,this)):(this._fill&&this._fill._update&&this._fill._update(),this._stroke&&this._stroke._update&&this._stroke._update()),this._clip&&!r||!this._renderer.texture)return this;t.current!==o&&(e.useProgram(o),e.bindBuffer(e.ARRAY_BUFFER,t.buffers.position),e.vertexAttribPointer(o.position,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(o.position),e.bufferData(e.ARRAY_BUFFER,fi,e.STATIC_DRAW),t.resolution.flagged||e.uniform2f(e.getUniformLocation(o,"u_resolution"),t.resolution.width,t.resolution.height),t.current=o),t.resolution.flagged&&e.uniform2f(e.getUniformLocation(o,"u_resolution"),t.resolution.width,t.resolution.height),e.bindTexture(e.TEXTURE_2D,this._renderer.texture);const _=this._renderer.rect;return e.uniformMatrix3fv(o.matrix,!1,this._renderer.matrix),e.uniform4f(o.rect,_.left,_.top,_.right,_.bottom),e.drawArrays(e.TRIANGLES,0,6),this._mask&&e.disable(e.STENCIL_TEST),this.flagReset()}},points:{updateCanvas:function(e,t){let r;const l=this.canvas,o=this.ctx,h=e.renderer.ratio,u=t._stroke,c=t._linewidth,p=t._fill,_=t._renderer.opacity||t._opacity,x=t.dashes,w=t._size*h;let b=w;G.isHidden.test(u)||(b+=c),l.width=ds(b),l.height=l.width;const P=b/l.width,C=l.width/2,S=l.height/2;o.clearRect(0,0,l.width,l.height),p&&(typeof p=="string"?o.fillStyle=p:(G[p._renderer.type].render.call(p,o,t),o.fillStyle=p._renderer.effect)),u&&(typeof u=="string"?o.strokeStyle=u:(G[u._renderer.type].render.call(u,o,t),o.strokeStyle=u._renderer.effect),c&&(o.lineWidth=c/P)),typeof _=="number"&&(o.globalAlpha=_),x&&x.length>0&&(o.lineDashOffset=x.offset||0,o.setLineDash(x)),o.save(),o.translate(C,S),o.scale(G.precision,G.precision),o.beginPath(),o.arc(0,0,w/P*.5,0,Pt),o.restore(),closed&&o.closePath(),G.isHidden.test(p)||(r=p._renderer&&p._renderer.offset,r&&(o.save(),o.translate(-p._renderer.offset.x,-p._renderer.offset.y),o.scale(p._renderer.scale.x,p._renderer.scale.y)),o.fill(),r&&o.restore()),G.isHidden.test(u)||(r=u._renderer&&u._renderer.offset,r&&(o.save(),o.translate(-u._renderer.offset.x,-u._renderer.offset.y),o.scale(u._renderer.scale.x,u._renderer.scale.y),o.lineWidth=c/u._renderer.scale.x),o.stroke(),r&&o.restore())},render:function(e,t,r){if(!this._visible||!this._opacity)return this;this._update();let l=this._size;const o=r||this.parent,h=t[this._renderer.type],u=this._sizeAttenuation,c=this._stroke,p=this._linewidth,_=o._matrix.manual||o._flagMatrix,x=this._matrix.manual||this._flagMatrix,w=this._renderer.parent!==o,b=this._renderer.vertices,P=this._renderer.collection.length,C=this._flagVertices,S=this._flagFill||this._fill instanceof ht&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagEndPoints)||this._fill instanceof ft&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagRadius||this._fill._flagCenter||this._fill._flagFocal)||this._fill instanceof st&&(this._fill._flagLoaded&&this._fill.loaded||this._fill._flagImage||this._fill._flagVideo||this._fill._flagRepeat||this._fill._flagOffset||this._fill._flagScale)||this._stroke instanceof ht&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagEndPoints)||this._stroke instanceof ft&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagRadius||this._stroke._flagCenter||this._stroke._flagFocal)||this._stroke instanceof st&&(this._stroke._flagLoaded&&this._stroke.loaded||this._stroke._flagImage||this._stroke._flagVideo||this._stroke._flagRepeat||this._stroke._flagOffset||this._fill._flagScale)||this._flagStroke||this._flagLinewidth||this._flagOpacity||o._flagOpacity||this._flagVisible||this._flagScale||this.dashes&&this.dashes.length>0||!this._renderer.texture;if((_||x||w)&&(this._renderer.matrix||(this._renderer.matrix=new Ht(9)),this._matrix.toTransformArray(!0,Gt),Ee(Gt,o._renderer.matrix,this._renderer.matrix),this._renderer.scale instanceof R||(this._renderer.scale=new R),this._scale instanceof R?(this._renderer.scale.x=this._scale.x*o._renderer.scale.x,this._renderer.scale.y=this._scale.y*o._renderer.scale.y):(this._renderer.scale.x=this._scale*o._renderer.scale.x,this._renderer.scale.y=this._scale*o._renderer.scale.y),w&&(this._renderer.parent=o)),C){const L=this._renderer.positionBuffer;L&&e.deleteBuffer(L),this._renderer.positionBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this._renderer.positionBuffer),e.vertexAttribPointer(h.position,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(h.position),e.bufferData(e.ARRAY_BUFFER,b,e.STATIC_DRAW)}return S?(this._renderer.opacity=this._opacity*o._renderer.opacity,G.updateTexture.call(G,e,this)):(this._fill&&this._fill._update&&this._fill._update(),this._stroke&&this._stroke._update&&this._stroke._update()),this._clip&&!r||!this._renderer.texture?this:(G.isHidden.test(c)||(l+=p),l/=G.precision,u&&(l*=Math.max(this._renderer.scale.x,this._renderer.scale.y)),t.current!==h&&(e.useProgram(h),t.resolution.flagged||e.uniform2f(e.getUniformLocation(h,"u_resolution"),t.resolution.width,t.resolution.height),t.current=h),t.resolution.flagged&&e.uniform2f(e.getUniformLocation(h,"u_resolution"),t.resolution.width,t.resolution.height),e.bindTexture(e.TEXTURE_2D,this._renderer.texture),e.uniformMatrix3fv(h.matrix,!1,this._renderer.matrix),e.uniform1f(h.size,l*t.resolution.ratio),e.drawArrays(e.POINTS,0,P),this.flagReset())}},text:{updateCanvas:function(e,t){const r=this.canvas,l=this.ctx,o=e.renderer.ratio,h=ss.copy(t._renderer.scale).multiply(o),u=t._stroke,c=t._linewidth,p=t._fill,_=t._renderer.opacity||t._opacity,x=t.dashes,w=t._decoration,b=t._direction;r.width=Math.max(Math.ceil(t._renderer.rect.width*h.x),1),r.height=Math.max(Math.ceil(t._renderer.rect.height*h.y),1);const P=t._renderer.rect.centroid,C=P.x,S=P.y;let L,A,I,X,M,k,U,D,Z,V,q;const J=p._renderer&&p._renderer.offset&&u._renderer&&u._renderer.offset;if(l.clearRect(0,0,r.width,r.height),J||(l.font=[t._style,t._weight,t._size+"px/"+t._leading+"px",t._family].join(" ")),l.textAlign="center",l.textBaseline="middle",l.textDirection=b,p&&(typeof p=="string"?l.fillStyle=p:(G[p._renderer.type].render.call(p,l,t),l.fillStyle=p._renderer.effect)),u&&(typeof u=="string"?l.strokeStyle=u:(G[u._renderer.type].render.call(u,l,t),l.strokeStyle=u._renderer.effect),c&&(l.lineWidth=c)),typeof _=="number"&&(l.globalAlpha=_),x&&x.length>0&&(l.lineDashOffset=x.offset||0,l.setLineDash(x)),l.save(),l.scale(h.x,h.y),l.translate(C,S),G.isHidden.test(p)||(p._renderer&&p._renderer.offset?(k=p._renderer.scale.x,U=p._renderer.scale.y,l.save(),l.translate(-p._renderer.offset.x,-p._renderer.offset.y),l.scale(k,U),L=t._size/p._renderer.scale.y,A=t._leading/p._renderer.scale.y,l.font=[t._style,t._weight,L+"px/",A+"px",t._family].join(" "),I=p._renderer.offset.x/p._renderer.scale.x,X=p._renderer.offset.y/p._renderer.scale.y,l.fillText(t.value,I,X),l.restore()):l.fillText(t.value,0,0)),G.isHidden.test(u)||(u._renderer&&u._renderer.offset?(k=u._renderer.scale.x,U=u._renderer.scale.y,l.save(),l.translate(-u._renderer.offset.x,-u._renderer.offset.y),l.scale(k,U),L=t._size/u._renderer.scale.y,A=t._leading/u._renderer.scale.y,l.font=[t._style,t._weight,L+"px/",A+"px",t._family].join(" "),I=u._renderer.offset.x/u._renderer.scale.x,X=u._renderer.offset.y/u._renderer.scale.y,M=c/u._renderer.scale.x,l.lineWidth=M,l.strokeText(t.value,I,X),l.restore()):l.strokeText(t.value,0,0)),/(underline|strikethrough)/i.test(w)){const j=l.measureText(t.value);switch(w){case"underline":Z=j.actualBoundingBoxDescent,q=j.actualBoundingBoxDescent;break;case"strikethrough":Z=0,q=0;break}D=-j.width/2,V=j.width/2,l.lineWidth=Math.max(Math.floor(t._size/15),1),l.strokeStyle=l.fillStyle,l.beginPath(),l.moveTo(D,Z),l.lineTo(V,q),l.stroke()}l.restore()},getBoundingClientRect:function(e,t){const r=G.ctx;r.font=[e._style,e._weight,e._size+"px/"+e._leading+"px",e._family].join(" "),r.textAlign="center",r.textBaseline=_e.Utils.baselines[e._baseline]||e._baseline;const l=r.measureText(e._value);let o=l.width,h=1.15*(l.actualBoundingBoxAscent+l.actualBoundingBoxDescent);this._linewidth&&!G.isHidden.test(this._stroke)&&(o+=this._linewidth*2,h+=this._linewidth*2);const u=o/2,c=h/2;switch(G.alignments[e._alignment]||e._alignment){case G.alignments.left:e.direction==="ltr"?(t.left=0,t.right=o):(t.left=-o,t.right=0);break;case G.alignments.right:e.direction==="ltr"?(t.left=-o,t.right=0):(t.left=0,t.right=o);break;default:t.left=-u,t.right=u}switch(e._baseline){case"bottom":t.top=-h,t.bottom=0;break;case"top":t.top=0,t.bottom=h;break;case"baseline":t.top=-c*1.5,t.bottom=c*.5;break;default:t.top=-c,t.bottom=c}t.width=o,t.height=h,t.centroid||(t.centroid={}),t.centroid.x=u,t.centroid.y=c},render:function(e,t,r){if(!this._visible||!this._opacity)return this;this._update();const l=r||this.parent,o=t[this._renderer.type],h=l._matrix.manual||l._flagMatrix,u=this._matrix.manual||this._flagMatrix,c=this._renderer.parent!==l,p=this._flagVertices||this._flagFill||this._fill instanceof ht&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagEndPoints)||this._fill instanceof ft&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagRadius||this._fill._flagCenter||this._fill._flagFocal)||this._fill instanceof st&&(this._fill._flagLoaded&&this._fill.loaded||this._fill._flagImage||this._fill._flagVideo||this._fill._flagRepeat||this._fill._flagOffset||this._fill._flagScale)||this._stroke instanceof ht&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagEndPoints)||this._stroke instanceof ft&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagRadius||this._stroke._flagCenter||this._stroke._flagFocal)||this._stroke instanceof st&&(this._stroke._flagLoaded&&this._stroke.loaded||this._stroke._flagImage||this._stroke._flagVideo||this._stroke._flagRepeat||this._stroke._flagOffset||this._fill._flagScale)||this._flagStroke||this._flagLinewidth||this._flagOpacity||l._flagOpacity||this._flagVisible||this._flagScale||this._flagValue||this._flagFamily||this._flagSize||this._flagLeading||this._flagAlignment||this._flagBaseline||this._flagStyle||this._flagWeight||this._flagDecoration||this.dashes&&this.dashes.length>0||!this._renderer.texture;if((h||u||c)&&(this._renderer.matrix||(this._renderer.matrix=new Ht(9)),this._matrix.toTransformArray(!0,Gt),Ee(Gt,l._renderer.matrix,this._renderer.matrix),this._renderer.scale instanceof R||(this._renderer.scale=new R),this._scale instanceof R?(this._renderer.scale.x=this._scale.x*l._renderer.scale.x,this._renderer.scale.y=this._scale.y*l._renderer.scale.y):(this._renderer.scale.x=this._scale*l._renderer.scale.x,this._renderer.scale.y=this._scale*l._renderer.scale.y),c&&(this._renderer.parent=l)),this._mask&&(e.clear(e.STENCIL_BUFFER_BIT),e.enable(e.STENCIL_TEST),e.stencilFunc(e.ALWAYS,1,0),e.stencilOp(e.KEEP,e.KEEP,e.REPLACE),e.colorMask(!1,!1,!1,!1),G[this._mask._renderer.type].render.call(this._mask,e,t,this),e.stencilFunc(e.EQUAL,1,255),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.colorMask(!0,!0,!0,!0)),p?(this._renderer.rect||(this._renderer.rect={}),this._renderer.opacity=this._opacity*l._renderer.opacity,G.text.getBoundingClientRect(this,this._renderer.rect),G.updateTexture.call(G,e,this)):(this._fill&&this._fill._update&&this._fill._update(),this._stroke&&this._stroke._update&&this._stroke._update()),this._clip&&!r||!this._renderer.texture)return this;t.current!==o&&(e.useProgram(o),e.bindBuffer(e.ARRAY_BUFFER,t.buffers.position),e.vertexAttribPointer(o.position,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(o.position),e.bufferData(e.ARRAY_BUFFER,fi,e.STATIC_DRAW),t.resolution.flagged||e.uniform2f(e.getUniformLocation(o,"u_resolution"),t.resolution.width,t.resolution.height),t.current=o),t.resolution.flagged&&e.uniform2f(e.getUniformLocation(o,"u_resolution"),t.resolution.width,t.resolution.height),e.bindTexture(e.TEXTURE_2D,this._renderer.texture);const _=this._renderer.rect;return e.uniformMatrix3fv(o.matrix,!1,this._renderer.matrix),e.uniform4f(o.rect,_.left,_.top,_.right,_.bottom),e.drawArrays(e.TRIANGLES,0,6),this._mask&&e.disable(e.STENCIL_TEST),this.flagReset()}},"linear-gradient":{render:function(e,t){if(!(!e.canvas.getContext("2d")||!t)){if(this._update(),!this._renderer.effect||this._flagEndPoints||this._flagStops||this._flagUnits){let r,l=this.left._x,o=this.left._y,h=this.right._x,u=this.right._y;/objectBoundingBox/i.test(this._units)&&(r=t.getBoundingClientRect(!0),l=(l-.5)*r.width,o=(o-.5)*r.height,h=(h-.5)*r.width,u=(u-.5)*r.height),this._renderer.effect=e.createLinearGradient(l,o,h,u);for(let c=0;c<this.stops.length;c++){const p=this.stops[c];this._renderer.effect.addColorStop(p._offset,p._color)}}return this.flagReset()}}},"radial-gradient":{render:function(e,t){if(!(!e.canvas.getContext("2d")||!t)){if(this._update(),!this._renderer.effect||this._flagCenter||this._flagFocal||this._flagRadius||this._flagStops||this._flagUnits){let r,l=this.center._x,o=this.center._y,h=this.focal._x,u=this.focal._y,c=this._radius;/objectBoundingBox/i.test(this._units)&&(r=t.getBoundingClientRect(!0),l=(l-.5)*r.width*.5,o=(o-.5)*r.height*.5,h=(h-.5)*r.width*.5,u=(u-.5)*r.height*.5,c*=Math.min(r.width,r.height)),this._renderer.effect=e.createRadialGradient(l,o,0,h,u,c);for(let p=0;p<this.stops.length;p++){const _=this.stops[p];this._renderer.effect.addColorStop(_._offset,_._color)}}return this.flagReset()}}},texture:{render:function(e,t){if(!e.canvas.getContext("2d"))return;this._update();const r=this.image;if((this._flagLoaded||this._flagImage||this._flagVideo||this._flagRepeat)&&this.loaded)this._renderer.effect=e.createPattern(r,this._repeat);else if(!this._renderer.effect)return this.flagReset();return(this._flagOffset||this._flagLoaded||this._flagScale)&&(this._renderer.offset instanceof R||(this._renderer.offset=new R),this._renderer.offset.x=-this._offset.x,this._renderer.offset.y=-this._offset.y,r&&(this._renderer.offset.x+=r.width/2,this._renderer.offset.y+=r.height/2,this._scale instanceof R?(this._renderer.offset.x*=this._scale.x,this._renderer.offset.y*=this._scale.y):(this._renderer.offset.x*=this._scale,this._renderer.offset.y*=this._scale))),(this._flagScale||this._flagLoaded)&&(this._renderer.scale instanceof R||(this._renderer.scale=new R),this._scale instanceof R?this._renderer.scale.copy(this._scale):this._renderer.scale.set(this._scale,this._scale)),this.flagReset()}},updateTexture:function(e,t){if(this[t._renderer.type].updateCanvas.call(G,e,t),this.canvas.width<=0||this.canvas.height<=0){t._renderer.texture&&e.deleteTexture(t._renderer.texture),delete t._renderer.texture;return}t._renderer.texture||(t._renderer.texture=e.createTexture()),e.bindTexture(e.TEXTURE_2D,t._renderer.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this.canvas),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR)},program:{create:function(e,t){let r,l,o;if(r=e.createProgram(),W.each(t,function(h){e.attachShader(r,h)}),e.linkProgram(r),l=e.getProgramParameter(r,e.LINK_STATUS),!l)throw o=e.getProgramInfoLog(r),e.deleteProgram(r),new kt("unable to link program: "+o);return r}},extensions:{init:function(e){const t={},r=["EXT_texture_filter_anisotropic","WEBGL_compressed_texture_s3tc","OES_texture_float_linear","WEBGL_multisampled_render_to_texture"];for(let l=0;l<r.length;l++){const o=r[l];t[o]=G.extensions.get(e,o)}return t},get:function(e,t){return e.getExtension(t)||e.getExtension(`MOZ_${t}`)||e.getExtension(`WEBKIT_${t}`)}},TextureRegistry:new qe};G.ctx=G.canvas.getContext("2d");var Ms=class extends O{constructor(e){super();let t,r,l,o;if(this.domElement=e.domElement||document.createElement("canvas"),typeof e.offscreenElement<"u"&&(G.canvas=e.offscreenElement,G.ctx=G.canvas.getContext("2d")),this.scene=new _t,this.scene.parent=this,this._renderer={type:"renderer",matrix:new Ht($n),scale:1,opacity:1},this._flagMatrix=!0,e=W.defaults(e||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,preserveDrawingBuffer:!0,overdraw:!1}),this.overdraw=e.overdraw,t=this.ctx=this.domElement.getContext("webgl",e)||this.domElement.getContext("experimental-webgl",e),!this.ctx)throw new kt("unable to create a webgl context. Try using another renderer.");l=Ft.create(t,Ft.path.vertex,Ft.types.vertex),o=Ft.create(t,Ft.path.fragment,Ft.types.fragment),this.programs={current:null,buffers:{position:t.createBuffer()},resolution:{width:0,height:0,ratio:1,flagged:!1}},r=this.programs.path=G.program.create(t,[l,o]),this.programs.text=this.programs.path,t.extensions=G.extensions.init(t),t.renderer=this,r.position=t.getAttribLocation(r,"a_position"),r.matrix=t.getUniformLocation(r,"u_matrix"),r.rect=t.getUniformLocation(r,"u_rect");const h=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,h),t.vertexAttribPointer(r.position,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(r.position),t.bufferData(t.ARRAY_BUFFER,fi,t.STATIC_DRAW),l=Ft.create(t,Ft.points.vertex,Ft.types.vertex),o=Ft.create(t,Ft.points.fragment,Ft.types.fragment),r=this.programs.points=G.program.create(t,[l,o]),r.position=t.getAttribLocation(r,"a_position"),r.matrix=t.getUniformLocation(r,"u_matrix"),r.size=t.getUniformLocation(r,"u_size"),t.enable(t.BLEND),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA)}setSize(e,t,r){let l,o;const h=this.ctx;return this.width=e,this.height=t,this.ratio=typeof r>"u"?ci(h):r,this.domElement.width=e*this.ratio,this.domElement.height=t*this.ratio,W.isObject(this.domElement.style)&&W.extend(this.domElement.style,{width:e+"px",height:t+"px"}),this._renderer.matrix[0]=this._renderer.matrix[4]=this._renderer.scale=this.ratio,this._flagMatrix=!0,l=e*this.ratio,o=t*this.ratio,h.viewport(0,0,l,o),this.programs.resolution.width=l,this.programs.resolution.height=o,this.programs.resolution.ratio=this.ratio,this.programs.resolution.flagged=!0,this.trigger(O.Types.resize,e,t,r)}render(){const e=this.ctx;return this.overdraw||e.clear(e.COLOR_BUFFER_BIT),G.group.render.call(this.scene,e,this.programs),this._flagMatrix=!1,this.programs.resolution.flagged=!0,this}};g(Ms,"Utils",G);var tl=W.extend({Error:kt,getRatio:ci,read:at,xhr:ks},W,Ot,ps,hs),ve=class{constructor(e){g(this,"_events",new O),g(this,"type",""),g(this,"renderer",null),g(this,"scene",null),g(this,"width",0),g(this,"height",0),g(this,"frameCount",0),g(this,"timeDelta",0),g(this,"playing",!1);const t=W.defaults(e||{},{fullscreen:!1,fitted:!1,width:640,height:480,type:ve.Types.svg,autostart:!1});if(W.each(t,function(r,l){/fullscreen/i.test(l)||/autostart/i.test(l)||(this[l]=r)},this),W.isElement(t.domElement)){const r=t.domElement.tagName.toLowerCase();/^(CanvasRenderer-canvas|WebGLRenderer-canvas|SVGRenderer-svg)$/.test(this.type+"-"+r)||(this.type=ve.Types[r])}this.renderer=new ve[this.type](this),this.setPlaying(t.autostart),this.frameCount=0,t.fullscreen?(this.fit=el.bind(this),this.fit.domElement=window,this.fit.attached=!0,W.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),W.extend(this.renderer.domElement.style,{display:"block",top:0,left:0,right:0,bottom:0,position:"fixed"}),Et.bind(this.fit.domElement,"resize",this.fit),this.fit()):t.fitted?(this.fit=il.bind(this),W.extend(this.renderer.domElement.style,{display:"block"})):W.isElement(t.domElement)||(this.renderer.setSize(t.width,t.height,this.ratio),this.width=t.width,this.height=t.height),this.renderer.bind(O.Types.resize,sl.bind(this)),this.scene=this.renderer.scene,ve.Instances.push(this),t.autostart&&be.init()}get _bound(){return this._events._bound}set _bound(e){this._events._bound=e}addEventListener(){return this._events.addEventListener.apply(this,arguments)}on(){return this._events.addEventListener.apply(this,arguments)}bind(){return this._events.addEventListener.apply(this,arguments)}removeEventListener(){return this._events.removeEventListener.apply(this,arguments)}off(){return this._events.removeEventListener.apply(this,arguments)}unbind(){return this._events.removeEventListener.apply(this,arguments)}dispatchEvent(){return this._events.dispatchEvent.apply(this,arguments)}trigger(){return this._events.dispatchEvent.apply(this,arguments)}listen(){return this._events.listen.apply(this,arguments)}ignore(){return this._events.ignore.apply(this,arguments)}appendTo(e){return e.appendChild(this.renderer.domElement),this.fit&&(this.fit.domElement!==window&&(this.fit.domElement=e,this.fit.attached=!1),this.update()),this}play(){return this.playing=!0,be.init(),this.trigger(O.Types.play)}pause(){return this.playing=!1,this.trigger(O.Types.pause)}setPlaying(e){this.playing=e}release(e){let t,r,l;if(!W.isObject(e))return this.release(this.scene);if(typeof e.unbind=="function"&&e.unbind(),e.vertices)for(typeof e.vertices.unbind=="function"&&e.vertices.unbind(),t=0;t<e.vertices.length;t++)r=e.vertices[t],typeof r.unbind=="function"&&r.unbind(),r.controls&&(r.controls.left&&typeof r.controls.left.unbind=="function"&&r.controls.left.unbind(),r.controls.right&&typeof r.controls.right.unbind=="function"&&r.controls.right.unbind());if(e.children){for(t=0;t<e.children.length;t++)l=e.children[t],this.release(l);typeof e.children.unbind=="function"&&e.children.unbind()}return e}update(){const e=!!this._lastFrame,t=W.performance.now();e&&(this.timeDelta=parseFloat((t-this._lastFrame).toFixed(3))),this._lastFrame=t,this.fit&&this.fit.domElement&&!this.fit.attached&&(Et.bind(this.fit.domElement,"resize",this.fit),this.fit.attached=!0,this.fit());const r=this.width,l=this.height,o=this.renderer;return(r!==o.width||l!==o.height)&&o.setSize(r,l,this.ratio),this.trigger(O.Types.update,this.frameCount,this.timeDelta),this.render()}render(){return this.renderer.render(),this.trigger(O.Types.render,this.frameCount++)}add(e){return e instanceof Array||(e=Array.prototype.slice.call(arguments)),this.scene.add(e),this}remove(e){return e instanceof Array||(e=Array.prototype.slice.call(arguments)),this.scene.remove(e),this}clear(){return this.scene.remove(this.scene.children),this}makeLine(e,t,r,l){const o=new di(e,t,r,l);return this.scene.add(o),o}makeArrow(e,t,r,l,o){const h=typeof o=="number"?o:10,u=Math.atan2(l-t,r-e),c=[new K(e,t,void 0,void 0,void 0,void 0,F.move),new K(r,l,void 0,void 0,void 0,void 0,F.line),new K(r-h*Math.cos(u-Math.PI/4),l-h*Math.sin(u-Math.PI/4),void 0,void 0,void 0,void 0,F.line),new K(r,l,void 0,void 0,void 0,void 0,F.move),new K(r-h*Math.cos(u+Math.PI/4),l-h*Math.sin(u+Math.PI/4),void 0,void 0,void 0,void 0,F.line)],p=new it(c,!1,!1,!0);return p.noFill(),p.cap="round",p.join="round",this.scene.add(p),p}makeRectangle(e,t,r,l){const o=new re(e,t,r,l);return this.scene.add(o),o}makeRoundedRectangle(e,t,r,l,o){const h=new Ge(e,t,r,l,o);return this.scene.add(h),h}makeCircle(e,t,r,l){const o=new He(e,t,r,l);return this.scene.add(o),o}makeEllipse(e,t,r,l,o){const h=new ze(e,t,r,l,o);return this.scene.add(h),h}makeStar(e,t,r,l,o){const h=new gi(e,t,r,l,o);return this.scene.add(h),h}makeCurve(e){const t=arguments.length;if(!Array.isArray(e)){e=[];for(let h=0;h<t;h+=2){const u=arguments[h];if(typeof u!="number")break;const c=arguments[h+1];e.push(new K(u,c))}}const r=arguments[t-1],l=new it(e,!(typeof r=="boolean"&&r),!0),o=l.getBoundingClientRect();return l.center().translation.set(o.left+o.width/2,o.top+o.height/2),this.scene.add(l),l}makePolygon(e,t,r,l){const o=new mi(e,t,r,l);return this.scene.add(o),o}makeArcSegment(e,t,r,l,o,h,u){const c=new pi(e,t,r,l,o,h,u);return this.scene.add(c),c}makePoints(e){const t=arguments.length;let r=e;if(!Array.isArray(e)){r=[];for(let o=0;o<t;o+=2){const h=arguments[o];if(typeof h!="number")break;const u=arguments[o+1];r.push(new R(h,u))}}const l=new _i(r);return this.scene.add(l),l}makePath(e){const t=arguments.length;let r=e;if(!Array.isArray(e)){r=[];for(let u=0;u<t;u+=2){const c=arguments[u];if(typeof c!="number")break;const p=arguments[u+1];r.push(new K(c,p))}}const l=arguments[t-1],o=new it(r,!(typeof l=="boolean"&&l)),h=o.getBoundingClientRect();return typeof h.top=="number"&&typeof h.left=="number"&&typeof h.right=="number"&&typeof h.bottom=="number"&&o.center().translation.set(h.left+h.width/2,h.top+h.height/2),this.scene.add(o),o}makeText(e,t,r,l){const o=new Yt(e,t,r,l);return this.add(o),o}makeLinearGradient(e,t,r,l){const o=Array.prototype.slice.call(arguments,4),h=new ht(e,t,r,l,o);return this.add(h),h}makeRadialGradient(e,t,r){const l=Array.prototype.slice.call(arguments,3),o=new ft(e,t,r,l);return this.add(o),o}makeSprite(e,t,r,l,o,h,u){const c=new Ve(e,t,r,l,o,h);return u&&c.play(),this.add(c),c}makeImageSequence(e,t,r,l,o){const h=new Ze(e,t,r,l);return o&&h.play(),this.add(h),h}makeTexture(e,t){return new st(e,t)}makeGroup(e){e instanceof Array||(e=Array.prototype.slice.call(arguments));const t=new _t;return this.scene.add(t),t.add(e),t}interpret(e,t,r){const l=e.tagName.toLowerCase();if(r=typeof r<"u"?r:!0,!(l in at))return null;const o=at[l].call(this,e);return r?this.add(t&&o instanceof _t?o.children:o):o.parent&&o.remove(),o}load(e,t){const r=new _t;let l,o,h;const u=(function(c){for(Et.temp.innerHTML=c,o=0;o<Et.temp.children.length;o++)l=Et.temp.children[o],h=this.interpret(l,!1,!1),h!==null&&r.add(h);if(typeof t=="function"){const p=Et.temp.children.length<=1?Et.temp.children[0]:Et.temp.children;t(r,p)}}).bind(this);return/\.svg$/i.test(e)?(ks(e,u),r):(u(e),r)}},Y=ve;g(Y,"nextFrameID",yt.nextFrameID);g(Y,"Types",yt.Types);g(Y,"Version",yt.Version);g(Y,"PublishDate",yt.PublishDate);g(Y,"Identifier",yt.Identifier);g(Y,"Resolution",yt.Resolution);g(Y,"AutoCalculateImportedMatrices",yt.AutoCalculateImportedMatrices);g(Y,"Instances",yt.Instances);g(Y,"uniqueId",yt.uniqueId);g(Y,"Anchor",K);g(Y,"Collection",Jt);g(Y,"Events",O);g(Y,"Group",_t);g(Y,"Matrix",se);g(Y,"Path",it);g(Y,"Registry",qe);g(Y,"Shape",jt);g(Y,"Text",Yt);g(Y,"Vector",R);g(Y,"Gradient",mt);g(Y,"ImageSequence",Ze);g(Y,"LinearGradient",ht);g(Y,"RadialGradient",ft);g(Y,"Sprite",Ve);g(Y,"Stop",Kt);g(Y,"Texture",st);g(Y,"ArcSegment",pi);g(Y,"Circle",He);g(Y,"Ellipse",ze);g(Y,"Line",di);g(Y,"Points",_i);g(Y,"Polygon",mi);g(Y,"Rectangle",re);g(Y,"RoundedRectangle",Ge);g(Y,"Star",gi);g(Y,"CanvasRenderer",_e);g(Y,"SVGRenderer",Ns);g(Y,"WebGLRenderer",Ms);g(Y,"Commands",F);g(Y,"Utils",tl);function el(){const e=document.body.getBoundingClientRect(),t=this.width=e.width,r=this.height=e.height;this.renderer.setSize(t,r,this.ratio)}function il(){const e=this.renderer.domElement.parentElement;if(!e){console.warn("Two.js: Attempting to fit to parent, but no parent found.");return}const t=e.getBoundingClientRect(),r=this.width=t.width,l=this.height=t.height;this.renderer.setSize(r,l,this.ratio)}function sl(e,t){this.width=e,this.height=t,this.trigger(O.Types.resize,e,t)}var be=Et.getRequestAnimationFrame();function Xs(){for(let e=0;e<Y.Instances.length;e++){const t=Y.Instances[e];t.playing&&t.update()}Y.nextFrameID=be(Xs)}be.init=function(){Xs(),be.init=function(){}};function rl(){return Math.random().toString(36).substr(2,9)}function nl(e,t,r,l,o){const h=[],u=2*Math.PI/o;for(let c=0;c<o;c++){const p=c*u,_=e+r*Math.cos(p),x=t+l*Math.sin(p);h.push({x:_,y:x})}return h}function ll(e,t){if(e.length<2)throw new Error("At least two points are required to create a stroked polygon.");const r=t/2,l=[],o=[];function h(u,c,p){const _=c.x-u.x,x=c.y-u.y,w=Math.sqrt(_*_+x*x);if(w===0)return{left:{x:u.x,y:u.y},right:{x:u.x,y:u.y}};const b=-x/w,P=_/w;return{left:{x:u.x+b*p,y:u.y+P*p},right:{x:u.x-b*p,y:u.y-P*p}}}for(let u=0;u<e.length-1;u++){const c=e[u],p=e[u+1],{left:_,right:x}=h(c,p,r);if(l.push(_),o.push(x),u>0){const w=l[l.length-2],b=o[o.length-2],P={x:(w.x+_.x)/2,y:(w.y+_.y)/2},C={x:(b.x+x.x)/2,y:(b.y+x.y)/2};l[l.length-2]=P,o[o.length-2]=C}if(u===e.length-2){const{left:w,right:b}=h(p,c,r);l.push(w),o.push(b)}}return[...l,...o.reverse()]}function ol(e,t,r){const l=r/2,o=t.x-e.x,h=t.y-e.y,u=Math.hypot(o,h);if(u===0)return[];const c=-h/u,p=o/u,_=c*l,x=p*l,w={x:e.x+_,y:e.y+x},b={x:e.x-_,y:e.y-x},P={x:t.x+_,y:t.y+x},C={x:t.x-_,y:t.y-x};return[w,P,C,b]}function al(e,t){let r=!1;const{x:l,y:o}=e;for(let h=0,u=t.length-1;h<t.length;u=h++){const c=t[h].x,p=t[h].y,_=t[u].x,x=t[u].y;p>o!=x>o&&l<(_-c)*(o-p)/(x-p)+c&&(r=!r)}return r}var wl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function hl(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var si={exports:{}},rs;function fl(){return rs||(rs=1,function(e){(function(){var t={};t.version="6.4.2.2",t.use_lines=!0,t.use_xyz=!1;var r=!1;e.exports?(e.exports=t,r=!0):typeof document<"u"?window.ClipperLib=t:self.ClipperLib=t;var l;if(r){var o="chrome";l="Netscape"}else{var o=navigator.userAgent.toString().toLowerCase();l=navigator.appName}var h={};o.indexOf("chrome")!=-1&&o.indexOf("chromium")==-1?h.chrome=1:h.chrome=0,o.indexOf("chromium")!=-1?h.chromium=1:h.chromium=0,o.indexOf("safari")!=-1&&o.indexOf("chrome")==-1&&o.indexOf("chromium")==-1?h.safari=1:h.safari=0,o.indexOf("firefox")!=-1?h.firefox=1:h.firefox=0,o.indexOf("firefox/17")!=-1?h.firefox17=1:h.firefox17=0,o.indexOf("firefox/15")!=-1?h.firefox15=1:h.firefox15=0,o.indexOf("firefox/3")!=-1?h.firefox3=1:h.firefox3=0,o.indexOf("opera")!=-1?h.opera=1:h.opera=0,o.indexOf("msie 10")!=-1?h.msie10=1:h.msie10=0,o.indexOf("msie 9")!=-1?h.msie9=1:h.msie9=0,o.indexOf("msie 8")!=-1?h.msie8=1:h.msie8=0,o.indexOf("msie 7")!=-1?h.msie7=1:h.msie7=0,o.indexOf("msie ")!=-1?h.msie=1:h.msie=0,t.biginteger_used=null;var u;function c(i,s,n){t.biginteger_used=1,i!=null&&(typeof i=="number"&&typeof s>"u"?this.fromInt(i):typeof i=="number"?this.fromNumber(i,s,n):s==null&&typeof i!="string"?this.fromString(i,256):this.fromString(i,s))}function p(){return new c(null,void 0,void 0)}function _(i,s,n,a,f,d){for(;--d>=0;){var m=s*this[i++]+n[a]+f;f=Math.floor(m/67108864),n[a++]=m&67108863}return f}function x(i,s,n,a,f,d){for(var m=s&32767,y=s>>15;--d>=0;){var v=this[i]&32767,T=this[i++]>>15,N=y*v+T*m;v=m*v+((N&32767)<<15)+n[a]+(f&1073741823),f=(v>>>30)+(N>>>15)+y*T+(f>>>30),n[a++]=v&1073741823}return f}function w(i,s,n,a,f,d){for(var m=s&16383,y=s>>14;--d>=0;){var v=this[i]&16383,T=this[i++]>>14,N=y*v+T*m;v=m*v+((N&16383)<<14)+n[a]+f,f=(v>>28)+(N>>14)+y*T,n[a++]=v&268435455}return f}l=="Microsoft Internet Explorer"?(c.prototype.am=x,u=30):l!="Netscape"?(c.prototype.am=_,u=26):(c.prototype.am=w,u=28),c.prototype.DB=u,c.prototype.DM=(1<<u)-1,c.prototype.DV=1<<u;var b=52;c.prototype.FV=Math.pow(2,b),c.prototype.F1=b-u,c.prototype.F2=2*u-b;var P="0123456789abcdefghijklmnopqrstuvwxyz",C=new Array,S,L;for(S=48,L=0;L<=9;++L)C[S++]=L;for(S=97,L=10;L<36;++L)C[S++]=L;for(S=65,L=10;L<36;++L)C[S++]=L;function A(i){return P.charAt(i)}function I(i,s){var n=C[i.charCodeAt(s)];return n??-1}function X(i){for(var s=this.t-1;s>=0;--s)i[s]=this[s];i.t=this.t,i.s=this.s}function M(i){this.t=1,this.s=i<0?-1:0,i>0?this[0]=i:i<-1?this[0]=i+this.DV:this.t=0}function k(i){var s=p();return s.fromInt(i),s}function U(i,s){var n;if(s==16)n=4;else if(s==8)n=3;else if(s==256)n=8;else if(s==2)n=1;else if(s==32)n=5;else if(s==4)n=2;else{this.fromRadix(i,s);return}this.t=0,this.s=0;for(var a=i.length,f=!1,d=0;--a>=0;){var m=n==8?i[a]&255:I(i,a);if(m<0){i.charAt(a)=="-"&&(f=!0);continue}f=!1,d==0?this[this.t++]=m:d+n>this.DB?(this[this.t-1]|=(m&(1<<this.DB-d)-1)<<d,this[this.t++]=m>>this.DB-d):this[this.t-1]|=m<<d,d+=n,d>=this.DB&&(d-=this.DB)}n==8&&i[0]&128&&(this.s=-1,d>0&&(this[this.t-1]|=(1<<this.DB-d)-1<<d)),this.clamp(),f&&c.ZERO.subTo(this,this)}function D(){for(var i=this.s&this.DM;this.t>0&&this[this.t-1]==i;)--this.t}function Z(i){if(this.s<0)return"-"+this.negate().toString(i);var s;if(i==16)s=4;else if(i==8)s=3;else if(i==2)s=1;else if(i==32)s=5;else if(i==4)s=2;else return this.toRadix(i);var n=(1<<s)-1,a,f=!1,d="",m=this.t,y=this.DB-m*this.DB%s;if(m-- >0)for(y<this.DB&&(a=this[m]>>y)>0&&(f=!0,d=A(a));m>=0;)y<s?(a=(this[m]&(1<<y)-1)<<s-y,a|=this[--m]>>(y+=this.DB-s)):(a=this[m]>>(y-=s)&n,y<=0&&(y+=this.DB,--m)),a>0&&(f=!0),f&&(d+=A(a));return f?d:"0"}function V(){var i=p();return c.ZERO.subTo(this,i),i}function q(){return this.s<0?this.negate():this}function J(i){var s=this.s-i.s;if(s!=0)return s;var n=this.t;if(s=n-i.t,s!=0)return this.s<0?-s:s;for(;--n>=0;)if((s=this[n]-i[n])!=0)return s;return 0}function j(i){var s=1,n;return(n=i>>>16)!=0&&(i=n,s+=16),(n=i>>8)!=0&&(i=n,s+=8),(n=i>>4)!=0&&(i=n,s+=4),(n=i>>2)!=0&&(i=n,s+=2),(n=i>>1)!=0&&(i=n,s+=1),s}function rt(){return this.t<=0?0:this.DB*(this.t-1)+j(this[this.t-1]^this.s&this.DM)}function $(i,s){var n;for(n=this.t-1;n>=0;--n)s[n+i]=this[n];for(n=i-1;n>=0;--n)s[n]=0;s.t=this.t+i,s.s=this.s}function ct(i,s){for(var n=i;n<this.t;++n)s[n-i]=this[n];s.t=Math.max(this.t-i,0),s.s=this.s}function ot(i,s){var n=i%this.DB,a=this.DB-n,f=(1<<a)-1,d=Math.floor(i/this.DB),m=this.s<<n&this.DM,y;for(y=this.t-1;y>=0;--y)s[y+d+1]=this[y]>>a|m,m=(this[y]&f)<<n;for(y=d-1;y>=0;--y)s[y]=0;s[d]=m,s.t=this.t+d+1,s.s=this.s,s.clamp()}function Mt(i,s){s.s=this.s;var n=Math.floor(i/this.DB);if(n>=this.t){s.t=0;return}var a=i%this.DB,f=this.DB-a,d=(1<<a)-1;s[0]=this[n]>>a;for(var m=n+1;m<this.t;++m)s[m-n-1]|=(this[m]&d)<<f,s[m-n]=this[m]>>a;a>0&&(s[this.t-n-1]|=(this.s&d)<<f),s.t=this.t-n,s.clamp()}function xt(i,s){for(var n=0,a=0,f=Math.min(i.t,this.t);n<f;)a+=this[n]-i[n],s[n++]=a&this.DM,a>>=this.DB;if(i.t<this.t){for(a-=i.s;n<this.t;)a+=this[n],s[n++]=a&this.DM,a>>=this.DB;a+=this.s}else{for(a+=this.s;n<i.t;)a-=i[n],s[n++]=a&this.DM,a>>=this.DB;a-=i.s}s.s=a<0?-1:0,a<-1?s[n++]=this.DV+a:a>0&&(s[n++]=a),s.t=n,s.clamp()}function bt(i,s){var n=this.abs(),a=i.abs(),f=n.t;for(s.t=f+a.t;--f>=0;)s[f]=0;for(f=0;f<a.t;++f)s[f+n.t]=n.am(0,a[f],s,f,0,n.t);s.s=0,s.clamp(),this.s!=i.s&&c.ZERO.subTo(s,s)}function Bt(i){for(var s=this.abs(),n=i.t=2*s.t;--n>=0;)i[n]=0;for(n=0;n<s.t-1;++n){var a=s.am(n,s[n],i,2*n,0,1);(i[n+s.t]+=s.am(n+1,2*s[n],i,2*n+1,a,s.t-n-1))>=s.DV&&(i[n+s.t]-=s.DV,i[n+s.t+1]=1)}i.t>0&&(i[i.t-1]+=s.am(n,s[n],i,2*n,0,1)),i.s=0,i.clamp()}function Wt(i,s,n){var a=i.abs();if(!(a.t<=0)){var f=this.abs();if(f.t<a.t){s!=null&&s.fromInt(0),n!=null&&this.copyTo(n);return}n==null&&(n=p());var d=p(),m=this.s,y=i.s,v=this.DB-j(a[a.t-1]);v>0?(a.lShiftTo(v,d),f.lShiftTo(v,n)):(a.copyTo(d),f.copyTo(n));var T=d.t,N=d[T-1];if(N!=0){var E=N*(1<<this.F1)+(T>1?d[T-2]>>this.F2:0),B=this.FV/E,H=(1<<this.F1)/E,tt=1<<this.F2,et=n.t,lt=et-T,Ct=s??p();for(d.dlShiftTo(lt,Ct),n.compareTo(Ct)>=0&&(n[n.t++]=1,n.subTo(Ct,n)),c.ONE.dlShiftTo(T,Ct),Ct.subTo(d,d);d.t<T;)d[d.t++]=0;for(;--lt>=0;){var Ut=n[--et]==N?this.DM:Math.floor(n[et]*B+(n[et-1]+tt)*H);if((n[et]+=d.am(0,Ut,n,lt,0,T))<Ut)for(d.dlShiftTo(lt,Ct),n.subTo(Ct,n);n[et]<--Ut;)n.subTo(Ct,n)}s!=null&&(n.drShiftTo(T,s),m!=y&&c.ZERO.subTo(s,s)),n.t=T,n.clamp(),v>0&&n.rShiftTo(v,n),m<0&&c.ZERO.subTo(n,n)}}}function $t(i){var s=p();return this.abs().divRemTo(i,null,s),this.s<0&&s.compareTo(c.ZERO)>0&&i.subTo(s,s),s}function Tt(i){this.m=i}function Qt(i){return i.s<0||i.compareTo(this.m)>=0?i.mod(this.m):i}function te(i){return i}function ee(i){i.divRemTo(this.m,null,i)}function At(i,s,n){i.multiplyTo(s,n),this.reduce(n)}function nt(i,s){i.squareTo(s),this.reduce(s)}Tt.prototype.convert=Qt,Tt.prototype.revert=te,Tt.prototype.reduce=ee,Tt.prototype.mulTo=At,Tt.prototype.sqrTo=nt;function Ys(){if(this.t<1)return 0;var i=this[0];if(!(i&1))return 0;var s=i&3;return s=s*(2-(i&15)*s)&15,s=s*(2-(i&255)*s)&255,s=s*(2-((i&65535)*s&65535))&65535,s=s*(2-i*s%this.DV)%this.DV,s>0?this.DV-s:-s}function ie(i){this.m=i,this.mp=i.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<i.DB-15)-1,this.mt2=2*i.t}function Ds(i){var s=p();return i.abs().dlShiftTo(this.m.t,s),s.divRemTo(this.m,null,s),i.s<0&&s.compareTo(c.ZERO)>0&&this.m.subTo(s,s),s}function Ws(i){var s=p();return i.copyTo(s),this.reduce(s),s}function Us(i){for(;i.t<=this.mt2;)i[i.t++]=0;for(var s=0;s<this.m.t;++s){var n=i[s]&32767,a=n*this.mpl+((n*this.mph+(i[s]>>15)*this.mpl&this.um)<<15)&i.DM;for(n=s+this.m.t,i[n]+=this.m.am(0,a,i,s,0,this.m.t);i[n]>=i.DV;)i[n]-=i.DV,i[++n]++}i.clamp(),i.drShiftTo(this.m.t,i),i.compareTo(this.m)>=0&&i.subTo(this.m,i)}function qs(i,s){i.squareTo(s),this.reduce(s)}function Vs(i,s,n){i.multiplyTo(s,n),this.reduce(n)}ie.prototype.convert=Ds,ie.prototype.revert=Ws,ie.prototype.reduce=Us,ie.prototype.mulTo=Vs,ie.prototype.sqrTo=qs;function Hs(){return(this.t>0?this[0]&1:this.s)==0}function zs(i,s){if(i>4294967295||i<1)return c.ONE;var n=p(),a=p(),f=s.convert(this),d=j(i)-1;for(f.copyTo(n);--d>=0;)if(s.sqrTo(n,a),(i&1<<d)>0)s.mulTo(a,f,n);else{var m=n;n=a,a=m}return s.revert(n)}function Gs(i,s){var n;return i<256||s.isEven()?n=new Tt(s):n=new ie(s),this.exp(i,n)}c.prototype.copyTo=X,c.prototype.fromInt=M,c.prototype.fromString=U,c.prototype.clamp=D,c.prototype.dlShiftTo=$,c.prototype.drShiftTo=ct,c.prototype.lShiftTo=ot,c.prototype.rShiftTo=Mt,c.prototype.subTo=xt,c.prototype.multiplyTo=bt,c.prototype.squareTo=Bt,c.prototype.divRemTo=Wt,c.prototype.invDigit=Ys,c.prototype.isEven=Hs,c.prototype.exp=zs,c.prototype.toString=Z,c.prototype.negate=V,c.prototype.abs=q,c.prototype.compareTo=J,c.prototype.bitLength=rt,c.prototype.mod=$t,c.prototype.modPowInt=Gs,c.ZERO=k(0),c.ONE=k(1);function Zs(){var i=p();return this.copyTo(i),i}function js(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function Js(){return this.t==0?this.s:this[0]<<24>>24}function Ks(){return this.t==0?this.s:this[0]<<16>>16}function $s(i){return Math.floor(Math.LN2*this.DB/Math.log(i))}function Qs(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function tr(i){if(i==null&&(i=10),this.signum()==0||i<2||i>36)return"0";var s=this.chunkSize(i),n=Math.pow(i,s),a=k(n),f=p(),d=p(),m="";for(this.divRemTo(a,f,d);f.signum()>0;)m=(n+d.intValue()).toString(i).substr(1)+m,f.divRemTo(a,f,d);return d.intValue().toString(i)+m}function er(i,s){this.fromInt(0),s==null&&(s=10);for(var n=this.chunkSize(s),a=Math.pow(s,n),f=!1,d=0,m=0,y=0;y<i.length;++y){var v=I(i,y);if(v<0){i.charAt(y)=="-"&&this.signum()==0&&(f=!0);continue}m=s*m+v,++d>=n&&(this.dMultiply(a),this.dAddOffset(m,0),d=0,m=0)}d>0&&(this.dMultiply(Math.pow(s,d)),this.dAddOffset(m,0)),f&&c.ZERO.subTo(this,this)}function ir(i,s,n){if(typeof s=="number")if(i<2)this.fromInt(1);else for(this.fromNumber(i,n),this.testBit(i-1)||this.bitwiseTo(c.ONE.shiftLeft(i-1),je,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(s);)this.dAddOffset(2,0),this.bitLength()>i&&this.subTo(c.ONE.shiftLeft(i-1),this);else{var a=new Array,f=i&7;a.length=(i>>3)+1,s.nextBytes(a),f>0?a[0]&=(1<<f)-1:a[0]=0,this.fromString(a,256)}}function sr(){var i=this.t,s=new Array;s[0]=this.s;var n=this.DB-i*this.DB%8,a,f=0;if(i-- >0)for(n<this.DB&&(a=this[i]>>n)!=(this.s&this.DM)>>n&&(s[f++]=a|this.s<<this.DB-n);i>=0;)n<8?(a=(this[i]&(1<<n)-1)<<8-n,a|=this[--i]>>(n+=this.DB-8)):(a=this[i]>>(n-=8)&255,n<=0&&(n+=this.DB,--i)),a&128&&(a|=-256),f==0&&(this.s&128)!=(a&128)&&++f,(f>0||a!=this.s)&&(s[f++]=a);return s}function rr(i){return this.compareTo(i)==0}function nr(i){return this.compareTo(i)<0?this:i}function lr(i){return this.compareTo(i)>0?this:i}function or(i,s,n){var a,f,d=Math.min(i.t,this.t);for(a=0;a<d;++a)n[a]=s(this[a],i[a]);if(i.t<this.t){for(f=i.s&this.DM,a=d;a<this.t;++a)n[a]=s(this[a],f);n.t=this.t}else{for(f=this.s&this.DM,a=d;a<i.t;++a)n[a]=s(f,i[a]);n.t=i.t}n.s=s(this.s,i.s),n.clamp()}function ar(i,s){return i&s}function hr(i){var s=p();return this.bitwiseTo(i,ar,s),s}function je(i,s){return i|s}function fr(i){var s=p();return this.bitwiseTo(i,je,s),s}function vi(i,s){return i^s}function ur(i){var s=p();return this.bitwiseTo(i,vi,s),s}function xi(i,s){return i&~s}function cr(i){var s=p();return this.bitwiseTo(i,xi,s),s}function dr(){for(var i=p(),s=0;s<this.t;++s)i[s]=this.DM&~this[s];return i.t=this.t,i.s=~this.s,i}function pr(i){var s=p();return i<0?this.rShiftTo(-i,s):this.lShiftTo(i,s),s}function _r(i){var s=p();return i<0?this.lShiftTo(-i,s):this.rShiftTo(i,s),s}function mr(i){if(i==0)return-1;var s=0;return i&65535||(i>>=16,s+=16),i&255||(i>>=8,s+=8),i&15||(i>>=4,s+=4),i&3||(i>>=2,s+=2),i&1||++s,s}function gr(){for(var i=0;i<this.t;++i)if(this[i]!=0)return i*this.DB+mr(this[i]);return this.s<0?this.t*this.DB:-1}function yr(i){for(var s=0;i!=0;)i&=i-1,++s;return s}function vr(){for(var i=0,s=this.s&this.DM,n=0;n<this.t;++n)i+=yr(this[n]^s);return i}function xr(i){var s=Math.floor(i/this.DB);return s>=this.t?this.s!=0:(this[s]&1<<i%this.DB)!=0}function Pr(i,s){var n=c.ONE.shiftLeft(i);return this.bitwiseTo(n,s,n),n}function br(i){return this.changeBit(i,je)}function wr(i){return this.changeBit(i,xi)}function Cr(i){return this.changeBit(i,vi)}function Ir(i,s){for(var n=0,a=0,f=Math.min(i.t,this.t);n<f;)a+=this[n]+i[n],s[n++]=a&this.DM,a>>=this.DB;if(i.t<this.t){for(a+=i.s;n<this.t;)a+=this[n],s[n++]=a&this.DM,a>>=this.DB;a+=this.s}else{for(a+=this.s;n<i.t;)a+=i[n],s[n++]=a&this.DM,a>>=this.DB;a+=i.s}s.s=a<0?-1:0,a>0?s[n++]=a:a<-1&&(s[n++]=this.DV+a),s.t=n,s.clamp()}function Tr(i){var s=p();return this.addTo(i,s),s}function Ar(i){var s=p();return this.subTo(i,s),s}function Sr(i){var s=p();return this.multiplyTo(i,s),s}function Lr(){var i=p();return this.squareTo(i),i}function Er(i){var s=p();return this.divRemTo(i,s,null),s}function Or(i){var s=p();return this.divRemTo(i,null,s),s}function kr(i){var s=p(),n=p();return this.divRemTo(i,s,n),new Array(s,n)}function Nr(i){this[this.t]=this.am(0,i-1,this,0,0,this.t),++this.t,this.clamp()}function Mr(i,s){if(i!=0){for(;this.t<=s;)this[this.t++]=0;for(this[s]+=i;this[s]>=this.DV;)this[s]-=this.DV,++s>=this.t&&(this[this.t++]=0),++this[s]}}function me(){}function Pi(i){return i}function Xr(i,s,n){i.multiplyTo(s,n)}function Fr(i,s){i.squareTo(s)}me.prototype.convert=Pi,me.prototype.revert=Pi,me.prototype.mulTo=Xr,me.prototype.sqrTo=Fr;function Rr(i){return this.exp(i,new me)}function Br(i,s,n){var a=Math.min(this.t+i.t,s);for(n.s=0,n.t=a;a>0;)n[--a]=0;var f;for(f=n.t-this.t;a<f;++a)n[a+this.t]=this.am(0,i[a],n,a,0,this.t);for(f=Math.min(i.t,s);a<f;++a)this.am(0,i[a],n,a,0,s-a);n.clamp()}function Yr(i,s,n){--s;var a=n.t=this.t+i.t-s;for(n.s=0;--a>=0;)n[a]=0;for(a=Math.max(s-this.t,0);a<i.t;++a)n[this.t+a-s]=this.am(s-a,i[a],n,0,0,this.t+a-s);n.clamp(),n.drShiftTo(1,n)}function ne(i){this.r2=p(),this.q3=p(),c.ONE.dlShiftTo(2*i.t,this.r2),this.mu=this.r2.divide(i),this.m=i}function Dr(i){if(i.s<0||i.t>2*this.m.t)return i.mod(this.m);if(i.compareTo(this.m)<0)return i;var s=p();return i.copyTo(s),this.reduce(s),s}function Wr(i){return i}function Ur(i){for(i.drShiftTo(this.m.t-1,this.r2),i.t>this.m.t+1&&(i.t=this.m.t+1,i.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);i.compareTo(this.r2)<0;)i.dAddOffset(1,this.m.t+1);for(i.subTo(this.r2,i);i.compareTo(this.m)>=0;)i.subTo(this.m,i)}function qr(i,s){i.squareTo(s),this.reduce(s)}function Vr(i,s,n){i.multiplyTo(s,n),this.reduce(n)}ne.prototype.convert=Dr,ne.prototype.revert=Wr,ne.prototype.reduce=Ur,ne.prototype.mulTo=Vr,ne.prototype.sqrTo=qr;function Hr(i,s){var n=i.bitLength(),a,f=k(1),d;if(n<=0)return f;n<18?a=1:n<48?a=3:n<144?a=4:n<768?a=5:a=6,n<8?d=new Tt(s):s.isEven()?d=new ne(s):d=new ie(s);var m=new Array,y=3,v=a-1,T=(1<<a)-1;if(m[1]=d.convert(this),a>1){var N=p();for(d.sqrTo(m[1],N);y<=T;)m[y]=p(),d.mulTo(N,m[y-2],m[y]),y+=2}var E=i.t-1,B,H=!0,tt=p(),et;for(n=j(i[E])-1;E>=0;){for(n>=v?B=i[E]>>n-v&T:(B=(i[E]&(1<<n+1)-1)<<v-n,E>0&&(B|=i[E-1]>>this.DB+n-v)),y=a;!(B&1);)B>>=1,--y;if((n-=y)<0&&(n+=this.DB,--E),H)m[B].copyTo(f),H=!1;else{for(;y>1;)d.sqrTo(f,tt),d.sqrTo(tt,f),y-=2;y>0?d.sqrTo(f,tt):(et=f,f=tt,tt=et),d.mulTo(tt,m[B],f)}for(;E>=0&&!(i[E]&1<<n);)d.sqrTo(f,tt),et=f,f=tt,tt=et,--n<0&&(n=this.DB-1,--E)}return d.revert(f)}function zr(i){var s=this.s<0?this.negate():this.clone(),n=i.s<0?i.negate():i.clone();if(s.compareTo(n)<0){var a=s;s=n,n=a}var f=s.getLowestSetBit(),d=n.getLowestSetBit();if(d<0)return s;for(f<d&&(d=f),d>0&&(s.rShiftTo(d,s),n.rShiftTo(d,n));s.signum()>0;)(f=s.getLowestSetBit())>0&&s.rShiftTo(f,s),(f=n.getLowestSetBit())>0&&n.rShiftTo(f,n),s.compareTo(n)>=0?(s.subTo(n,s),s.rShiftTo(1,s)):(n.subTo(s,n),n.rShiftTo(1,n));return d>0&&n.lShiftTo(d,n),n}function Gr(i){if(i<=0)return 0;var s=this.DV%i,n=this.s<0?i-1:0;if(this.t>0)if(s==0)n=this[0]%i;else for(var a=this.t-1;a>=0;--a)n=(s*n+this[a])%i;return n}function Zr(i){var s=i.isEven();if(this.isEven()&&s||i.signum()==0)return c.ZERO;for(var n=i.clone(),a=this.clone(),f=k(1),d=k(0),m=k(0),y=k(1);n.signum()!=0;){for(;n.isEven();)n.rShiftTo(1,n),s?((!f.isEven()||!d.isEven())&&(f.addTo(this,f),d.subTo(i,d)),f.rShiftTo(1,f)):d.isEven()||d.subTo(i,d),d.rShiftTo(1,d);for(;a.isEven();)a.rShiftTo(1,a),s?((!m.isEven()||!y.isEven())&&(m.addTo(this,m),y.subTo(i,y)),m.rShiftTo(1,m)):y.isEven()||y.subTo(i,y),y.rShiftTo(1,y);n.compareTo(a)>=0?(n.subTo(a,n),s&&f.subTo(m,f),d.subTo(y,d)):(a.subTo(n,a),s&&m.subTo(f,m),y.subTo(d,y))}if(a.compareTo(c.ONE)!=0)return c.ZERO;if(y.compareTo(i)>=0)return y.subtract(i);if(y.signum()<0)y.addTo(i,y);else return y;return y.signum()<0?y.add(i):y}var wt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],jr=(1<<26)/wt[wt.length-1];function Jr(i){var s,n=this.abs();if(n.t==1&&n[0]<=wt[wt.length-1]){for(s=0;s<wt.length;++s)if(n[0]==wt[s])return!0;return!1}if(n.isEven())return!1;for(s=1;s<wt.length;){for(var a=wt[s],f=s+1;f<wt.length&&a<jr;)a*=wt[f++];for(a=n.modInt(a);s<f;)if(a%wt[s++]==0)return!1}return n.millerRabin(i)}function Kr(i){var s=this.subtract(c.ONE),n=s.getLowestSetBit();if(n<=0)return!1;var a=s.shiftRight(n);i=i+1>>1,i>wt.length&&(i=wt.length);for(var f=p(),d=0;d<i;++d){f.fromInt(wt[Math.floor(Math.random()*wt.length)]);var m=f.modPow(a,this);if(m.compareTo(c.ONE)!=0&&m.compareTo(s)!=0){for(var y=1;y++<n&&m.compareTo(s)!=0;)if(m=m.modPowInt(2,this),m.compareTo(c.ONE)==0)return!1;if(m.compareTo(s)!=0)return!1}}return!0}c.prototype.chunkSize=$s,c.prototype.toRadix=tr,c.prototype.fromRadix=er,c.prototype.fromNumber=ir,c.prototype.bitwiseTo=or,c.prototype.changeBit=Pr,c.prototype.addTo=Ir,c.prototype.dMultiply=Nr,c.prototype.dAddOffset=Mr,c.prototype.multiplyLowerTo=Br,c.prototype.multiplyUpperTo=Yr,c.prototype.modInt=Gr,c.prototype.millerRabin=Kr,c.prototype.clone=Zs,c.prototype.intValue=js,c.prototype.byteValue=Js,c.prototype.shortValue=Ks,c.prototype.signum=Qs,c.prototype.toByteArray=sr,c.prototype.equals=rr,c.prototype.min=nr,c.prototype.max=lr,c.prototype.and=hr,c.prototype.or=fr,c.prototype.xor=ur,c.prototype.andNot=cr,c.prototype.not=dr,c.prototype.shiftLeft=pr,c.prototype.shiftRight=_r,c.prototype.getLowestSetBit=gr,c.prototype.bitCount=vr,c.prototype.testBit=xr,c.prototype.setBit=br,c.prototype.clearBit=wr,c.prototype.flipBit=Cr,c.prototype.add=Tr,c.prototype.subtract=Ar,c.prototype.multiply=Sr,c.prototype.divide=Er,c.prototype.remainder=Or,c.prototype.divideAndRemainder=kr,c.prototype.modPow=Hr,c.prototype.modInverse=Zr,c.prototype.pow=Rr,c.prototype.gcd=zr,c.prototype.isProbablePrime=Jr,c.prototype.square=Lr;var Q=c;Q.prototype.IsNegative=function(){return this.compareTo(Q.ZERO)==-1},Q.op_Equality=function(i,s){return i.compareTo(s)==0},Q.op_Inequality=function(i,s){return i.compareTo(s)!=0},Q.op_GreaterThan=function(i,s){return i.compareTo(s)>0},Q.op_LessThan=function(i,s){return i.compareTo(s)<0},Q.op_Addition=function(i,s){return new Q(i,void 0,void 0).add(new Q(s,void 0,void 0))},Q.op_Subtraction=function(i,s){return new Q(i,void 0,void 0).subtract(new Q(s,void 0,void 0))},Q.Int128Mul=function(i,s){return new Q(i,void 0,void 0).multiply(new Q(s,void 0,void 0))},Q.op_Division=function(i,s){return i.divide(s)},Q.prototype.ToDouble=function(){return parseFloat(this.toString())};var bi=function(i,s){var n;if(typeof Object.getOwnPropertyNames>"u"){for(n in s.prototype)(typeof i.prototype[n]>"u"||i.prototype[n]===Object.prototype[n])&&(i.prototype[n]=s.prototype[n]);for(n in s)typeof i[n]>"u"&&(i[n]=s[n]);i.$baseCtor=s}else{for(var a=Object.getOwnPropertyNames(s.prototype),f=0;f<a.length;f++)typeof Object.getOwnPropertyDescriptor(i.prototype,a[f])>"u"&&Object.defineProperty(i.prototype,a[f],Object.getOwnPropertyDescriptor(s.prototype,a[f]));for(n in s)typeof i[n]>"u"&&(i[n]=s[n]);i.$baseCtor=s}};t.Path=function(){return[]},t.Path.prototype.push=Array.prototype.push,t.Paths=function(){return[]},t.Paths.prototype.push=Array.prototype.push,t.DoublePoint=function(){var i=arguments;this.X=0,this.Y=0,i.length===1?(this.X=i[0].X,this.Y=i[0].Y):i.length===2&&(this.X=i[0],this.Y=i[1])},t.DoublePoint0=function(){this.X=0,this.Y=0},t.DoublePoint0.prototype=t.DoublePoint.prototype,t.DoublePoint1=function(i){this.X=i.X,this.Y=i.Y},t.DoublePoint1.prototype=t.DoublePoint.prototype,t.DoublePoint2=function(i,s){this.X=i,this.Y=s},t.DoublePoint2.prototype=t.DoublePoint.prototype,t.PolyNode=function(){this.m_Parent=null,this.m_polygon=new t.Path,this.m_Index=0,this.m_jointype=0,this.m_endtype=0,this.m_Childs=[],this.IsOpen=!1},t.PolyNode.prototype.IsHoleNode=function(){for(var i=!0,s=this.m_Parent;s!==null;)i=!i,s=s.m_Parent;return i},t.PolyNode.prototype.ChildCount=function(){return this.m_Childs.length},t.PolyNode.prototype.Contour=function(){return this.m_polygon},t.PolyNode.prototype.AddChild=function(i){var s=this.m_Childs.length;this.m_Childs.push(i),i.m_Parent=this,i.m_Index=s},t.PolyNode.prototype.GetNext=function(){return this.m_Childs.length>0?this.m_Childs[0]:this.GetNextSiblingUp()},t.PolyNode.prototype.GetNextSiblingUp=function(){return this.m_Parent===null?null:this.m_Index===this.m_Parent.m_Childs.length-1?this.m_Parent.GetNextSiblingUp():this.m_Parent.m_Childs[this.m_Index+1]},t.PolyNode.prototype.Childs=function(){return this.m_Childs},t.PolyNode.prototype.Parent=function(){return this.m_Parent},t.PolyNode.prototype.IsHole=function(){return this.IsHoleNode()},t.PolyTree=function(){this.m_AllPolys=[],t.PolyNode.call(this)},t.PolyTree.prototype.Clear=function(){for(var i=0,s=this.m_AllPolys.length;i<s;i++)this.m_AllPolys[i]=null;this.m_AllPolys.length=0,this.m_Childs.length=0},t.PolyTree.prototype.GetFirst=function(){return this.m_Childs.length>0?this.m_Childs[0]:null},t.PolyTree.prototype.Total=function(){var i=this.m_AllPolys.length;return i>0&&this.m_Childs[0]!==this.m_AllPolys[0]&&i--,i},bi(t.PolyTree,t.PolyNode),t.Math_Abs_Int64=t.Math_Abs_Int32=t.Math_Abs_Double=function(i){return Math.abs(i)},t.Math_Max_Int32_Int32=function(i,s){return Math.max(i,s)},h.msie||h.opera||h.safari?t.Cast_Int32=function(i){return i|0}:t.Cast_Int32=function(i){return~~i},typeof Number.toInteger>"u"&&(Number.toInteger=null),h.chrome?t.Cast_Int64=function(i){return i<-2147483648||i>2147483647?i<0?Math.ceil(i):Math.floor(i):~~i}:h.firefox&&typeof Number.toInteger=="function"?t.Cast_Int64=function(i){return Number.toInteger(i)}:h.msie7||h.msie8?t.Cast_Int64=function(i){return parseInt(i,10)}:h.msie?t.Cast_Int64=function(i){return i<-2147483648||i>2147483647?i<0?Math.ceil(i):Math.floor(i):i|0}:t.Cast_Int64=function(i){return i<0?Math.ceil(i):Math.floor(i)},t.Clear=function(i){i.length=0},t.PI=3.141592653589793,t.PI2=2*3.141592653589793,t.IntPoint=function(){var i=arguments,s=i.length;if(this.X=0,this.Y=0,t.use_xyz)if(this.Z=0,s===3)this.X=i[0],this.Y=i[1],this.Z=i[2];else if(s===2)this.X=i[0],this.Y=i[1],this.Z=0;else if(s===1)if(i[0]instanceof t.DoublePoint){var n=i[0];this.X=t.Clipper.Round(n.X),this.Y=t.Clipper.Round(n.Y),this.Z=0}else{var a=i[0];typeof a.Z>"u"&&(a.Z=0),this.X=a.X,this.Y=a.Y,this.Z=a.Z}else this.X=0,this.Y=0,this.Z=0;else if(s===2)this.X=i[0],this.Y=i[1];else if(s===1)if(i[0]instanceof t.DoublePoint){var n=i[0];this.X=t.Clipper.Round(n.X),this.Y=t.Clipper.Round(n.Y)}else{var a=i[0];this.X=a.X,this.Y=a.Y}else this.X=0,this.Y=0},t.IntPoint.op_Equality=function(i,s){return i.X===s.X&&i.Y===s.Y},t.IntPoint.op_Inequality=function(i,s){return i.X!==s.X||i.Y!==s.Y},t.IntPoint0=function(){this.X=0,this.Y=0,t.use_xyz&&(this.Z=0)},t.IntPoint0.prototype=t.IntPoint.prototype,t.IntPoint1=function(i){this.X=i.X,this.Y=i.Y,t.use_xyz&&(typeof i.Z>"u"?this.Z=0:this.Z=i.Z)},t.IntPoint1.prototype=t.IntPoint.prototype,t.IntPoint1dp=function(i){this.X=t.Clipper.Round(i.X),this.Y=t.Clipper.Round(i.Y),t.use_xyz&&(this.Z=0)},t.IntPoint1dp.prototype=t.IntPoint.prototype,t.IntPoint2=function(i,s,n){this.X=i,this.Y=s,t.use_xyz&&(typeof n>"u"?this.Z=0:this.Z=n)},t.IntPoint2.prototype=t.IntPoint.prototype,t.IntRect=function(){var i=arguments,s=i.length;if(s===4)this.left=i[0],this.top=i[1],this.right=i[2],this.bottom=i[3];else if(s===1){var n=i[0];this.left=n.left,this.top=n.top,this.right=n.right,this.bottom=n.bottom}else this.left=0,this.top=0,this.right=0,this.bottom=0},t.IntRect0=function(){this.left=0,this.top=0,this.right=0,this.bottom=0},t.IntRect0.prototype=t.IntRect.prototype,t.IntRect1=function(i){this.left=i.left,this.top=i.top,this.right=i.right,this.bottom=i.bottom},t.IntRect1.prototype=t.IntRect.prototype,t.IntRect4=function(i,s,n,a){this.left=i,this.top=s,this.right=n,this.bottom=a},t.IntRect4.prototype=t.IntRect.prototype,t.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,ctXor:3},t.PolyType={ptSubject:0,ptClip:1},t.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3},t.JoinType={jtSquare:0,jtRound:1,jtMiter:2},t.EndType={etOpenSquare:0,etOpenRound:1,etOpenButt:2,etClosedLine:3,etClosedPolygon:4},t.EdgeSide={esLeft:0,esRight:1},t.Direction={dRightToLeft:0,dLeftToRight:1},t.TEdge=function(){this.Bot=new t.IntPoint0,this.Curr=new t.IntPoint0,this.Top=new t.IntPoint0,this.Delta=new t.IntPoint0,this.Dx=0,this.PolyTyp=t.PolyType.ptSubject,this.Side=t.EdgeSide.esLeft,this.WindDelta=0,this.WindCnt=0,this.WindCnt2=0,this.OutIdx=0,this.Next=null,this.Prev=null,this.NextInLML=null,this.NextInAEL=null,this.PrevInAEL=null,this.NextInSEL=null,this.PrevInSEL=null},t.IntersectNode=function(){this.Edge1=null,this.Edge2=null,this.Pt=new t.IntPoint0},t.MyIntersectNodeSort=function(){},t.MyIntersectNodeSort.Compare=function(i,s){var n=s.Pt.Y-i.Pt.Y;return n>0?1:n<0?-1:0},t.LocalMinima=function(){this.Y=0,this.LeftBound=null,this.RightBound=null,this.Next=null},t.Scanbeam=function(){this.Y=0,this.Next=null},t.Maxima=function(){this.X=0,this.Next=null,this.Prev=null},t.OutRec=function(){this.Idx=0,this.IsHole=!1,this.IsOpen=!1,this.FirstLeft=null,this.Pts=null,this.BottomPt=null,this.PolyNode=null},t.OutPt=function(){this.Idx=0,this.Pt=new t.IntPoint0,this.Next=null,this.Prev=null},t.Join=function(){this.OutPt1=null,this.OutPt2=null,this.OffPt=new t.IntPoint0},t.ClipperBase=function(){this.m_MinimaList=null,this.m_CurrentLM=null,this.m_edges=new Array,this.m_UseFullRange=!1,this.m_HasOpenPaths=!1,this.PreserveCollinear=!1,this.m_Scanbeam=null,this.m_PolyOuts=null,this.m_ActiveEdges=null},t.ClipperBase.horizontal=-9007199254740992,t.ClipperBase.Skip=-2,t.ClipperBase.Unassigned=-1,t.ClipperBase.tolerance=1e-20,t.ClipperBase.loRange=47453132,t.ClipperBase.hiRange=0xfffffffffffff,t.ClipperBase.near_zero=function(i){return i>-t.ClipperBase.tolerance&&i<t.ClipperBase.tolerance},t.ClipperBase.IsHorizontal=function(i){return i.Delta.Y===0},t.ClipperBase.prototype.PointIsVertex=function(i,s){var n=s;do{if(t.IntPoint.op_Equality(n.Pt,i))return!0;n=n.Next}while(n!==s);return!1},t.ClipperBase.prototype.PointOnLineSegment=function(i,s,n,a){return a?i.X===s.X&&i.Y===s.Y||i.X===n.X&&i.Y===n.Y||i.X>s.X==i.X<n.X&&i.Y>s.Y==i.Y<n.Y&&Q.op_Equality(Q.Int128Mul(i.X-s.X,n.Y-s.Y),Q.Int128Mul(n.X-s.X,i.Y-s.Y)):i.X===s.X&&i.Y===s.Y||i.X===n.X&&i.Y===n.Y||i.X>s.X==i.X<n.X&&i.Y>s.Y==i.Y<n.Y&&(i.X-s.X)*(n.Y-s.Y)===(n.X-s.X)*(i.Y-s.Y)},t.ClipperBase.prototype.PointOnPolygon=function(i,s,n){for(var a=s;;){if(this.PointOnLineSegment(i,a.Pt,a.Next.Pt,n))return!0;if(a=a.Next,a===s)break}return!1},t.ClipperBase.prototype.SlopesEqual=t.ClipperBase.SlopesEqual=function(){var i=arguments,s=i.length,n,a,f,d,m,y,v;return s===3?(n=i[0],a=i[1],v=i[2],v?Q.op_Equality(Q.Int128Mul(n.Delta.Y,a.Delta.X),Q.Int128Mul(n.Delta.X,a.Delta.Y)):t.Cast_Int64(n.Delta.Y*a.Delta.X)===t.Cast_Int64(n.Delta.X*a.Delta.Y)):s===4?(f=i[0],d=i[1],m=i[2],v=i[3],v?Q.op_Equality(Q.Int128Mul(f.Y-d.Y,d.X-m.X),Q.Int128Mul(f.X-d.X,d.Y-m.Y)):t.Cast_Int64((f.Y-d.Y)*(d.X-m.X))-t.Cast_Int64((f.X-d.X)*(d.Y-m.Y))===0):(f=i[0],d=i[1],m=i[2],y=i[3],v=i[4],v?Q.op_Equality(Q.Int128Mul(f.Y-d.Y,m.X-y.X),Q.Int128Mul(f.X-d.X,m.Y-y.Y)):t.Cast_Int64((f.Y-d.Y)*(m.X-y.X))-t.Cast_Int64((f.X-d.X)*(m.Y-y.Y))===0)},t.ClipperBase.SlopesEqual3=function(i,s,n){return n?Q.op_Equality(Q.Int128Mul(i.Delta.Y,s.Delta.X),Q.Int128Mul(i.Delta.X,s.Delta.Y)):t.Cast_Int64(i.Delta.Y*s.Delta.X)===t.Cast_Int64(i.Delta.X*s.Delta.Y)},t.ClipperBase.SlopesEqual4=function(i,s,n,a){return a?Q.op_Equality(Q.Int128Mul(i.Y-s.Y,s.X-n.X),Q.Int128Mul(i.X-s.X,s.Y-n.Y)):t.Cast_Int64((i.Y-s.Y)*(s.X-n.X))-t.Cast_Int64((i.X-s.X)*(s.Y-n.Y))===0},t.ClipperBase.SlopesEqual5=function(i,s,n,a,f){return f?Q.op_Equality(Q.Int128Mul(i.Y-s.Y,n.X-a.X),Q.Int128Mul(i.X-s.X,n.Y-a.Y)):t.Cast_Int64((i.Y-s.Y)*(n.X-a.X))-t.Cast_Int64((i.X-s.X)*(n.Y-a.Y))===0},t.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var i=0,s=this.m_edges.length;i<s;++i){for(var n=0,a=this.m_edges[i].length;n<a;++n)this.m_edges[i][n]=null;t.Clear(this.m_edges[i])}t.Clear(this.m_edges),this.m_UseFullRange=!1,this.m_HasOpenPaths=!1},t.ClipperBase.prototype.DisposeLocalMinimaList=function(){for(;this.m_MinimaList!==null;){var i=this.m_MinimaList.Next;this.m_MinimaList=null,this.m_MinimaList=i}this.m_CurrentLM=null},t.ClipperBase.prototype.RangeTest=function(i,s){s.Value?(i.X>t.ClipperBase.hiRange||i.Y>t.ClipperBase.hiRange||-i.X>t.ClipperBase.hiRange||-i.Y>t.ClipperBase.hiRange)&&t.Error("Coordinate outside allowed range in RangeTest()."):(i.X>t.ClipperBase.loRange||i.Y>t.ClipperBase.loRange||-i.X>t.ClipperBase.loRange||-i.Y>t.ClipperBase.loRange)&&(s.Value=!0,this.RangeTest(i,s))},t.ClipperBase.prototype.InitEdge=function(i,s,n,a){i.Next=s,i.Prev=n,i.Curr.X=a.X,i.Curr.Y=a.Y,t.use_xyz&&(i.Curr.Z=a.Z),i.OutIdx=-1},t.ClipperBase.prototype.InitEdge2=function(i,s){i.Curr.Y>=i.Next.Curr.Y?(i.Bot.X=i.Curr.X,i.Bot.Y=i.Curr.Y,t.use_xyz&&(i.Bot.Z=i.Curr.Z),i.Top.X=i.Next.Curr.X,i.Top.Y=i.Next.Curr.Y,t.use_xyz&&(i.Top.Z=i.Next.Curr.Z)):(i.Top.X=i.Curr.X,i.Top.Y=i.Curr.Y,t.use_xyz&&(i.Top.Z=i.Curr.Z),i.Bot.X=i.Next.Curr.X,i.Bot.Y=i.Next.Curr.Y,t.use_xyz&&(i.Bot.Z=i.Next.Curr.Z)),this.SetDx(i),i.PolyTyp=s},t.ClipperBase.prototype.FindNextLocMin=function(i){for(var s;;){for(;t.IntPoint.op_Inequality(i.Bot,i.Prev.Bot)||t.IntPoint.op_Equality(i.Curr,i.Top);)i=i.Next;if(i.Dx!==t.ClipperBase.horizontal&&i.Prev.Dx!==t.ClipperBase.horizontal)break;for(;i.Prev.Dx===t.ClipperBase.horizontal;)i=i.Prev;for(s=i;i.Dx===t.ClipperBase.horizontal;)i=i.Next;if(i.Top.Y!==i.Prev.Bot.Y){s.Prev.Bot.X<i.Bot.X&&(i=s);break}}return i},t.ClipperBase.prototype.ProcessBound=function(i,s){var n,a=i,f;if(a.OutIdx===t.ClipperBase.Skip){if(i=a,s){for(;i.Top.Y===i.Next.Bot.Y;)i=i.Next;for(;i!==a&&i.Dx===t.ClipperBase.horizontal;)i=i.Prev}else{for(;i.Top.Y===i.Prev.Bot.Y;)i=i.Prev;for(;i!==a&&i.Dx===t.ClipperBase.horizontal;)i=i.Next}if(i===a)s?a=i.Next:a=i.Prev;else{s?i=a.Next:i=a.Prev;var d=new t.LocalMinima;d.Next=null,d.Y=i.Bot.Y,d.LeftBound=null,d.RightBound=i,i.WindDelta=0,a=this.ProcessBound(i,s),this.InsertLocalMinima(d)}return a}if(i.Dx===t.ClipperBase.horizontal&&(s?n=i.Prev:n=i.Next,n.Dx===t.ClipperBase.horizontal?n.Bot.X!==i.Bot.X&&n.Top.X!==i.Bot.X&&this.ReverseHorizontal(i):n.Bot.X!==i.Bot.X&&this.ReverseHorizontal(i)),n=i,s){for(;a.Top.Y===a.Next.Bot.Y&&a.Next.OutIdx!==t.ClipperBase.Skip;)a=a.Next;if(a.Dx===t.ClipperBase.horizontal&&a.Next.OutIdx!==t.ClipperBase.Skip){for(f=a;f.Prev.Dx===t.ClipperBase.horizontal;)f=f.Prev;f.Prev.Top.X>a.Next.Top.X&&(a=f.Prev)}for(;i!==a;)i.NextInLML=i.Next,i.Dx===t.ClipperBase.horizontal&&i!==n&&i.Bot.X!==i.Prev.Top.X&&this.ReverseHorizontal(i),i=i.Next;i.Dx===t.ClipperBase.horizontal&&i!==n&&i.Bot.X!==i.Prev.Top.X&&this.ReverseHorizontal(i),a=a.Next}else{for(;a.Top.Y===a.Prev.Bot.Y&&a.Prev.OutIdx!==t.ClipperBase.Skip;)a=a.Prev;if(a.Dx===t.ClipperBase.horizontal&&a.Prev.OutIdx!==t.ClipperBase.Skip){for(f=a;f.Next.Dx===t.ClipperBase.horizontal;)f=f.Next;(f.Next.Top.X===a.Prev.Top.X||f.Next.Top.X>a.Prev.Top.X)&&(a=f.Next)}for(;i!==a;)i.NextInLML=i.Prev,i.Dx===t.ClipperBase.horizontal&&i!==n&&i.Bot.X!==i.Next.Top.X&&this.ReverseHorizontal(i),i=i.Prev;i.Dx===t.ClipperBase.horizontal&&i!==n&&i.Bot.X!==i.Next.Top.X&&this.ReverseHorizontal(i),a=a.Prev}return a},t.ClipperBase.prototype.AddPath=function(i,s,n){t.use_lines?!n&&s===t.PolyType.ptClip&&t.Error("AddPath: Open paths must be subject."):n||t.Error("AddPath: Open paths have been disabled.");var a=i.length-1;if(n)for(;a>0&&t.IntPoint.op_Equality(i[a],i[0]);)--a;for(;a>0&&t.IntPoint.op_Equality(i[a],i[a-1]);)--a;if(n&&a<2||!n&&a<1)return!1;for(var f=new Array,d=0;d<=a;d++)f.push(new t.TEdge);var m=!0;f[1].Curr.X=i[1].X,f[1].Curr.Y=i[1].Y,t.use_xyz&&(f[1].Curr.Z=i[1].Z);var y={Value:this.m_UseFullRange};this.RangeTest(i[0],y),this.m_UseFullRange=y.Value,y.Value=this.m_UseFullRange,this.RangeTest(i[a],y),this.m_UseFullRange=y.Value,this.InitEdge(f[0],f[1],f[a],i[0]),this.InitEdge(f[a],f[0],f[a-1],i[a]);for(var d=a-1;d>=1;--d)y.Value=this.m_UseFullRange,this.RangeTest(i[d],y),this.m_UseFullRange=y.Value,this.InitEdge(f[d],f[d+1],f[d-1],i[d]);for(var v=f[0],T=v,N=v;;){if(T.Curr===T.Next.Curr&&(n||T.Next!==v)){if(T===T.Next)break;T===v&&(v=T.Next),T=this.RemoveEdge(T),N=T;continue}if(T.Prev===T.Next)break;if(n&&t.ClipperBase.SlopesEqual4(T.Prev.Curr,T.Curr,T.Next.Curr,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(T.Prev.Curr,T.Curr,T.Next.Curr))){T===v&&(v=T.Next),T=this.RemoveEdge(T),T=T.Prev,N=T;continue}if(T=T.Next,T===N||!n&&T.Next===v)break}if(!n&&T===T.Next||n&&T.Prev===T.Next)return!1;n||(this.m_HasOpenPaths=!0,v.Prev.OutIdx=t.ClipperBase.Skip),T=v;do this.InitEdge2(T,s),T=T.Next,m&&T.Curr.Y!==v.Curr.Y&&(m=!1);while(T!==v);if(m){if(n)return!1;T.Prev.OutIdx=t.ClipperBase.Skip;var E=new t.LocalMinima;for(E.Next=null,E.Y=T.Bot.Y,E.LeftBound=null,E.RightBound=T,E.RightBound.Side=t.EdgeSide.esRight,E.RightBound.WindDelta=0;T.Bot.X!==T.Prev.Top.X&&this.ReverseHorizontal(T),T.Next.OutIdx!==t.ClipperBase.Skip;)T.NextInLML=T.Next,T=T.Next;return this.InsertLocalMinima(E),this.m_edges.push(f),!0}this.m_edges.push(f);var B,H=null;for(t.IntPoint.op_Equality(T.Prev.Bot,T.Prev.Top)&&(T=T.Next);T=this.FindNextLocMin(T),T!==H;){H===null&&(H=T);var E=new t.LocalMinima;E.Next=null,E.Y=T.Bot.Y,T.Dx<T.Prev.Dx?(E.LeftBound=T.Prev,E.RightBound=T,B=!1):(E.LeftBound=T,E.RightBound=T.Prev,B=!0),E.LeftBound.Side=t.EdgeSide.esLeft,E.RightBound.Side=t.EdgeSide.esRight,n?E.LeftBound.Next===E.RightBound?E.LeftBound.WindDelta=-1:E.LeftBound.WindDelta=1:E.LeftBound.WindDelta=0,E.RightBound.WindDelta=-E.LeftBound.WindDelta,T=this.ProcessBound(E.LeftBound,B),T.OutIdx===t.ClipperBase.Skip&&(T=this.ProcessBound(T,B));var tt=this.ProcessBound(E.RightBound,!B);tt.OutIdx===t.ClipperBase.Skip&&(tt=this.ProcessBound(tt,!B)),E.LeftBound.OutIdx===t.ClipperBase.Skip?E.LeftBound=null:E.RightBound.OutIdx===t.ClipperBase.Skip&&(E.RightBound=null),this.InsertLocalMinima(E),B||(T=tt)}return!0},t.ClipperBase.prototype.AddPaths=function(i,s,n){for(var a=!1,f=0,d=i.length;f<d;++f)this.AddPath(i[f],s,n)&&(a=!0);return a},t.ClipperBase.prototype.Pt2IsBetweenPt1AndPt3=function(i,s,n){return t.IntPoint.op_Equality(i,n)||t.IntPoint.op_Equality(i,s)||t.IntPoint.op_Equality(n,s)?!1:i.X!==n.X?s.X>i.X==s.X<n.X:s.Y>i.Y==s.Y<n.Y},t.ClipperBase.prototype.RemoveEdge=function(i){i.Prev.Next=i.Next,i.Next.Prev=i.Prev;var s=i.Next;return i.Prev=null,s},t.ClipperBase.prototype.SetDx=function(i){i.Delta.X=i.Top.X-i.Bot.X,i.Delta.Y=i.Top.Y-i.Bot.Y,i.Delta.Y===0?i.Dx=t.ClipperBase.horizontal:i.Dx=i.Delta.X/i.Delta.Y},t.ClipperBase.prototype.InsertLocalMinima=function(i){if(this.m_MinimaList===null)this.m_MinimaList=i;else if(i.Y>=this.m_MinimaList.Y)i.Next=this.m_MinimaList,this.m_MinimaList=i;else{for(var s=this.m_MinimaList;s.Next!==null&&i.Y<s.Next.Y;)s=s.Next;i.Next=s.Next,s.Next=i}},t.ClipperBase.prototype.PopLocalMinima=function(i,s){return s.v=this.m_CurrentLM,this.m_CurrentLM!==null&&this.m_CurrentLM.Y===i?(this.m_CurrentLM=this.m_CurrentLM.Next,!0):!1},t.ClipperBase.prototype.ReverseHorizontal=function(i){var s=i.Top.X;i.Top.X=i.Bot.X,i.Bot.X=s,t.use_xyz&&(s=i.Top.Z,i.Top.Z=i.Bot.Z,i.Bot.Z=s)},t.ClipperBase.prototype.Reset=function(){if(this.m_CurrentLM=this.m_MinimaList,this.m_CurrentLM!==null){this.m_Scanbeam=null;for(var i=this.m_MinimaList;i!==null;){this.InsertScanbeam(i.Y);var s=i.LeftBound;s!==null&&(s.Curr.X=s.Bot.X,s.Curr.Y=s.Bot.Y,t.use_xyz&&(s.Curr.Z=s.Bot.Z),s.OutIdx=t.ClipperBase.Unassigned),s=i.RightBound,s!==null&&(s.Curr.X=s.Bot.X,s.Curr.Y=s.Bot.Y,t.use_xyz&&(s.Curr.Z=s.Bot.Z),s.OutIdx=t.ClipperBase.Unassigned),i=i.Next}this.m_ActiveEdges=null}},t.ClipperBase.prototype.InsertScanbeam=function(i){if(this.m_Scanbeam===null)this.m_Scanbeam=new t.Scanbeam,this.m_Scanbeam.Next=null,this.m_Scanbeam.Y=i;else if(i>this.m_Scanbeam.Y){var s=new t.Scanbeam;s.Y=i,s.Next=this.m_Scanbeam,this.m_Scanbeam=s}else{for(var n=this.m_Scanbeam;n.Next!==null&&i<=n.Next.Y;)n=n.Next;if(i===n.Y)return;var a=new t.Scanbeam;a.Y=i,a.Next=n.Next,n.Next=a}},t.ClipperBase.prototype.PopScanbeam=function(i){return this.m_Scanbeam===null?(i.v=0,!1):(i.v=this.m_Scanbeam.Y,this.m_Scanbeam=this.m_Scanbeam.Next,!0)},t.ClipperBase.prototype.LocalMinimaPending=function(){return this.m_CurrentLM!==null},t.ClipperBase.prototype.CreateOutRec=function(){var i=new t.OutRec;return i.Idx=t.ClipperBase.Unassigned,i.IsHole=!1,i.IsOpen=!1,i.FirstLeft=null,i.Pts=null,i.BottomPt=null,i.PolyNode=null,this.m_PolyOuts.push(i),i.Idx=this.m_PolyOuts.length-1,i},t.ClipperBase.prototype.DisposeOutRec=function(i){var s=this.m_PolyOuts[i];s.Pts=null,s=null,this.m_PolyOuts[i]=null},t.ClipperBase.prototype.UpdateEdgeIntoAEL=function(i){i.NextInLML===null&&t.Error("UpdateEdgeIntoAEL: invalid call");var s=i.PrevInAEL,n=i.NextInAEL;return i.NextInLML.OutIdx=i.OutIdx,s!==null?s.NextInAEL=i.NextInLML:this.m_ActiveEdges=i.NextInLML,n!==null&&(n.PrevInAEL=i.NextInLML),i.NextInLML.Side=i.Side,i.NextInLML.WindDelta=i.WindDelta,i.NextInLML.WindCnt=i.WindCnt,i.NextInLML.WindCnt2=i.WindCnt2,i=i.NextInLML,i.Curr.X=i.Bot.X,i.Curr.Y=i.Bot.Y,i.PrevInAEL=s,i.NextInAEL=n,t.ClipperBase.IsHorizontal(i)||this.InsertScanbeam(i.Top.Y),i},t.ClipperBase.prototype.SwapPositionsInAEL=function(i,s){if(!(i.NextInAEL===i.PrevInAEL||s.NextInAEL===s.PrevInAEL)){if(i.NextInAEL===s){var n=s.NextInAEL;n!==null&&(n.PrevInAEL=i);var a=i.PrevInAEL;a!==null&&(a.NextInAEL=s),s.PrevInAEL=a,s.NextInAEL=i,i.PrevInAEL=s,i.NextInAEL=n}else if(s.NextInAEL===i){var f=i.NextInAEL;f!==null&&(f.PrevInAEL=s);var d=s.PrevInAEL;d!==null&&(d.NextInAEL=i),i.PrevInAEL=d,i.NextInAEL=s,s.PrevInAEL=i,s.NextInAEL=f}else{var m=i.NextInAEL,y=i.PrevInAEL;i.NextInAEL=s.NextInAEL,i.NextInAEL!==null&&(i.NextInAEL.PrevInAEL=i),i.PrevInAEL=s.PrevInAEL,i.PrevInAEL!==null&&(i.PrevInAEL.NextInAEL=i),s.NextInAEL=m,s.NextInAEL!==null&&(s.NextInAEL.PrevInAEL=s),s.PrevInAEL=y,s.PrevInAEL!==null&&(s.PrevInAEL.NextInAEL=s)}i.PrevInAEL===null?this.m_ActiveEdges=i:s.PrevInAEL===null&&(this.m_ActiveEdges=s)}},t.ClipperBase.prototype.DeleteFromAEL=function(i){var s=i.PrevInAEL,n=i.NextInAEL;s===null&&n===null&&i!==this.m_ActiveEdges||(s!==null?s.NextInAEL=n:this.m_ActiveEdges=n,n!==null&&(n.PrevInAEL=s),i.NextInAEL=null,i.PrevInAEL=null)},t.Clipper=function(i){typeof i>"u"&&(i=0),this.m_PolyOuts=null,this.m_ClipType=t.ClipType.ctIntersection,this.m_Scanbeam=null,this.m_Maxima=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=null,this.m_IntersectNodeComparer=null,this.m_ExecuteLocked=!1,this.m_ClipFillType=t.PolyFillType.pftEvenOdd,this.m_SubjFillType=t.PolyFillType.pftEvenOdd,this.m_Joins=null,this.m_GhostJoins=null,this.m_UsingPolyTree=!1,this.ReverseSolution=!1,this.StrictlySimple=!1,t.ClipperBase.call(this),this.m_Scanbeam=null,this.m_Maxima=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=new Array,this.m_IntersectNodeComparer=t.MyIntersectNodeSort.Compare,this.m_ExecuteLocked=!1,this.m_UsingPolyTree=!1,this.m_PolyOuts=new Array,this.m_Joins=new Array,this.m_GhostJoins=new Array,this.ReverseSolution=(1&i)!==0,this.StrictlySimple=(2&i)!==0,this.PreserveCollinear=(4&i)!==0,t.use_xyz&&(this.ZFillFunction=null)},t.Clipper.ioReverseSolution=1,t.Clipper.ioStrictlySimple=2,t.Clipper.ioPreserveCollinear=4,t.Clipper.prototype.Clear=function(){this.m_edges.length!==0&&(this.DisposeAllPolyPts(),t.ClipperBase.prototype.Clear.call(this))},t.Clipper.prototype.InsertMaxima=function(i){var s=new t.Maxima;if(s.X=i,this.m_Maxima===null)this.m_Maxima=s,this.m_Maxima.Next=null,this.m_Maxima.Prev=null;else if(i<this.m_Maxima.X)s.Next=this.m_Maxima,s.Prev=null,this.m_Maxima=s;else{for(var n=this.m_Maxima;n.Next!==null&&i>=n.Next.X;)n=n.Next;if(i===n.X)return;s.Next=n.Next,s.Prev=n,n.Next!==null&&(n.Next.Prev=s),n.Next=s}},t.Clipper.prototype.Execute=function(){var i=arguments,s=i.length,n=i[1]instanceof t.PolyTree;if(s===4&&!n){var a=i[0],f=i[1],d=i[2],m=i[3];if(this.m_ExecuteLocked)return!1;this.m_HasOpenPaths&&t.Error("Error: PolyTree struct is needed for open path clipping."),this.m_ExecuteLocked=!0,t.Clear(f),this.m_SubjFillType=d,this.m_ClipFillType=m,this.m_ClipType=a,this.m_UsingPolyTree=!1;try{var y=this.ExecuteInternal();y&&this.BuildResult(f)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return y}else if(s===4&&n){var a=i[0],v=i[1],d=i[2],m=i[3];if(this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0,this.m_SubjFillType=d,this.m_ClipFillType=m,this.m_ClipType=a,this.m_UsingPolyTree=!0;try{var y=this.ExecuteInternal();y&&this.BuildResult2(v)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return y}else if(s===2&&!n){var a=i[0],f=i[1];return this.Execute(a,f,t.PolyFillType.pftEvenOdd,t.PolyFillType.pftEvenOdd)}else if(s===2&&n){var a=i[0],v=i[1];return this.Execute(a,v,t.PolyFillType.pftEvenOdd,t.PolyFillType.pftEvenOdd)}},t.Clipper.prototype.FixHoleLinkage=function(i){if(!(i.FirstLeft===null||i.IsHole!==i.FirstLeft.IsHole&&i.FirstLeft.Pts!==null)){for(var s=i.FirstLeft;s!==null&&(s.IsHole===i.IsHole||s.Pts===null);)s=s.FirstLeft;i.FirstLeft=s}},t.Clipper.prototype.ExecuteInternal=function(){try{this.Reset(),this.m_SortedEdges=null,this.m_Maxima=null;var i={},s={};if(!this.PopScanbeam(i))return!1;for(this.InsertLocalMinimaIntoAEL(i.v);this.PopScanbeam(s)||this.LocalMinimaPending();){if(this.ProcessHorizontals(),this.m_GhostJoins.length=0,!this.ProcessIntersections(s.v))return!1;this.ProcessEdgesAtTopOfScanbeam(s.v),i.v=s.v,this.InsertLocalMinimaIntoAEL(i.v)}var n,a,f;for(a=0,f=this.m_PolyOuts.length;a<f;a++)n=this.m_PolyOuts[a],!(n.Pts===null||n.IsOpen)&&(n.IsHole^this.ReverseSolution)==this.Area$1(n)>0&&this.ReversePolyPtLinks(n.Pts);for(this.JoinCommonEdges(),a=0,f=this.m_PolyOuts.length;a<f;a++)n=this.m_PolyOuts[a],n.Pts!==null&&(n.IsOpen?this.FixupOutPolyline(n):this.FixupOutPolygon(n));return this.StrictlySimple&&this.DoSimplePolygons(),!0}finally{this.m_Joins.length=0,this.m_GhostJoins.length=0}},t.Clipper.prototype.DisposeAllPolyPts=function(){for(var i=0,s=this.m_PolyOuts.length;i<s;++i)this.DisposeOutRec(i);t.Clear(this.m_PolyOuts)},t.Clipper.prototype.AddJoin=function(i,s,n){var a=new t.Join;a.OutPt1=i,a.OutPt2=s,a.OffPt.X=n.X,a.OffPt.Y=n.Y,t.use_xyz&&(a.OffPt.Z=n.Z),this.m_Joins.push(a)},t.Clipper.prototype.AddGhostJoin=function(i,s){var n=new t.Join;n.OutPt1=i,n.OffPt.X=s.X,n.OffPt.Y=s.Y,t.use_xyz&&(n.OffPt.Z=s.Z),this.m_GhostJoins.push(n)},t.Clipper.prototype.SetZ=function(i,s,n){if(this.ZFillFunction!==null){if(i.Z!==0||this.ZFillFunction===null)return;t.IntPoint.op_Equality(i,s.Bot)?i.Z=s.Bot.Z:t.IntPoint.op_Equality(i,s.Top)?i.Z=s.Top.Z:t.IntPoint.op_Equality(i,n.Bot)?i.Z=n.Bot.Z:t.IntPoint.op_Equality(i,n.Top)?i.Z=n.Top.Z:this.ZFillFunction(s.Bot,s.Top,n.Bot,n.Top,i)}},t.Clipper.prototype.InsertLocalMinimaIntoAEL=function(i){for(var s={},n,a;this.PopLocalMinima(i,s);){n=s.v.LeftBound,a=s.v.RightBound;var f=null;if(n===null?(this.InsertEdgeIntoAEL(a,null),this.SetWindingCount(a),this.IsContributing(a)&&(f=this.AddOutPt(a,a.Bot))):a===null?(this.InsertEdgeIntoAEL(n,null),this.SetWindingCount(n),this.IsContributing(n)&&(f=this.AddOutPt(n,n.Bot)),this.InsertScanbeam(n.Top.Y)):(this.InsertEdgeIntoAEL(n,null),this.InsertEdgeIntoAEL(a,n),this.SetWindingCount(n),a.WindCnt=n.WindCnt,a.WindCnt2=n.WindCnt2,this.IsContributing(n)&&(f=this.AddLocalMinPoly(n,a,n.Bot)),this.InsertScanbeam(n.Top.Y)),a!==null&&(t.ClipperBase.IsHorizontal(a)?(a.NextInLML!==null&&this.InsertScanbeam(a.NextInLML.Top.Y),this.AddEdgeToSEL(a)):this.InsertScanbeam(a.Top.Y)),!(n===null||a===null)){if(f!==null&&t.ClipperBase.IsHorizontal(a)&&this.m_GhostJoins.length>0&&a.WindDelta!==0)for(var d=0,m=this.m_GhostJoins.length;d<m;d++){var y=this.m_GhostJoins[d];this.HorzSegmentsOverlap(y.OutPt1.Pt.X,y.OffPt.X,a.Bot.X,a.Top.X)&&this.AddJoin(y.OutPt1,f,y.OffPt)}if(n.OutIdx>=0&&n.PrevInAEL!==null&&n.PrevInAEL.Curr.X===n.Bot.X&&n.PrevInAEL.OutIdx>=0&&t.ClipperBase.SlopesEqual5(n.PrevInAEL.Curr,n.PrevInAEL.Top,n.Curr,n.Top,this.m_UseFullRange)&&n.WindDelta!==0&&n.PrevInAEL.WindDelta!==0){var v=this.AddOutPt(n.PrevInAEL,n.Bot);this.AddJoin(f,v,n.Top)}if(n.NextInAEL!==a){if(a.OutIdx>=0&&a.PrevInAEL.OutIdx>=0&&t.ClipperBase.SlopesEqual5(a.PrevInAEL.Curr,a.PrevInAEL.Top,a.Curr,a.Top,this.m_UseFullRange)&&a.WindDelta!==0&&a.PrevInAEL.WindDelta!==0){var v=this.AddOutPt(a.PrevInAEL,a.Bot);this.AddJoin(f,v,a.Top)}var T=n.NextInAEL;if(T!==null)for(;T!==a;)this.IntersectEdges(a,T,n.Curr),T=T.NextInAEL}}}},t.Clipper.prototype.InsertEdgeIntoAEL=function(i,s){if(this.m_ActiveEdges===null)i.PrevInAEL=null,i.NextInAEL=null,this.m_ActiveEdges=i;else if(s===null&&this.E2InsertsBeforeE1(this.m_ActiveEdges,i))i.PrevInAEL=null,i.NextInAEL=this.m_ActiveEdges,this.m_ActiveEdges.PrevInAEL=i,this.m_ActiveEdges=i;else{for(s===null&&(s=this.m_ActiveEdges);s.NextInAEL!==null&&!this.E2InsertsBeforeE1(s.NextInAEL,i);)s=s.NextInAEL;i.NextInAEL=s.NextInAEL,s.NextInAEL!==null&&(s.NextInAEL.PrevInAEL=i),i.PrevInAEL=s,s.NextInAEL=i}},t.Clipper.prototype.E2InsertsBeforeE1=function(i,s){return s.Curr.X===i.Curr.X?s.Top.Y>i.Top.Y?s.Top.X<t.Clipper.TopX(i,s.Top.Y):i.Top.X>t.Clipper.TopX(s,i.Top.Y):s.Curr.X<i.Curr.X},t.Clipper.prototype.IsEvenOddFillType=function(i){return i.PolyTyp===t.PolyType.ptSubject?this.m_SubjFillType===t.PolyFillType.pftEvenOdd:this.m_ClipFillType===t.PolyFillType.pftEvenOdd},t.Clipper.prototype.IsEvenOddAltFillType=function(i){return i.PolyTyp===t.PolyType.ptSubject?this.m_ClipFillType===t.PolyFillType.pftEvenOdd:this.m_SubjFillType===t.PolyFillType.pftEvenOdd},t.Clipper.prototype.IsContributing=function(i){var s,n;switch(i.PolyTyp===t.PolyType.ptSubject?(s=this.m_SubjFillType,n=this.m_ClipFillType):(s=this.m_ClipFillType,n=this.m_SubjFillType),s){case t.PolyFillType.pftEvenOdd:if(i.WindDelta===0&&i.WindCnt!==1)return!1;break;case t.PolyFillType.pftNonZero:if(Math.abs(i.WindCnt)!==1)return!1;break;case t.PolyFillType.pftPositive:if(i.WindCnt!==1)return!1;break;default:if(i.WindCnt!==-1)return!1;break}switch(this.m_ClipType){case t.ClipType.ctIntersection:switch(n){case t.PolyFillType.pftEvenOdd:case t.PolyFillType.pftNonZero:return i.WindCnt2!==0;case t.PolyFillType.pftPositive:return i.WindCnt2>0;default:return i.WindCnt2<0}case t.ClipType.ctUnion:switch(n){case t.PolyFillType.pftEvenOdd:case t.PolyFillType.pftNonZero:return i.WindCnt2===0;case t.PolyFillType.pftPositive:return i.WindCnt2<=0;default:return i.WindCnt2>=0}case t.ClipType.ctDifference:if(i.PolyTyp===t.PolyType.ptSubject)switch(n){case t.PolyFillType.pftEvenOdd:case t.PolyFillType.pftNonZero:return i.WindCnt2===0;case t.PolyFillType.pftPositive:return i.WindCnt2<=0;default:return i.WindCnt2>=0}else switch(n){case t.PolyFillType.pftEvenOdd:case t.PolyFillType.pftNonZero:return i.WindCnt2!==0;case t.PolyFillType.pftPositive:return i.WindCnt2>0;default:return i.WindCnt2<0}case t.ClipType.ctXor:if(i.WindDelta===0)switch(n){case t.PolyFillType.pftEvenOdd:case t.PolyFillType.pftNonZero:return i.WindCnt2===0;case t.PolyFillType.pftPositive:return i.WindCnt2<=0;default:return i.WindCnt2>=0}else return!0}return!0},t.Clipper.prototype.SetWindingCount=function(i){for(var s=i.PrevInAEL;s!==null&&(s.PolyTyp!==i.PolyTyp||s.WindDelta===0);)s=s.PrevInAEL;if(s===null){var n=i.PolyTyp===t.PolyType.ptSubject?this.m_SubjFillType:this.m_ClipFillType;i.WindDelta===0?i.WindCnt=n===t.PolyFillType.pftNegative?-1:1:i.WindCnt=i.WindDelta,i.WindCnt2=0,s=this.m_ActiveEdges}else if(i.WindDelta===0&&this.m_ClipType!==t.ClipType.ctUnion)i.WindCnt=1,i.WindCnt2=s.WindCnt2,s=s.NextInAEL;else if(this.IsEvenOddFillType(i)){if(i.WindDelta===0){for(var a=!0,f=s.PrevInAEL;f!==null;)f.PolyTyp===s.PolyTyp&&f.WindDelta!==0&&(a=!a),f=f.PrevInAEL;i.WindCnt=a?0:1}else i.WindCnt=i.WindDelta;i.WindCnt2=s.WindCnt2,s=s.NextInAEL}else s.WindCnt*s.WindDelta<0?Math.abs(s.WindCnt)>1?s.WindDelta*i.WindDelta<0?i.WindCnt=s.WindCnt:i.WindCnt=s.WindCnt+i.WindDelta:i.WindCnt=i.WindDelta===0?1:i.WindDelta:i.WindDelta===0?i.WindCnt=s.WindCnt<0?s.WindCnt-1:s.WindCnt+1:s.WindDelta*i.WindDelta<0?i.WindCnt=s.WindCnt:i.WindCnt=s.WindCnt+i.WindDelta,i.WindCnt2=s.WindCnt2,s=s.NextInAEL;if(this.IsEvenOddAltFillType(i))for(;s!==i;)s.WindDelta!==0&&(i.WindCnt2=i.WindCnt2===0?1:0),s=s.NextInAEL;else for(;s!==i;)i.WindCnt2+=s.WindDelta,s=s.NextInAEL},t.Clipper.prototype.AddEdgeToSEL=function(i){this.m_SortedEdges===null?(this.m_SortedEdges=i,i.PrevInSEL=null,i.NextInSEL=null):(i.NextInSEL=this.m_SortedEdges,i.PrevInSEL=null,this.m_SortedEdges.PrevInSEL=i,this.m_SortedEdges=i)},t.Clipper.prototype.PopEdgeFromSEL=function(i){if(i.v=this.m_SortedEdges,i.v===null)return!1;var s=i.v;return this.m_SortedEdges=i.v.NextInSEL,this.m_SortedEdges!==null&&(this.m_SortedEdges.PrevInSEL=null),s.NextInSEL=null,s.PrevInSEL=null,!0},t.Clipper.prototype.CopyAELToSEL=function(){var i=this.m_ActiveEdges;for(this.m_SortedEdges=i;i!==null;)i.PrevInSEL=i.PrevInAEL,i.NextInSEL=i.NextInAEL,i=i.NextInAEL},t.Clipper.prototype.SwapPositionsInSEL=function(i,s){if(!(i.NextInSEL===null&&i.PrevInSEL===null)&&!(s.NextInSEL===null&&s.PrevInSEL===null)){if(i.NextInSEL===s){var n=s.NextInSEL;n!==null&&(n.PrevInSEL=i);var a=i.PrevInSEL;a!==null&&(a.NextInSEL=s),s.PrevInSEL=a,s.NextInSEL=i,i.PrevInSEL=s,i.NextInSEL=n}else if(s.NextInSEL===i){var n=i.NextInSEL;n!==null&&(n.PrevInSEL=s);var a=s.PrevInSEL;a!==null&&(a.NextInSEL=i),i.PrevInSEL=a,i.NextInSEL=s,s.PrevInSEL=i,s.NextInSEL=n}else{var n=i.NextInSEL,a=i.PrevInSEL;i.NextInSEL=s.NextInSEL,i.NextInSEL!==null&&(i.NextInSEL.PrevInSEL=i),i.PrevInSEL=s.PrevInSEL,i.PrevInSEL!==null&&(i.PrevInSEL.NextInSEL=i),s.NextInSEL=n,s.NextInSEL!==null&&(s.NextInSEL.PrevInSEL=s),s.PrevInSEL=a,s.PrevInSEL!==null&&(s.PrevInSEL.NextInSEL=s)}i.PrevInSEL===null?this.m_SortedEdges=i:s.PrevInSEL===null&&(this.m_SortedEdges=s)}},t.Clipper.prototype.AddLocalMaxPoly=function(i,s,n){this.AddOutPt(i,n),s.WindDelta===0&&this.AddOutPt(s,n),i.OutIdx===s.OutIdx?(i.OutIdx=-1,s.OutIdx=-1):i.OutIdx<s.OutIdx?this.AppendPolygon(i,s):this.AppendPolygon(s,i)},t.Clipper.prototype.AddLocalMinPoly=function(i,s,n){var a,f,d;if(t.ClipperBase.IsHorizontal(s)||i.Dx>s.Dx?(a=this.AddOutPt(i,n),s.OutIdx=i.OutIdx,i.Side=t.EdgeSide.esLeft,s.Side=t.EdgeSide.esRight,f=i,f.PrevInAEL===s?d=s.PrevInAEL:d=f.PrevInAEL):(a=this.AddOutPt(s,n),i.OutIdx=s.OutIdx,i.Side=t.EdgeSide.esRight,s.Side=t.EdgeSide.esLeft,f=s,f.PrevInAEL===i?d=i.PrevInAEL:d=f.PrevInAEL),d!==null&&d.OutIdx>=0&&d.Top.Y<n.Y&&f.Top.Y<n.Y){var m=t.Clipper.TopX(d,n.Y),y=t.Clipper.TopX(f,n.Y);if(m===y&&f.WindDelta!==0&&d.WindDelta!==0&&t.ClipperBase.SlopesEqual5(new t.IntPoint2(m,n.Y),d.Top,new t.IntPoint2(y,n.Y),f.Top,this.m_UseFullRange)){var v=this.AddOutPt(d,n);this.AddJoin(a,v,f.Top)}}return a},t.Clipper.prototype.AddOutPt=function(i,s){if(i.OutIdx<0){var n=this.CreateOutRec();n.IsOpen=i.WindDelta===0;var a=new t.OutPt;return n.Pts=a,a.Idx=n.Idx,a.Pt.X=s.X,a.Pt.Y=s.Y,t.use_xyz&&(a.Pt.Z=s.Z),a.Next=a,a.Prev=a,n.IsOpen||this.SetHoleState(i,n),i.OutIdx=n.Idx,a}else{var n=this.m_PolyOuts[i.OutIdx],f=n.Pts,d=i.Side===t.EdgeSide.esLeft;if(d&&t.IntPoint.op_Equality(s,f.Pt))return f;if(!d&&t.IntPoint.op_Equality(s,f.Prev.Pt))return f.Prev;var a=new t.OutPt;return a.Idx=n.Idx,a.Pt.X=s.X,a.Pt.Y=s.Y,t.use_xyz&&(a.Pt.Z=s.Z),a.Next=f,a.Prev=f.Prev,a.Prev.Next=a,f.Prev=a,d&&(n.Pts=a),a}},t.Clipper.prototype.GetLastOutPt=function(i){var s=this.m_PolyOuts[i.OutIdx];return i.Side===t.EdgeSide.esLeft?s.Pts:s.Pts.Prev},t.Clipper.prototype.SwapPoints=function(i,s){var n=new t.IntPoint1(i.Value);i.Value.X=s.Value.X,i.Value.Y=s.Value.Y,t.use_xyz&&(i.Value.Z=s.Value.Z),s.Value.X=n.X,s.Value.Y=n.Y,t.use_xyz&&(s.Value.Z=n.Z)},t.Clipper.prototype.HorzSegmentsOverlap=function(i,s,n,a){var f;return i>s&&(f=i,i=s,s=f),n>a&&(f=n,n=a,a=f),i<a&&n<s},t.Clipper.prototype.SetHoleState=function(i,s){for(var n=i.PrevInAEL,a=null;n!==null;)n.OutIdx>=0&&n.WindDelta!==0&&(a===null?a=n:a.OutIdx===n.OutIdx&&(a=null)),n=n.PrevInAEL;a===null?(s.FirstLeft=null,s.IsHole=!1):(s.FirstLeft=this.m_PolyOuts[a.OutIdx],s.IsHole=!s.FirstLeft.IsHole)},t.Clipper.prototype.GetDx=function(i,s){return i.Y===s.Y?t.ClipperBase.horizontal:(s.X-i.X)/(s.Y-i.Y)},t.Clipper.prototype.FirstIsBottomPt=function(i,s){for(var n=i.Prev;t.IntPoint.op_Equality(n.Pt,i.Pt)&&n!==i;)n=n.Prev;var a=Math.abs(this.GetDx(i.Pt,n.Pt));for(n=i.Next;t.IntPoint.op_Equality(n.Pt,i.Pt)&&n!==i;)n=n.Next;var f=Math.abs(this.GetDx(i.Pt,n.Pt));for(n=s.Prev;t.IntPoint.op_Equality(n.Pt,s.Pt)&&n!==s;)n=n.Prev;var d=Math.abs(this.GetDx(s.Pt,n.Pt));for(n=s.Next;t.IntPoint.op_Equality(n.Pt,s.Pt)&&n!==s;)n=n.Next;var m=Math.abs(this.GetDx(s.Pt,n.Pt));return Math.max(a,f)===Math.max(d,m)&&Math.min(a,f)===Math.min(d,m)?this.Area(i)>0:a>=d&&a>=m||f>=d&&f>=m},t.Clipper.prototype.GetBottomPt=function(i){for(var s=null,n=i.Next;n!==i;)n.Pt.Y>i.Pt.Y?(i=n,s=null):n.Pt.Y===i.Pt.Y&&n.Pt.X<=i.Pt.X&&(n.Pt.X<i.Pt.X?(s=null,i=n):n.Next!==i&&n.Prev!==i&&(s=n)),n=n.Next;if(s!==null)for(;s!==n;)for(this.FirstIsBottomPt(n,s)||(i=s),s=s.Next;t.IntPoint.op_Inequality(s.Pt,i.Pt);)s=s.Next;return i},t.Clipper.prototype.GetLowermostRec=function(i,s){i.BottomPt===null&&(i.BottomPt=this.GetBottomPt(i.Pts)),s.BottomPt===null&&(s.BottomPt=this.GetBottomPt(s.Pts));var n=i.BottomPt,a=s.BottomPt;return n.Pt.Y>a.Pt.Y?i:n.Pt.Y<a.Pt.Y?s:n.Pt.X<a.Pt.X?i:n.Pt.X>a.Pt.X||n.Next===n?s:a.Next===a||this.FirstIsBottomPt(n,a)?i:s},t.Clipper.prototype.OutRec1RightOfOutRec2=function(i,s){do if(i=i.FirstLeft,i===s)return!0;while(i!==null);return!1},t.Clipper.prototype.GetOutRec=function(i){for(var s=this.m_PolyOuts[i];s!==this.m_PolyOuts[s.Idx];)s=this.m_PolyOuts[s.Idx];return s},t.Clipper.prototype.AppendPolygon=function(i,s){var n=this.m_PolyOuts[i.OutIdx],a=this.m_PolyOuts[s.OutIdx],f;this.OutRec1RightOfOutRec2(n,a)?f=a:this.OutRec1RightOfOutRec2(a,n)?f=n:f=this.GetLowermostRec(n,a);var d=n.Pts,m=d.Prev,y=a.Pts,v=y.Prev;i.Side===t.EdgeSide.esLeft?s.Side===t.EdgeSide.esLeft?(this.ReversePolyPtLinks(y),y.Next=d,d.Prev=y,m.Next=v,v.Prev=m,n.Pts=v):(v.Next=d,d.Prev=v,y.Prev=m,m.Next=y,n.Pts=y):s.Side===t.EdgeSide.esRight?(this.ReversePolyPtLinks(y),m.Next=v,v.Prev=m,y.Next=d,d.Prev=y):(m.Next=y,y.Prev=m,d.Prev=v,v.Next=d),n.BottomPt=null,f===a&&(a.FirstLeft!==n&&(n.FirstLeft=a.FirstLeft),n.IsHole=a.IsHole),a.Pts=null,a.BottomPt=null,a.FirstLeft=n;var T=i.OutIdx,N=s.OutIdx;i.OutIdx=-1,s.OutIdx=-1;for(var E=this.m_ActiveEdges;E!==null;){if(E.OutIdx===N){E.OutIdx=T,E.Side=i.Side;break}E=E.NextInAEL}a.Idx=n.Idx},t.Clipper.prototype.ReversePolyPtLinks=function(i){if(i!==null){var s,n;s=i;do n=s.Next,s.Next=s.Prev,s.Prev=n,s=n;while(s!==i)}},t.Clipper.SwapSides=function(i,s){var n=i.Side;i.Side=s.Side,s.Side=n},t.Clipper.SwapPolyIndexes=function(i,s){var n=i.OutIdx;i.OutIdx=s.OutIdx,s.OutIdx=n},t.Clipper.prototype.IntersectEdges=function(i,s,n){var a=i.OutIdx>=0,f=s.OutIdx>=0;if(t.use_xyz&&this.SetZ(n,i,s),t.use_lines&&(i.WindDelta===0||s.WindDelta===0)){if(i.WindDelta===0&&s.WindDelta===0)return;i.PolyTyp===s.PolyTyp&&i.WindDelta!==s.WindDelta&&this.m_ClipType===t.ClipType.ctUnion?i.WindDelta===0?f&&(this.AddOutPt(i,n),a&&(i.OutIdx=-1)):a&&(this.AddOutPt(s,n),f&&(s.OutIdx=-1)):i.PolyTyp!==s.PolyTyp&&(i.WindDelta===0&&Math.abs(s.WindCnt)===1&&(this.m_ClipType!==t.ClipType.ctUnion||s.WindCnt2===0)?(this.AddOutPt(i,n),a&&(i.OutIdx=-1)):s.WindDelta===0&&Math.abs(i.WindCnt)===1&&(this.m_ClipType!==t.ClipType.ctUnion||i.WindCnt2===0)&&(this.AddOutPt(s,n),f&&(s.OutIdx=-1)));return}if(i.PolyTyp===s.PolyTyp)if(this.IsEvenOddFillType(i)){var d=i.WindCnt;i.WindCnt=s.WindCnt,s.WindCnt=d}else i.WindCnt+s.WindDelta===0?i.WindCnt=-i.WindCnt:i.WindCnt+=s.WindDelta,s.WindCnt-i.WindDelta===0?s.WindCnt=-s.WindCnt:s.WindCnt-=i.WindDelta;else this.IsEvenOddFillType(s)?i.WindCnt2=i.WindCnt2===0?1:0:i.WindCnt2+=s.WindDelta,this.IsEvenOddFillType(i)?s.WindCnt2=s.WindCnt2===0?1:0:s.WindCnt2-=i.WindDelta;var m,y,v,T;i.PolyTyp===t.PolyType.ptSubject?(m=this.m_SubjFillType,v=this.m_ClipFillType):(m=this.m_ClipFillType,v=this.m_SubjFillType),s.PolyTyp===t.PolyType.ptSubject?(y=this.m_SubjFillType,T=this.m_ClipFillType):(y=this.m_ClipFillType,T=this.m_SubjFillType);var N,E;switch(m){case t.PolyFillType.pftPositive:N=i.WindCnt;break;case t.PolyFillType.pftNegative:N=-i.WindCnt;break;default:N=Math.abs(i.WindCnt);break}switch(y){case t.PolyFillType.pftPositive:E=s.WindCnt;break;case t.PolyFillType.pftNegative:E=-s.WindCnt;break;default:E=Math.abs(s.WindCnt);break}if(a&&f)N!==0&&N!==1||E!==0&&E!==1||i.PolyTyp!==s.PolyTyp&&this.m_ClipType!==t.ClipType.ctXor?this.AddLocalMaxPoly(i,s,n):(this.AddOutPt(i,n),this.AddOutPt(s,n),t.Clipper.SwapSides(i,s),t.Clipper.SwapPolyIndexes(i,s));else if(a)(E===0||E===1)&&(this.AddOutPt(i,n),t.Clipper.SwapSides(i,s),t.Clipper.SwapPolyIndexes(i,s));else if(f)(N===0||N===1)&&(this.AddOutPt(s,n),t.Clipper.SwapSides(i,s),t.Clipper.SwapPolyIndexes(i,s));else if((N===0||N===1)&&(E===0||E===1)){var B,H;switch(v){case t.PolyFillType.pftPositive:B=i.WindCnt2;break;case t.PolyFillType.pftNegative:B=-i.WindCnt2;break;default:B=Math.abs(i.WindCnt2);break}switch(T){case t.PolyFillType.pftPositive:H=s.WindCnt2;break;case t.PolyFillType.pftNegative:H=-s.WindCnt2;break;default:H=Math.abs(s.WindCnt2);break}if(i.PolyTyp!==s.PolyTyp)this.AddLocalMinPoly(i,s,n);else if(N===1&&E===1)switch(this.m_ClipType){case t.ClipType.ctIntersection:B>0&&H>0&&this.AddLocalMinPoly(i,s,n);break;case t.ClipType.ctUnion:B<=0&&H<=0&&this.AddLocalMinPoly(i,s,n);break;case t.ClipType.ctDifference:(i.PolyTyp===t.PolyType.ptClip&&B>0&&H>0||i.PolyTyp===t.PolyType.ptSubject&&B<=0&&H<=0)&&this.AddLocalMinPoly(i,s,n);break;case t.ClipType.ctXor:this.AddLocalMinPoly(i,s,n);break}else t.Clipper.SwapSides(i,s)}},t.Clipper.prototype.DeleteFromSEL=function(i){var s=i.PrevInSEL,n=i.NextInSEL;s===null&&n===null&&i!==this.m_SortedEdges||(s!==null?s.NextInSEL=n:this.m_SortedEdges=n,n!==null&&(n.PrevInSEL=s),i.NextInSEL=null,i.PrevInSEL=null)},t.Clipper.prototype.ProcessHorizontals=function(){for(var i={};this.PopEdgeFromSEL(i);)this.ProcessHorizontal(i.v)},t.Clipper.prototype.GetHorzDirection=function(i,s){i.Bot.X<i.Top.X?(s.Left=i.Bot.X,s.Right=i.Top.X,s.Dir=t.Direction.dLeftToRight):(s.Left=i.Top.X,s.Right=i.Bot.X,s.Dir=t.Direction.dRightToLeft)},t.Clipper.prototype.ProcessHorizontal=function(i){var s={Dir:null,Left:null,Right:null};this.GetHorzDirection(i,s);for(var n=s.Dir,a=s.Left,f=s.Right,d=i.WindDelta===0,m=i,y=null;m.NextInLML!==null&&t.ClipperBase.IsHorizontal(m.NextInLML);)m=m.NextInLML;m.NextInLML===null&&(y=this.GetMaximaPair(m));var v=this.m_Maxima;if(v!==null)if(n===t.Direction.dLeftToRight){for(;v!==null&&v.X<=i.Bot.X;)v=v.Next;v!==null&&v.X>=m.Top.X&&(v=null)}else{for(;v.Next!==null&&v.Next.X<i.Bot.X;)v=v.Next;v.X<=m.Top.X&&(v=null)}for(var T=null;;){for(var N=i===m,E=this.GetNextInAEL(i,n);E!==null;){if(v!==null)if(n===t.Direction.dLeftToRight)for(;v!==null&&v.X<E.Curr.X;)i.OutIdx>=0&&!d&&this.AddOutPt(i,new t.IntPoint2(v.X,i.Bot.Y)),v=v.Next;else for(;v!==null&&v.X>E.Curr.X;)i.OutIdx>=0&&!d&&this.AddOutPt(i,new t.IntPoint2(v.X,i.Bot.Y)),v=v.Prev;if(n===t.Direction.dLeftToRight&&E.Curr.X>f||n===t.Direction.dRightToLeft&&E.Curr.X<a||E.Curr.X===i.Top.X&&i.NextInLML!==null&&E.Dx<i.NextInLML.Dx)break;if(i.OutIdx>=0&&!d){t.use_xyz&&(n===t.Direction.dLeftToRight?this.SetZ(E.Curr,i,E):this.SetZ(E.Curr,E,i)),T=this.AddOutPt(i,E.Curr);for(var B=this.m_SortedEdges;B!==null;){if(B.OutIdx>=0&&this.HorzSegmentsOverlap(i.Bot.X,i.Top.X,B.Bot.X,B.Top.X)){var H=this.GetLastOutPt(B);this.AddJoin(H,T,B.Top)}B=B.NextInSEL}this.AddGhostJoin(T,i.Bot)}if(E===y&&N){i.OutIdx>=0&&this.AddLocalMaxPoly(i,y,i.Top),this.DeleteFromAEL(i),this.DeleteFromAEL(y);return}if(n===t.Direction.dLeftToRight){var tt=new t.IntPoint2(E.Curr.X,i.Curr.Y);this.IntersectEdges(i,E,tt)}else{var tt=new t.IntPoint2(E.Curr.X,i.Curr.Y);this.IntersectEdges(E,i,tt)}var et=this.GetNextInAEL(E,n);this.SwapPositionsInAEL(i,E),E=et}if(i.NextInLML===null||!t.ClipperBase.IsHorizontal(i.NextInLML))break;i=this.UpdateEdgeIntoAEL(i),i.OutIdx>=0&&this.AddOutPt(i,i.Bot),s={Dir:n,Left:a,Right:f},this.GetHorzDirection(i,s),n=s.Dir,a=s.Left,f=s.Right}if(i.OutIdx>=0&&T===null){T=this.GetLastOutPt(i);for(var B=this.m_SortedEdges;B!==null;){if(B.OutIdx>=0&&this.HorzSegmentsOverlap(i.Bot.X,i.Top.X,B.Bot.X,B.Top.X)){var H=this.GetLastOutPt(B);this.AddJoin(H,T,B.Top)}B=B.NextInSEL}this.AddGhostJoin(T,i.Top)}if(i.NextInLML!==null)if(i.OutIdx>=0){if(T=this.AddOutPt(i,i.Top),i=this.UpdateEdgeIntoAEL(i),i.WindDelta===0)return;var lt=i.PrevInAEL,et=i.NextInAEL;if(lt!==null&&lt.Curr.X===i.Bot.X&&lt.Curr.Y===i.Bot.Y&&lt.WindDelta===0&&lt.OutIdx>=0&&lt.Curr.Y>lt.Top.Y&&t.ClipperBase.SlopesEqual3(i,lt,this.m_UseFullRange)){var H=this.AddOutPt(lt,i.Bot);this.AddJoin(T,H,i.Top)}else if(et!==null&&et.Curr.X===i.Bot.X&&et.Curr.Y===i.Bot.Y&&et.WindDelta!==0&&et.OutIdx>=0&&et.Curr.Y>et.Top.Y&&t.ClipperBase.SlopesEqual3(i,et,this.m_UseFullRange)){var H=this.AddOutPt(et,i.Bot);this.AddJoin(T,H,i.Top)}}else i=this.UpdateEdgeIntoAEL(i);else i.OutIdx>=0&&this.AddOutPt(i,i.Top),this.DeleteFromAEL(i)},t.Clipper.prototype.GetNextInAEL=function(i,s){return s===t.Direction.dLeftToRight?i.NextInAEL:i.PrevInAEL},t.Clipper.prototype.IsMinima=function(i){return i!==null&&i.Prev.NextInLML!==i&&i.Next.NextInLML!==i},t.Clipper.prototype.IsMaxima=function(i,s){return i!==null&&i.Top.Y===s&&i.NextInLML===null},t.Clipper.prototype.IsIntermediate=function(i,s){return i.Top.Y===s&&i.NextInLML!==null},t.Clipper.prototype.GetMaximaPair=function(i){return t.IntPoint.op_Equality(i.Next.Top,i.Top)&&i.Next.NextInLML===null?i.Next:t.IntPoint.op_Equality(i.Prev.Top,i.Top)&&i.Prev.NextInLML===null?i.Prev:null},t.Clipper.prototype.GetMaximaPairEx=function(i){var s=this.GetMaximaPair(i);return s===null||s.OutIdx===t.ClipperBase.Skip||s.NextInAEL===s.PrevInAEL&&!t.ClipperBase.IsHorizontal(s)?null:s},t.Clipper.prototype.ProcessIntersections=function(i){if(this.m_ActiveEdges===null)return!0;try{if(this.BuildIntersectList(i),this.m_IntersectList.length===0)return!0;if(this.m_IntersectList.length===1||this.FixupIntersectionOrder())this.ProcessIntersectList();else return!1}catch{this.m_SortedEdges=null,this.m_IntersectList.length=0,t.Error("ProcessIntersections error")}return this.m_SortedEdges=null,!0},t.Clipper.prototype.BuildIntersectList=function(i){if(this.m_ActiveEdges!==null){var s=this.m_ActiveEdges;for(this.m_SortedEdges=s;s!==null;)s.PrevInSEL=s.PrevInAEL,s.NextInSEL=s.NextInAEL,s.Curr.X=t.Clipper.TopX(s,i),s=s.NextInAEL;for(var n=!0;n&&this.m_SortedEdges!==null;){for(n=!1,s=this.m_SortedEdges;s.NextInSEL!==null;){var a=s.NextInSEL,f=new t.IntPoint0;if(s.Curr.X>a.Curr.X){this.IntersectPoint(s,a,f),f.Y<i&&(f=new t.IntPoint2(t.Clipper.TopX(s,i),i));var d=new t.IntersectNode;d.Edge1=s,d.Edge2=a,d.Pt.X=f.X,d.Pt.Y=f.Y,t.use_xyz&&(d.Pt.Z=f.Z),this.m_IntersectList.push(d),this.SwapPositionsInSEL(s,a),n=!0}else s=a}if(s.PrevInSEL!==null)s.PrevInSEL.NextInSEL=null;else break}this.m_SortedEdges=null}},t.Clipper.prototype.EdgesAdjacent=function(i){return i.Edge1.NextInSEL===i.Edge2||i.Edge1.PrevInSEL===i.Edge2},t.Clipper.IntersectNodeSort=function(i,s){return s.Pt.Y-i.Pt.Y},t.Clipper.prototype.FixupIntersectionOrder=function(){this.m_IntersectList.sort(this.m_IntersectNodeComparer),this.CopyAELToSEL();for(var i=this.m_IntersectList.length,s=0;s<i;s++){if(!this.EdgesAdjacent(this.m_IntersectList[s])){for(var n=s+1;n<i&&!this.EdgesAdjacent(this.m_IntersectList[n]);)n++;if(n===i)return!1;var a=this.m_IntersectList[s];this.m_IntersectList[s]=this.m_IntersectList[n],this.m_IntersectList[n]=a}this.SwapPositionsInSEL(this.m_IntersectList[s].Edge1,this.m_IntersectList[s].Edge2)}return!0},t.Clipper.prototype.ProcessIntersectList=function(){for(var i=0,s=this.m_IntersectList.length;i<s;i++){var n=this.m_IntersectList[i];this.IntersectEdges(n.Edge1,n.Edge2,n.Pt),this.SwapPositionsInAEL(n.Edge1,n.Edge2)}this.m_IntersectList.length=0};var $r=function(i){return i<0?Math.ceil(i-.5):Math.round(i)},Qr=function(i){return i<0?Math.ceil(i-.5):Math.floor(i+.5)},tn=function(i){return i<0?-Math.round(Math.abs(i)):Math.round(i)},en=function(i){return i<0?(i-=.5,i<-2147483648?Math.ceil(i):i|0):(i+=.5,i>2147483647?Math.floor(i):i|0)};h.msie?t.Clipper.Round=$r:h.chromium?t.Clipper.Round=tn:h.safari?t.Clipper.Round=en:t.Clipper.Round=Qr,t.Clipper.TopX=function(i,s){return s===i.Top.Y?i.Top.X:i.Bot.X+t.Clipper.Round(i.Dx*(s-i.Bot.Y))},t.Clipper.prototype.IntersectPoint=function(i,s,n){n.X=0,n.Y=0;var a,f;if(i.Dx===s.Dx){n.Y=i.Curr.Y,n.X=t.Clipper.TopX(i,n.Y);return}if(i.Delta.X===0)n.X=i.Bot.X,t.ClipperBase.IsHorizontal(s)?n.Y=s.Bot.Y:(f=s.Bot.Y-s.Bot.X/s.Dx,n.Y=t.Clipper.Round(n.X/s.Dx+f));else if(s.Delta.X===0)n.X=s.Bot.X,t.ClipperBase.IsHorizontal(i)?n.Y=i.Bot.Y:(a=i.Bot.Y-i.Bot.X/i.Dx,n.Y=t.Clipper.Round(n.X/i.Dx+a));else{a=i.Bot.X-i.Bot.Y*i.Dx,f=s.Bot.X-s.Bot.Y*s.Dx;var d=(f-a)/(i.Dx-s.Dx);n.Y=t.Clipper.Round(d),Math.abs(i.Dx)<Math.abs(s.Dx)?n.X=t.Clipper.Round(i.Dx*d+a):n.X=t.Clipper.Round(s.Dx*d+f)}if(n.Y<i.Top.Y||n.Y<s.Top.Y){if(i.Top.Y>s.Top.Y)return n.Y=i.Top.Y,n.X=t.Clipper.TopX(s,i.Top.Y),n.X<i.Top.X;n.Y=s.Top.Y,Math.abs(i.Dx)<Math.abs(s.Dx)?n.X=t.Clipper.TopX(i,n.Y):n.X=t.Clipper.TopX(s,n.Y)}n.Y>i.Curr.Y&&(n.Y=i.Curr.Y,Math.abs(i.Dx)>Math.abs(s.Dx)?n.X=t.Clipper.TopX(s,n.Y):n.X=t.Clipper.TopX(i,n.Y))},t.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=function(i){for(var s=this.m_ActiveEdges;s!==null;){var n=this.IsMaxima(s,i);if(n){var a=this.GetMaximaPairEx(s);n=a===null||!t.ClipperBase.IsHorizontal(a)}if(n){this.StrictlySimple&&this.InsertMaxima(s.Top.X);var f=s.PrevInAEL;this.DoMaxima(s),f===null?s=this.m_ActiveEdges:s=f.NextInAEL}else{if(this.IsIntermediate(s,i)&&t.ClipperBase.IsHorizontal(s.NextInLML)?(s=this.UpdateEdgeIntoAEL(s),s.OutIdx>=0&&this.AddOutPt(s,s.Bot),this.AddEdgeToSEL(s)):(s.Curr.X=t.Clipper.TopX(s,i),s.Curr.Y=i),t.use_xyz&&(s.Top.Y===i?s.Curr.Z=s.Top.Z:s.Bot.Y===i?s.Curr.Z=s.Bot.Z:s.Curr.Z=0),this.StrictlySimple){var f=s.PrevInAEL;if(s.OutIdx>=0&&s.WindDelta!==0&&f!==null&&f.OutIdx>=0&&f.Curr.X===s.Curr.X&&f.WindDelta!==0){var d=new t.IntPoint1(s.Curr);t.use_xyz&&this.SetZ(d,f,s);var m=this.AddOutPt(f,d),y=this.AddOutPt(s,d);this.AddJoin(m,y,d)}}s=s.NextInAEL}}for(this.ProcessHorizontals(),this.m_Maxima=null,s=this.m_ActiveEdges;s!==null;){if(this.IsIntermediate(s,i)){var m=null;s.OutIdx>=0&&(m=this.AddOutPt(s,s.Top)),s=this.UpdateEdgeIntoAEL(s);var f=s.PrevInAEL,v=s.NextInAEL;if(f!==null&&f.Curr.X===s.Bot.X&&f.Curr.Y===s.Bot.Y&&m!==null&&f.OutIdx>=0&&f.Curr.Y===f.Top.Y&&t.ClipperBase.SlopesEqual5(s.Curr,s.Top,f.Curr,f.Top,this.m_UseFullRange)&&s.WindDelta!==0&&f.WindDelta!==0){var y=this.AddOutPt(ePrev2,s.Bot);this.AddJoin(m,y,s.Top)}else if(v!==null&&v.Curr.X===s.Bot.X&&v.Curr.Y===s.Bot.Y&&m!==null&&v.OutIdx>=0&&v.Curr.Y===v.Top.Y&&t.ClipperBase.SlopesEqual5(s.Curr,s.Top,v.Curr,v.Top,this.m_UseFullRange)&&s.WindDelta!==0&&v.WindDelta!==0){var y=this.AddOutPt(v,s.Bot);this.AddJoin(m,y,s.Top)}}s=s.NextInAEL}},t.Clipper.prototype.DoMaxima=function(i){var s=this.GetMaximaPairEx(i);if(s===null){i.OutIdx>=0&&this.AddOutPt(i,i.Top),this.DeleteFromAEL(i);return}for(var n=i.NextInAEL;n!==null&&n!==s;)this.IntersectEdges(i,n,i.Top),this.SwapPositionsInAEL(i,n),n=i.NextInAEL;i.OutIdx===-1&&s.OutIdx===-1?(this.DeleteFromAEL(i),this.DeleteFromAEL(s)):i.OutIdx>=0&&s.OutIdx>=0?(i.OutIdx>=0&&this.AddLocalMaxPoly(i,s,i.Top),this.DeleteFromAEL(i),this.DeleteFromAEL(s)):t.use_lines&&i.WindDelta===0?(i.OutIdx>=0&&(this.AddOutPt(i,i.Top),i.OutIdx=t.ClipperBase.Unassigned),this.DeleteFromAEL(i),s.OutIdx>=0&&(this.AddOutPt(s,i.Top),s.OutIdx=t.ClipperBase.Unassigned),this.DeleteFromAEL(s)):t.Error("DoMaxima error")},t.Clipper.ReversePaths=function(i){for(var s=0,n=i.length;s<n;s++)i[s].reverse()},t.Clipper.Orientation=function(i){return t.Clipper.Area(i)>=0},t.Clipper.prototype.PointCount=function(i){if(i===null)return 0;var s=0,n=i;do s++,n=n.Next;while(n!==i);return s},t.Clipper.prototype.BuildResult=function(i){t.Clear(i);for(var s=0,n=this.m_PolyOuts.length;s<n;s++){var a=this.m_PolyOuts[s];if(a.Pts!==null){var f=a.Pts.Prev,d=this.PointCount(f);if(!(d<2)){for(var m=new Array(d),y=0;y<d;y++)m[y]=f.Pt,f=f.Prev;i.push(m)}}}},t.Clipper.prototype.BuildResult2=function(i){i.Clear();for(var s=0,n=this.m_PolyOuts.length;s<n;s++){var a=this.m_PolyOuts[s],f=this.PointCount(a.Pts);if(!(a.IsOpen&&f<2||!a.IsOpen&&f<3)){this.FixHoleLinkage(a);var d=new t.PolyNode;i.m_AllPolys.push(d),a.PolyNode=d,d.m_polygon.length=f;for(var m=a.Pts.Prev,y=0;y<f;y++)d.m_polygon[y]=m.Pt,m=m.Prev}}for(var s=0,n=this.m_PolyOuts.length;s<n;s++){var a=this.m_PolyOuts[s];a.PolyNode!==null&&(a.IsOpen?(a.PolyNode.IsOpen=!0,i.AddChild(a.PolyNode)):a.FirstLeft!==null&&a.FirstLeft.PolyNode!==null?a.FirstLeft.PolyNode.AddChild(a.PolyNode):i.AddChild(a.PolyNode))}},t.Clipper.prototype.FixupOutPolyline=function(i){for(var s=i.Pts,n=s.Prev;s!==n;)if(s=s.Next,t.IntPoint.op_Equality(s.Pt,s.Prev.Pt)){s===n&&(n=s.Prev);var a=s.Prev;a.Next=s.Next,s.Next.Prev=a,s=a}s===s.Prev&&(i.Pts=null)},t.Clipper.prototype.FixupOutPolygon=function(i){var s=null;i.BottomPt=null;for(var n=i.Pts,a=this.PreserveCollinear||this.StrictlySimple;;){if(n.Prev===n||n.Prev===n.Next){i.Pts=null;return}if(t.IntPoint.op_Equality(n.Pt,n.Next.Pt)||t.IntPoint.op_Equality(n.Pt,n.Prev.Pt)||t.ClipperBase.SlopesEqual4(n.Prev.Pt,n.Pt,n.Next.Pt,this.m_UseFullRange)&&(!a||!this.Pt2IsBetweenPt1AndPt3(n.Prev.Pt,n.Pt,n.Next.Pt)))s=null,n.Prev.Next=n.Next,n.Next.Prev=n.Prev,n=n.Prev;else{if(n===s)break;s===null&&(s=n),n=n.Next}}i.Pts=n},t.Clipper.prototype.DupOutPt=function(i,s){var n=new t.OutPt;return n.Pt.X=i.Pt.X,n.Pt.Y=i.Pt.Y,t.use_xyz&&(n.Pt.Z=i.Pt.Z),n.Idx=i.Idx,s?(n.Next=i.Next,n.Prev=i,i.Next.Prev=n,i.Next=n):(n.Prev=i.Prev,n.Next=i,i.Prev.Next=n,i.Prev=n),n},t.Clipper.prototype.GetOverlap=function(i,s,n,a,f){return i<s?n<a?(f.Left=Math.max(i,n),f.Right=Math.min(s,a)):(f.Left=Math.max(i,a),f.Right=Math.min(s,n)):n<a?(f.Left=Math.max(s,n),f.Right=Math.min(i,a)):(f.Left=Math.max(s,a),f.Right=Math.min(i,n)),f.Left<f.Right},t.Clipper.prototype.JoinHorz=function(i,s,n,a,f,d){var m=i.Pt.X>s.Pt.X?t.Direction.dRightToLeft:t.Direction.dLeftToRight,y=n.Pt.X>a.Pt.X?t.Direction.dRightToLeft:t.Direction.dLeftToRight;if(m===y)return!1;if(m===t.Direction.dLeftToRight){for(;i.Next.Pt.X<=f.X&&i.Next.Pt.X>=i.Pt.X&&i.Next.Pt.Y===f.Y;)i=i.Next;d&&i.Pt.X!==f.X&&(i=i.Next),s=this.DupOutPt(i,!d),t.IntPoint.op_Inequality(s.Pt,f)&&(i=s,i.Pt.X=f.X,i.Pt.Y=f.Y,t.use_xyz&&(i.Pt.Z=f.Z),s=this.DupOutPt(i,!d))}else{for(;i.Next.Pt.X>=f.X&&i.Next.Pt.X<=i.Pt.X&&i.Next.Pt.Y===f.Y;)i=i.Next;!d&&i.Pt.X!==f.X&&(i=i.Next),s=this.DupOutPt(i,d),t.IntPoint.op_Inequality(s.Pt,f)&&(i=s,i.Pt.X=f.X,i.Pt.Y=f.Y,t.use_xyz&&(i.Pt.Z=f.Z),s=this.DupOutPt(i,d))}if(y===t.Direction.dLeftToRight){for(;n.Next.Pt.X<=f.X&&n.Next.Pt.X>=n.Pt.X&&n.Next.Pt.Y===f.Y;)n=n.Next;d&&n.Pt.X!==f.X&&(n=n.Next),a=this.DupOutPt(n,!d),t.IntPoint.op_Inequality(a.Pt,f)&&(n=a,n.Pt.X=f.X,n.Pt.Y=f.Y,t.use_xyz&&(n.Pt.Z=f.Z),a=this.DupOutPt(n,!d))}else{for(;n.Next.Pt.X>=f.X&&n.Next.Pt.X<=n.Pt.X&&n.Next.Pt.Y===f.Y;)n=n.Next;!d&&n.Pt.X!==f.X&&(n=n.Next),a=this.DupOutPt(n,d),t.IntPoint.op_Inequality(a.Pt,f)&&(n=a,n.Pt.X=f.X,n.Pt.Y=f.Y,t.use_xyz&&(n.Pt.Z=f.Z),a=this.DupOutPt(n,d))}return m===t.Direction.dLeftToRight===d?(i.Prev=n,n.Next=i,s.Next=a,a.Prev=s):(i.Next=n,n.Prev=i,s.Prev=a,a.Next=s),!0},t.Clipper.prototype.JoinPoints=function(i,s,n){var a=i.OutPt1,f=new t.OutPt,d=i.OutPt2,m=new t.OutPt,y=i.OutPt1.Pt.Y===i.OffPt.Y;if(y&&t.IntPoint.op_Equality(i.OffPt,i.OutPt1.Pt)&&t.IntPoint.op_Equality(i.OffPt,i.OutPt2.Pt)){if(s!==n)return!1;for(f=i.OutPt1.Next;f!==a&&t.IntPoint.op_Equality(f.Pt,i.OffPt);)f=f.Next;var v=f.Pt.Y>i.OffPt.Y;for(m=i.OutPt2.Next;m!==d&&t.IntPoint.op_Equality(m.Pt,i.OffPt);)m=m.Next;var T=m.Pt.Y>i.OffPt.Y;return v===T?!1:v?(f=this.DupOutPt(a,!1),m=this.DupOutPt(d,!0),a.Prev=d,d.Next=a,f.Next=m,m.Prev=f,i.OutPt1=a,i.OutPt2=f,!0):(f=this.DupOutPt(a,!0),m=this.DupOutPt(d,!1),a.Next=d,d.Prev=a,f.Prev=m,m.Next=f,i.OutPt1=a,i.OutPt2=f,!0)}else if(y){for(f=a;a.Prev.Pt.Y===a.Pt.Y&&a.Prev!==f&&a.Prev!==d;)a=a.Prev;for(;f.Next.Pt.Y===f.Pt.Y&&f.Next!==a&&f.Next!==d;)f=f.Next;if(f.Next===a||f.Next===d)return!1;for(m=d;d.Prev.Pt.Y===d.Pt.Y&&d.Prev!==m&&d.Prev!==f;)d=d.Prev;for(;m.Next.Pt.Y===m.Pt.Y&&m.Next!==d&&m.Next!==a;)m=m.Next;if(m.Next===d||m.Next===a)return!1;var N={Left:null,Right:null};if(!this.GetOverlap(a.Pt.X,f.Pt.X,d.Pt.X,m.Pt.X,N))return!1;var E=N.Left,B=N.Right,H=new t.IntPoint0,tt;return a.Pt.X>=E&&a.Pt.X<=B?(H.X=a.Pt.X,H.Y=a.Pt.Y,t.use_xyz&&(H.Z=a.Pt.Z),tt=a.Pt.X>f.Pt.X):d.Pt.X>=E&&d.Pt.X<=B?(H.X=d.Pt.X,H.Y=d.Pt.Y,t.use_xyz&&(H.Z=d.Pt.Z),tt=d.Pt.X>m.Pt.X):f.Pt.X>=E&&f.Pt.X<=B?(H.X=f.Pt.X,H.Y=f.Pt.Y,t.use_xyz&&(H.Z=f.Pt.Z),tt=f.Pt.X>a.Pt.X):(H.X=m.Pt.X,H.Y=m.Pt.Y,t.use_xyz&&(H.Z=m.Pt.Z),tt=m.Pt.X>d.Pt.X),i.OutPt1=a,i.OutPt2=d,this.JoinHorz(a,f,d,m,H,tt)}else{for(f=a.Next;t.IntPoint.op_Equality(f.Pt,a.Pt)&&f!==a;)f=f.Next;var et=f.Pt.Y>a.Pt.Y||!t.ClipperBase.SlopesEqual4(a.Pt,f.Pt,i.OffPt,this.m_UseFullRange);if(et){for(f=a.Prev;t.IntPoint.op_Equality(f.Pt,a.Pt)&&f!==a;)f=f.Prev;if(f.Pt.Y>a.Pt.Y||!t.ClipperBase.SlopesEqual4(a.Pt,f.Pt,i.OffPt,this.m_UseFullRange))return!1}for(m=d.Next;t.IntPoint.op_Equality(m.Pt,d.Pt)&&m!==d;)m=m.Next;var lt=m.Pt.Y>d.Pt.Y||!t.ClipperBase.SlopesEqual4(d.Pt,m.Pt,i.OffPt,this.m_UseFullRange);if(lt){for(m=d.Prev;t.IntPoint.op_Equality(m.Pt,d.Pt)&&m!==d;)m=m.Prev;if(m.Pt.Y>d.Pt.Y||!t.ClipperBase.SlopesEqual4(d.Pt,m.Pt,i.OffPt,this.m_UseFullRange))return!1}return f===a||m===d||f===m||s===n&&et===lt?!1:et?(f=this.DupOutPt(a,!1),m=this.DupOutPt(d,!0),a.Prev=d,d.Next=a,f.Next=m,m.Prev=f,i.OutPt1=a,i.OutPt2=f,!0):(f=this.DupOutPt(a,!0),m=this.DupOutPt(d,!1),a.Next=d,d.Prev=a,f.Prev=m,m.Next=f,i.OutPt1=a,i.OutPt2=f,!0)}},t.Clipper.GetBounds=function(i){for(var s=0,n=i.length;s<n&&i[s].length===0;)s++;if(s===n)return new t.IntRect(0,0,0,0);var a=new t.IntRect;for(a.left=i[s][0].X,a.right=a.left,a.top=i[s][0].Y,a.bottom=a.top;s<n;s++)for(var f=0,d=i[s].length;f<d;f++)i[s][f].X<a.left?a.left=i[s][f].X:i[s][f].X>a.right&&(a.right=i[s][f].X),i[s][f].Y<a.top?a.top=i[s][f].Y:i[s][f].Y>a.bottom&&(a.bottom=i[s][f].Y);return a},t.Clipper.prototype.GetBounds2=function(i){var s=i,n=new t.IntRect;for(n.left=i.Pt.X,n.right=i.Pt.X,n.top=i.Pt.Y,n.bottom=i.Pt.Y,i=i.Next;i!==s;)i.Pt.X<n.left&&(n.left=i.Pt.X),i.Pt.X>n.right&&(n.right=i.Pt.X),i.Pt.Y<n.top&&(n.top=i.Pt.Y),i.Pt.Y>n.bottom&&(n.bottom=i.Pt.Y),i=i.Next;return n},t.Clipper.PointInPolygon=function(i,s){var n=0,a=s.length;if(a<3)return 0;for(var f=s[0],d=1;d<=a;++d){var m=d===a?s[0]:s[d];if(m.Y===i.Y&&(m.X===i.X||f.Y===i.Y&&m.X>i.X==f.X<i.X))return-1;if(f.Y<i.Y!=m.Y<i.Y){if(f.X>=i.X)if(m.X>i.X)n=1-n;else{var y=(f.X-i.X)*(m.Y-i.Y)-(m.X-i.X)*(f.Y-i.Y);if(y===0)return-1;y>0==m.Y>f.Y&&(n=1-n)}else if(m.X>i.X){var y=(f.X-i.X)*(m.Y-i.Y)-(m.X-i.X)*(f.Y-i.Y);if(y===0)return-1;y>0==m.Y>f.Y&&(n=1-n)}}f=m}return n},t.Clipper.prototype.PointInPolygon=function(i,s){var n=0,a=s,f=i.X,d=i.Y,m=s.Pt.X,y=s.Pt.Y;do{s=s.Next;var v=s.Pt.X,T=s.Pt.Y;if(T===d&&(v===f||y===d&&v>f==m<f))return-1;if(y<d!=T<d){if(m>=f)if(v>f)n=1-n;else{var N=(m-f)*(T-d)-(v-f)*(y-d);if(N===0)return-1;N>0==T>y&&(n=1-n)}else if(v>f){var N=(m-f)*(T-d)-(v-f)*(y-d);if(N===0)return-1;N>0==T>y&&(n=1-n)}}m=v,y=T}while(a!==s);return n},t.Clipper.prototype.Poly2ContainsPoly1=function(i,s){var n=i;do{var a=this.PointInPolygon(n.Pt,s);if(a>=0)return a>0;n=n.Next}while(n!==i);return!0},t.Clipper.prototype.FixupFirstLefts1=function(i,s){for(var n,a,f=0,d=this.m_PolyOuts.length;f<d;f++)n=this.m_PolyOuts[f],a=t.Clipper.ParseFirstLeft(n.FirstLeft),n.Pts!==null&&a===i&&this.Poly2ContainsPoly1(n.Pts,s.Pts)&&(n.FirstLeft=s)},t.Clipper.prototype.FixupFirstLefts2=function(i,s){for(var n=s.FirstLeft,a,f,d=0,m=this.m_PolyOuts.length;d<m;d++)a=this.m_PolyOuts[d],!(a.Pts===null||a===s||a===i)&&(f=t.Clipper.ParseFirstLeft(a.FirstLeft),!(f!==n&&f!==i&&f!==s)&&(this.Poly2ContainsPoly1(a.Pts,i.Pts)?a.FirstLeft=i:this.Poly2ContainsPoly1(a.Pts,s.Pts)?a.FirstLeft=s:(a.FirstLeft===i||a.FirstLeft===s)&&(a.FirstLeft=n)))},t.Clipper.prototype.FixupFirstLefts3=function(i,s){for(var n,a,f=0,d=this.m_PolyOuts.length;f<d;f++)n=this.m_PolyOuts[f],a=t.Clipper.ParseFirstLeft(n.FirstLeft),n.Pts!==null&&a===i&&(n.FirstLeft=s)},t.Clipper.ParseFirstLeft=function(i){for(;i!==null&&i.Pts===null;)i=i.FirstLeft;return i},t.Clipper.prototype.JoinCommonEdges=function(){for(var i=0,s=this.m_Joins.length;i<s;i++){var n=this.m_Joins[i],a=this.GetOutRec(n.OutPt1.Idx),f=this.GetOutRec(n.OutPt2.Idx);if(!(a.Pts===null||f.Pts===null)&&!(a.IsOpen||f.IsOpen)){var d;a===f?d=a:this.OutRec1RightOfOutRec2(a,f)?d=f:this.OutRec1RightOfOutRec2(f,a)?d=a:d=this.GetLowermostRec(a,f),this.JoinPoints(n,a,f)&&(a===f?(a.Pts=n.OutPt1,a.BottomPt=null,f=this.CreateOutRec(),f.Pts=n.OutPt2,this.UpdateOutPtIdxs(f),this.Poly2ContainsPoly1(f.Pts,a.Pts)?(f.IsHole=!a.IsHole,f.FirstLeft=a,this.m_UsingPolyTree&&this.FixupFirstLefts2(f,a),(f.IsHole^this.ReverseSolution)==this.Area$1(f)>0&&this.ReversePolyPtLinks(f.Pts)):this.Poly2ContainsPoly1(a.Pts,f.Pts)?(f.IsHole=a.IsHole,a.IsHole=!f.IsHole,f.FirstLeft=a.FirstLeft,a.FirstLeft=f,this.m_UsingPolyTree&&this.FixupFirstLefts2(a,f),(a.IsHole^this.ReverseSolution)==this.Area$1(a)>0&&this.ReversePolyPtLinks(a.Pts)):(f.IsHole=a.IsHole,f.FirstLeft=a.FirstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(a,f))):(f.Pts=null,f.BottomPt=null,f.Idx=a.Idx,a.IsHole=d.IsHole,d===f&&(a.FirstLeft=f.FirstLeft),f.FirstLeft=a,this.m_UsingPolyTree&&this.FixupFirstLefts3(f,a)))}}},t.Clipper.prototype.UpdateOutPtIdxs=function(i){var s=i.Pts;do s.Idx=i.Idx,s=s.Prev;while(s!==i.Pts)},t.Clipper.prototype.DoSimplePolygons=function(){for(var i=0;i<this.m_PolyOuts.length;){var s=this.m_PolyOuts[i++],n=s.Pts;if(!(n===null||s.IsOpen))do{for(var a=n.Next;a!==s.Pts;){if(t.IntPoint.op_Equality(n.Pt,a.Pt)&&a.Next!==n&&a.Prev!==n){var f=n.Prev,d=a.Prev;n.Prev=d,d.Next=n,a.Prev=f,f.Next=a,s.Pts=n;var m=this.CreateOutRec();m.Pts=a,this.UpdateOutPtIdxs(m),this.Poly2ContainsPoly1(m.Pts,s.Pts)?(m.IsHole=!s.IsHole,m.FirstLeft=s,this.m_UsingPolyTree&&this.FixupFirstLefts2(m,s)):this.Poly2ContainsPoly1(s.Pts,m.Pts)?(m.IsHole=s.IsHole,s.IsHole=!m.IsHole,m.FirstLeft=s.FirstLeft,s.FirstLeft=m,this.m_UsingPolyTree&&this.FixupFirstLefts2(s,m)):(m.IsHole=s.IsHole,m.FirstLeft=s.FirstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(s,m)),a=n}a=a.Next}n=n.Next}while(n!==s.Pts)}},t.Clipper.Area=function(i){if(!Array.isArray(i))return 0;var s=i.length;if(s<3)return 0;for(var n=0,a=0,f=s-1;a<s;++a)n+=(i[f].X+i[a].X)*(i[f].Y-i[a].Y),f=a;return-n*.5},t.Clipper.prototype.Area=function(i){var s=i;if(i===null)return 0;var n=0;do n=n+(i.Prev.Pt.X+i.Pt.X)*(i.Prev.Pt.Y-i.Pt.Y),i=i.Next;while(i!==s);return n*.5},t.Clipper.prototype.Area$1=function(i){return this.Area(i.Pts)},t.Clipper.SimplifyPolygon=function(i,s){var n=new Array,a=new t.Clipper(0);return a.StrictlySimple=!0,a.AddPath(i,t.PolyType.ptSubject,!0),a.Execute(t.ClipType.ctUnion,n,s,s),n},t.Clipper.SimplifyPolygons=function(i,s){typeof s>"u"&&(s=t.PolyFillType.pftEvenOdd);var n=new Array,a=new t.Clipper(0);return a.StrictlySimple=!0,a.AddPaths(i,t.PolyType.ptSubject,!0),a.Execute(t.ClipType.ctUnion,n,s,s),n},t.Clipper.DistanceSqrd=function(i,s){var n=i.X-s.X,a=i.Y-s.Y;return n*n+a*a},t.Clipper.DistanceFromLineSqrd=function(i,s,n){var a=s.Y-n.Y,f=n.X-s.X,d=a*s.X+f*s.Y;return d=a*i.X+f*i.Y-d,d*d/(a*a+f*f)},t.Clipper.SlopesNearCollinear=function(i,s,n,a){return Math.abs(i.X-s.X)>Math.abs(i.Y-s.Y)?i.X>s.X==i.X<n.X?t.Clipper.DistanceFromLineSqrd(i,s,n)<a:s.X>i.X==s.X<n.X?t.Clipper.DistanceFromLineSqrd(s,i,n)<a:t.Clipper.DistanceFromLineSqrd(n,i,s)<a:i.Y>s.Y==i.Y<n.Y?t.Clipper.DistanceFromLineSqrd(i,s,n)<a:s.Y>i.Y==s.Y<n.Y?t.Clipper.DistanceFromLineSqrd(s,i,n)<a:t.Clipper.DistanceFromLineSqrd(n,i,s)<a},t.Clipper.PointsAreClose=function(i,s,n){var a=i.X-s.X,f=i.Y-s.Y;return a*a+f*f<=n},t.Clipper.ExcludeOp=function(i){var s=i.Prev;return s.Next=i.Next,i.Next.Prev=s,s.Idx=0,s},t.Clipper.CleanPolygon=function(i,s){typeof s>"u"&&(s=1.415);var n=i.length;if(n===0)return new Array;for(var a=new Array(n),f=0;f<n;++f)a[f]=new t.OutPt;for(var f=0;f<n;++f)a[f].Pt=i[f],a[f].Next=a[(f+1)%n],a[f].Next.Prev=a[f],a[f].Idx=0;for(var d=s*s,m=a[0];m.Idx===0&&m.Next!==m.Prev;)t.Clipper.PointsAreClose(m.Pt,m.Prev.Pt,d)?(m=t.Clipper.ExcludeOp(m),n--):t.Clipper.PointsAreClose(m.Prev.Pt,m.Next.Pt,d)?(t.Clipper.ExcludeOp(m.Next),m=t.Clipper.ExcludeOp(m),n-=2):t.Clipper.SlopesNearCollinear(m.Prev.Pt,m.Pt,m.Next.Pt,d)?(m=t.Clipper.ExcludeOp(m),n--):(m.Idx=1,m=m.Next);n<3&&(n=0);for(var y=new Array(n),f=0;f<n;++f)y[f]=new t.IntPoint1(m.Pt),m=m.Next;return a=null,y},t.Clipper.CleanPolygons=function(i,s){for(var n=new Array(i.length),a=0,f=i.length;a<f;a++)n[a]=t.Clipper.CleanPolygon(i[a],s);return n},t.Clipper.Minkowski=function(i,s,n,a){var f=a?1:0,d=i.length,m=s.length,y=new Array;if(n)for(var v=0;v<m;v++){for(var T=new Array(d),N=0,E=i.length,B=i[N];N<E;N++,B=i[N])T[N]=new t.IntPoint2(s[v].X+B.X,s[v].Y+B.Y);y.push(T)}else for(var v=0;v<m;v++){for(var T=new Array(d),N=0,E=i.length,B=i[N];N<E;N++,B=i[N])T[N]=new t.IntPoint2(s[v].X-B.X,s[v].Y-B.Y);y.push(T)}for(var H=new Array,v=0;v<m-1+f;v++)for(var N=0;N<d;N++){var tt=new Array;tt.push(y[v%m][N%d]),tt.push(y[(v+1)%m][N%d]),tt.push(y[(v+1)%m][(N+1)%d]),tt.push(y[v%m][(N+1)%d]),t.Clipper.Orientation(tt)||tt.reverse(),H.push(tt)}return H},t.Clipper.MinkowskiSum=function(i,s,n){if(s[0]instanceof Array){for(var f=s,m=new t.Paths,d=new t.Clipper,y=0;y<f.length;++y){var v=t.Clipper.Minkowski(i,f[y],!0,n);if(d.AddPaths(v,t.PolyType.ptSubject,!0),n){var a=t.Clipper.TranslatePath(f[y],i[0]);d.AddPath(a,t.PolyType.ptClip,!0)}}return d.Execute(t.ClipType.ctUnion,m,t.PolyFillType.pftNonZero,t.PolyFillType.pftNonZero),m}else{var a=s,f=t.Clipper.Minkowski(i,a,!0,n),d=new t.Clipper;return d.AddPaths(f,t.PolyType.ptSubject,!0),d.Execute(t.ClipType.ctUnion,f,t.PolyFillType.pftNonZero,t.PolyFillType.pftNonZero),f}},t.Clipper.TranslatePath=function(i,s){for(var n=new t.Path,a=0;a<i.length;a++)n.push(new t.IntPoint2(i[a].X+s.X,i[a].Y+s.Y));return n},t.Clipper.MinkowskiDiff=function(i,s){var n=t.Clipper.Minkowski(i,s,!1,!0),a=new t.Clipper;return a.AddPaths(n,t.PolyType.ptSubject,!0),a.Execute(t.ClipType.ctUnion,n,t.PolyFillType.pftNonZero,t.PolyFillType.pftNonZero),n},t.Clipper.PolyTreeToPaths=function(i){var s=new Array;return t.Clipper.AddPolyNodeToPaths(i,t.Clipper.NodeType.ntAny,s),s},t.Clipper.AddPolyNodeToPaths=function(i,s,n){var a=!0;switch(s){case t.Clipper.NodeType.ntOpen:return;case t.Clipper.NodeType.ntClosed:a=!i.IsOpen;break}i.m_polygon.length>0&&a&&n.push(i.m_polygon);for(var f=0,d=i.Childs(),m=d.length,y=d[f];f<m;f++,y=d[f])t.Clipper.AddPolyNodeToPaths(y,s,n)},t.Clipper.OpenPathsFromPolyTree=function(i){for(var s=new t.Paths,n=0,a=i.ChildCount();n<a;n++)i.Childs()[n].IsOpen&&s.push(i.Childs()[n].m_polygon);return s},t.Clipper.ClosedPathsFromPolyTree=function(i){var s=new t.Paths;return t.Clipper.AddPolyNodeToPaths(i,t.Clipper.NodeType.ntClosed,s),s},bi(t.Clipper,t.ClipperBase),t.Clipper.NodeType={ntAny:0,ntOpen:1,ntClosed:2},t.ClipperOffset=function(i,s){typeof i>"u"&&(i=2),typeof s>"u"&&(s=t.ClipperOffset.def_arc_tolerance),this.m_destPolys=new t.Paths,this.m_srcPoly=new t.Path,this.m_destPoly=new t.Path,this.m_normals=new Array,this.m_delta=0,this.m_sinA=0,this.m_sin=0,this.m_cos=0,this.m_miterLim=0,this.m_StepsPerRad=0,this.m_lowest=new t.IntPoint0,this.m_polyNodes=new t.PolyNode,this.MiterLimit=i,this.ArcTolerance=s,this.m_lowest.X=-1},t.ClipperOffset.two_pi=6.28318530717959,t.ClipperOffset.def_arc_tolerance=.25,t.ClipperOffset.prototype.Clear=function(){t.Clear(this.m_polyNodes.Childs()),this.m_lowest.X=-1},t.ClipperOffset.Round=t.Clipper.Round,t.ClipperOffset.prototype.AddPath=function(i,s,n){var a=i.length-1;if(!(a<0)){var f=new t.PolyNode;if(f.m_jointype=s,f.m_endtype=n,n===t.EndType.etClosedLine||n===t.EndType.etClosedPolygon)for(;a>0&&t.IntPoint.op_Equality(i[0],i[a]);)a--;f.m_polygon.push(i[0]);for(var d=0,m=0,y=1;y<=a;y++)t.IntPoint.op_Inequality(f.m_polygon[d],i[y])&&(d++,f.m_polygon.push(i[y]),(i[y].Y>f.m_polygon[m].Y||i[y].Y===f.m_polygon[m].Y&&i[y].X<f.m_polygon[m].X)&&(m=d));if(!(n===t.EndType.etClosedPolygon&&d<2)&&(this.m_polyNodes.AddChild(f),n===t.EndType.etClosedPolygon))if(this.m_lowest.X<0)this.m_lowest=new t.IntPoint2(this.m_polyNodes.ChildCount()-1,m);else{var v=this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon[this.m_lowest.Y];(f.m_polygon[m].Y>v.Y||f.m_polygon[m].Y===v.Y&&f.m_polygon[m].X<v.X)&&(this.m_lowest=new t.IntPoint2(this.m_polyNodes.ChildCount()-1,m))}}},t.ClipperOffset.prototype.AddPaths=function(i,s,n){for(var a=0,f=i.length;a<f;a++)this.AddPath(i[a],s,n)},t.ClipperOffset.prototype.FixOrientations=function(){if(this.m_lowest.X>=0&&!t.Clipper.Orientation(this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon))for(var i=0;i<this.m_polyNodes.ChildCount();i++){var s=this.m_polyNodes.Childs()[i];(s.m_endtype===t.EndType.etClosedPolygon||s.m_endtype===t.EndType.etClosedLine&&t.Clipper.Orientation(s.m_polygon))&&s.m_polygon.reverse()}else for(var i=0;i<this.m_polyNodes.ChildCount();i++){var s=this.m_polyNodes.Childs()[i];s.m_endtype===t.EndType.etClosedLine&&!t.Clipper.Orientation(s.m_polygon)&&s.m_polygon.reverse()}},t.ClipperOffset.GetUnitNormal=function(i,s){var n=s.X-i.X,a=s.Y-i.Y;if(n===0&&a===0)return new t.DoublePoint2(0,0);var f=1/Math.sqrt(n*n+a*a);return n*=f,a*=f,new t.DoublePoint2(a,-n)},t.ClipperOffset.prototype.DoOffset=function(i){if(this.m_destPolys=new Array,this.m_delta=i,t.ClipperBase.near_zero(i)){for(var s=0;s<this.m_polyNodes.ChildCount();s++){var n=this.m_polyNodes.Childs()[s];n.m_endtype===t.EndType.etClosedPolygon&&this.m_destPolys.push(n.m_polygon)}return}this.MiterLimit>2?this.m_miterLim=2/(this.MiterLimit*this.MiterLimit):this.m_miterLim=.5;var a;this.ArcTolerance<=0?a=t.ClipperOffset.def_arc_tolerance:this.ArcTolerance>Math.abs(i)*t.ClipperOffset.def_arc_tolerance?a=Math.abs(i)*t.ClipperOffset.def_arc_tolerance:a=this.ArcTolerance;var f=3.14159265358979/Math.acos(1-a/Math.abs(i));this.m_sin=Math.sin(t.ClipperOffset.two_pi/f),this.m_cos=Math.cos(t.ClipperOffset.two_pi/f),this.m_StepsPerRad=f/t.ClipperOffset.two_pi,i<0&&(this.m_sin=-this.m_sin);for(var s=0;s<this.m_polyNodes.ChildCount();s++){var n=this.m_polyNodes.Childs()[s];this.m_srcPoly=n.m_polygon;var d=this.m_srcPoly.length;if(!(d===0||i<=0&&(d<3||n.m_endtype!==t.EndType.etClosedPolygon))){if(this.m_destPoly=new Array,d===1){if(n.m_jointype===t.JoinType.jtRound)for(var m=1,y=0,v=1;v<=f;v++){this.m_destPoly.push(new t.IntPoint2(t.ClipperOffset.Round(this.m_srcPoly[0].X+m*i),t.ClipperOffset.Round(this.m_srcPoly[0].Y+y*i)));var T=m;m=m*this.m_cos-this.m_sin*y,y=T*this.m_sin+y*this.m_cos}else for(var m=-1,y=-1,v=0;v<4;++v)this.m_destPoly.push(new t.IntPoint2(t.ClipperOffset.Round(this.m_srcPoly[0].X+m*i),t.ClipperOffset.Round(this.m_srcPoly[0].Y+y*i))),m<0?m=1:y<0?y=1:m=-1;this.m_destPolys.push(this.m_destPoly);continue}this.m_normals.length=0;for(var v=0;v<d-1;v++)this.m_normals.push(t.ClipperOffset.GetUnitNormal(this.m_srcPoly[v],this.m_srcPoly[v+1]));if(n.m_endtype===t.EndType.etClosedLine||n.m_endtype===t.EndType.etClosedPolygon?this.m_normals.push(t.ClipperOffset.GetUnitNormal(this.m_srcPoly[d-1],this.m_srcPoly[0])):this.m_normals.push(new t.DoublePoint1(this.m_normals[d-2])),n.m_endtype===t.EndType.etClosedPolygon){for(var N=d-1,v=0;v<d;v++)N=this.OffsetPoint(v,N,n.m_jointype);this.m_destPolys.push(this.m_destPoly)}else if(n.m_endtype===t.EndType.etClosedLine){for(var N=d-1,v=0;v<d;v++)N=this.OffsetPoint(v,N,n.m_jointype);this.m_destPolys.push(this.m_destPoly),this.m_destPoly=new Array;for(var E=this.m_normals[d-1],v=d-1;v>0;v--)this.m_normals[v]=new t.DoublePoint2(-this.m_normals[v-1].X,-this.m_normals[v-1].Y);this.m_normals[0]=new t.DoublePoint2(-E.X,-E.Y),N=0;for(var v=d-1;v>=0;v--)N=this.OffsetPoint(v,N,n.m_jointype);this.m_destPolys.push(this.m_destPoly)}else{for(var N=0,v=1;v<d-1;++v)N=this.OffsetPoint(v,N,n.m_jointype);var B;if(n.m_endtype===t.EndType.etOpenButt){var v=d-1;B=new t.IntPoint2(t.ClipperOffset.Round(this.m_srcPoly[v].X+this.m_normals[v].X*i),t.ClipperOffset.Round(this.m_srcPoly[v].Y+this.m_normals[v].Y*i)),this.m_destPoly.push(B),B=new t.IntPoint2(t.ClipperOffset.Round(this.m_srcPoly[v].X-this.m_normals[v].X*i),t.ClipperOffset.Round(this.m_srcPoly[v].Y-this.m_normals[v].Y*i)),this.m_destPoly.push(B)}else{var v=d-1;N=d-2,this.m_sinA=0,this.m_normals[v]=new t.DoublePoint2(-this.m_normals[v].X,-this.m_normals[v].Y),n.m_endtype===t.EndType.etOpenSquare?this.DoSquare(v,N):this.DoRound(v,N)}for(var v=d-1;v>0;v--)this.m_normals[v]=new t.DoublePoint2(-this.m_normals[v-1].X,-this.m_normals[v-1].Y);this.m_normals[0]=new t.DoublePoint2(-this.m_normals[1].X,-this.m_normals[1].Y),N=d-1;for(var v=N-1;v>0;--v)N=this.OffsetPoint(v,N,n.m_jointype);n.m_endtype===t.EndType.etOpenButt?(B=new t.IntPoint2(t.ClipperOffset.Round(this.m_srcPoly[0].X-this.m_normals[0].X*i),t.ClipperOffset.Round(this.m_srcPoly[0].Y-this.m_normals[0].Y*i)),this.m_destPoly.push(B),B=new t.IntPoint2(t.ClipperOffset.Round(this.m_srcPoly[0].X+this.m_normals[0].X*i),t.ClipperOffset.Round(this.m_srcPoly[0].Y+this.m_normals[0].Y*i)),this.m_destPoly.push(B)):(N=1,this.m_sinA=0,n.m_endtype===t.EndType.etOpenSquare?this.DoSquare(0,1):this.DoRound(0,1)),this.m_destPolys.push(this.m_destPoly)}}}},t.ClipperOffset.prototype.Execute=function(){var i=arguments,s=i[0]instanceof t.PolyTree;if(s){var n=i[0],a=i[1];n.Clear(),this.FixOrientations(),this.DoOffset(a);var f=new t.Clipper(0);if(f.AddPaths(this.m_destPolys,t.PolyType.ptSubject,!0),a>0)f.Execute(t.ClipType.ctUnion,n,t.PolyFillType.pftPositive,t.PolyFillType.pftPositive);else{var d=t.Clipper.GetBounds(this.m_destPolys),m=new t.Path;if(m.push(new t.IntPoint2(d.left-10,d.bottom+10)),m.push(new t.IntPoint2(d.right+10,d.bottom+10)),m.push(new t.IntPoint2(d.right+10,d.top-10)),m.push(new t.IntPoint2(d.left-10,d.top-10)),f.AddPath(m,t.PolyType.ptSubject,!0),f.ReverseSolution=!0,f.Execute(t.ClipType.ctUnion,n,t.PolyFillType.pftNegative,t.PolyFillType.pftNegative),n.ChildCount()===1&&n.Childs()[0].ChildCount()>0){var y=n.Childs()[0];n.Childs()[0]=y.Childs()[0],n.Childs()[0].m_Parent=n;for(var v=1;v<y.ChildCount();v++)n.AddChild(y.Childs()[v])}else n.Clear()}}else{var n=i[0],a=i[1];t.Clear(n),this.FixOrientations(),this.DoOffset(a);var f=new t.Clipper(0);if(f.AddPaths(this.m_destPolys,t.PolyType.ptSubject,!0),a>0)f.Execute(t.ClipType.ctUnion,n,t.PolyFillType.pftPositive,t.PolyFillType.pftPositive);else{var d=t.Clipper.GetBounds(this.m_destPolys),m=new t.Path;m.push(new t.IntPoint2(d.left-10,d.bottom+10)),m.push(new t.IntPoint2(d.right+10,d.bottom+10)),m.push(new t.IntPoint2(d.right+10,d.top-10)),m.push(new t.IntPoint2(d.left-10,d.top-10)),f.AddPath(m,t.PolyType.ptSubject,!0),f.ReverseSolution=!0,f.Execute(t.ClipType.ctUnion,n,t.PolyFillType.pftNegative,t.PolyFillType.pftNegative),n.length>0&&n.splice(0,1)}}},t.ClipperOffset.prototype.OffsetPoint=function(i,s,n){if(this.m_sinA=this.m_normals[s].X*this.m_normals[i].Y-this.m_normals[i].X*this.m_normals[s].Y,Math.abs(this.m_sinA*this.m_delta)<1){var a=this.m_normals[s].X*this.m_normals[i].X+this.m_normals[i].Y*this.m_normals[s].Y;if(a>0)return this.m_destPoly.push(new t.IntPoint2(t.ClipperOffset.Round(this.m_srcPoly[i].X+this.m_normals[s].X*this.m_delta),t.ClipperOffset.Round(this.m_srcPoly[i].Y+this.m_normals[s].Y*this.m_delta))),s}else this.m_sinA>1?this.m_sinA=1:this.m_sinA<-1&&(this.m_sinA=-1);if(this.m_sinA*this.m_delta<0)this.m_destPoly.push(new t.IntPoint2(t.ClipperOffset.Round(this.m_srcPoly[i].X+this.m_normals[s].X*this.m_delta),t.ClipperOffset.Round(this.m_srcPoly[i].Y+this.m_normals[s].Y*this.m_delta))),this.m_destPoly.push(new t.IntPoint1(this.m_srcPoly[i])),this.m_destPoly.push(new t.IntPoint2(t.ClipperOffset.Round(this.m_srcPoly[i].X+this.m_normals[i].X*this.m_delta),t.ClipperOffset.Round(this.m_srcPoly[i].Y+this.m_normals[i].Y*this.m_delta)));else switch(n){case t.JoinType.jtMiter:{var f=1+(this.m_normals[i].X*this.m_normals[s].X+this.m_normals[i].Y*this.m_normals[s].Y);f>=this.m_miterLim?this.DoMiter(i,s,f):this.DoSquare(i,s);break}case t.JoinType.jtSquare:this.DoSquare(i,s);break;case t.JoinType.jtRound:this.DoRound(i,s);break}return s=i,s},t.ClipperOffset.prototype.DoSquare=function(i,s){var n=Math.tan(Math.atan2(this.m_sinA,this.m_normals[s].X*this.m_normals[i].X+this.m_normals[s].Y*this.m_normals[i].Y)/4);this.m_destPoly.push(new t.IntPoint2(t.ClipperOffset.Round(this.m_srcPoly[i].X+this.m_delta*(this.m_normals[s].X-this.m_normals[s].Y*n)),t.ClipperOffset.Round(this.m_srcPoly[i].Y+this.m_delta*(this.m_normals[s].Y+this.m_normals[s].X*n)))),this.m_destPoly.push(new t.IntPoint2(t.ClipperOffset.Round(this.m_srcPoly[i].X+this.m_delta*(this.m_normals[i].X+this.m_normals[i].Y*n)),t.ClipperOffset.Round(this.m_srcPoly[i].Y+this.m_delta*(this.m_normals[i].Y-this.m_normals[i].X*n))))},t.ClipperOffset.prototype.DoMiter=function(i,s,n){var a=this.m_delta/n;this.m_destPoly.push(new t.IntPoint2(t.ClipperOffset.Round(this.m_srcPoly[i].X+(this.m_normals[s].X+this.m_normals[i].X)*a),t.ClipperOffset.Round(this.m_srcPoly[i].Y+(this.m_normals[s].Y+this.m_normals[i].Y)*a)))},t.ClipperOffset.prototype.DoRound=function(i,s){for(var n=Math.atan2(this.m_sinA,this.m_normals[s].X*this.m_normals[i].X+this.m_normals[s].Y*this.m_normals[i].Y),a=Math.max(t.Cast_Int32(t.ClipperOffset.Round(this.m_StepsPerRad*Math.abs(n))),1),f=this.m_normals[s].X,d=this.m_normals[s].Y,m,y=0;y<a;++y)this.m_destPoly.push(new t.IntPoint2(t.ClipperOffset.Round(this.m_srcPoly[i].X+f*this.m_delta),t.ClipperOffset.Round(this.m_srcPoly[i].Y+d*this.m_delta))),m=f,f=f*this.m_cos-this.m_sin*d,d=m*this.m_sin+d*this.m_cos;this.m_destPoly.push(new t.IntPoint2(t.ClipperOffset.Round(this.m_srcPoly[i].X+this.m_normals[i].X*this.m_delta),t.ClipperOffset.Round(this.m_srcPoly[i].Y+this.m_normals[i].Y*this.m_delta)))},t.Error=function(i){try{throw new Error(i)}catch(s){alert(s.message)}},t.JS={},t.JS.AreaOfPolygon=function(i,s){return s||(s=1),t.Clipper.Area(i)/(s*s)},t.JS.AreaOfPolygons=function(i,s){s||(s=1);for(var n=0,a=0;a<i.length;a++)n+=t.Clipper.Area(i[a]);return n/(s*s)},t.JS.BoundsOfPath=function(i,s){return t.JS.BoundsOfPaths([i],s)},t.JS.BoundsOfPaths=function(i,s){s||(s=1);var n=t.Clipper.GetBounds(i);return n.left/=s,n.bottom/=s,n.right/=s,n.top/=s,n},t.JS.Clean=function(a,s){if(!(a instanceof Array))return[];var n=a[0]instanceof Array,a=t.JS.Clone(a);if(typeof s!="number"||s===null)return t.Error("Delta is not a number in Clean()."),a;if(a.length===0||a.length===1&&a[0].length===0||s<0)return a;n||(a=[a]);for(var f=a.length,d,m,y,v,T,N,E,B=[],H=0;H<f;H++)if(m=a[H],d=m.length,d!==0){if(d<3){y=m,B.push(y);continue}for(y=m,v=s*s,T=m[0],N=1,E=1;E<d;E++)(m[E].X-T.X)*(m[E].X-T.X)+(m[E].Y-T.Y)*(m[E].Y-T.Y)<=v||(y[N]=m[E],T=m[E],N++);T=m[N-1],(m[0].X-T.X)*(m[0].X-T.X)+(m[0].Y-T.Y)*(m[0].Y-T.Y)<=v&&N--,N<d&&y.splice(N,d-N),y.length&&B.push(y)}return!n&&B.length?B=B[0]:!n&&B.length===0?B=[]:n&&B.length===0&&(B=[[]]),B},t.JS.Clone=function(i){if(!(i instanceof Array))return[];if(i.length===0)return[];if(i.length===1&&i[0].length===0)return[[]];var s=i[0]instanceof Array;s||(i=[i]);var n=i.length,a,f,d,m,y=new Array(n);for(f=0;f<n;f++){for(a=i[f].length,m=new Array(a),d=0;d<a;d++)m[d]={X:i[f][d].X,Y:i[f][d].Y};y[f]=m}return s||(y=y[0]),y},t.JS.Lighten=function(i,s){if(!(i instanceof Array))return[];if(typeof s!="number"||s===null)return t.Error("Tolerance is not a number in Lighten()."),t.JS.Clone(i);if(i.length===0||i.length===1&&i[0].length===0||s<0)return t.JS.Clone(i);var n=i[0]instanceof Array;n||(i=[i]);var a,f,d,m,y,v,T,N,E,B,H,tt,et,lt,Ct,Ut,le,sn=i.length,rn=s*s,oe=[];for(a=0;a<sn;a++)if(d=i[a],v=d.length,v!==0){for(m=0;m<1e6;m++){for(y=[],v=d.length,d[v-1].X!==d[0].X||d[v-1].Y!==d[0].Y?(tt=1,d.push({X:d[0].X,Y:d[0].Y}),v=d.length):tt=0,H=[],f=0;f<v-2;f++)T=d[f],E=d[f+1],N=d[f+2],Ut=T.X,le=T.Y,et=N.X-Ut,lt=N.Y-le,(et!==0||lt!==0)&&(Ct=((E.X-Ut)*et+(E.Y-le)*lt)/(et*et+lt*lt),Ct>1?(Ut=N.X,le=N.Y):Ct>0&&(Ut+=et*Ct,le+=lt*Ct)),et=E.X-Ut,lt=E.Y-le,B=et*et+lt*lt,B<=rn&&(H[f+1]=1,f++);for(y.push({X:d[0].X,Y:d[0].Y}),f=1;f<v-1;f++)H[f]||y.push({X:d[f].X,Y:d[f].Y});if(y.push({X:d[v-1].X,Y:d[v-1].Y}),tt&&d.pop(),H.length)d=y;else break}v=y.length,y[v-1].X===y[0].X&&y[v-1].Y===y[0].Y&&y.pop(),y.length>2&&oe.push(y)}return n||(oe=oe[0]),typeof oe>"u"&&(oe=[]),oe},t.JS.PerimeterOfPath=function(i,s,n){if(typeof i>"u")return 0;var a=Math.sqrt,f=0,d,m,y=0,v=0,T=0,N=0,E=i.length;if(E<2)return 0;for(s&&(i[E]=i[0],E++);--E;)d=i[E],y=d.X,v=d.Y,m=i[E-1],T=m.X,N=m.Y,f+=a((y-T)*(y-T)+(v-N)*(v-N));return s&&i.pop(),f/n},t.JS.PerimeterOfPaths=function(i,s,n){n||(n=1);for(var a=0,f=0;f<i.length;f++)a+=t.JS.PerimeterOfPath(i[f],s,n);return a},t.JS.ScaleDownPath=function(i,s){var n,a;for(s||(s=1),n=i.length;n--;)a=i[n],a.X=a.X/s,a.Y=a.Y/s},t.JS.ScaleDownPaths=function(i,s){var n,a,f;for(s||(s=1),n=i.length;n--;)for(a=i[n].length;a--;)f=i[n][a],f.X=f.X/s,f.Y=f.Y/s},t.JS.ScaleUpPath=function(i,s){var n,a,f=Math.round;for(s||(s=1),n=i.length;n--;)a=i[n],a.X=f(a.X*s),a.Y=f(a.Y*s)},t.JS.ScaleUpPaths=function(i,s){var n,a,f,d=Math.round;for(s||(s=1),n=i.length;n--;)for(a=i[n].length;a--;)f=i[n][a],f.X=d(f.X*s),f.Y=d(f.Y*s)},t.ExPolygons=function(){return[]},t.ExPolygon=function(){this.outer=null,this.holes=null},t.JS.AddOuterPolyNodeToExPolygons=function(i,s){var n=new t.ExPolygon;n.outer=i.Contour();var a=i.Childs(),f=a.length;n.holes=new Array(f);var d,m,y,v,T,N;for(y=0;y<f;y++)for(d=a[y],n.holes[y]=d.Contour(),v=0,T=d.Childs(),N=T.length;v<N;v++)m=T[v],t.JS.AddOuterPolyNodeToExPolygons(m,s);s.push(n)},t.JS.ExPolygonsToPaths=function(i){var s,n,a,f,d=new t.Paths;for(s=0,a=i.length;s<a;s++)for(d.push(i[s].outer),n=0,f=i[s].holes.length;n<f;n++)d.push(i[s].holes[n]);return d},t.JS.PolyTreeToExPolygons=function(i){var s=new t.ExPolygons,n,a,f,d;for(a=0,f=i.Childs(),d=f.length;a<d;a++)n=f[a],t.JS.AddOuterPolyNodeToExPolygons(n,s);return s}})()}(si)),si.exports}var ul=fl();const fe=hl(ul);function cl(e,t){const l=e.map(_=>({X:_.x*1e6,Y:_.y*1e6})),o=t.map(_=>({X:_.x*1e6,Y:_.y*1e6})),h=new fe.Clipper,u=[];if(h.AddPath(l,fe.PolyType.ptSubject,!0),h.AddPath(o,fe.PolyType.ptClip,!0),!h.Execute(fe.ClipType.ctIntersection,u,fe.PolyFillType.pftNonZero,fe.PolyFillType.pftNonZero))throw new Error("   .");return u.map(_=>_.map(x=>({x:x.X/1e6,y:x.Y/1e6})))}function ns(e){for(var t=e.length,r=0,l=0;l<t;l++)r+=e[l%t].x*e[(l+1)%t].y-e[l%t].y*e[(l+1)%t].x;return Math.abs(r/2)}const we={COLOR:"#000000",STROKE:3,DASHLINE:[],SNAP_RIGHT:!0,SHIFT:!1,SHIFTTOOL:!1,SNAP_DEG:2.5,PEN_MIN_DIST:1,TEXT_RES:1.5,IMAGE_GLOBAL_PADDING:50,MIN_SELECT_PERCENT:.1,EXPORT_IMAGE_SCALE:3};function It(e){return we[e]}function pe(e,t){we[e]=t,console.log(`State updated: ${e} = ${t}`)}window.getState=It;window.setState=pe;window.state=we;function Cl(){return we.SHIFT||we.SHIFTTOOL}class dl{constructor(t){St(this,"id");St(this,"root");St(this,"two");St(this,"twoElements",{});St(this,"cachecdPolygon",{});St(this,"focused",!0);St(this,"renderRequested",!1);St(this,"history",[[]]);St(this,"lastID",0);console.log("Instance created"),this.id=rl(),this.root=document.createElement("div"),this.root.id=this.id,this.root.className="instance",this.two=new Y({fullscreen:!0}),this.two.appendTo(this.root),t.appendChild(this.root),this.setupRequestFrame()}getNewID(){return this.lastID++}setFocused(t){this.focused=t}focus(){this.focused=!0}blur(){this.focused=!1}requestRender(){this.renderRequested=!0}setupRequestFrame(){const t=()=>{if(!this.focused)return requestAnimationFrame(t);this.renderRequested&&(this.renderRequested=!1,this.two.update()),requestAnimationFrame(t)};t()}appendRectangle(t){const r=[new Y.Anchor(t.x,t.y),new Y.Anchor(t.x+t.width,t.y),new Y.Anchor(t.x+t.width,t.y+t.height),new Y.Anchor(t.x,t.y+t.height)],l=this.two.makePath(r);l.fill=t.fillColor,l.stroke=t.strokeColor,l.linewidth=t.strokeWidth;const o=this.getNewID();return this.twoElements[o]=l,this.cachecdPolygon[o]=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}],o}appendCircle(t){const r=nl(t.x,t.y,t.xRadius,t.yRadius,360),l=[...r].map(u=>new Y.Anchor(u.x,u.y)),o=this.two.makePath(l);o.fill=t.fillColor,o.stroke=t.strokeColor,o.linewidth=t.strokeWidth;const h=this.getNewID();return this.twoElements[h]=o,this.cachecdPolygon[h]=[...r],h}appendTriangle(t){const r=this.two.makePath([new Y.Anchor(t.x1,t.y1),new Y.Anchor(t.x2,t.y2),new Y.Anchor(t.x3,t.y3)]);r.fill=t.fillColor,r.stroke=t.strokeColor,r.linewidth=t.strokeWidth;const l=this.getNewID();return this.twoElements[l]=r,this.cachecdPolygon[l]=[{x:t.x1,y:t.y1},{x:t.x2,y:t.y2},{x:t.x3,y:t.y3}],l}appendPenPath(t){const r=ll([...t.points],t.strokeWidth),l=this.getNewID();this.cachecdPolygon[l]=[...r];const o=this.two.makePath(t.points.map(h=>new Y.Anchor(h.x,h.y)),!1,!0);return o.stroke=t.strokeColor,o.linewidth=t.strokeWidth,o.fill="transparent",this.twoElements[l]=o,this.twoElements[l].canvasData="PEN",l}appendLine(t){const r=this.two.makePath([new Y.Anchor(t.x1,t.y1),new Y.Anchor(t.x2,t.y2)]);r.stroke=t.strokeColor,r.linewidth=t.strokeWidth,r.dashes=t.dashArray||[];const l=this.getNewID();return this.twoElements[l]=r,this.cachecdPolygon[l]=ol({x:t.x1,y:t.y1},{x:t.x2,y:t.y2},t.strokeWidth),l}appendImage(t){const r=new Y.Texture(t.image),l=this.two.makeSprite(r,t.x,t.y);l.rotation=t.rotate;const o=t.width/t.image.width,h=t.height/t.image.height;l.scale=new Y.Vector(o,h);const u=this.getNewID();this.twoElements[u]=l;const c=t.width/2,p=t.height/2;return this.cachecdPolygon[u]=[{x:t.x-c,y:t.y-p},{x:t.x+c,y:t.y-p},{x:t.x+c,y:t.y+p},{x:t.x-c,y:t.y+p}],u}toTop(t){if(Array.isArray(t)){for(const l of t)this.toTop(l);return}const r=this.twoElements[t];this.two.scene.add(r)}clear(){this.two.clear(),this.twoElements=[]}setTransform(t,r,l){const o=this.twoElements[t];if(typeof l>"u"){o.translation.set(r,r);return}o.translation.set(r,l)}transform(t,r,l){this.twoElements[t].translation.add(new Y.Vector(r,l))}rotate(t,r){const l=this.twoElements[t];l.rotation+=r}rotateAbout(t,r,l,o){const h=this.twoElements[t],u=h.translation.x,c=h.translation.y,p=u-l,_=c-o,x=Math.cos(r),w=Math.sin(r),b=p*x-_*w,P=p*w+_*x;h.translation.set(b+l,P+o),h.rotation+=r}setRotate(t,r){const l=this.twoElements[t];l.rotation=r}setScale(t,r,l){const o=this.twoElements[t];if(typeof l>"u"){o.scale=r;return}else o.scale=new Y.Vector(r,l)}scaleAboutSelf(t,r,l){const o=this.twoElements[t],h=o.scale;typeof h=="number"?o.scale=new Y.Vector(h*r,h*r):o.scale=new Y.Vector(h.x*r,h.y*l)}scaleAboutRect(t,r,l,o){const h=this.twoElements[t],u=h.translation,c=h.scale;typeof c=="number"?h.scale=new Y.Vector(c*l,c*o):h.scale=new Y.Vector(c.x*l,c.y*o),h.translation.x=u.x*l+(1-l)*r.x,h.translation.y=u.y*o+(1-o)*r.y}flipX(t,r){const l=this.twoElements[t],o=l.translation,h=l.scale;typeof h=="number"?l.scale=new Y.Vector(-h,h):l.scale=new Y.Vector(-h.x,h.y),l.translation.x=2*r-o.x,this.cachePolygon(t)}flipY(t,r){const l=this.twoElements[t],o=l.translation,h=l.scale;typeof h=="number"?l.scale=new Y.Vector(h,-h):l.scale=new Y.Vector(h.x,-h.y),l.translation.y=2*r-o.y,this.cachePolygon(t)}cloneObject(t){const r=this.twoElements[t],l=this.two.makePath(r.vertices.map(h=>new Y.Anchor(h.x,h.y)),!1,!0);l.fill=r.fill,l.stroke=r.stroke,l.linewidth=r.linewidth+0,l.translation=new Y.Vector(r.translation.x,r.translation.y),l.rotation=r.rotation+0,l.scale=new Y.Vector(typeof r.scale=="number"?r.scale+0:r.scale.x+0,typeof r.scale=="number"?r.scale+0:r.scale.y+0),l.dashes=[...r.dashes];const o=this.getNewID();return this.twoElements[o]=l,this.cachecdPolygon[o]=[...this.cachecdPolygon[t]],o}cachePolygon(t){const r=this.twoElements[t],l=typeof r.scale=="number"?r.scale:r.scale.x,o=typeof r.scale=="number"?r.scale:r.scale.y;this.cachecdPolygon[t]=r.vertices.map(h=>{const u=Math.cos(r.rotation),c=Math.sin(r.rotation),p=h.x*l,_=h.y*o,x=p*u-_*c,w=p*c+_*u;return{x:x+r.position.x,y:w+r.position.y}})}removeElement(t){this.twoElements[t].remove(),delete this.twoElements[t],delete this.cachecdPolygon[t]}removeAt(t){const r=[];for(const l in this.twoElements)al(t,this.cachecdPolygon[l])&&(this.removeElement(Number(l)),r.push(Number(l)));return r}lassoSelect(t){const r=[];for(const l in this.twoElements){const o=cl(this.cachecdPolygon[Number(l)],t);if(o.length==0)continue;let h=0;const u=ns(this.cachecdPolygon[Number(l)]);for(const c of o)h+=ns(c);h>=u*It("MIN_SELECT_PERCENT")&&r.push(Number(l))}return r}saveAsHistory(){const t=Object.keys(this.twoElements).map(r=>this.exportElement(Number(r)));this.history.push(t),this.history.length>100&&this.history.shift()}undo(){if(this.history.length<=1)return;this.history.pop();const t=this.history[this.history.length-1];this.clear();for(const r of t)if(r.type==="image"){const l=this.appendImage(r);this.twoElements[l].rotation=r.rotate,this.twoElements[l].scale=r.scale}else{const l=this.getNewID();this.twoElements[l]=r.isPen?this.two.makePath(r.points.map(h=>new Y.Anchor(h.x,h.y)),!1,!0):this.two.makePath(r.points.map(h=>new Y.Anchor(h.x,h.y)));const o=this.twoElements[l];o.fill=r.fillColor,o.stroke=r.strokeColor,o.linewidth=r.strokeWidth,o.dashes=r.dash,o.rotation=r.rotation,o.scale=r.scale}}exportElement(t,r){const l=this.twoElements[t],o=l.position;if(l instanceof Y.Sprite){let h=l.texture.image;return r?new Promise(async u=>{const c=document.createElement("canvas"),p=c.getContext("2d");c.width=h.width,c.height=h.height,p.drawImage(h,0,0);const _=c.toDataURL("image/webp"),x=await fetch(_).then(w=>w.arrayBuffer());u({type:"image",x:o.x,y:o.y,width:l.width,height:l.height,rotate:l.rotation,image:x,scale:typeof l.scale=="number"?l.scale:{x:l.scale.x,y:l.scale.y}})}):{type:"image",x:o.x,y:o.y,width:l.width,height:l.height,rotate:l.rotation,image:h,scale:typeof l.scale=="number"?l.scale:{x:l.scale.x,y:l.scale.y}}}return{type:"path",points:l.vertices.map(h=>({x:h.x+o.x,y:h.y+o.y})),rotation:l.rotation,scale:typeof l.scale=="number"?l.scale:{x:l.scale.x,y:l.scale.y},fillColor:l.fill,strokeColor:l.stroke,strokeWidth:l.linewidth,dash:l.dashes,isPen:l.canvasData==="PEN"}}exportAsImage(){const t=this.two.renderer.domElement,r=new XMLSerializer().serializeToString(t),l=document.createElement("canvas"),o=l.getContext("2d");if(!o)return Promise.reject("Failed to get 2d context");const h=new Image,u=new Blob([r],{type:"image/svg+xml"}),c=URL.createObjectURL(u);return new Promise(p=>{h.onload=()=>{l.width=h.width*It("EXPORT_IMAGE_SCALE"),l.height=h.height*It("EXPORT_IMAGE_SCALE"),o.drawImage(h,0,0,l.width,l.height),URL.revokeObjectURL(c),p(l.toDataURL("image/png"))},h.src=c})}async exportAsJSON(){return await Promise.all(Object.keys(this.twoElements).map(r=>this.exportElement(Number(r),!0)))}async importFromJSON(t){this.clear();for(const r of t)if(r.type==="image"){const l=new Image,o=new Blob([r.image],{type:"image/webp"});await new Promise(h=>{l.onload=()=>{l.onload=null;const c=this.appendImage({x:r.x,y:r.y,width:r.width,height:r.height,image:l,rotate:r.rotate});this.twoElements[c].rotation=r.rotate,typeof r.scale=="number"?this.twoElements[c].scale=new Y.Vector(r.scale,r.scale):this.twoElements[c].scale=new Y.Vector(r.scale.x,r.scale.y),h()};const u=URL.createObjectURL(o);l.src=u})}else{const l=this.getNewID();this.twoElements[l]=r.isPen?this.two.makePath(r.points.map(h=>new Y.Anchor(h.x,h.y)),!1,!0):this.two.makePath(r.points.map(h=>new Y.Anchor(h.x,h.y)));const o=this.twoElements[l];o.fill=r.fillColor,o.stroke=r.strokeColor,o.linewidth=r.strokeWidth,o.dashes=r.dash,o.rotation=r.rotation,o.scale=r.scale}this.requestRender()}destroy(){this.two.clear(),this.two.unbind(),this.root.remove()}}class pl{constructor(t){St(this,"root");St(this,"instances",[]);St(this,"focusedInstance",-1);console.log("InstanceManager created"),this.root=t}createInstance(){const t=new dl(this.root);return t.root.style.display="none",this.instances.push(t),this.instances.length-1}focusInstance(t){this.focusedInstance!=-1&&(this.instances[this.focusedInstance].root.style.display="none"),this.focusedInstance=t,this.instances[this.focusedInstance].root.style.display="block"}nextInstance(){this.focusedInstance+1<this.instances.length?this.focusInstance(this.focusedInstance+1):(this.createInstance(),this.focusInstance(this.focusedInstance+1))}prevInstance(){this.focusedInstance-1>=0&&this.focusInstance(this.focusedInstance-1)}get focused(){return this.instances[this.focusedInstance]}clear(){this.instances.forEach(t=>t.destroy()),this.instances=[],this.focusedInstance=-1}}const _l="modulepreload",ml=function(e,t){return new URL(e,t).href},ls={},Fs=function(t,r,l){let o=Promise.resolve();if(r&&r.length>0){const u=document.getElementsByTagName("link"),c=document.querySelector("meta[property=csp-nonce]"),p=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));o=Promise.allSettled(r.map(_=>{if(_=ml(_,l),_ in ls)return;ls[_]=!0;const x=_.endsWith(".css"),w=x?'[rel="stylesheet"]':"";if(!!l)for(let C=u.length-1;C>=0;C--){const S=u[C];if(S.href===_&&(!x||S.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${_}"]${w}`))return;const P=document.createElement("link");if(P.rel=x?"stylesheet":_l,x||(P.as="script"),P.crossOrigin="",P.href=_,p&&P.setAttribute("nonce",p),document.head.appendChild(P),x)return new Promise((C,S)=>{P.addEventListener("load",C),P.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${_}`)))})}))}function h(u){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=u,window.dispatchEvent(c),!c.defaultPrevented)throw u}return o.then(u=>{for(const c of u||[])c.status==="rejected"&&h(c.reason);return t().catch(h)})};function gl(){let e=0;const t=document.querySelectorAll(".colorwrp");t.forEach((r,l)=>{r.children[0].style.background=r.children[1].value,r.addEventListener("click",()=>{e==l?r.children[1].click():t[e].classList.remove("focus"),e=l,r.classList.add("focus"),pe("COLOR",r.children[1].value)}),r.children[1].addEventListener("input",()=>{r.children[0].style.background=r.children[1].value,pe("COLOR",r.children[1].value)})})}function yl(){var t,r;const e=()=>{const l=document.getElementById("pageindi");l&&(l.innerText=`${zt.focusedInstance+1}/${zt.instances.length}`)};(t=document.getElementById("right"))==null||t.addEventListener("click",()=>{zt.nextInstance(),e()}),(r=document.getElementById("left"))==null||r.addEventListener("click",()=>{zt.prevInstance(),e()})}function vl(){const e=document.querySelectorAll("#strokes > .strkel"),t=document.getElementById("selstk"),r=[3,9,15];e.forEach((l,o)=>{l.addEventListener("click",()=>{t&&(t.style.left=`calc(1.5rem * ${o})`),pe("STROKE",r[o])})})}let Rs={};function Il(e,t){console.log(`Function registered: ${e}`),Rs[e]=t}let yi={},ri=null;function Tl(e,t,r=!1){console.log(`Tool registered: ${e}`),yi[e]=t,r&&Bs(e)}function Bs(e,t=!1){console.log(`Tool applied: ${e}`),ri&&ri(),ri=yi[e].apply(t)}function xl(){gl(),vl(),yl();let e=0;const t=document.querySelectorAll(".tool-button");t.forEach((r,l)=>{const o=r.getAttribute("data-tool");o&&r.addEventListener("click",()=>{e===l&&!yi[o].callEvenSelected||(t[e].classList.remove("active"),r.classList.add("active"),console.log(`Tool selected: ${o}`),Bs(o,e===l),e=l)})}),document.querySelectorAll(".function-button").forEach(r=>{const l=r.getAttribute("data-function");l&&r.addEventListener("click",()=>{console.log(`Function selected: ${l}`),Rs[l]()})}),document.addEventListener("keydown",r=>{r.keyCode===16&&pe("SHIFT",!0)}),document.addEventListener("keyup",r=>{r.keyCode===16&&pe("SHIFT",!1)})}Fs(()=>import("./index-Dg7vCluJ.js").then(e=>e.i),[],import.meta.url);Fs(()=>import("./index-DW8KqQ1Q.js"),[],import.meta.url);let zt;const Pl=()=>{const e=document.getElementById("drawnLayer");if(!e)return;const t=new pl(e);window.manager=t,zt=t,xl(),t.createInstance(),t.focusInstance(0);try{let l={width:0,height:0};require("electron").ipcRenderer.on("cap",(o,h)=>{const u=new Image;u.onload=()=>{u.onload=null;const c=u.width/l.width,p=document.createElement("canvas"),_=p.getContext("2d");if(!_)return;p.width=u.width,p.height=u.height,_.drawImage(u,0,0);const x=_.getImageData(h.start.x*c,h.start.y*c,(h.end.x-h.start.x)*c,(h.end.y-h.start.y)*c),w=document.createElement("canvas"),b=w.getContext("2d");if(!b)return;w.width=(h.end.x-h.start.x)*c,w.height=(h.end.y-h.start.y)*c,b.putImageData(x,0,0);const P=new Image;P.onload=()=>{P.onload=null;let[C,S]=[P.width,P.height];C/=c,S/=c,console.log(C,S),C>window.innerWidth-It("IMAGE_GLOBAL_PADDING")&&(S*=(window.innerWidth-It("IMAGE_GLOBAL_PADDING"))/C,C=window.innerWidth-It("IMAGE_GLOBAL_PADDING")),S>window.innerHeight-It("IMAGE_GLOBAL_PADDING")&&(C*=(window.innerHeight-It("IMAGE_GLOBAL_PADDING"))/S,S=window.innerHeight-It("IMAGE_GLOBAL_PADDING")),zt.focused.appendImage({width:C,height:S,image:P,rotate:0,x:window.innerWidth/2,y:window.innerHeight/2}),zt.focused.requestRender()},P.src=w.toDataURL()},u.src="image://png/"+Date.now()}),require("electron").ipcRenderer.on("screen",(o,h)=>{l=h})}catch{}const r=l=>{var h;const o=(h=l.clipboardData)==null?void 0:h.items;if(o)for(let u=0;u<o.length;u++){if(o[u].type.indexOf("image")===-1)continue;const c=o[u].getAsFile();if(!c)continue;const p=new FileReader;p.onload=_=>{var w;const x=new Image;x.onload=()=>{x.onload=null;const[b,P]=[x.width,x.height];let C=1;b>window.innerWidth-It("IMAGE_GLOBAL_PADDING")&&(C=(window.innerWidth-It("IMAGE_GLOBAL_PADDING"))/b),P*C>window.innerHeight-It("IMAGE_GLOBAL_PADDING")&&(C=(window.innerHeight-It("IMAGE_GLOBAL_PADDING"))/P),zt.focused.appendImage({x:window.innerWidth/2,y:window.innerHeight/2,width:b*C,height:P*C,image:x,rotate:0}),zt.focused.requestRender()},x.src=(w=_.target)==null?void 0:w.result},p.readAsDataURL(c)}};document.addEventListener("paste",r)};Pl();export{Fs as _,Tl as a,hl as b,wl as c,It as g,Cl as i,zt as m,Il as r,pe as s};
